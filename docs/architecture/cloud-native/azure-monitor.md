---
title: Azure Monitor
description: Azure モニターを使用してシステムを可視化する方法が実行されています。
ms.date: 02/05/2020
ms.openlocfilehash: 4e5ddba6c1c13dc65662a7748d4ae3a58a6a6f68
ms.sourcegitcommit: f87ad41b8e62622da126aa928f7640108c4eff98
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/07/2020
ms.locfileid: "80805633"
---
# <a name="azure-monitor"></a><span data-ttu-id="c2221-103">Azure Monitor</span><span class="sxs-lookup"><span data-stu-id="c2221-103">Azure Monitor</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="c2221-104">Azure に見られるクラウド アプリケーション監視ソリューションほど成熟したクラウド プロバイダーは他にありません。</span><span class="sxs-lookup"><span data-stu-id="c2221-104">No other cloud provider has as mature of a cloud application monitoring solution as that found in Azure.</span></span> <span data-ttu-id="c2221-105">Azure Monitor は、システムの状態の可視性、問題の把握、アプリケーションの最適化を提供するように設計されたツールのコレクションの名前です。</span><span class="sxs-lookup"><span data-stu-id="c2221-105">Azure Monitor is an umbrella name for a collection of tools designed to provide visibility into the state of your system, insights into any problems, and optimization of your application.</span></span>

<span data-ttu-id="c2221-106">![Azure Monitor は、クラウド ネイティブ アプリケーションがどのように機能しているかを分析するためのツールのコレクションです。](./media/azure-monitor.png)
**図 7-12**.</span><span class="sxs-lookup"><span data-stu-id="c2221-106">![Azure Monitor, a collection to tools to provide insight into how a cloud-native application is functioning.](./media/azure-monitor.png)
**Figure 7-12**.</span></span> <span data-ttu-id="c2221-107">Azure Monitor は、クラウド ネイティブ アプリケーションがどのように機能しているかを分析するためのツールのコレクションです。</span><span class="sxs-lookup"><span data-stu-id="c2221-107">Azure Monitor, a collection to tools to provide insight into how a cloud-native application is functioning.</span></span>

## <a name="gathering-logs-and-metrics"></a><span data-ttu-id="c2221-108">ログとメトリックの収集</span><span class="sxs-lookup"><span data-stu-id="c2221-108">Gathering logs and metrics</span></span>

<span data-ttu-id="c2221-109">あらゆる監視ソリューションの最初のステップは、できるだけ多くのデータを収集することです。</span><span class="sxs-lookup"><span data-stu-id="c2221-109">The first step in any monitoring solution is to gather as much data as possible.</span></span> <span data-ttu-id="c2221-110">収集できるデータが多ければ多いほど、得られる洞察はより深くなります。</span><span class="sxs-lookup"><span data-stu-id="c2221-110">The more data that can be gathered, the deeper the insights that can be obtained.</span></span> <span data-ttu-id="c2221-111">従来、計測システムは困難でした。</span><span class="sxs-lookup"><span data-stu-id="c2221-111">Instrumenting systems has traditionally been difficult.</span></span> <span data-ttu-id="c2221-112">簡易ネットワーク管理プロトコル (SNMP) は、マシン レベルの情報を収集するためのゴールドスタンダード プロトコルでしたが、多くの知識と構成が必要でした。</span><span class="sxs-lookup"><span data-stu-id="c2221-112">Simple Network Management Protocol (SNMP) was the gold standard protocol for collecting machine level information but it required a great deal of knowledge and configuring.</span></span> <span data-ttu-id="c2221-113">さいわい、この作業の多くは、最も一般的なメトリックが Azure Monitor によって自動的に収集されるため、排除されています。</span><span class="sxs-lookup"><span data-stu-id="c2221-113">Fortunately, much of this hard work has been eliminated as the most common metrics are gathered automatically by Azure Monitor.</span></span>

<span data-ttu-id="c2221-114">アプリケーション レベルのメトリックとイベントは、配置されるアプリケーションに固有であるため、自動的にはインストルメント化できません。</span><span class="sxs-lookup"><span data-stu-id="c2221-114">Application level metrics and events aren't possible to instrument automatically because they're specific to the application being deployed.</span></span> <span data-ttu-id="c2221-115">これらのメトリックを収集するために、顧客がサインアップまたは注文を完了したときなど、このような情報を直接報告[するために利用可能な SDK と API](https://docs.microsoft.com/azure/azure-monitor/app/api-custom-events-metrics)があります。</span><span class="sxs-lookup"><span data-stu-id="c2221-115">In order to gather these metrics, there are [SDKs and APIs available](https://docs.microsoft.com/azure/azure-monitor/app/api-custom-events-metrics) to directly report such information, such as when a customer signs up or completes an order.</span></span> <span data-ttu-id="c2221-116">例外は、アプリケーションインサイトを介して Azure Monitor にキャプチャおよびレポートを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="c2221-116">Exceptions can also be captured and reported back into Azure Monitor via Application Insights.</span></span> <span data-ttu-id="c2221-117">SDK は、クラウド ネイティブ アプリケーションで見つかったほとんどすべての言語をサポートします。</span><span class="sxs-lookup"><span data-stu-id="c2221-117">The SDKs support most every language found in Cloud Native Applications including Go, Python, JavaScript, and the .NET languages.</span></span>

<span data-ttu-id="c2221-118">アプリケーションの状態に関する情報を収集する最終的な目標は、エンド ユーザーが適切なエクスペリエンスを提供できるようにすることです。</span><span class="sxs-lookup"><span data-stu-id="c2221-118">The ultimate goal of gathering information about the state of your application is to ensure that your end users have a good experience.</span></span> <span data-ttu-id="c2221-119">外部で[Web テスト](https://docs.microsoft.com/azure/azure-monitor/app/monitor-web-app-availability)を実行するよりも、ユーザーに問題があるかどうかを確認する優れた方法は何ですか。</span><span class="sxs-lookup"><span data-stu-id="c2221-119">What better way to tell if users are experiencing issues than doing [outside-in web tests](https://docs.microsoft.com/azure/azure-monitor/app/monitor-web-app-availability)?</span></span> <span data-ttu-id="c2221-120">これらのテストは、世界中の場所からウェブサイトに ping を実行するのと同じくらい簡単に行うことができますし、エージェントがサイトにログインしてユーザーの操作をシミュレートするのと同じくらい簡単です。</span><span class="sxs-lookup"><span data-stu-id="c2221-120">These tests can be as simple as pinging your website from locations around the world or as involved as having agents log into the site and simulate user actions.</span></span>

## <a name="reporting-data"></a><span data-ttu-id="c2221-121">レポート データ</span><span class="sxs-lookup"><span data-stu-id="c2221-121">Reporting data</span></span>

<span data-ttu-id="c2221-122">データが収集されると、データを操作、要約、およびグラフにプロットして、ユーザーが問題が発生したときにすぐに表示されるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="c2221-122">Once the data is gathered, it can be manipulated, summarized, and plotted into charts, which allow users to instantly see when there are problems.</span></span> <span data-ttu-id="c2221-123">これらのグラフは、ダッシュボードやワークブック(システムのいくつかの側面についてのストーリーを伝えるように設計された複数ページのレポート)に集めることができます。</span><span class="sxs-lookup"><span data-stu-id="c2221-123">These charts can be gathered into dashboards or into Workbooks, a multi-page report designed to tell a story about some aspect of the system.</span></span>

<span data-ttu-id="c2221-124">人工知能や機械学習がなければ、現代のアプリケーションは完全ではありません。</span><span class="sxs-lookup"><span data-stu-id="c2221-124">No modern application would be complete without some artificial intelligence or machine learning.</span></span> <span data-ttu-id="c2221-125">この場合、データを Azure のさまざまな機械学習ツールに渡して、他の方法で非表示にする傾向や情報を抽出[できます](https://www.youtube.com/watch?v=Cuza-I1g9tw)。</span><span class="sxs-lookup"><span data-stu-id="c2221-125">To this end, data [can be passed](https://www.youtube.com/watch?v=Cuza-I1g9tw) to the various machine learning tools in Azure to allow you to extract trends and information that would otherwise be hidden.</span></span>

<span data-ttu-id="c2221-126">Application Insights は Kusto と呼ばれる強力なクエリ言語を提供し、レコードの検索、要約、さらにはグラフのプロットに使用できます。</span><span class="sxs-lookup"><span data-stu-id="c2221-126">Application Insights provides a powerful query language called Kusto that can be used to find records, summarize them, and even plot charts.</span></span> <span data-ttu-id="c2221-127">たとえば、このクエリは、2007 年 11 月のすべてのレコードを検索し、それらを州別にグループ化し、トップ 10 を円グラフとしてプロットします。</span><span class="sxs-lookup"><span data-stu-id="c2221-127">For instance, this query will locate all the records for the month of November 2007, group them by state, and plot the top 10 as a pie chart.</span></span>

```kusto
StormEvents
| where StartTime >= datetime(2007-11-01) and StartTime < datetime(2007-12-01)
| summarize count() by State
| top 10 by count_
| render piechart
```

<span data-ttu-id="c2221-128">![アプリケーション インサイト クエリ](./media/azure-monitor.png)
**図 7-13**の結果。</span><span class="sxs-lookup"><span data-stu-id="c2221-128">![The result of the Application Insights Query](./media/azure-monitor.png)
**Figure 7-13**.</span></span> <span data-ttu-id="c2221-129">アプリケーションインサイトクエリの結果。</span><span class="sxs-lookup"><span data-stu-id="c2221-129">The result of the Application Insights Query.</span></span>

<span data-ttu-id="c2221-130">1時間か2時間を過ごすのに最適な場所である[Kustoクエリを試すための遊び場](https://dataexplorer.azure.com/clusters/help/databases/Samples)があります。</span><span class="sxs-lookup"><span data-stu-id="c2221-130">There is a [playground for experimenting with Kusto](https://dataexplorer.azure.com/clusters/help/databases/Samples) queries, which is a fantastic place to spend an hour or two.</span></span> <span data-ttu-id="c2221-131">[サンプル クエリの](https://docs.microsoft.com/azure/kusto/query/samples)読み取りも有益です。</span><span class="sxs-lookup"><span data-stu-id="c2221-131">Reading [sample queries](https://docs.microsoft.com/azure/kusto/query/samples) can also be instructive.</span></span>

## <a name="dashboards"></a><span data-ttu-id="c2221-132">ダッシュボード</span><span class="sxs-lookup"><span data-stu-id="c2221-132">Dashboards</span></span>

<span data-ttu-id="c2221-133">Azure Monitor から情報を表示するために使用できるさまざまなダッシュボード テクノロジがいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="c2221-133">There are several different dashboard technologies that may be used to surface the information from Azure Monitor.</span></span> <span data-ttu-id="c2221-134">おそらく最も簡単なのは、アプリケーションインサイトでクエリを実行し、[データをチャートにプロットすることです](https://docs.microsoft.com/azure/azure-monitor/learn/tutorial-app-dashboards)。</span><span class="sxs-lookup"><span data-stu-id="c2221-134">Perhaps the simplest is to just run queries in Application Insights and [plot the data into a chart](https://docs.microsoft.com/azure/azure-monitor/learn/tutorial-app-dashboards).</span></span>

<span data-ttu-id="c2221-135">![メインの Azure ダッシュボード](./media/azure-monitor.png)
**の図 7-14**に埋め込まれたアプリケーション インサイト グラフの例。</span><span class="sxs-lookup"><span data-stu-id="c2221-135">![An example of Application Insights charts embedded in the main Azure Dashboard](./media/azure-monitor.png)
**Figure 7-14**.</span></span> <span data-ttu-id="c2221-136">メインの Azure ダッシュボードに埋め込まれたアプリケーション インサイト グラフの例。</span><span class="sxs-lookup"><span data-stu-id="c2221-136">An example of Application Insights charts embedded in the main Azure Dashboard.</span></span>

<span data-ttu-id="c2221-137">ダッシュボード機能を使用して、これらのグラフを Azure ポータルに適切に埋め込むことができます。</span><span class="sxs-lookup"><span data-stu-id="c2221-137">These charts can then be embedded in the Azure portal proper through use of the dashboard feature.</span></span> <span data-ttu-id="c2221-138">複数のデータ層にドリルダウンするなど、より厳密な要件を持つユーザーは[、Azure](https://powerbi.microsoft.com/)Monitor データを Power BI で使用できます。</span><span class="sxs-lookup"><span data-stu-id="c2221-138">For users with more exacting requirements, such as being able to drill down into several tiers of data, Azure Monitor data is available to [Power BI](https://powerbi.microsoft.com/).</span></span> <span data-ttu-id="c2221-139">Power BI は、さまざまなデータ ソースからデータを集約できる、業界をリードするエンタープライズ クラスのビジネス インテリジェンス ツールです。</span><span class="sxs-lookup"><span data-stu-id="c2221-139">Power BI is an industry-leading, enterprise class, business intelligence tool that can aggregate data from many different data sources.</span></span>

<span data-ttu-id="c2221-140">![Power BI ダッシュボード](./media/azure-monitor.png)
**の図 7-15 の**例を示します。</span><span class="sxs-lookup"><span data-stu-id="c2221-140">![An example Power BI dashboard](./media/azure-monitor.png)
**Figure 7-15**.</span></span> <span data-ttu-id="c2221-141">Power BI ダッシュボードの例。</span><span class="sxs-lookup"><span data-stu-id="c2221-141">An example Power BI dashboard.</span></span>

## <a name="alerts"></a><span data-ttu-id="c2221-142">警告</span><span class="sxs-lookup"><span data-stu-id="c2221-142">Alerts</span></span>

<span data-ttu-id="c2221-143">データ ダッシュボードを使用する場合は、不十分な場合があります。</span><span class="sxs-lookup"><span data-stu-id="c2221-143">Sometimes, having data dashboards is insufficient.</span></span> <span data-ttu-id="c2221-144">誰もダッシュボードを見るために目を覚ましていない場合でも、問題が解決されるか、検出されるまでに何時間もかかる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c2221-144">If nobody is awake to watch the dashboards, then it can still be many hours before a problem is addressed, or even detected.</span></span> <span data-ttu-id="c2221-145">このため、Azure Monitor は、一流の[アラート ソリューション](https://docs.microsoft.com/azure/azure-monitor/platform/alerts-overview)も提供します。</span><span class="sxs-lookup"><span data-stu-id="c2221-145">To this end, Azure Monitor also provides a top notch [alerting solution](https://docs.microsoft.com/azure/azure-monitor/platform/alerts-overview).</span></span> <span data-ttu-id="c2221-146">アラートは、次の条件を含むさまざまな条件によってトリガーされます。</span><span class="sxs-lookup"><span data-stu-id="c2221-146">Alerts can be triggered by a wide range of conditions including:</span></span>

- <span data-ttu-id="c2221-147">メトリックの値</span><span class="sxs-lookup"><span data-stu-id="c2221-147">Metric values</span></span>
- <span data-ttu-id="c2221-148">ログの検索クエリ</span><span class="sxs-lookup"><span data-stu-id="c2221-148">Log search queries</span></span>
- <span data-ttu-id="c2221-149">アクティビティ ログのイベント</span><span class="sxs-lookup"><span data-stu-id="c2221-149">Activity Log events</span></span>
- <span data-ttu-id="c2221-150">基になっている Azure プラットフォームの正常性</span><span class="sxs-lookup"><span data-stu-id="c2221-150">Health of the underlying Azure platform</span></span>
- <span data-ttu-id="c2221-151">Web サイトの可用性のテスト</span><span class="sxs-lookup"><span data-stu-id="c2221-151">Tests for web site availability</span></span>

<span data-ttu-id="c2221-152">アラートがトリガーされると、さまざまなタスクを実行できます。</span><span class="sxs-lookup"><span data-stu-id="c2221-152">When triggered, the alerts can perform a wide variety of tasks.</span></span> <span data-ttu-id="c2221-153">単純な面では、アラートはメーリングリストに電子メール通知を送信するか、またはテキストメッセージを個人に送信するだけです。</span><span class="sxs-lookup"><span data-stu-id="c2221-153">On the simple side, the alerts may just send an e-mail notification to a mailing list or a text message to an individual.</span></span> <span data-ttu-id="c2221-154">より複雑なアラートにより、特定のアプリケーションの呼び出し元を認識する PagerDuty などのツールでワークフローがトリガーされる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c2221-154">More involved alerts might trigger a workflow in a tool such as PagerDuty, which is aware of who is on call for a particular application.</span></span> <span data-ttu-id="c2221-155">アラートは、ワークフローの可能性が無限に近い[Microsoft Flow](https://flow.microsoft.com/)でアクションをトリガーできます。</span><span class="sxs-lookup"><span data-stu-id="c2221-155">Alerts can trigger actions in [Microsoft Flow](https://flow.microsoft.com/) unlocking near limitless possibilities for workflows.</span></span>

<span data-ttu-id="c2221-156">アラートの一般的な原因が特定されると、アラートの一般的な原因と、アラートを解決するための手順に関する詳細を使用して、アラートを強化できます。</span><span class="sxs-lookup"><span data-stu-id="c2221-156">As common causes of alerts are identified, the alerts can be enhanced with details about the common causes of the alerts and the steps to take to resolve them.</span></span> <span data-ttu-id="c2221-157">高度に成熟したクラウドネイティブアプリケーションの展開では、スケールセットから失敗したノードを削除したり、自動スケールアクティビティをトリガーしたりするアクションを実行する自己修復タスクを開始する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c2221-157">Highly mature cloud-native application deployments may opt to kick off self-healing tasks, which perform actions such as removing failing nodes from a scale set or triggering an autoscaling activity.</span></span> <span data-ttu-id="c2221-158">最終的には、システムが翌朝誰かが仕事に到着するまで、システムが補償したり、少なくともぐったりするように調整することができるので、ライブサイトの問題を解決するために午前2時にオンコール担当者を起こす必要はなくなるかもしれません。</span><span class="sxs-lookup"><span data-stu-id="c2221-158">Eventually it may no longer be necessary to wake up on-call personnel at 2AM to resolve a live-site issue as the system will be able to adjust itself to compensate or at least limp along until somebody arrives at work the next morning.</span></span>

<span data-ttu-id="c2221-159">Azure Monitor は、機械学習を自動的に活用して、デプロイされたアプリケーションの通常の動作パラメーターを理解します。</span><span class="sxs-lookup"><span data-stu-id="c2221-159">Azure Monitor automatically leverages machine learning to understand the normal operating parameters of deployed applications.</span></span> <span data-ttu-id="c2221-160">これにより、通常のパラメータの外部で動作しているサービスを検出できます。</span><span class="sxs-lookup"><span data-stu-id="c2221-160">This enables it to detect services that are operating outside of their normal parameters.</span></span> <span data-ttu-id="c2221-161">たとえば、サイトの平日のトラフィックは、1 分間に 10,000 件の要求になります。</span><span class="sxs-lookup"><span data-stu-id="c2221-161">For instance, the typical weekday traffic on the site might be 10,000 requests per minute.</span></span> <span data-ttu-id="c2221-162">そして、特定の週に、突然要求の数は、毎分20,000要求の非常に珍しいヒットします。</span><span class="sxs-lookup"><span data-stu-id="c2221-162">And then, on a given week, suddenly the number of requests hits a highly unusual 20,000 requests per minute.</span></span> <span data-ttu-id="c2221-163">[スマート検出](https://docs.microsoft.com/azure/azure-monitor/app/proactive-diagnostics)は、標準からのこの偏差に気づき、アラートをトリガーします。</span><span class="sxs-lookup"><span data-stu-id="c2221-163">[Smart Detection](https://docs.microsoft.com/azure/azure-monitor/app/proactive-diagnostics) will notice this deviation from the norm and trigger an alert.</span></span> <span data-ttu-id="c2221-164">同時に、トラフィックの負荷が予想される場合に誤検知を発生させないほど、トレンド分析は十分にスマートです。</span><span class="sxs-lookup"><span data-stu-id="c2221-164">At the same time, the trend analysis is smart enough to avoid firing false positives when the traffic load is expected.</span></span>

## <a name="references"></a><span data-ttu-id="c2221-165">References</span><span class="sxs-lookup"><span data-stu-id="c2221-165">References</span></span>

- [<span data-ttu-id="c2221-166">Azure Monitor</span><span class="sxs-lookup"><span data-stu-id="c2221-166">Azure Monitor</span></span>](https://docs.microsoft.com/azure/azure-monitor/overview)

>[!div class="step-by-step"]
><span data-ttu-id="c2221-167">[前へ](monitoring-azure-kubernetes.md)
>[次へ](identity.md)</span><span class="sxs-lookup"><span data-stu-id="c2221-167">[Previous](monitoring-azure-kubernetes.md)
[Next](identity.md)</span></span>
