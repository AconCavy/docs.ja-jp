---
title: Azure Monitor
description: Azure Monitor を使用すると、システムが実行されていることを確認できます。
ms.date: 09/23/2019
ms.openlocfilehash: 27503627217c71e4090674945830f6332b202a5b
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2019
ms.locfileid: "74281650"
---
# <a name="azure-monitor"></a><span data-ttu-id="6bd30-103">Azure Monitor</span><span class="sxs-lookup"><span data-stu-id="6bd30-103">Azure Monitor</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="6bd30-104">他のクラウドプロバイダーは、Azure でのクラウドアプリケーションの監視ソリューションの成熟度としては機能しません。</span><span class="sxs-lookup"><span data-stu-id="6bd30-104">No other cloud provider has as mature of a cloud application monitoring solution as that found in Azure.</span></span> <span data-ttu-id="6bd30-105">Azure Monitor は、システムの状態を可視化し、アプリケーションの問題や最適化に関する洞察を得ることができるように設計されたツールコレクションの包括的な名前です。</span><span class="sxs-lookup"><span data-stu-id="6bd30-105">Azure Monitor is an umbrella name for a collection of tools designed to provide visibility into the state of your system, insights into any problems and optimization of your application.</span></span>

<span data-ttu-id="6bd30-106">![Azure Monitor は、クラウドネイティブアプリケーションがどのように機能しているかについての洞察を提供するためのツールのコレクションです。](./media/azure-monitor.png)
**図 7-9**。</span><span class="sxs-lookup"><span data-stu-id="6bd30-106">![Azure Monitor, a collection to tools to provide insight into how a cloud-native application is functioning.](./media/azure-monitor.png)
**Figure 7-9**.</span></span> <span data-ttu-id="6bd30-107">Azure Monitor、クラウドネイティブアプリケーションがどのように機能しているかについての洞察を提供するためのツールのコレクションです。</span><span class="sxs-lookup"><span data-stu-id="6bd30-107">Azure Monitor, a collection to tools to provide insight into how a cloud-native application is functioning.</span></span>

## <a name="gathering-logs-and-metrics"></a><span data-ttu-id="6bd30-108">ログとメトリックの収集</span><span class="sxs-lookup"><span data-stu-id="6bd30-108">Gathering logs and metrics</span></span>

<span data-ttu-id="6bd30-109">監視ソリューションの最初の手順は、可能な限り多くのデータを収集することです。</span><span class="sxs-lookup"><span data-stu-id="6bd30-109">The first step in any monitoring solution is to gather as much data as possible.</span></span> <span data-ttu-id="6bd30-110">収集できるデータが多いほど、取得できる洞察が深くなります。</span><span class="sxs-lookup"><span data-stu-id="6bd30-110">The more data that can be gathered, the deeper the insights that can be obtained.</span></span> <span data-ttu-id="6bd30-111">従来、システムのインストルメント化は困難でした。</span><span class="sxs-lookup"><span data-stu-id="6bd30-111">Instrumenting systems has traditionally been difficult.</span></span> <span data-ttu-id="6bd30-112">Simple Network Management Protocol (SNMP) は、マシンレベルの情報を収集するための gold 標準プロトコルでしたが、多くの知識と構成を必要としていました。</span><span class="sxs-lookup"><span data-stu-id="6bd30-112">Simple Network Management Protocol (SNMP) was the gold standard protocol for collecting machine level information but it required a great deal of knowledge and configuring.</span></span> <span data-ttu-id="6bd30-113">幸いにも、最も一般的なメトリックは Azure Monitor によって自動的に収集されるため、このようなハード作業の大部分は排除されています。</span><span class="sxs-lookup"><span data-stu-id="6bd30-113">Fortunately, much of this hard work has been eliminated as the most common metrics are gathered automatically by Azure Monitor.</span></span>

<span data-ttu-id="6bd30-114">アプリケーションレベルのメトリックとイベントは、デプロイされるアプリケーションに対してローカルであるため、自動的にインストルメント化することはできません。</span><span class="sxs-lookup"><span data-stu-id="6bd30-114">Application level metrics and events aren't possible to instrument automatically because they're local to the application being deployed.</span></span> <span data-ttu-id="6bd30-115">これらのメトリックを収集するために、顧客が注文にサインアップまたは完了したときなど、このような情報を直接報告するための[sdk と api](https://docs.microsoft.com/azure/azure-monitor/app/api-custom-events-metrics)が用意されています。</span><span class="sxs-lookup"><span data-stu-id="6bd30-115">In order to gather these metrics, there are [SDKs and APIs available](https://docs.microsoft.com/azure/azure-monitor/app/api-custom-events-metrics) to directly report such information, such as when a customer signs up or completes an order.</span></span> <span data-ttu-id="6bd30-116">例外をキャプチャして、Application Insights 経由で Azure Monitor に返すこともできます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-116">Exceptions can also be captured and reported back into Azure Monitor via Application Insights.</span></span> <span data-ttu-id="6bd30-117">Sdk は、ゴー、Python、JavaScript、.NET 言語などのクラウドネイティブアプリケーションで検出されたほとんどすべての言語をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="6bd30-117">The SDKs support most every language found in Cloud Native Applications including Go, Python, JavaScript, and the .NET languages.</span></span>

<span data-ttu-id="6bd30-118">アプリケーションの状態に関する情報を収集する最終的な目標は、エンドユーザーのエクスペリエンスを向上させることです。</span><span class="sxs-lookup"><span data-stu-id="6bd30-118">The ultimate goal of gathering information about the state of your application is to ensure that your end users have a good experience.</span></span> <span data-ttu-id="6bd30-119">ユーザーが[外部の web テストを](https://docs.microsoft.com/azure/azure-monitor/app/monitor-web-app-availability)実行する場合よりも問題が発生しているかどうかを確認するには、どうすればよいでしょうか。</span><span class="sxs-lookup"><span data-stu-id="6bd30-119">What better way to tell if users are experiencing issues than doing [outside-in web tests](https://docs.microsoft.com/azure/azure-monitor/app/monitor-web-app-availability)?</span></span> <span data-ttu-id="6bd30-120">これらのテストは、世界中の場所から web サイトに ping を実行したり、エージェントがサイトにログインしてアクションを実行したりするのと同じように簡単に行うことができます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-120">These tests can be as simple as pinging your website from locations around the world or as involved as having agents log into the site and do actions.</span></span>

## <a name="reporting-data"></a><span data-ttu-id="6bd30-121">レポートデータ</span><span class="sxs-lookup"><span data-stu-id="6bd30-121">Reporting data</span></span>

<span data-ttu-id="6bd30-122">データが収集されると、データの操作、要約、およびグラフへのプロットが可能になり、問題が発生したときにすぐにユーザーが表示できるようになります。</span><span class="sxs-lookup"><span data-stu-id="6bd30-122">Once the data is gathered, it can be manipulated, summarized, and plotted into charts, which allow users to instantly see when there are problems.</span></span> <span data-ttu-id="6bd30-123">これらのグラフは、システムのいくつかの側面についてストーリーを示すために設計された複数ページのレポートである、ダッシュボードまたはブックに収集できます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-123">These charts can be gathered into dashboards or into Workbooks, a multi-page report designed to tell a story about some aspect of the system.</span></span>

<span data-ttu-id="6bd30-124">人工知能や機械学習を行わずに、最新のアプリケーションを完成させることはできません。</span><span class="sxs-lookup"><span data-stu-id="6bd30-124">No modern application would be complete without some artificial intelligence or machine learning.</span></span> <span data-ttu-id="6bd30-125">このため、Azure のさまざまな machine learning ツールにデータを[渡すことが](https://www.youtube.com/watch?v=Cuza-I1g9tw)できるため、表示されない傾向や情報を抽出できます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-125">To this end, data [can be passed](https://www.youtube.com/watch?v=Cuza-I1g9tw) to the various machine learning tools in Azure to allow you to extract trends and information that would otherwise be hidden.</span></span>

<span data-ttu-id="6bd30-126">Application Insights には Kusto と呼ばれる強力なクエリ言語が用意されており、これを使用してレコードの検索、集計、グラフのプロットを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-126">Application Insights provides a powerful query language called Kusto that can be used to find records, summarize them, and even plot charts.</span></span> <span data-ttu-id="6bd30-127">たとえば、このクエリでは、2007年11月のすべてのレコードが検索され、州ごとにグループ化され、上位10が円グラフとしてプロットされます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-127">For instance, this query will locate all the records for the month of November 2007, group them by state, and plot the top 10 as a pie chart.</span></span>

```kusto
StormEvents
| where StartTime >= datetime(2007-11-01) and StartTime < datetime(2007-12-01)
| summarize count() by State
| top 10 by count_
| render piechart
```

<span data-ttu-id="6bd30-128">Application Insights クエリの結果 ![、**図 7-10**](./media/azure-monitor.png)
ます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-128">![The result of the Application Insights Query](./media/azure-monitor.png)
**Figure 7-10**.</span></span> <span data-ttu-id="6bd30-129">Application Insights クエリの結果。</span><span class="sxs-lookup"><span data-stu-id="6bd30-129">The result of the Application Insights Query.</span></span>

<span data-ttu-id="6bd30-130">[Kusto クエリを試してみるためのプレイグラウンド](https://dataexplorer.azure.com/clusters/help/databases/Samples)は、1時間または2時間のすばらしい場所です。</span><span class="sxs-lookup"><span data-stu-id="6bd30-130">There is a [playground for experimenting with Kusto](https://dataexplorer.azure.com/clusters/help/databases/Samples) queries, which is a fantastic place to spend an hour or two.</span></span> <span data-ttu-id="6bd30-131">[サンプルクエリ](https://docs.microsoft.com/azure/kusto/query/samples)の読み取りも参考になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="6bd30-131">Reading [sample queries](https://docs.microsoft.com/azure/kusto/query/samples) can also be instructive.</span></span>

## <a name="dashboards"></a><span data-ttu-id="6bd30-132">ダッシュボード</span><span class="sxs-lookup"><span data-stu-id="6bd30-132">Dashboards</span></span>

<span data-ttu-id="6bd30-133">Azure Monitor から情報を表示するために使用できる、いくつかの異なるダッシュボードテクノロジがあります。</span><span class="sxs-lookup"><span data-stu-id="6bd30-133">There are several different dashboard technologies that may be used to surface the information from Azure Monitor.</span></span> <span data-ttu-id="6bd30-134">単純に、Application Insights でクエリを実行し、[データをグラフにプロット](https://docs.microsoft.com/azure/azure-monitor/learn/tutorial-app-dashboards)するだけです。</span><span class="sxs-lookup"><span data-stu-id="6bd30-134">Perhaps the simplest is to just run queries in Application Insights and [plot the data into a chart](https://docs.microsoft.com/azure/azure-monitor/learn/tutorial-app-dashboards).</span></span>

<span data-ttu-id="6bd30-135">メインの Azure ダッシュボードに埋め込まれた Application Insights グラフの例 ![](./media/azure-monitor.png)
**図 7-11**。</span><span class="sxs-lookup"><span data-stu-id="6bd30-135">![An example of Application Insights charts embedded in the main Azure Dashboard](./media/azure-monitor.png)
**Figure 7-11**.</span></span> <span data-ttu-id="6bd30-136">メインの Azure ダッシュボードに埋め込まれている Application Insights グラフの例を示します。</span><span class="sxs-lookup"><span data-stu-id="6bd30-136">An example of Application Insights charts embedded in the main Azure Dashboard.</span></span>

<span data-ttu-id="6bd30-137">これらのグラフは、ダッシュボード機能を使用して適切に Azure portal に埋め込むことができます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-137">These charts can then be embedded in the Azure portal proper through use of the dashboard feature.</span></span> <span data-ttu-id="6bd30-138">複数の層のデータにドリルダウンできるなど、より厳しい要件を持つユーザーには、 [Power BI](https://powerbi.microsoft.com/)がデータを Azure Monitor ことができます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-138">For users with more exacting requirements such as being able to drill down into several tiers of data Azure Monitor data is available to [Power BI](https://powerbi.microsoft.com/).</span></span> <span data-ttu-id="6bd30-139">Power BI は、業界をリードするエンタープライズクラスのビジネスインテリジェンスツールであり、さまざまなデータソースからデータを集計できます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-139">Power BI is an industry-leading, enterprise class, business intelligence tool that can aggregate data from many different data sources.</span></span>

<span data-ttu-id="6bd30-140">Power BI ダッシュボードの例を ![](./media/azure-monitor.png)
**図 7-12**。</span><span class="sxs-lookup"><span data-stu-id="6bd30-140">![An example Power BI dashboard](./media/azure-monitor.png)
**Figure 7-12**.</span></span> <span data-ttu-id="6bd30-141">ダッシュボード Power BI 例。</span><span class="sxs-lookup"><span data-stu-id="6bd30-141">An example Power BI dashboard.</span></span>

## <a name="alerts"></a><span data-ttu-id="6bd30-142">アラート</span><span class="sxs-lookup"><span data-stu-id="6bd30-142">Alerts</span></span>

<span data-ttu-id="6bd30-143">データダッシュボードが不十分な場合もあります。</span><span class="sxs-lookup"><span data-stu-id="6bd30-143">Sometimes, having data dashboards is insufficient.</span></span> <span data-ttu-id="6bd30-144">ダッシュボードの監視が開始されていない場合でも、問題が解決されるまで、または検出されるまでに数時間かかることがあります。</span><span class="sxs-lookup"><span data-stu-id="6bd30-144">If nobody is awake to watch the dashboards, then it can still be many hours before a problem is addressed, or even detected.</span></span> <span data-ttu-id="6bd30-145">このため、Azure Monitor には、上位ノッチの[アラートソリューション](https://docs.microsoft.com/azure/azure-monitor/platform/alerts-overview)も用意されています。</span><span class="sxs-lookup"><span data-stu-id="6bd30-145">To this end, Azure Monitor also provides a top notch [alerting solution](https://docs.microsoft.com/azure/azure-monitor/platform/alerts-overview).</span></span> <span data-ttu-id="6bd30-146">アラートは、次のような幅広い条件によってトリガーできます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-146">Alerts can be triggered by a wide range of conditions including:</span></span>

- <span data-ttu-id="6bd30-147">メトリック値</span><span class="sxs-lookup"><span data-stu-id="6bd30-147">Metric values</span></span>
- <span data-ttu-id="6bd30-148">ログ検索クエリ</span><span class="sxs-lookup"><span data-stu-id="6bd30-148">Log search queries</span></span>
- <span data-ttu-id="6bd30-149">アクティビティログイベント</span><span class="sxs-lookup"><span data-stu-id="6bd30-149">Activity Log events</span></span>
- <span data-ttu-id="6bd30-150">基になる Azure プラットフォームの正常性</span><span class="sxs-lookup"><span data-stu-id="6bd30-150">Health of the underlying Azure platform</span></span>
- <span data-ttu-id="6bd30-151">Web サイトの可用性のテスト</span><span class="sxs-lookup"><span data-stu-id="6bd30-151">Tests for web site availability</span></span>

<span data-ttu-id="6bd30-152">トリガーされると、アラートはさまざまなタスクを実行できます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-152">When triggered, the alerts can perform a wide variety of tasks.</span></span> <span data-ttu-id="6bd30-153">単純な側では、アラートは電子メールによる通知をメーリングリストまたはテキストメッセージに送信するだけです。</span><span class="sxs-lookup"><span data-stu-id="6bd30-153">On the simple side, the alerts may just send an e-mail notification to a mailing list or a text message to an individual.</span></span> <span data-ttu-id="6bd30-154">さらに関連するアラートによって、PagerDuty などのツールでワークフローがトリガーされることがあります。これは、特定のアプリケーションの呼び出し元を認識します。</span><span class="sxs-lookup"><span data-stu-id="6bd30-154">More involved alerts might trigger a workflow in a tool such as PagerDuty, which is aware of who is on call for a particular application.</span></span> <span data-ttu-id="6bd30-155">アラートは、ワークフローのほぼ無制限の可能性を[Microsoft Flow](https://flow.microsoft.com/)にロックを解除するアクションをトリガーできます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-155">Alerts can trigger actions in [Microsoft Flow](https://flow.microsoft.com/) unlocking near limitless possibilities for workflows.</span></span>

<span data-ttu-id="6bd30-156">アラートの一般的な原因を特定すると、アラートの原因と解決方法についての詳細情報を使用してアラートを強化できます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-156">As common causes of alerts are identified, the alerts can be enhanced with details about the common causes of the alerts and the steps to take to resolve them.</span></span> <span data-ttu-id="6bd30-157">クラウドネイティブアプリケーションの高成熟した展開では、障害が発生したノードをスケールセットから削除する、または自動スケールアクティビティをトリガーするなどのアクションを実行する自己復旧タスクを開始することを選択できます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-157">Highly mature Cloud Native Application deployments may opt to kick off self-healing tasks, which perform actions such as removing failing nodes from a scale set or triggering an autoscaling activity.</span></span> <span data-ttu-id="6bd30-158">最終的には、午前2時に勤務先の担当者をウェイクアップして、ライブサイトの問題を解決する必要がなくなる可能性があります。システムは、翌朝に仕事が到着するまで、補償または少なくとも limp を調整できるようにするためです。</span><span class="sxs-lookup"><span data-stu-id="6bd30-158">Eventually it may no longer be necessary to wake up on-call personnel at 2AM to resolve a live-site issue as the system will be able to adjust itself to compensate or at least limp along until somebody arrives at work the next morning.</span></span>

<span data-ttu-id="6bd30-159">Azure Monitor は、自動的に機械学習を活用して、デプロイされたアプリケーションの通常の動作パラメーターを把握します。</span><span class="sxs-lookup"><span data-stu-id="6bd30-159">Azure Monitor automatically leverages machine learning to understand the normal operating parameters of deployed applications.</span></span> <span data-ttu-id="6bd30-160">これにより、通常のパラメーターの外部で動作しているサービスを検出できます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-160">This enables it to detect services that are operating outside of their normal parameters.</span></span> <span data-ttu-id="6bd30-161">たとえば、サイトでの一般的な平日のトラフィックは、1分あたり1万の要求になることがあります。</span><span class="sxs-lookup"><span data-stu-id="6bd30-161">For instance, the typical weekday traffic on the site might be 10,000 requests per minute.</span></span> <span data-ttu-id="6bd30-162">その後、特定の週に、要求の数が突然、1分あたりの非常に異常な2万要求に達します。</span><span class="sxs-lookup"><span data-stu-id="6bd30-162">And then, on a given week, suddenly the number of requests hits a highly unusual 20,000 requests per minute.</span></span> <span data-ttu-id="6bd30-163">[スマート検出](https://docs.microsoft.com/azure/azure-monitor/app/proactive-diagnostics)では、この偏差が基準からのものであることがわかり、アラートがトリガーされます。</span><span class="sxs-lookup"><span data-stu-id="6bd30-163">[Smart Detection](https://docs.microsoft.com/azure/azure-monitor/app/proactive-diagnostics) will notice this deviation from the norm and trigger an alert.</span></span> <span data-ttu-id="6bd30-164">同時に、傾向分析は、トラフィックの負荷が予想されるときに偽陽性が発生しないようにするのに十分なスマートです。</span><span class="sxs-lookup"><span data-stu-id="6bd30-164">At the same time, the trend analysis is smart enough to avoid firing false positives when the traffic load is expected.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="6bd30-165">[前へ](monitoring-azure-kubernetes.md)
>[次へ](identity.md)</span><span class="sxs-lookup"><span data-stu-id="6bd30-165">[Previous](monitoring-azure-kubernetes.md)
[Next](identity.md)</span></span>
