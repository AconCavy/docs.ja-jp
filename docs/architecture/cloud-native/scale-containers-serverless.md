---
title: コンテナーとサーバーレスのアプリケーションのスケーリング
description: ユーザーの要求を満たすために、Azure Kubernetes サービスを使用してクラウドネイティブアプリケーションをスケーリングします。
ms.date: 04/13/2020
ms.openlocfilehash: b4580e6994611ad394bbaa2d5bb07f64c2798569
ms.sourcegitcommit: 5988e9a29cedb8757320817deda3c08c6f44a6aa
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2020
ms.locfileid: "82199925"
---
# <a name="scaling-containers-and-serverless-applications"></a><span data-ttu-id="5520e-103">コンテナーとサーバーレスのアプリケーションのスケーリング</span><span class="sxs-lookup"><span data-stu-id="5520e-103">Scaling containers and serverless applications</span></span>

<span data-ttu-id="5520e-104">アプリケーションの規模を設定するには、次の2つの方法があります。前者は容量を1つのリソースに追加することを示していますが、後者は容量を増やすためにリソースを追加することを意味しています。</span><span class="sxs-lookup"><span data-stu-id="5520e-104">There are two ways to scale an application: up or out. The former refers to adding capacity to a single resource, while the latter refers to adding more resources to increase capacity.</span></span>

## <a name="the-simple-solution-scaling-up"></a><span data-ttu-id="5520e-105">単純な解決策: スケールアップ</span><span class="sxs-lookup"><span data-stu-id="5520e-105">The simple solution: scaling up</span></span>

<span data-ttu-id="5520e-106">CPU、メモリ、ディスク i/o 速度、およびネットワーク i/o 速度が向上している既存のホストサーバーをアップグレードすることを、*スケールアップ*と呼びます。</span><span class="sxs-lookup"><span data-stu-id="5520e-106">Upgrading an existing host server with increased CPU, memory, disk I/O speed, and network I/O speed is known as *scaling up*.</span></span> <span data-ttu-id="5520e-107">クラウドネイティブアプリケーションをスケールアップするには、クラウドベンダーから、より多くの対応リソースを選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5520e-107">Scaling up a cloud-native application involves choosing more capable resources from the cloud vendor.</span></span> <span data-ttu-id="5520e-108">たとえば、Kubernetes クラスター内のより大きな Vm を含む新しいノードプールを作成できます。</span><span class="sxs-lookup"><span data-stu-id="5520e-108">For example, you can a new node pool with larger VMs in your Kubernetes cluster.</span></span> <span data-ttu-id="5520e-109">次に、コンテナー化されたサービスを新しいプールに移行します。</span><span class="sxs-lookup"><span data-stu-id="5520e-109">Then, migrate your containerized services to the new pool.</span></span>

<span data-ttu-id="5520e-110">サーバーレスアプリをスケールアップするには、専用の app service プランから[Premium Functions プラン](https://docs.microsoft.com/azure/azure-functions/functions-scale)または premium インスタンスのサイズを選択します。</span><span class="sxs-lookup"><span data-stu-id="5520e-110">Serverless apps scale up by choosing the [premium Functions plan](https://docs.microsoft.com/azure/azure-functions/functions-scale) or premium instance sizes from a dedicated app service plan.</span></span>

## <a name="scaling-out-cloud-native-apps"></a><span data-ttu-id="5520e-111">クラウドネイティブアプリのスケールアウト</span><span class="sxs-lookup"><span data-stu-id="5520e-111">Scaling out cloud-native apps</span></span>

<span data-ttu-id="5520e-112">クラウドネイティブアプリケーションでは、多くの場合、必要に応じて大規模な変動が発生し、その時点の通知にスケールが必要です。</span><span class="sxs-lookup"><span data-stu-id="5520e-112">Cloud-native applications often experience large fluctuations in demand and require scale on a moment's notice.</span></span> <span data-ttu-id="5520e-113">スケールアウトを優先します。スケールアウトは、既存のクラスターにコンピューター (ノードと呼ばれます) またはアプリケーションインスタンスを追加することによって、水平方向に実行されます。</span><span class="sxs-lookup"><span data-stu-id="5520e-113">They favor scaling out. Scaling out is done horizontally by adding additional machines (called nodes) or application instances to an existing cluster.</span></span> <span data-ttu-id="5520e-114">Kubernetes では、アプリの構成設定 ([ノードプールのスケーリング](https://docs.microsoft.com/azure/aks/use-multiple-node-pools#scale-a-node-pool-manually)など) を調整するか、自動スケールを使用して手動でスケールすることができます。</span><span class="sxs-lookup"><span data-stu-id="5520e-114">In Kubernetes, you can scale manually by adjusting configuration settings for the app (for example, [scaling a node pool](https://docs.microsoft.com/azure/aks/use-multiple-node-pools#scale-a-node-pool-manually)), or through autoscaling.</span></span>

<span data-ttu-id="5520e-115">AKS クラスターは、次の2つの方法のいずれかで自動スケールできます。</span><span class="sxs-lookup"><span data-stu-id="5520e-115">AKS clusters can autoscale in one of two ways:</span></span>

<span data-ttu-id="5520e-116">まず、[水平ポッドオートスケーラー](https://docs.microsoft.com/azure/aks/tutorial-kubernetes-scale#autoscale-pods)はリソースの需要を監視し、ポッドレプリカに合わせて自動的にサイズを調整します。</span><span class="sxs-lookup"><span data-stu-id="5520e-116">First, the [Horizontal Pod Autoscaler](https://docs.microsoft.com/azure/aks/tutorial-kubernetes-scale#autoscale-pods) monitors resource demand and automatically scales your POD replicas to meet it.</span></span> <span data-ttu-id="5520e-117">トラフィックが増加すると、サービスをスケールアウトするために、追加のレプリカが自動的にプロビジョニングされます。</span><span class="sxs-lookup"><span data-stu-id="5520e-117">When traffic increases, additional replicas are automatically provisioned to scale out your services.</span></span> <span data-ttu-id="5520e-118">同様に、要求が減少すると、サービスをスケールインするために削除されます。</span><span class="sxs-lookup"><span data-stu-id="5520e-118">Likewise, when demand decreases, they're removed to scale-in your services.</span></span> <span data-ttu-id="5520e-119">スケールするメトリック (CPU 使用率など) を定義します。</span><span class="sxs-lookup"><span data-stu-id="5520e-119">You define the metric on which to scale, for example, CPU usage.</span></span> <span data-ttu-id="5520e-120">また、実行するレプリカの最小数と最大数を指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="5520e-120">You can also specify the minimum and maximum number of replicas to run.</span></span> <span data-ttu-id="5520e-121">AKS はそのメトリックを監視し、それに応じてスケールします。</span><span class="sxs-lookup"><span data-stu-id="5520e-121">AKS monitors that metric and scales accordingly.</span></span>

<span data-ttu-id="5520e-122">次に、 [AKS Cluster オートスケーラー](https://docs.microsoft.com/azure/aks/cluster-autoscaler)機能を使用すると、需要に合わせて自動的に Kubernetes クラスター全体にコンピューティングノードをスケーリングできます。</span><span class="sxs-lookup"><span data-stu-id="5520e-122">Next, the [AKS Cluster Autoscaler](https://docs.microsoft.com/azure/aks/cluster-autoscaler) feature enables you to automatically scale compute nodes across a Kubernetes cluster to meet demand.</span></span> <span data-ttu-id="5520e-123">この機能を使用すると、のコンピューティング容量が必要になるたびに、基になる Azure 仮想マシンスケールセットに新しい Vm を自動的に追加できます。</span><span class="sxs-lookup"><span data-stu-id="5520e-123">With it, you can automatically add new VMs to the underlying Azure Virtual Machine Scale Set whenever more compute capacity of is required.</span></span> <span data-ttu-id="5520e-124">また、不要になったときにノードが削除されます。</span><span class="sxs-lookup"><span data-stu-id="5520e-124">It also removes nodes when no longer required.</span></span>

<span data-ttu-id="5520e-125">図3-13 に、これら2つのスケーリングサービスの関係を示します。</span><span class="sxs-lookup"><span data-stu-id="5520e-125">Figure 3-13 shows the relationship between these two scaling services.</span></span>

![App Service プランをスケールアウトします。](./media/aks-cluster-autoscaler.png)

<span data-ttu-id="5520e-127">**図 3-13**.</span><span class="sxs-lookup"><span data-stu-id="5520e-127">**Figure 3-13**.</span></span> <span data-ttu-id="5520e-128">App Service プランをスケールアウトします。</span><span class="sxs-lookup"><span data-stu-id="5520e-128">Scaling out an App Service plan.</span></span>

<span data-ttu-id="5520e-129">同時に作業することで、必要に応じた需要をサポートするために、コンテナーインスタンスとコンピューティングノードの数が最適になります。</span><span class="sxs-lookup"><span data-stu-id="5520e-129">Working together, both ensure an optimal number of container instances and compute nodes to support fluctuating demand.</span></span> <span data-ttu-id="5520e-130">水平ポッドオートスケーラーは、必要なポッドの数を最適化します。</span><span class="sxs-lookup"><span data-stu-id="5520e-130">The horizontal pod autoscaler optimizes the number of pods required.</span></span> <span data-ttu-id="5520e-131">クラスターオートスケーラーは、必要なノードの数を最適化します。</span><span class="sxs-lookup"><span data-stu-id="5520e-131">The cluster autoscaler optimizes the number of nodes required.</span></span>

### <a name="scaling-azure-functions"></a><span data-ttu-id="5520e-132">Azure Functions のスケーリング</span><span class="sxs-lookup"><span data-stu-id="5520e-132">Scaling Azure Functions</span></span>

<span data-ttu-id="5520e-133">Azure Functions、必要に応じて自動的にスケールアウトされます。</span><span class="sxs-lookup"><span data-stu-id="5520e-133">Azure Functions automatically scale out upon demand.</span></span> <span data-ttu-id="5520e-134">サーバーリソースは、トリガーされたイベントの数に基づいて動的に割り当てられ、削除されます。</span><span class="sxs-lookup"><span data-stu-id="5520e-134">Server resources are dynamically allocated and removed based on the number of triggered events.</span></span> <span data-ttu-id="5520e-135">関数の実行時に消費されるコンピューティングリソースに対してのみ課金されます。</span><span class="sxs-lookup"><span data-stu-id="5520e-135">You're only charged for compute resources consumed when your functions run.</span></span> <span data-ttu-id="5520e-136">課金は、実行回数、実行時間、および使用されたメモリに基づいて行われます。</span><span class="sxs-lookup"><span data-stu-id="5520e-136">Billing is based upon the number of executions, execution time, and memory used.</span></span>

<span data-ttu-id="5520e-137">既定の従量課金プランでは、ほとんどのアプリに対して経済的でスケーラブルなソリューションが提供されますが、premium オプションを使用すると、開発者はカスタム Azure Functions 要件を柔軟に設定できます。</span><span class="sxs-lookup"><span data-stu-id="5520e-137">While the default consumption plan provides an economical and scalable solution for most apps, the premium option allows developers flexibility for custom Azure Functions requirements.</span></span> <span data-ttu-id="5520e-138">Premium プランにアップグレードすると、インスタンスサイズ、事前に準備された med-v インスタンス (コールドスタートの遅延を回避するため)、および専用 Vm を制御できるようになります。</span><span class="sxs-lookup"><span data-stu-id="5520e-138">Upgrading to the premium plan provides control over instance sizes, pre-warmed instances (to avoid cold start delays), and dedicated VMs.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="5520e-139">[前へ](deploy-containers-azure.md)
>[次へ](other-deployment-options.md)</span><span class="sxs-lookup"><span data-stu-id="5520e-139">[Previous](deploy-containers-azure.md)
[Next](other-deployment-options.md)</span></span>
