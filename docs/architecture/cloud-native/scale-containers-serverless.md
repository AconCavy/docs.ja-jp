---
title: コンテナーとサーバーレスのアプリケーションのスケーリング
description: 個々のマシンリソースを増やしたり、アプリケーションクラスター内のマシンの数を増やしたりすることにより、クラウドネイティブアプリケーションを Azure Kubernetes Service でスケーリングし、ユーザーのニーズを満たすことができます。
ms.date: 09/23/2019
ms.openlocfilehash: 2d0537fb3ed56beb4eccbf9b8c34a5d87793413b
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/23/2019
ms.locfileid: "73841013"
---
# <a name="scaling-containers-and-serverless-applications"></a><span data-ttu-id="9f965-103">コンテナーとサーバーレスのアプリケーションのスケーリング</span><span class="sxs-lookup"><span data-stu-id="9f965-103">Scaling containers and serverless applications</span></span>

<span data-ttu-id="9f965-104">アプリケーションをスケーリングするには、スケールアップとスケールアウトの2つの一般的な方法があります。前者は、1つのホストに機能を追加することを指し、後者はホストの合計数に追加することを示しています。</span><span class="sxs-lookup"><span data-stu-id="9f965-104">There are two typical ways to scale an application: scaling up and scaling out. The former refers to adding capabilities to one host, while the latter refers to adding to the total number of hosts.</span></span> <span data-ttu-id="9f965-105">これについて考えてみるための一般的な比喩は、友人と友人の間で友人を手にする方法です。</span><span class="sxs-lookup"><span data-stu-id="9f965-105">A common analogy to use to think about this is how to get yourself and some friends across town.</span></span> <span data-ttu-id="9f965-106">友人が1人だけの場合は、2台の座席レース車にホップできます。</span><span class="sxs-lookup"><span data-stu-id="9f965-106">If it's just one friend, you could hop into your two-seat race car.</span></span> <span data-ttu-id="9f965-107">ただし、3つまたは4つの場合は、容量を増やすためにスケールアップする、SUVs または minivan のいずれかを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9f965-107">But if it's three or four, you might need to take one of your SUVs or a minivan, scaling up to increase capacity.</span></span> <span data-ttu-id="9f965-108">ただし、合計数が数十以上になると、場合によっては、複数の車両 (だれかがバスを運転している場合を除く) が必要になることがあります。これは、インスタンスを追加することによるスケールアウトの概念を示しています (この例では、より多くの車両)。</span><span class="sxs-lookup"><span data-stu-id="9f965-108">When your total number jumps up to a dozen or more, though, you probably need to take multiple vehicles (unless someone drives a bus), which demonstrates the concept of scaling out by adding more instances (in this case, more vehicles).</span></span> <span data-ttu-id="9f965-109">これがアプリケーションにどのように適用されるかを見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="9f965-109">Let's see how this applies to our applications.</span></span>

## <a name="the-simple-solution-scaling-up"></a><span data-ttu-id="9f965-110">単純な解決策: スケールアップ</span><span class="sxs-lookup"><span data-stu-id="9f965-110">The simple solution: scaling up</span></span>

<span data-ttu-id="9f965-111">既存のサーバーをアップグレードしてより多くのリソースを提供するプロセス (CPU、メモリ、ディスク i/o 速度、ネットワーク i/o 速度) は、*スケールアップ*として知られています。</span><span class="sxs-lookup"><span data-stu-id="9f965-111">The process of upgrading existing servers to give them more resources (CPU, memory, disk I/O speed, network I/O speed) is known as *scaling up*.</span></span> <span data-ttu-id="9f965-112">クラウドネイティブアプリケーションでは、スケールアップは通常、物理マシンに実際のハードウェアを購入してインストールすることを意味するのではなく、利用可能なオプションの一覧からより多くの機能を備えたプランを選択します。</span><span class="sxs-lookup"><span data-stu-id="9f965-112">In cloud-native applications, scaling up doesn't typically refer to purchasing and installing actual hardware on physical machines so much as choosing a more capable plan from a list of options available.</span></span> <span data-ttu-id="9f965-113">クラウドネイティブアプリは、通常、Kubernetes ノードプール内の個々のノードをホストするために使用される仮想マシン (VM) のサイズを変更することによってスケールアップします。</span><span class="sxs-lookup"><span data-stu-id="9f965-113">Cloud-native apps typically scale up by modifying the virtual machine (VM) size used to host the individual nodes in their Kubernetes node pool.</span></span> <span data-ttu-id="9f965-114">ノード、クラスター、ポッドなどの Kubernetes の概念については、[次のセクション](leverage-containers-orchestrators.md)で詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="9f965-114">Kubernetes concepts like nodes, clusters, and pods are described further in [the next section](leverage-containers-orchestrators.md).</span></span> <span data-ttu-id="9f965-115">Azure では、 [Windows](https://docs.microsoft.com/azure/virtual-machines/windows/sizes?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)と[Linux](https://docs.microsoft.com/azure/virtual-machines/linux/sizes)の両方を実行するさまざまな VM サイズをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="9f965-115">Azure supports a wide variety of VM sizes running both [Windows](https://docs.microsoft.com/azure/virtual-machines/windows/sizes?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) and [Linux](https://docs.microsoft.com/azure/virtual-machines/linux/sizes).</span></span> <span data-ttu-id="9f965-116">アプリケーションを垂直方向にスケーリングするには、より大きなノードの VM サイズで新しいノードプールを作成し、ワークロードを新しいプールに移行します。</span><span class="sxs-lookup"><span data-stu-id="9f965-116">To vertically scale your application, create a new node pool with a larger node VM size and then migrate workloads to the new pool.</span></span> <span data-ttu-id="9f965-117">これには、 [AKS クラスターに複数のノードプール](https://docs.microsoft.com/azure/aks/use-multiple-node-pools)が必要です。これは、現在プレビュー段階にある機能です。</span><span class="sxs-lookup"><span data-stu-id="9f965-117">This requires [multiple node pools for your AKS cluster](https://docs.microsoft.com/azure/aks/use-multiple-node-pools), a feature that is currently in preview.</span></span> <span data-ttu-id="9f965-118">サーバーレスアプリは、 [premium プラン](https://docs.microsoft.com/azure/azure-functions/functions-scale)と premium インスタンスのサイズを選択するか、別の専用 app service プランを選択することでスケールアップします。</span><span class="sxs-lookup"><span data-stu-id="9f965-118">Serverless apps scale up by choosing a [premium plan](https://docs.microsoft.com/azure/azure-functions/functions-scale) and premium instance sizes or by choosing a different dedicated app service plan.</span></span>

## <a name="scaling-out-cloud-native-apps"></a><span data-ttu-id="9f965-119">クラウドネイティブアプリのスケールアウト</span><span class="sxs-lookup"><span data-stu-id="9f965-119">Scaling out cloud-native apps</span></span>

<span data-ttu-id="9f965-120">クラウドネイティブアプリは、追加のノードまたはポッドをサービス要求に追加することによって、スケールアウトをサポートします。</span><span class="sxs-lookup"><span data-stu-id="9f965-120">Cloud-native apps support scaling out by adding additional nodes or pods to service requests.</span></span> <span data-ttu-id="9f965-121">これは、アプリの構成設定 ([ノードプールのスケーリング](https://docs.microsoft.com/azure/aks/use-multiple-node-pools#scale-a-node-pool-manually)など) を調整するか、自動*スケール*を使用して手動で行うことができます。</span><span class="sxs-lookup"><span data-stu-id="9f965-121">This can be accomplished manually by adjusting configuration settings for the app (for example, [scaling a node pool](https://docs.microsoft.com/azure/aks/use-multiple-node-pools#scale-a-node-pool-manually)), or through *autoscaling*.</span></span> <span data-ttu-id="9f965-122">自動スケールでは、要求に応答するためにアプリによって使用されるリソースを調整します。これは、サーモスタットが追加の暖房や冷却のためにを呼び出すことによって温度に応答する方法と似ています。</span><span class="sxs-lookup"><span data-stu-id="9f965-122">Autoscaling adjusts the resources used by an app in order to respond to demand, similar to how a thermostat responds to temperature by calling for additional heating or cooling.</span></span> <span data-ttu-id="9f965-123">自動スケールを使用する場合、手動によるスケーリングは無効になります。</span><span class="sxs-lookup"><span data-stu-id="9f965-123">When using autoscaling, manual scaling is disabled.</span></span>

<span data-ttu-id="9f965-124">AKS クラスターは、次の2つの方法のいずれかで拡張できます。</span><span class="sxs-lookup"><span data-stu-id="9f965-124">AKS clusters can scale in one of two ways:</span></span>

- <span data-ttu-id="9f965-125">[クラスターオートスケーラー](https://docs.microsoft.com/azure/aks/cluster-autoscaler)は、リソースの制約のためにノードにスケジュールできないポッドを監視します。</span><span class="sxs-lookup"><span data-stu-id="9f965-125">The [cluster autoscaler](https://docs.microsoft.com/azure/aks/cluster-autoscaler) watches for pods that can't be scheduled on nodes because of resource constraints.</span></span> <span data-ttu-id="9f965-126">必要に応じてノードが追加されます。</span><span class="sxs-lookup"><span data-stu-id="9f965-126">It adds additional nodes as required.</span></span>
- <span data-ttu-id="9f965-127">**水平ポッドオートスケーラー**は、Kubernetes クラスターのメトリックサーバーを使用してポッドのリソース要求を監視します。</span><span class="sxs-lookup"><span data-stu-id="9f965-127">The **horizontal pod autoscaler** uses the Metrics Server in a Kubernetes cluster to monitor the resource demands of pods.</span></span> <span data-ttu-id="9f965-128">サービスにより多くのリソースが必要な場合、オートスケーラーはポッドの数を増やします。</span><span class="sxs-lookup"><span data-stu-id="9f965-128">If a service needs more resources, the autoscaler increases the number of pods.</span></span>

<span data-ttu-id="9f965-129">図3-13 に、これら2つのスケーリングサービスの関係を示します。</span><span class="sxs-lookup"><span data-stu-id="9f965-129">Figure 3-13 shows the relationship between these two scaling services.</span></span>

![App Service プランをスケールアウトします。](./media/aks-cluster-autoscaler.png)

<span data-ttu-id="9f965-131">**図 3-13**.</span><span class="sxs-lookup"><span data-stu-id="9f965-131">**Figure 3-13**.</span></span> <span data-ttu-id="9f965-132">App Service プランをスケールアウトします。</span><span class="sxs-lookup"><span data-stu-id="9f965-132">Scaling out an App Service plan.</span></span>

<span data-ttu-id="9f965-133">これらのサービスは、必要に応じてポッドまたはノードの数を減らすこともできます。</span><span class="sxs-lookup"><span data-stu-id="9f965-133">These services can also reduce the number of pods or nodes as needed.</span></span> <span data-ttu-id="9f965-134">これらの2つのサービスは連携して動作し、多くの場合、クラスターにデプロイされます。</span><span class="sxs-lookup"><span data-stu-id="9f965-134">These two services can work together and are often deployed together in a cluster.</span></span> <span data-ttu-id="9f965-135">これを組み合わせると、アプリケーションの需要に対応するために必要なポッドの数を実行することが、水平ポッドのオートスケーラーに集中します。</span><span class="sxs-lookup"><span data-stu-id="9f965-135">When combined, the horizontal pod autoscaler is focused on running the number of pods required to meet application demand.</span></span> <span data-ttu-id="9f965-136">クラスターオートスケーラーは、スケジュールされたポッドをサポートするために必要なノード数の実行に重点を置いています。</span><span class="sxs-lookup"><span data-stu-id="9f965-136">The cluster autoscaler is focused on running the number of nodes required to support the scheduled pods.</span></span>

### <a name="scaling-azure-functions"></a><span data-ttu-id="9f965-137">スケーリング Azure Functions</span><span class="sxs-lookup"><span data-stu-id="9f965-137">Scaling Azure Functions</span></span>

<span data-ttu-id="9f965-138">Azure Functions は、スケールアウトを自動的にサポートします。既定の従量課金プランでは、受信するトリガーイベントの数に基づいて、リソースが動的に追加 (および削除) されます。</span><span class="sxs-lookup"><span data-stu-id="9f965-138">Azure Functions automatically supports scaling out. The default consumption plan adds (and removes) resources dynamically based on the number of triggering events coming in.</span></span> <span data-ttu-id="9f965-139">使用されているコンピューティングリソースに対して課金されるのは、実行回数、実行時間、およびメモリ使用量に基づいて、関数が実行されている場合のみです。</span><span class="sxs-lookup"><span data-stu-id="9f965-139">You're only charged for compute resources being used when your functions are running based on the number of executions, execution time, and memory used.</span></span> <span data-ttu-id="9f965-140">Premium プランを使用すると、これらの同じ機能を利用できますが、使用するインスタンスサイズを制御したり、インスタンスが既に稼働状態になっていることを確認したり (コールドスタートの遅延を回避するため)、関数を実行する専用 Vm を構成したりすることもできます。</span><span class="sxs-lookup"><span data-stu-id="9f965-140">Using the premium plan, you get these same features but you can also control the instance sizes that are used, have instances already warmed up (to avoid cold start delays), and configure dedicated VMs on which to run your functions.</span></span> <span data-ttu-id="9f965-141">既定の構成では、ほとんどのアプリに対して経済的でスケーラブルなソリューションが提供されますが、premium オプションを使用すると、開発者はカスタム Azure Functions 要件を柔軟に設定できます。</span><span class="sxs-lookup"><span data-stu-id="9f965-141">While the default configuration should provide an economical and scalable solution for most apps, the premium option allows developers flexibility for custom Azure Functions requirements.</span></span>

## <a name="references"></a><span data-ttu-id="9f965-142">関連項目</span><span class="sxs-lookup"><span data-stu-id="9f965-142">References</span></span>

- [<span data-ttu-id="9f965-143">複数のノードプールの AKS</span><span class="sxs-lookup"><span data-stu-id="9f965-143">AKS Multiple Node Pools</span></span>](https://docs.microsoft.com/azure/aks/use-multiple-node-pools)
- [<span data-ttu-id="9f965-144">AKS クラスターオートスケーラー</span><span class="sxs-lookup"><span data-stu-id="9f965-144">AKS Cluster Autoscaler</span></span>](https://docs.microsoft.com/azure/aks/cluster-autoscaler)
- [<span data-ttu-id="9f965-145">チュートリアル: AKS でのアプリケーションのスケーリング</span><span class="sxs-lookup"><span data-stu-id="9f965-145">Tutorial: Scale applications in AKS</span></span>](https://docs.microsoft.com/azure/aks/tutorial-kubernetes-scale)
- [<span data-ttu-id="9f965-146">Azure Functions のスケールとホスト</span><span class="sxs-lookup"><span data-stu-id="9f965-146">Azure Functions scale and hosting</span></span>](https://docs.microsoft.com/azure/azure-functions/functions-scale)

>[!div class="step-by-step"]
><span data-ttu-id="9f965-147">[前へ](deploy-containers-azure.md)
>[次へ](other-deployment-options.md)</span><span class="sxs-lookup"><span data-stu-id="9f965-147">[Previous](deploy-containers-azure.md)
[Next](other-deployment-options.md)</span></span>
