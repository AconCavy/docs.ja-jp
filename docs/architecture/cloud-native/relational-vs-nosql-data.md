---
title: リレーショナル データ ソースとNoSQL データ
description: クラウドネイティブアプリケーションのリレーショナルデータとNoSQLデータについて学ぶ
author: robvet
ms.date: 01/22/2020
ms.openlocfilehash: 3fb3dcc3a87e278c05f3e15d261245f4d61453d1
ms.sourcegitcommit: f87ad41b8e62622da126aa928f7640108c4eff98
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/07/2020
ms.locfileid: "80805798"
---
# <a name="relational-vs-nosql-data"></a><span data-ttu-id="8ee01-103">リレーショナル データ ソースとNoSQL データ</span><span class="sxs-lookup"><span data-stu-id="8ee01-103">Relational vs. NoSQL data</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="8ee01-104">リレーショナルと NoSQL は、一般的にクラウドネイティブアプリケーションに実装される 2 種類のデータベースシステムです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-104">Relational and NoSQL are two types of database systems commonly implemented in cloud-native apps.</span></span> <span data-ttu-id="8ee01-105">異なる方法で構築され、データの保存方法が異なり、アクセス方法が異なります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-105">They're built differently, store data differently, and accessed differently.</span></span> <span data-ttu-id="8ee01-106">このセクションでは、両方を見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="8ee01-106">In this section, we'll look at both.</span></span> <span data-ttu-id="8ee01-107">この章の後半では *、NewSQL*という新しいデータベーステクノロジについて説明します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-107">Later in this chapter, we'll look at an emerging database technology called *NewSQL*.</span></span>

<span data-ttu-id="8ee01-108">*リレーショナル データベース*は、何十年もの間普及しているテクノロジです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-108">*Relational databases* have been a prevalent technology for decades.</span></span> <span data-ttu-id="8ee01-109">成熟し、実績があり、広く実装されています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-109">They're mature, proven, and widely implemented.</span></span> <span data-ttu-id="8ee01-110">競合するデータベース製品、ツーリング、専門知識が豊富に含まれています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-110">Competing database products, tooling, and expertise abound.</span></span> <span data-ttu-id="8ee01-111">リレーショナル データベースは、関連するデータ テーブルのストアを提供します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-111">Relational databases provide a store of related data tables.</span></span> <span data-ttu-id="8ee01-112">これらのテーブルには固定スキーマがあり、SQL (構造化照会言語) を使用してデータを管理し、ACID 保証をサポートします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-112">These tables have a fixed schema, use SQL (Structured Query Language) to manage data, and support ACID guarantees.</span></span>

<span data-ttu-id="8ee01-113">*SQL データベースは*、高パフォーマンスで非リレーショナル データ ストアを参照します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-113">*No-SQL databases* refer to high-performance, non-relational data stores.</span></span> <span data-ttu-id="8ee01-114">使いやすさ、スケーラビリティ、復元性、可用性の特性に優れています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-114">They excel in their ease-of-use, scalability, resilience, and availability characteristics.</span></span> <span data-ttu-id="8ee01-115">正規化されたデータのテーブルを結合する代わりに、NoSQL は構造化されていないデータまたは半構造化されたデータを、多くの場合、キーと値のペアまたは JSON ドキュメントに格納します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-115">Instead of joining tables of normalized data, NoSQL stores unstructured or semi-structured data, often in key-value pairs or JSON documents.</span></span> <span data-ttu-id="8ee01-116">通常、SQL データベースは、単一のデータベース・パーティションの範囲を超える ACID 保証を提供しません。</span><span class="sxs-lookup"><span data-stu-id="8ee01-116">No-SQL databases typically don't provide ACID guarantees beyond the scope of a single database partition.</span></span> <span data-ttu-id="8ee01-117">サブ秒応答時間を必要とする大量のサービスは、NoSQL データストアを優先します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-117">High volume services that require sub second response time favor NoSQL datastores.</span></span>

<span data-ttu-id="8ee01-118">分散クラウドネイティブシステムに対する[NoSQL](https://www.geeksforgeeks.org/introduction-to-nosql/)テクノロジーの影響は、誇張することはできません。</span><span class="sxs-lookup"><span data-stu-id="8ee01-118">The impact of [NoSQL](https://www.geeksforgeeks.org/introduction-to-nosql/) technologies for distributed cloud-native systems can't be overstated.</span></span> <span data-ttu-id="8ee01-119">この分野で新しいデータテクノロジが普及し、かつてはリレーショナルデータベースのみに依存していたソリューションが混乱しています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-119">The proliferation of new data technologies in this space has disrupted solutions that once exclusively relied on relational databases.</span></span>

<span data-ttu-id="8ee01-120">NoSQL データベースには、データにアクセスして管理するための複数の異なるモデルが含まれ、それぞれが特定のユースケースに適しています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-120">NoSQL databases include several different models for accessing and managing data, each suited to specific use cases.</span></span> <span data-ttu-id="8ee01-121">図 5-9 に、一般的なモデルを 4 つ示します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-121">Figure 5-9 presents four common models.</span></span>

![NoSQL データモデル](./media/types-of-nosql-datastores.png)

<span data-ttu-id="8ee01-123">**図 5-9**: NoSQL データベースのデータ モデル</span><span class="sxs-lookup"><span data-stu-id="8ee01-123">**Figure 5-9**: Data models for NoSQL databases</span></span>

| <span data-ttu-id="8ee01-124">モデル</span><span class="sxs-lookup"><span data-stu-id="8ee01-124">Model</span></span> | <span data-ttu-id="8ee01-125">特性</span><span class="sxs-lookup"><span data-stu-id="8ee01-125">Characteristics</span></span> |
| :-------- | :-------- |
| <span data-ttu-id="8ee01-126">ドキュメント ストア</span><span class="sxs-lookup"><span data-stu-id="8ee01-126">Document Store</span></span> | <span data-ttu-id="8ee01-127">データとメタデータは、データベース内の JSON ベースのドキュメントに階層的に格納されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-127">Data and metadata are stored hierarchically in JSON-based documents inside the database.</span></span> |
| <span data-ttu-id="8ee01-128">キー値ストア</span><span class="sxs-lookup"><span data-stu-id="8ee01-128">Key Value Store</span></span> | <span data-ttu-id="8ee01-129">最も単純な NoSQL データベースでは、データはキーと値のペアのコレクションとして表されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-129">The simplest of the NoSQL databases, data is represented as a collection of key-value pairs.</span></span> |
| <span data-ttu-id="8ee01-130">ワイドカラムストア</span><span class="sxs-lookup"><span data-stu-id="8ee01-130">Wide-Column Store</span></span> | <span data-ttu-id="8ee01-131">関連データは、1 つの列内に入れ子になったキーと値のペアのセットとして格納されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-131">Related data is stored as a set of nested-key/value pairs within a single column.</span></span> |
| <span data-ttu-id="8ee01-132">グラフストア</span><span class="sxs-lookup"><span data-stu-id="8ee01-132">Graph Store</span></span> | <span data-ttu-id="8ee01-133">データは、ノード、エッジ、およびデータのプロパティとしてグラフ構造に格納されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-133">Data is stored in a graph structure as node, edge, and data properties.</span></span> |

## <a name="the-cap-theorem"></a><span data-ttu-id="8ee01-134">CAP定理</span><span class="sxs-lookup"><span data-stu-id="8ee01-134">The CAP theorem</span></span>

<span data-ttu-id="8ee01-135">これらのタイプのデータベースの違いを理解する方法として、状態を格納する分散システムに適用される一連の原則である CAP 定理を検討してください。</span><span class="sxs-lookup"><span data-stu-id="8ee01-135">As a way to understand the differences between these types of databases, consider the CAP theorem, a set of principles applied to distributed systems that store state.</span></span> <span data-ttu-id="8ee01-136">図 5-10 は、CAP 定理の 3 つのプロパティを示しています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-136">Figure 5-10 shows the three properties of the CAP theorem.</span></span>

![CAP 定理](./media/cap-theorem.png)

<span data-ttu-id="8ee01-138">**図 5-10**</span><span class="sxs-lookup"><span data-stu-id="8ee01-138">**Figure 5-10**.</span></span> <span data-ttu-id="8ee01-139">CAP定理</span><span class="sxs-lookup"><span data-stu-id="8ee01-139">The CAP theorem</span></span>

<span data-ttu-id="8ee01-140">この定理では、分散データ システムは、整合性、可用性、およびパーティション許容範囲の間のトレードオフを提供すると述べています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-140">The theorem states that distributed data systems will offer a trade-off between consistency, availability, and partition tolerance.</span></span> <span data-ttu-id="8ee01-141">また、どのデータベースでも、次の 3 つのプロパティのうち*2 つの*プロパティしか保証できません。</span><span class="sxs-lookup"><span data-stu-id="8ee01-141">And, that any database can only guarantee *two* of the three properties:</span></span>

- <span data-ttu-id="8ee01-142">*一貫性。*</span><span class="sxs-lookup"><span data-stu-id="8ee01-142">*Consistency.*</span></span> <span data-ttu-id="8ee01-143">すべてのレプリカが更新されるまでシステムが要求をブロックする必要がある場合でも、クラスター内のすべてのノードが最新のデータで応答します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-143">Every node in the cluster responds with the most recent data, even if the system must block the request until all replicas update.</span></span> <span data-ttu-id="8ee01-144">現在更新中のアイテムに対して"整合性のあるシステム" を照会する場合は、すべてのレプリカが正常に更新されるまで、その応答を待ちます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-144">If you query a "consistent system" for an item that is currently updating, you'll wait for that response until all replicas successfully update.</span></span> <span data-ttu-id="8ee01-145">ただし、最新のデータを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-145">However, you'll receive the most current data.</span></span>

- <span data-ttu-id="8ee01-146">*可用性。*</span><span class="sxs-lookup"><span data-stu-id="8ee01-146">*Availability.*</span></span> <span data-ttu-id="8ee01-147">すべてのノードは、その応答が最新のデータではない場合でも、即時応答を返します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-147">Every node returns an immediate response, even if that response isn't the most recent data.</span></span> <span data-ttu-id="8ee01-148">更新中のアイテムに対して "使用可能なシステム" を照会すると、その時点でサービスが提供できる最適な回答が得られます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-148">If you query an "available system" for an item that is updating, you'll get the best possible answer the service can provide at that moment.</span></span>

- <span data-ttu-id="8ee01-149">*パーティション許容度。*</span><span class="sxs-lookup"><span data-stu-id="8ee01-149">*Partition Tolerance.*</span></span> <span data-ttu-id="8ee01-150">レプリケートされたデータ ノードに障害が発生した場合や、他のレプリケートされたデータ ノードとの接続が失われた場合でも、システムの動作を継続します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-150">Guarantees the system continues to operate even if a replicated data node fails or loses connectivity with other replicated data nodes.</span></span>

<span data-ttu-id="8ee01-151">リレーショナル データベースは、通常、整合性と可用性を提供しますが、パーティションの許容範囲は提供しません。</span><span class="sxs-lookup"><span data-stu-id="8ee01-151">Relational databases typically provide consistency and availability, but not partition tolerance.</span></span> <span data-ttu-id="8ee01-152">通常、単一のサーバーにプロビジョニングされ、マシンにリソースを追加して垂直方向にスケーリングします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-152">They're typically provisioned to a single server and scale vertically by adding more resources to the machine.</span></span>

<span data-ttu-id="8ee01-153">多くのリレーショナル データベース システムでは、プライマリ データベースのコピーを他のセカンダリ サーバー インスタンスにコピーできる組み込みのレプリケーション機能がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-153">Many relational database systems support built-in replication features where copies of the primary database can be made to other secondary server instances.</span></span> <span data-ttu-id="8ee01-154">書き込み操作はプライマリ インスタンスに対して行われ、各セカンダリにレプリケートされます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-154">Write operations are made to the primary instance and replicated to each of the secondaries.</span></span> <span data-ttu-id="8ee01-155">障害が発生した場合、プライマリ インスタンスはセカンダリにフェールオーバーして高可用性を実現できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-155">Upon a failure, the primary instance can fail over to a secondary to provide high availability.</span></span> <span data-ttu-id="8ee01-156">セカンダリは、読み取り操作を分散するためにも使用できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-156">Secondaries can also be used to distribute read operations.</span></span> <span data-ttu-id="8ee01-157">書き込み操作は常にプライマリ レプリカに対して行われますが、読み取り操作は任意のセカンダリにルーティングされ、システム負荷を軽減できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-157">While writes operations always go against the primary replica, read operations can be routed to any of the secondaries to reduce system load.</span></span>

<span data-ttu-id="8ee01-158">シャーディング など、複数のノード間でデータ[を水平方向に](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-scale-introduction)分割することもできます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-158">Data can also be horizontally partitioned across multiple nodes, such as with [sharding](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-scale-introduction).</span></span> <span data-ttu-id="8ee01-159">しかし、シャーディングは、容易に通信できない多くの部分にデータを吐き出すことで、運用上のオーバーヘッドを大幅に増加させます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-159">But, sharding dramatically increases operational overhead by spitting data across many pieces that cannot easily communicate.</span></span> <span data-ttu-id="8ee01-160">管理にはコストがかかり、時間がかかる場合があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-160">It can be costly and time consuming to manage.</span></span> <span data-ttu-id="8ee01-161">最終的には、パフォーマンス、テーブル結合、参照整合性に影響を与える可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-161">It can end up impacting performance, table joins, and referential integrity.</span></span>

<span data-ttu-id="8ee01-162">データ レプリカが"非常に一貫性のある" リレーショナル データベース クラスタでネットワーク接続を失うと、データベースに書き込む機能はありません。</span><span class="sxs-lookup"><span data-stu-id="8ee01-162">If data replicas were to lose network connectivity in a "highly consistent" relational database cluster, you wouldn't be able to write to the database.</span></span> <span data-ttu-id="8ee01-163">システムは、その変更を他のデータ レプリカにレプリケートできないので、書き込み操作を拒否します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-163">The system would reject the write operation as it can't replicate that change to the other data replica.</span></span> <span data-ttu-id="8ee01-164">トランザクションを完了する前に、すべてのデータ レプリカを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-164">Every data replica has to update before the transaction can complete.</span></span>

<span data-ttu-id="8ee01-165">NoSQL データベースは、通常、高可用性とパーティション許容度をサポートします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-165">NoSQL databases typically support high availability and partition tolerance.</span></span> <span data-ttu-id="8ee01-166">多くの場合、コモディティ サーバー間で水平方向にスケール アウトします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-166">They scale out horizontally, often across commodity servers.</span></span> <span data-ttu-id="8ee01-167">このアプローチは、地理的地域内および地域全体で、コストを削減して、驚異的な可用性を提供します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-167">This approach provides tremendous availability, both within and across geographical regions at a reduced cost.</span></span> <span data-ttu-id="8ee01-168">これらのマシンまたはノード間でデータをパーティション化してレプリケートし、冗長性とフォールト トレランスを実現します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-168">You partition and replicate data across these machines, or nodes, providing redundancy and fault tolerance.</span></span> <span data-ttu-id="8ee01-169">欠点は一貫性です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-169">The downside is consistency.</span></span> <span data-ttu-id="8ee01-170">1 つの NoSQL ノード上のデータの変更は、他のノードに伝播するのに時間がかかる場合があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-170">A change to data on one NoSQL node can take some time to propagate to other nodes.</span></span> <span data-ttu-id="8ee01-171">通常、NoSQL データベースノードは、提示されたデータが古く、まだ更新されていない場合でも、クエリに対して即時応答を提供します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-171">Typically, a NoSQL database node will provide an immediate response to a query - even if the data that is presented is stale and hasn't updated yet.</span></span>

<span data-ttu-id="8ee01-172">「高可用性」NoSQL データベースクラスターでデータレプリカの接続が失われた場合でも、データベースへの書き込み操作を完了できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-172">If data replicas were to lose connectivity in a "highly available" NoSQL database cluster, you could still complete a write operation to the database.</span></span> <span data-ttu-id="8ee01-173">データベース クラスタは書き込み操作を許可し、各データ レプリカが使用可能になったときに更新します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-173">The database cluster would allow the write operation and update each data replica as it becomes available.</span></span>

<span data-ttu-id="8ee01-174">この種の結果は、ACID トランザクションがサポートされていない分散データ システムの特性である、最終的な整合性と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-174">This kind of result is known as eventual consistency, a characteristic of distributed data systems where ACID transactions aren't supported.</span></span> <span data-ttu-id="8ee01-175">データ項目の更新と、その更新を各レプリカ ノードに反映するのにかかる時間の間の短い遅延です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-175">It's a brief delay between the update of a data item and time that it takes to propagate that update to each of the replica nodes.</span></span> <span data-ttu-id="8ee01-176">通常の条件では、通常はラグは短いですが、問題が発生すると増加する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-176">Under normal conditions, the lag is typically short, but can increase when problems arise.</span></span> <span data-ttu-id="8ee01-177">たとえば、米国の NoSQL データベースの製品項目を更新し、ヨーロッパのレプリカ ノードから同じデータ項目をクエリするとどうなるでしょうか。</span><span class="sxs-lookup"><span data-stu-id="8ee01-177">For example, what would happen if you were to update a product item in a NoSQL database in the United States and query that same data item from a replica node in Europe?</span></span> <span data-ttu-id="8ee01-178">クラスターが製品の変更に伴ってヨーロッパのノードを更新するまで、以前の製品情報を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-178">You would receive the earlier product information, until the cluster updates the European node with the product change.</span></span> <span data-ttu-id="8ee01-179">クエリ結果をすぐに返し、すべてのレプリカ ノードの更新を待たないと、膨大な規模とボリュームが得られますが、古いデータを表示する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-179">By immediately returning a query result and not waiting for all replica nodes to update, you gain enormous scale and volume, but with the possibility of presenting older data.</span></span>

<span data-ttu-id="8ee01-180">高い可用性と大規模なスケーラビリティは、多くの場合、強力な一貫性よりもビジネスにとって重要です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-180">High availability and massive scalability are often more critical to the business than strong consistency.</span></span> <span data-ttu-id="8ee01-181">開発者は、佐賀、CQRS、非同期メッセージングなどの手法やパターンを実装して、最終的な一貫性を取り入れることができます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-181">Developers can implement techniques and patterns such as Sagas, CQRS, and asynchronous messaging to embrace eventual consistency.</span></span>

> <span data-ttu-id="8ee01-182">今日では、CAP 定理制約を連結する際には注意が必要です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-182">Nowadays, care must be taken when conidering the CAP theorem constraints.</span></span> <span data-ttu-id="8ee01-183">新しい種類の NewSQL が登場し、リレーショナル データベース エンジンを拡張して、水平スケーラビリティと NoSQL システムのスケーラブルなパフォーマンスの両方をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-183">A new type of database, called NewSQL, has emerged which extends the relational database engine to support both horizontal scalability and the scalable performance of NoSQL systems.</span></span>

## <a name="considerations-for-relational-vs-nosql-systems"></a><span data-ttu-id="8ee01-184">リレーショナルシステムとNoSQLシステムに関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="8ee01-184">Considerations for relational vs. NoSQL systems</span></span>

<span data-ttu-id="8ee01-185">特定のデータ要件に基づいて、クラウド ネイティブ ベースのマイクロサービスは、リレーショナル、NoSQL データストア、またはその両方を実装できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-185">Based upon specific data requirements, a cloud-native-based microservice can implement a relational, NoSQL datastore or both.</span></span>

|  <span data-ttu-id="8ee01-186">次の場合に NoSQL データストアを検討してください。</span><span class="sxs-lookup"><span data-stu-id="8ee01-186">Consider a NoSQL datastore when:</span></span> | <span data-ttu-id="8ee01-187">次の場合にリレーショナル データベースを検討してください。</span><span class="sxs-lookup"><span data-stu-id="8ee01-187">Consider a relational database when:</span></span> |
| :-------- | :-------- |
| <span data-ttu-id="8ee01-188">大規模なワークロードを必要とする大量のワークロードがある場合</span><span class="sxs-lookup"><span data-stu-id="8ee01-188">You have high volume workloads that require large scale</span></span> | <span data-ttu-id="8ee01-189">ワークロードの量は一貫性があり、中規模から大規模なスケールが必要</span><span class="sxs-lookup"><span data-stu-id="8ee01-189">Your workload volume is consistent and requires medium to large scale</span></span> |
| <span data-ttu-id="8ee01-190">ワークロードに ACID 保証が必要ない</span><span class="sxs-lookup"><span data-stu-id="8ee01-190">Your workloads don't require ACID guarantees</span></span> |  <span data-ttu-id="8ee01-191">ACID保証が必要です</span><span class="sxs-lookup"><span data-stu-id="8ee01-191">ACID guarantees are required</span></span> |
| <span data-ttu-id="8ee01-192">データは動的で、頻繁に変更される</span><span class="sxs-lookup"><span data-stu-id="8ee01-192">Your data is dynamic and frequently changes</span></span> | <span data-ttu-id="8ee01-193">データは予測可能で高度に構造化されています</span><span class="sxs-lookup"><span data-stu-id="8ee01-193">Your data is predictable and highly structured</span></span> |
| <span data-ttu-id="8ee01-194">データは関係なしで表現できる</span><span class="sxs-lookup"><span data-stu-id="8ee01-194">Data can be expressed without relationships</span></span> | <span data-ttu-id="8ee01-195">データはリレーショナルで最もよく表現される</span><span class="sxs-lookup"><span data-stu-id="8ee01-195">Data is best expressed relationally</span></span> |  
| <span data-ttu-id="8ee01-196">高速書き込みが必要で、書き込みの安全性は重要ではありません</span><span class="sxs-lookup"><span data-stu-id="8ee01-196">You need fast writes and write safety isn't critical</span></span> | <span data-ttu-id="8ee01-197">書き込み安全性は必須条件</span><span class="sxs-lookup"><span data-stu-id="8ee01-197">Write safety is a requirement</span></span> |  
| <span data-ttu-id="8ee01-198">データの取得は単純で、フラットになる傾向があります</span><span class="sxs-lookup"><span data-stu-id="8ee01-198">Data retrieval is simple and tends to be flat</span></span> | <span data-ttu-id="8ee01-199">複雑なクエリとレポートを使用する</span><span class="sxs-lookup"><span data-stu-id="8ee01-199">You work with complex queries and reports</span></span>|
| <span data-ttu-id="8ee01-200">データには幅広い地理的分布が必要</span><span class="sxs-lookup"><span data-stu-id="8ee01-200">Your data requires a wide geographic distribution</span></span> | <span data-ttu-id="8ee01-201">ユーザーの集中管理</span><span class="sxs-lookup"><span data-stu-id="8ee01-201">Your users are more centralized</span></span> |
| <span data-ttu-id="8ee01-202">アプリケーションは、パブリック クラウドなどのコモディティ ハードウェアに展開されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-202">Your application will be deployed to commodity hardware, such as with public clouds</span></span> | <span data-ttu-id="8ee01-203">アプリケーションは、大規模でハイエンドのハードウェアに展開されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-203">Your application will be deployed to large, high-end hardware</span></span> |
|||

<span data-ttu-id="8ee01-204">以降のセクションでは、クラウド ネイティブ データの格納と管理に使用できる Azure クラウドで使用できるオプションについて説明します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-204">In the next sections, we'll explore the options available in the Azure cloud for storing and managing your cloud-native data.</span></span>

## <a name="database-as-a-service"></a><span data-ttu-id="8ee01-205">サービスとしてのデータベース</span><span class="sxs-lookup"><span data-stu-id="8ee01-205">Database as a Service</span></span>

<span data-ttu-id="8ee01-206">まず、Azure 仮想マシンをプロビジョニングし、各サービスに適したデータベースをインストールします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-206">To start, you could provision an Azure virtual machine and install your database of choice for each service.</span></span> <span data-ttu-id="8ee01-207">環境を完全に制御できる一方で、クラウド プラットフォームの多くの組み込み機能を見落とします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-207">While you'd have full control over the environment, you'd forgo many built-in features of the cloud platform.</span></span> <span data-ttu-id="8ee01-208">また、各サービスの仮想マシンとデータベースの管理も担当します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-208">You'd also be responsible for managing the virtual machine and database for each service.</span></span> <span data-ttu-id="8ee01-209">このアプローチは、時間とコストが急速に高くなる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-209">This approach could quickly become time-consuming and expensive.</span></span>

<span data-ttu-id="8ee01-210">代わりに、クラウド ネイティブ アプリケーションは、[サービスとしてのデータベース (DBaaS) として](https://www.stratoscale.com/blog/dbaas/what-is-database-as-a-service/)公開されるデータ サービスを優先します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-210">Instead, cloud-native applications favor data services exposed as a [Database as a Service (DBaaS)](https://www.stratoscale.com/blog/dbaas/what-is-database-as-a-service/).</span></span> <span data-ttu-id="8ee01-211">クラウド ベンダーによって完全に管理されているこれらのサービスは、組み込みのセキュリティ、スケーラビリティ、および監視を提供します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-211">Fully managed by a cloud vendor, these services provide built-in security, scalability, and monitoring.</span></span> <span data-ttu-id="8ee01-212">サービスを所有する代わりに、単に[バッキング サービス](./definition.md#backing-services)として使用します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-212">Instead of owning the service, you simply consume it as a [backing service](./definition.md#backing-services).</span></span> <span data-ttu-id="8ee01-213">プロバイダは、大規模なリソースを運用し、パフォーマンスとメンテナンスの責任を負います。</span><span class="sxs-lookup"><span data-stu-id="8ee01-213">The provider operates the resource at scale and bears the responsibility for performance and maintenance.</span></span>

<span data-ttu-id="8ee01-214">これらのサービスは、クラウドの可用性ゾーンとリージョン間で構成して、高可用性を実現できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-214">They can be configured across cloud availability zones and regions to achieve high availability.</span></span> <span data-ttu-id="8ee01-215">彼らはすべてジャストインタイム容量と従量課金制モデルをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-215">They all support just-in-time capacity and a pay-as-you-go model.</span></span> <span data-ttu-id="8ee01-216">Azure には、さまざまな種類のマネージド データ サービス オプションが用意され、それぞれに特定の利点があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-216">Azure features different kinds of managed data service options, each with specific benefits.</span></span>

<span data-ttu-id="8ee01-217">まず、Azure で利用できるリレーショナル DBaaS サービスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-217">We'll first look at relational DBaaS services available in Azure.</span></span> <span data-ttu-id="8ee01-218">マイクロソフトの主力 SQL Server データベースと、いくつかのオープン ソース オプションが用意されています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-218">You'll see that Microsoft's flagship SQL Server database is available along with several open-source options.</span></span> <span data-ttu-id="8ee01-219">次に、Azure の NoSQL データ サービスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-219">Then, we'll talk about the NoSQL data services in Azure.</span></span>

## <a name="azure-relational-databases"></a><span data-ttu-id="8ee01-220">Azure リレーショナル データベース</span><span class="sxs-lookup"><span data-stu-id="8ee01-220">Azure relational databases</span></span>

<span data-ttu-id="8ee01-221">リレーショナル データを必要とするクラウド ネイティブ マイクロサービスの場合、Azure は、4 つのマネージド リレーショナル データベースをサービス (DBaaS) として提供しています (図 5-11 参照)。</span><span class="sxs-lookup"><span data-stu-id="8ee01-221">For cloud-native microservices that require relational data, Azure offers four managed relational databases as a service (DBaaS) offerings, shown in Figure 5-11.</span></span>

![Azure のマネージ リレーショナル データベース](./media/azure-managed-databases.png)

<span data-ttu-id="8ee01-223">**図 5-11**</span><span class="sxs-lookup"><span data-stu-id="8ee01-223">**Figure 5-11**.</span></span> <span data-ttu-id="8ee01-224">Azure で使用できるマネージド リレーショナル データベース</span><span class="sxs-lookup"><span data-stu-id="8ee01-224">Managed relational databases available in Azure</span></span>

<span data-ttu-id="8ee01-225">前の図では、各インフラストラクチャが、追加コストなしで主要な機能を備えた共通の DBaaS インフラストラクチャにどのように存在するかを確認します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-225">In the previous figure, note how each sits upon a common DBaaS infrastructure which features key capabilities at no additional cost.</span></span>

<span data-ttu-id="8ee01-226">これらの機能は、多数のデータベースをプロビジョニングする組織にとって特に重要ですが、管理するリソースが限られています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-226">These features are especially important to organizations who provision large numbers of databases, but have limited resources to administer them.</span></span>
<span data-ttu-id="8ee01-227">処理コア、メモリ、および基になるストレージの量を選択することで、Azure データベースを数分でプロビジョニングできます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-227">You can provision an Azure database in minutes by selecting the amount of processing cores, memory, and underlying storage.</span></span> <span data-ttu-id="8ee01-228">データベースをリアルタイムでスケールし、ダウンタイムをほとんどまたはまったくからなく、リソースを動的に調整できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-228">You can scale the database on-the-fly and dynamically adjust resources with little to no downtime.</span></span>

## <a name="azure-sql-database"></a><span data-ttu-id="8ee01-229">Azure SQL データベース</span><span class="sxs-lookup"><span data-stu-id="8ee01-229">Azure SQL Database</span></span>

<span data-ttu-id="8ee01-230">マイクロソフト SQL Server の専門知識を持つ開発チームは[、Azure SQL データベース](https://docs.microsoft.com/azure/sql-database/)を検討する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-230">Development teams with expertise in Microsoft SQL Server should consider [Azure SQL Database](https://docs.microsoft.com/azure/sql-database/).</span></span> <span data-ttu-id="8ee01-231">これは、Microsoft SQL Server データベース エンジンに基づく完全に管理されたリレーショナル データベースサービスとしての (DBaaS) です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-231">It's a fully managed relational database-as-a-service (DBaaS) based on the Microsoft SQL Server Database Engine.</span></span> <span data-ttu-id="8ee01-232">このサービスは、オンプレミスバージョンの SQL Server で見つかった多くの機能を共有し、最新の安定バージョンの SQL Server データベース エンジンを実行します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-232">The service shares many features found in the on-premises version of SQL Server and runs the latest stable version of the SQL Server Database Engine.</span></span>

<span data-ttu-id="8ee01-233">クラウドネイティブマイクロサービスで使用するために、Azure SQL データベースには 3 つのデプロイオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-233">For use with a cloud-native microservice, Azure SQL Database is available with three deployment options:</span></span>

- <span data-ttu-id="8ee01-234">単一データベースは[、Azure](https://docs.microsoft.com/azure/sql-database/sql-database-servers)クラウド内の Azure SQL データベース サーバーで実行されている完全に管理された SQL データベースを表します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-234">A Single Database represents a fully managed SQL Database running on an [Azure SQL Database server](https://docs.microsoft.com/azure/sql-database/sql-database-servers) in the Azure cloud.</span></span> <span data-ttu-id="8ee01-235">データベースは、基になるデータベース サーバーに対する構成の依存関係がないため、[*包含*](https://docs.microsoft.com/sql/relational-databases/databases/contained-databases)と見なされます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-235">The database is considered [*contained*](https://docs.microsoft.com/sql/relational-databases/databases/contained-databases) as it has no configuration dependencies on the underlying database server.</span></span>
  
- <span data-ttu-id="8ee01-236">[マネージド インスタンス](https://docs.microsoft.com/azure/sql-database/sql-database-managed-instance)は、オンプレミスの SQL Server との互換性を 100% 近く提供する、Microsoft SQL Server データベース エンジンの完全マネージド インスタンスです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-236">A [Managed Instance](https://docs.microsoft.com/azure/sql-database/sql-database-managed-instance) is a fully managed instance of the Microsoft SQL Server Database Engine that provides near-100% compatibility with an on-premises SQL Server.</span></span> <span data-ttu-id="8ee01-237">このオプションは、最大 35 TB の大規模なデータベースをサポートし、分離を向上させるために[Azure 仮想ネットワーク](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview)に配置されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-237">This option supports larger databases, up to 35 TB and is placed in an [Azure Virtual Network](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview) for better isolation.</span></span>

- <span data-ttu-id="8ee01-238">[Azure SQL Database サーバーレス](https://docs.microsoft.com/azure/sql-database/sql-database-serverless)は、ワークロードの需要に基づいて自動的にスケーリングされる単一のデータベースのコンピューティング層です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-238">[Azure SQL Database serverless](https://docs.microsoft.com/azure/sql-database/sql-database-serverless) is a compute tier for a single database that automatically scales based on workload demand.</span></span> <span data-ttu-id="8ee01-239">1 秒あたりに使用されるコンピューティングの量に対してのみ請求されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-239">It bills only for the amount of compute used per second.</span></span> <span data-ttu-id="8ee01-240">このサービスは、断続的で予測不可能な使用パターンを持つワークロードに適しており、非アクティブな期間が散在します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-240">The service is well suited for workloads with intermittent, unpredictable usage patterns, interspersed with periods of inactivity.</span></span> <span data-ttu-id="8ee01-241">また、サーバーレスコンピューティング層は、非アクティブ期間中にデータベースを自動的に一時停止し、ストレージ料金のみが課金されるようにします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-241">The serverless compute tier also automatically pauses databases during inactive periods so that only storage charges are billed.</span></span> <span data-ttu-id="8ee01-242">アクティビティが戻ると自動的に再開されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-242">It automatically resumes when activity returns.</span></span>

<span data-ttu-id="8ee01-243">従来の Microsoft SQL Server スタックを超えて、Azure には、一般的な 3 つのオープン ソース データベースのマネージ バージョンも用意されています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-243">Beyond the traditional Microsoft SQL Server stack, Azure also features managed versions of three popular open-source databases.</span></span>

## <a name="open-source-databases-in-azure"></a><span data-ttu-id="8ee01-244">Azure のオープン ソース データベース</span><span class="sxs-lookup"><span data-stu-id="8ee01-244">Open-source databases in Azure</span></span>

<span data-ttu-id="8ee01-245">オープンソースのリレーショナルデータベースは、クラウドネイティブアプリケーションに人気の選択肢となっています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-245">Open-source relational databases have become a popular choice for cloud-native applications.</span></span> <span data-ttu-id="8ee01-246">多くの企業は、特にコスト削減のために、商用データベース製品よりも彼らを支持します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-246">Many enterprises favor them over commercial database products, especially for cost savings.</span></span> <span data-ttu-id="8ee01-247">多くの開発チームは、柔軟性、コミュニティに支援された開発、ツールと拡張機能のエコシステムを享受しています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-247">Many development teams enjoy their flexibility, community-backed development, and ecosystem of tools and extensions.</span></span> <span data-ttu-id="8ee01-248">オープンソースデータベースは、複数のクラウドプロバイダーに展開できるため、「ベンダーのロックイン」の懸念を最小限に抑えることができます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-248">Open-source databases can be deployed across multiple cloud providers, helping minimize the concern of "vendor lock-in."</span></span>

<span data-ttu-id="8ee01-249">開発者は、Azure VM 上の任意のオープン ソース データベースを簡単に自己ホストできます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-249">Developers can easily self-host any open-source database on an Azure VM.</span></span> <span data-ttu-id="8ee01-250">このアプローチでは、完全な制御を提供しながら、データベースと VM の管理、監視、および保守を行います。</span><span class="sxs-lookup"><span data-stu-id="8ee01-250">While providing full control, this approach puts you on the hook for the management, monitoring, and maintenance of the database and VM.</span></span>

<span data-ttu-id="8ee01-251">しかし、マイクロソフトは、*完全に管理*された DBaaS サービスとしていくつかの一般的なオープンソース データベースを提供することで、Azure を「オープン プラットフォーム」に保つというコミットメントを継続しています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-251">However, Microsoft continues its commitment to keeping Azure an “open platform” by offering several popular open-source databases as *fully managed* DBaaS services.</span></span>

### <a name="azure-database-for-mysql"></a><span data-ttu-id="8ee01-252">Azure Database for MySQL</span><span class="sxs-lookup"><span data-stu-id="8ee01-252">Azure Database for MySQL</span></span>

<span data-ttu-id="8ee01-253">[MySQL](https://en.wikipedia.org/wiki/MySQL) はオープンソースのリレーショナルデータベースであり[、LAMP ソフトウェアスタック](https://en.wikipedia.org/wiki/LAMP_(software_bundle))上に構築されたアプリケーションの柱です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-253">[MySQL](https://en.wikipedia.org/wiki/MySQL) is an open-source relational database and a pillar for applications built on the [LAMP software stack](https://en.wikipedia.org/wiki/LAMP_(software_bundle)).</span></span> <span data-ttu-id="8ee01-254">*読み取り負荷の高い*ワークロードに広く選ばれ、Facebook、Twitter、YouTubeなど多くの大規模な組織で使用されています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-254">Widely chosen for *read heavy* workloads, it's used by many large organizations, including Facebook, Twitter, and YouTube.</span></span> <span data-ttu-id="8ee01-255">コミュニティ版は無料で利用できますが、エンタープライズ版ではライセンスの購入が必要です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-255">The community edition is available for free, while the enterprise edition requires a license purchase.</span></span> <span data-ttu-id="8ee01-256">1995年に創作されたこの製品は、2008年にサン・マイクロシステムズによって購入されました。</span><span class="sxs-lookup"><span data-stu-id="8ee01-256">Originally created in 1995, the product was purchased by Sun Microsystems in 2008.</span></span> <span data-ttu-id="8ee01-257">オラクルは2010年にサンとMySQLを買収した。</span><span class="sxs-lookup"><span data-stu-id="8ee01-257">Oracle acquired Sun and MySQL in 2010.</span></span>

<span data-ttu-id="8ee01-258">[MySQL 用 Azure データベース](https://azure.microsoft.com/services/mysql/)は、オープン ソースの MySQL Server エンジンに基づく管理されたリレーショナル データベース サービスです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-258">[Azure Database for MySQL](https://azure.microsoft.com/services/mysql/) is a managed relational database service based on the open-source MySQL Server engine.</span></span> <span data-ttu-id="8ee01-259">これは、MySQL コミュニティエディションを使用します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-259">It uses the MySQL Community edition.</span></span> <span data-ttu-id="8ee01-260">Azure MySQL サーバーは、サービスの管理ポイントです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-260">The Azure MySQL server is the administrative point for the service.</span></span> <span data-ttu-id="8ee01-261">オンプレミスの展開に使用されるのと同じ MySQL サーバー エンジンです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-261">It's the same MySQL server engine used for on-premises deployments.</span></span> <span data-ttu-id="8ee01-262">エンジンは、1 つのサーバーにつき 1 つのデータベースを作成することも、リソースを共有するサーバーごとに複数のデータベースを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-262">The engine can create a single database per server or multiple databases per server that share resources.</span></span> <span data-ttu-id="8ee01-263">新しいスキルを習得したり、仮想マシンを管理したりすることなく、同じオープンソースツールを使用してデータを管理し続けることができます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-263">You can continue to manage data using the same open-source tools without having to learn new skills or manage virtual machines.</span></span>

### <a name="azure-database-for-mariadb"></a><span data-ttu-id="8ee01-264">Azure Database for MariaDB</span><span class="sxs-lookup"><span data-stu-id="8ee01-264">Azure Database for MariaDB</span></span>

<span data-ttu-id="8ee01-265">[マリアド](https://mariadb.com/)サーバーは、もう 1 つの一般的なオープンソース データベース サーバーです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-265">[MariaDB](https://mariadb.com/) Server is another popular open-source database server.</span></span> <span data-ttu-id="8ee01-266">これは、オラクルがMySQLを所有していたサンマイクロシステムズを購入したときにMySQLの*フォーク*として作成されました。</span><span class="sxs-lookup"><span data-stu-id="8ee01-266">It was created as a *fork* of MySQL when Oracle purchased Sun Microsystems, who owned MySQL.</span></span> <span data-ttu-id="8ee01-267">その目的は、MariaDB がオープンソースのままであることを保証することであった。</span><span class="sxs-lookup"><span data-stu-id="8ee01-267">The intent was to ensure that MariaDB remained open-source.</span></span> <span data-ttu-id="8ee01-268">MariaDB は MySQL のフォークであるため、データとテーブルの定義は互換性があり、クライアントプロトコル、構造体、API は密接に結び付いています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-268">As MariaDB is a fork of MySQL, the data and table definitions are compatible, and the client protocols, structures, and APIs, are close-knit.</span></span>

<span data-ttu-id="8ee01-269">MariaDBは強力なコミュニティを持ち、多くの大企業で使用されています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-269">MariaDB has a strong community and is used by many large enterprises.</span></span> <span data-ttu-id="8ee01-270">Oracle は MySQL の保守、強化、サポートを継続していますが、MariaDB の基盤は MariaDB を管理し、製品とドキュメントへの一般の貢献を可能にします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-270">While Oracle continues to maintain, enhance, and support MySQL, the MariaDB foundation manages MariaDB, allowing public contributions to the product and documentation.</span></span>

<span data-ttu-id="8ee01-271">[MariaDB 用の Azure データベース](https://azure.microsoft.com/services/mariadb/)は、Azure クラウドのサービスとして完全に管理されたリレーショナル データベースです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-271">[Azure Database for MariaDB](https://azure.microsoft.com/services/mariadb/) is a fully managed relational database as a service in the Azure cloud.</span></span> <span data-ttu-id="8ee01-272">このサービスは、MariaDB コミュニティエディションのサーバーエンジンに基づいています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-272">The service is based on the MariaDB community edition server engine.</span></span> <span data-ttu-id="8ee01-273">予測可能なパフォーマンスと動的なスケーラビリティで、ミッションクリティカルなワークロードを処理できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-273">It can handle mission-critical workloads with predictable performance and dynamic scalability.</span></span>

### <a name="azure-database-for-postgresql"></a><span data-ttu-id="8ee01-274">Azure Database for PostgreSQL</span><span class="sxs-lookup"><span data-stu-id="8ee01-274">Azure Database for PostgreSQL</span></span>

<span data-ttu-id="8ee01-275">[PostgreSQL](https://www.postgresql.org/)は、30年以上の開発を行うオープンソースのリレーショナルデータベースです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-275">[PostgreSQL](https://www.postgresql.org/) is an open-source relational database with over 30 years of active development.</span></span> <span data-ttu-id="8ee01-276">PostgresSQL は信頼性とデータ整合性に対して高い評価を得ています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-276">PostgresSQL has a strong reputation for reliability and data integrity.</span></span> <span data-ttu-id="8ee01-277">特に複雑なクエリや大量の書き込みを伴うワークロードでは、機能が豊富で、SQLに準拠しており、MySQLよりもパフォーマンスが高いと考えられています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-277">It’s feature rich, SQL compliant, and considered more performant than MySQL - especially for workloads with complex queries and heavy writes.</span></span> <span data-ttu-id="8ee01-278">アップル、レッドハット、富士通など多くの大企業がPostgreSQLを使用して製品を構築しています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-278">Many large enterprises including Apple, Red Hat, and Fujitsu have built products using PostgreSQL.</span></span>

<span data-ttu-id="8ee01-279">[PostgreSQL 用 Azure データベース](https://azure.microsoft.com/services/postgresql/)は、オープン ソースの Postgres データベース エンジンに基づく、完全に管理されたリレーショナル データベース サービスです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-279">[Azure Database for PostgreSQL](https://azure.microsoft.com/services/postgresql/) is a fully managed relational database service, based on the open-source Postgres database engine.</span></span> <span data-ttu-id="8ee01-280">このサービスは、C++、Java、Python、ノード、C、PHP\#など、多くの開発プラットフォームをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-280">The service supports many development platforms, including C++, Java, Python, Node, C\#, and PHP.</span></span> <span data-ttu-id="8ee01-281">[コマンド ライン インターフェイス](https://datamigration.microsoft.com/scenario/postgresql-to-azurepostgresql?step=1)ツールまたは Azure データ移行サービスを使用して PostgreSQL データベースを移行できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-281">You can migrate PostgreSQL databases to it using the [command-line interface](https://datamigration.microsoft.com/scenario/postgresql-to-azurepostgresql?step=1) tool or Azure Data Migration Service.</span></span>

<span data-ttu-id="8ee01-282">ポストグレSQL用の Azure データベースには、次の 2 つのデプロイ オプションがあります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-282">Azure Database for PostgreSQL is available with two deployment options:</span></span>

- <span data-ttu-id="8ee01-283">[単一サーバー](https://docs.microsoft.com/azure/postgresql/concepts-servers)の展開オプションは、複数のデータベースを配置できる集中管理ポイントです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-283">The [Single Server](https://docs.microsoft.com/azure/postgresql/concepts-servers) deployment option is a central administrative point for multiple databases to which you can deploy many databases.</span></span> <span data-ttu-id="8ee01-284">価格は、コアとストレージに基づいてサーバーごとに構成されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-284">The pricing is structured per-server based upon cores and storage.</span></span>

- <span data-ttu-id="8ee01-285">[ハイパースケール(Citus)オプション](https://azure.microsoft.com/blog/get-high-performance-scaling-for-your-azure-database-workloads-with-hyperscale/)は、Citusデータ技術によって駆動されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-285">The [Hyperscale (Citus) option](https://azure.microsoft.com/blog/get-high-performance-scaling-for-your-azure-database-workloads-with-hyperscale/) is powered by Citus Data technology.</span></span> <span data-ttu-id="8ee01-286">1 つのデータベースを数百のノード*に水平方向にスケーリング*し、高速なパフォーマンスとスケールを実現することで、高いパフォーマンスを実現します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-286">It enables high performance by *horizontally scaling* a single database across hundreds of nodes to deliver fast performance and scale.</span></span> <span data-ttu-id="8ee01-287">このオプションを使用すると、エンジンはメモリに多くのデータを取り込み、数百のノードに対するクエリを並列化し、データのインデックスをより速く作成できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-287">This option allows the engine to fit more data in memory, parallelize queries across hundreds of nodes, and index data faster.</span></span>

## <a name="nosql-data-in-azure"></a><span data-ttu-id="8ee01-288">Azure の NoSQL データ</span><span class="sxs-lookup"><span data-stu-id="8ee01-288">NoSQL data in Azure</span></span>

<span data-ttu-id="8ee01-289">Cosmos DB は、Azure クラウドで完全に管理されたグローバルに分散された NoSQL データベース サービスです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-289">Cosmos DB is a fully managed, globally distributed NoSQL database service in the Azure cloud.</span></span> <span data-ttu-id="8ee01-290">コカ・コーラ、スカイプ、エクソンモービル、リバティ・ミューチュアルなど、世界中の多くの大企業に採用されています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-290">It has been adopted by many large companies across the world,  including Coca-Cola, Skype, ExxonMobil, and Liberty Mutual.</span></span>

<span data-ttu-id="8ee01-291">サービスが世界中のどこからでも高速な応答、高可用性、または柔軟なスケーラビリティを必要とする場合、Cosmos DB は優れた選択肢です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-291">If your services require fast response from anywhere in the world, high availability, or elastic scalability, Cosmos DB is a great choice.</span></span> <span data-ttu-id="8ee01-292">図5-12は、Cosmos DBを示す。</span><span class="sxs-lookup"><span data-stu-id="8ee01-292">Figure 5-12 shows Cosmos DB.</span></span>

![コスモスDBの概要](./media/cosmos-db-overview.png)

<span data-ttu-id="8ee01-294">**図 5-12**: コスモス DB の概要</span><span class="sxs-lookup"><span data-stu-id="8ee01-294">**Figure 5-12**: Overview of Cosmos DB</span></span>

<span data-ttu-id="8ee01-295">上の図は、Cosmos DB で利用できる組み込みのクラウドネイティブ機能の多くを示しています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-295">The previous figure presents many of the built-in cloud-native capabilities available in Cosmos DB.</span></span> <span data-ttu-id="8ee01-296">このセクションでは、それらを詳しく見ていきます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-296">In this section, we’ll take a closer look at them.</span></span>

### <a name="global-support"></a><span data-ttu-id="8ee01-297">グローバル サポート</span><span class="sxs-lookup"><span data-stu-id="8ee01-297">Global support</span></span>

<span data-ttu-id="8ee01-298">クラウドネイティブアプリケーションは、多くの場合、グローバルなユーザーを持ち、グローバル規模を必要とします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-298">Cloud-native applications often have a global audience and require global scale.</span></span>

<span data-ttu-id="8ee01-299">Cosmos データベースを地域間または世界中に分散して、ユーザーの近くにデータを配置し、応答時間を短縮し、待ち時間を短縮できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-299">You can distribute Cosmos databases across regions or around the world, placing data close to your users, improving response time, and reducing latency.</span></span> <span data-ttu-id="8ee01-300">サービスを一時停止または再デプロイしなくても、リージョンにデータベースを追加したり、リージョンからデータベースを削除したりできます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-300">You can add or remove a database from a region without pausing or redeploying your services.</span></span> <span data-ttu-id="8ee01-301">バックグラウンドで、Cosmos DB は、構成された各リージョンにデータを透過的に複製します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-301">In the background, Cosmos DB transparently replicates the data to each of the configured regions.</span></span>

<span data-ttu-id="8ee01-302">Cosmos DB はグローバル レベルで[アクティブ/アクティブ](https://kemptechnologies.com/white-papers/unfog-confusion-active-passive-activeactive-load-balancing/)クラスタリングをサポートし、*書き込みと読み取りの両方*をサポートするようにデータベース領域を設定できるようにします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-302">Cosmos DB supports [active/active](https://kemptechnologies.com/white-papers/unfog-confusion-active-passive-activeactive-load-balancing/) clustering at the global level, enabling you to configure any of your database regions to support *both writes and reads*.</span></span>

<span data-ttu-id="8ee01-303">[マルチマスター](https://docs.microsoft.com/azure/cosmos-db/multi-master-benefits)プロトコルは、次の機能を有効にする Cosmos DB の重要な機能です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-303">The [Multi-Master](https://docs.microsoft.com/azure/cosmos-db/multi-master-benefits) protocol is an important feature in Cosmos DB that enables the following functionality:</span></span>

- <span data-ttu-id="8ee01-304">無制限でエラスティックな書き込みと読み取りのスケーラビリティ。</span><span class="sxs-lookup"><span data-stu-id="8ee01-304">Unlimited elastic write and read scalability.</span></span>

- <span data-ttu-id="8ee01-305">全世界での 99.999% の読み取りおよび書き込みの可用性。</span><span class="sxs-lookup"><span data-stu-id="8ee01-305">99.999% read and write availability all around the world.</span></span>

- <span data-ttu-id="8ee01-306">99 パーセンタイルで 10 ミリ秒未満の処理性能が保証された読み取りと書き込み。</span><span class="sxs-lookup"><span data-stu-id="8ee01-306">Guaranteed reads and writes served in less than 10 milliseconds at the 99th percentile.</span></span>

<span data-ttu-id="8ee01-307">Cosmos DB[マルチホーミング API を](https://docs.microsoft.com/azure/cosmos-db/distribute-data-globally)使用すると、マイクロサービスは最も近い Azure リージョンを自動的に認識し、要求を送信します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-307">With the Cosmos DB [Multi-Homing APIs](https://docs.microsoft.com/azure/cosmos-db/distribute-data-globally), your microservice is automatically aware of the nearest Azure region and sends requests to it.</span></span> <span data-ttu-id="8ee01-308">最も近いリージョンは、設定を変更せずに Cosmos DB によって識別されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-308">The nearest region is identified by Cosmos DB without any configuration changes.</span></span> <span data-ttu-id="8ee01-309">リージョンが使用できなくなった場合、マルチホーミング機能は、次に近い利用可能なリージョンにリクエストを自動的にルーティングします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-309">Should a region become unavailable, the Multi-Homing feature will automatically route requests to the next nearest available region.</span></span>

### <a name="multi-model-support"></a><span data-ttu-id="8ee01-310">マルチモデルサポート</span><span class="sxs-lookup"><span data-stu-id="8ee01-310">Multi-model support</span></span>

<span data-ttu-id="8ee01-311">モノリシック アプリケーションをクラウドネイティブ アーキテクチャに再プラットフォーム化する場合、開発チームは、オープンソースの NoSQL データ ストアを移行する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-311">When replatforming monolithic applications to a cloud-native architecture, development teams sometimes have to migrate open-source, NoSQL data stores.</span></span> <span data-ttu-id="8ee01-312">Cosmos DB は、*マルチモデル*データ プラットフォームを使用して、これらの NoSQL データストアへの投資を維持するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-312">Cosmos DB can help you preserve your investment in these NoSQL datastores with its *multi-model* data platform.</span></span> <span data-ttu-id="8ee01-313">図 5-13 は、サポートされている NoSQL[互換性 API を示しています](https://www.wikiwand.com/en/Cosmos_DB)。</span><span class="sxs-lookup"><span data-stu-id="8ee01-313">Figure 5-13 shows the supported NoSQL [compatibility APIs](https://www.wikiwand.com/en/Cosmos_DB).</span></span>

![コスモス DB プロバイダー](./media/cosmos-db-providers.png)

<span data-ttu-id="8ee01-315">**図 5-13**: Cosmos DB プロバイダ</span><span class="sxs-lookup"><span data-stu-id="8ee01-315">**Figure 5-13**: Cosmos DB providers</span></span>

<span data-ttu-id="8ee01-316">開発チームは、既存の Mongo、Gremlin、または Cassandra データベースを、データやコードに対する最小限の変更で Cosmos DB に移行できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-316">Development teams can migrate existing Mongo, Gremlin, or Cassandra databases into Cosmos DB with minimal changes to data or code.</span></span> <span data-ttu-id="8ee01-317">新しいアプリの場合、開発チームは、オープン ソース オプションまたは組み込みの SQL API モデルから選択できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-317">For new apps, development teams can choose among open-source options or the built-in SQL API model.</span></span>

> <span data-ttu-id="8ee01-318">内部的には、Cosmos はプリミティブデータ型で構成された単純な構造体形式でデータを格納します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-318">Internally, Cosmos stores the data in a simple struct format made up of primitive data types.</span></span> <span data-ttu-id="8ee01-319">各要求に対して、データベース エンジンはプリミティブ データを選択したモデル表現に変換します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-319">For each request, the database engine translates the primitive data into the model representation you've selected.</span></span>

<span data-ttu-id="8ee01-320">前の図の 5-13 では、[テーブル API](https://docs.microsoft.com/azure/cosmos-db/table-introduction)オプションに注意してください。</span><span class="sxs-lookup"><span data-stu-id="8ee01-320">In the previous figure, 5-13, note the [Table API](https://docs.microsoft.com/azure/cosmos-db/table-introduction) option.</span></span> <span data-ttu-id="8ee01-321">この API は、Azure テーブル ストレージの進化です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-321">This API is an evolution of Azure Table Storage.</span></span> <span data-ttu-id="8ee01-322">どちらも同じ基になるテーブル モデルを共有しますが、Cosmos DB テーブル API は Azure ストレージ API では利用できないプレミアム機能強化を追加します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-322">Both share the same underlying table model, but the Cosmos DB Table API adds premium enhancements not available in the Azure Storage API.</span></span> <span data-ttu-id="8ee01-323">これらの機能は、図 5-4 で対照的です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-323">These features are contrasted in Figure 5-4.</span></span>

![Azure Table API](media/azure-table-api.png)

<span data-ttu-id="8ee01-325">**図 5-14**: Azure テーブル API プロバイダー</span><span class="sxs-lookup"><span data-stu-id="8ee01-325">**Figure 5-14**: Azure Table API Providers</span></span>

<span data-ttu-id="8ee01-326">Azure テーブル ストレージを使用するマイクロサービスは、簡単に Cosmos DB テーブル API に移行できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-326">Microservices that consume Azure Table storage can easily migrate to the Cosmos DB Table API.</span></span> <span data-ttu-id="8ee01-327">コードに変更を加える必要はありません。</span><span class="sxs-lookup"><span data-stu-id="8ee01-327">No code changes are required.</span></span>

### <a name="tunable-consistency"></a><span data-ttu-id="8ee01-328">チューニング可能な一貫性</span><span class="sxs-lookup"><span data-stu-id="8ee01-328">Tunable consistency</span></span>

<span data-ttu-id="8ee01-329">前の「*リレーショナルと NoSQL」* のセクションで、*データの整合性*の主題について説明しました。</span><span class="sxs-lookup"><span data-stu-id="8ee01-329">Earlier in the *Relational vs. NoSQL* section, we discussed the subject of *data consistency*.</span></span> <span data-ttu-id="8ee01-330">データの整合性とは、データの*整合性*を指します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-330">Data consistency refers to the *integrity* of your data.</span></span> <span data-ttu-id="8ee01-331">分散データを持つクラウドネイティブサービスはレプリケーションに依存しており、読み取り一貫性、可用性、待機時間の間の基本的なトレードオフを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-331">Cloud-native services with distributed data rely on replication and must make a fundamental tradeoff between read consistency, availability, and latency.</span></span>

<span data-ttu-id="8ee01-332">ほとんどの分散データベースでは、開発者は、強力な一貫性と最終的な一貫性という 2 つの一貫性モデルから選択できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-332">Most distributed databases allow developers to choose between two consistency models: strong consistency and eventual consistency.</span></span> <span data-ttu-id="8ee01-333">*強力な一貫性*は、データプログラミングのゴールドスタンダードです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-333">*Strong consistency* is the gold standard of data programmability.</span></span> <span data-ttu-id="8ee01-334">更新がすべてのデータベース コピーにレプリケートされるのを待つ待機時間がシステムで発生する必要がある場合でも、クエリが常に最新のデータを返すことを保証します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-334">It guarantees that a query will always return the most current data - even if the system must incur latency waiting for an update to replicate across all database copies.</span></span> <span data-ttu-id="8ee01-335">*最終的な整合性*を保つデータベースは、データが最新のコピーでない場合でも、データをすぐに返します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-335">While a database configured for *eventual consistency* will return data immediately, even if that data isn't the most current copy.</span></span> <span data-ttu-id="8ee01-336">後者のオプションを使用すると、可用性の向上、拡張性の向上、パフォーマンスの向上が可能になります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-336">The latter option enables higher availability, greater scale, and increased performance.</span></span>

<span data-ttu-id="8ee01-337">Azure Cosmos DB には、図 5-15 に示す 5 つの明確に定義された[一貫性モデル](https://docs.microsoft.com/azure/cosmos-db/consistency-levels)が用意されています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-337">Azure Cosmos DB offers five well-defined [consistency models](https://docs.microsoft.com/azure/cosmos-db/consistency-levels) shown in Figure 5-15.</span></span>

![コスモスDB整合性グラフ](./media/cosmos-consistency-level-graph.png)

<span data-ttu-id="8ee01-339">**図 5-15**: コスモス DB の整合性レベル</span><span class="sxs-lookup"><span data-stu-id="8ee01-339">**Figure 5-15**: Cosmos DB Consistency Levels</span></span>

 <span data-ttu-id="8ee01-340">これらのオプションを使用すると、データの一貫性、可用性、パフォーマンスを得るために、正確な選択と細かいトレードオフを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-340">These options enable you to make precise choices and granular tradeoffs for consistency, availability, and the performance for your data.</span></span> <span data-ttu-id="8ee01-341">図 5-16 に各レベルを示します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-341">Figure 5-16 describes each level.</span></span>

![コスモス DB の一貫性レベル](./media/cosmos-db-consistency-levels.png)

<span data-ttu-id="8ee01-343">**図 5-16**: Cosmos DB 整合性レベルの説明</span><span class="sxs-lookup"><span data-stu-id="8ee01-343">**Figure 5-16**: Cosmos DB Consistency Level Description</span></span>

<span data-ttu-id="8ee01-344">記事では[、9ボールの背後にある: Cosmos DB の一貫性レベルの説明](https://blog.jeremylikness.com/blog/2018-03-23_getting-behind-the-9ball-cosmosdb-consistency-levels/)、 Microsoft クラウド開発者の提唱ジェレミー類似性 5 つのモデルの優れた説明を提供します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-344">In the article [Getting Behind the 9-Ball: Cosmos DB Consistency Levels Explained](https://blog.jeremylikness.com/blog/2018-03-23_getting-behind-the-9ball-cosmosdb-consistency-levels/), Microsoft Cloud Developer Advocate Jeremy Likeness provides an excellent explanation of the five models.</span></span>

### <a name="partitioning"></a><span data-ttu-id="8ee01-345">パーティション分割</span><span class="sxs-lookup"><span data-stu-id="8ee01-345">Partitioning</span></span>

<span data-ttu-id="8ee01-346">Azure Cosmos DB では、自動[パーティション分割](https://docs.microsoft.com/azure/cosmos-db/partitioning-overview)を採用して、クラウド ネイティブ サービスのパフォーマンス ニーズに合わせてデータベースを拡張します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-346">Azure Cosmos DB embraces automatic [partitioning](https://docs.microsoft.com/azure/cosmos-db/partitioning-overview) to scale a database to meet the performance needs of your cloud-native services.</span></span>

<span data-ttu-id="8ee01-347">データベース、コンテナー、およびアイテムを作成して、Cosmos DB データのデータを管理します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-347">You manage data in Cosmos DB data by creating databases, containers, and items.</span></span>

<span data-ttu-id="8ee01-348">コンテナーは Cosmos DB データベースに存在し、スキーマに依存しないアイテムのグループを表します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-348">Containers live in a Cosmos DB database and represent a schema-agnostic grouping of items.</span></span> <span data-ttu-id="8ee01-349">項目は、コンテナーに追加するデータです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-349">Items are the data that you add to the container.</span></span> <span data-ttu-id="8ee01-350">ドキュメント、行、ノード、またはエッジとして表されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-350">They're represented as documents, rows, nodes, or edges.</span></span> <span data-ttu-id="8ee01-351">コンテナーに追加されたすべての項目は自動的にインデックスが作成されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-351">All items added to a container are automatically indexed.</span></span>

<span data-ttu-id="8ee01-352">コンテナを分割するために、項目は論理区画と呼ばれる別個のサブセットに分割されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-352">To partition the container, items are divided into distinct subsets called logical partitions.</span></span> <span data-ttu-id="8ee01-353">論理パーティションは、コンテナー内の各項目に関連付けられているパーティション キーの値に基づいて設定されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-353">Logical partitions are populated based on the value of a partition key that is associated with each item in a container.</span></span> <span data-ttu-id="8ee01-354">図 5-18 は、パーティションキー値に基づいて論理パーティションを持つ 2 つのコンテナーを示しています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-354">Figure 5-18 shows two containers each with a logical partition based on a partition key value.</span></span>

![コスモスDBパーティション力学](./media/cosmos-db-partitioning.png)

<span data-ttu-id="8ee01-356">**図 5-18**: Cosmos DB パーティショニングメカニクス</span><span class="sxs-lookup"><span data-stu-id="8ee01-356">**Figure 5-18**: Cosmos DB partitioning mechanics</span></span>

<span data-ttu-id="8ee01-357">前の図では、各項目に 「都市」 または 「空港」のいずれかのパーティション キーが含まれている方法に注意してください。</span><span class="sxs-lookup"><span data-stu-id="8ee01-357">Note in the  previous figure how each item includes a partition key of either ‘city’ or ‘airport’.</span></span> <span data-ttu-id="8ee01-358">キーによって、項目の論理区画が決まります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-358">The key determines the item’s logical partition.</span></span> <span data-ttu-id="8ee01-359">市町村コードが含まれるアイテムは、左側のコンテナに、空港コードが設定されたアイテムは右側のコンテナに割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-359">Items with a city code are assigned to the container on the left, and items with an airport code, to the container on the right.</span></span> <span data-ttu-id="8ee01-360">パーティション キー値と ID 値を組み合わせると、項目のインデックスが作成され、アイテムが一意に識別されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-360">Combining the partition key value with the ID value creates an item's index, which uniquely identifies the item.</span></span>

<span data-ttu-id="8ee01-361">内部的には、Cosmos DB は、コンテナのスケーラビリティとパフォーマンスのニーズを満たすために、物理パーティション上の[論理パーティション](https://docs.microsoft.com/azure/cosmos-db/partition-data)の配置を自動的に管理します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-361">Internally, Cosmos DB automatically manages the placement of [logical partitions](https://docs.microsoft.com/azure/cosmos-db/partition-data) on physical partitions to satisfy the scalability and performance needs of the container.</span></span> <span data-ttu-id="8ee01-362">アプリケーションのスループットとストレージ要件が増加すると、Azure Cosmos DB は、より多くのサーバーに論理パーティションを再配布します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-362">As application throughput and storage requirements  increase, Azure Cosmos DB redistributes logical partitions across a greater number of servers.</span></span> <span data-ttu-id="8ee01-363">再配布操作は Cosmos DB によって管理され、中断やダウンタイムなしで呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-363">Redistribution operations are managed by Cosmos DB and invoked without interruption or downtime.</span></span>

## <a name="newsql-databases"></a><span data-ttu-id="8ee01-364">データベースの新規作成</span><span class="sxs-lookup"><span data-stu-id="8ee01-364">NewSQL databases</span></span>

<span data-ttu-id="8ee01-365">*NewSQL* は、NoSQL の分散スケーラビリティとリレーショナル データベースの ACID 保証を組み合わせた新しいデータベース テクノロジです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-365">*NewSQL* is an emerging database technology that combines the distributed scalability of NoSQL with the ACID guarantees of a relational database.</span></span> <span data-ttu-id="8ee01-366">NewSQL データベースは、トランザクションの完全なサポートと ACID 準拠を使用して、分散環境全体で大量のデータを処理する必要があるビジネス システムにとって重要です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-366">NewSQL databases are important for business systems that must process high-volumes of data, across distributed environments, with full transactional support and ACID compliance.</span></span> <span data-ttu-id="8ee01-367">NoSQL データベースは、大規模なスケーラビリティを提供できますが、データの一貫性は保証されません。</span><span class="sxs-lookup"><span data-stu-id="8ee01-367">While a NoSQL database can provide massive scalability, it does not guarantee data consistency.</span></span> <span data-ttu-id="8ee01-368">データの一貫性がなくなると、一貫性のない問題が発生すると、開発チームに負担が生じる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-368">Intermittent problems from inconsistent data can place a burden on the development team.</span></span> <span data-ttu-id="8ee01-369">開発者は、マイクロサービス コードにセーフガードを組み込み、データの不整合によって発生する問題を管理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-369">Developers must construct safeguards into their microservice code to manage problems caused by inconsistent data.</span></span>

<span data-ttu-id="8ee01-370">クラウド ネイティブ コンピューティング ファウンデーション (CNCF) には、いくつかの NewSQL データベース プロジェクトが用意されています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-370">The Cloud Native Computing Foundation (CNCF) features several NewSQL database projects.</span></span>

| <span data-ttu-id="8ee01-371">Project</span><span class="sxs-lookup"><span data-stu-id="8ee01-371">Project</span></span> | <span data-ttu-id="8ee01-372">特性</span><span class="sxs-lookup"><span data-stu-id="8ee01-372">Characteristics</span></span> |
| :-------- | :-------- |
| <span data-ttu-id="8ee01-373">ゴキブリDB</span><span class="sxs-lookup"><span data-stu-id="8ee01-373">Cockroach DB</span></span> |<span data-ttu-id="8ee01-374">グローバルに拡張する ACID 準拠のリレーショナル データベース。</span><span class="sxs-lookup"><span data-stu-id="8ee01-374">An ACID compliant, relational database that scales globally.</span></span> <span data-ttu-id="8ee01-375">新しいノードをクラスターに追加すると、ゴキブリ DB はインスタンスと地域間でデータのバランスを取ります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-375">Add a new node to a cluster and CockroachDB takes care of balancing the data across instances and geographies.</span></span> <span data-ttu-id="8ee01-376">信頼性を確保するためにレプリカを作成、管理、配布します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-376">It creates, manages and distributes replicas to ensure reliability.</span></span> <span data-ttu-id="8ee01-377">それはオープンソースで、自由に利用できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-377">It’s open source and freely available.</span></span>  |
| <span data-ttu-id="8ee01-378">ティジド</span><span class="sxs-lookup"><span data-stu-id="8ee01-378">TiDB</span></span> | <span data-ttu-id="8ee01-379">ハイブリッド トランザクションおよび分析処理 (HTAP) ワークロードをサポートするオープン ソース データベース。</span><span class="sxs-lookup"><span data-stu-id="8ee01-379">An open-source database that supports Hybrid Transactional and Analytical Processing (HTAP) workloads.</span></span> <span data-ttu-id="8ee01-380">MySQL と互換性があり、水平スケーラビリティ、強力な一貫性、高可用性を備えています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-380">It is MySQL-compatible and features horizontal scalability, strong consistency, and high availability.</span></span>  <span data-ttu-id="8ee01-381">TiDB は、MySQL サーバーのように動作します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-381">TiDB acts like a MySQL server.</span></span> <span data-ttu-id="8ee01-382">既存の MySQL クライアントライブラリを引き続き使用できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-382">You can continue to use existing MySQL client libraries, without requiring extensive code changes to your application.</span></span> |
| <span data-ttu-id="8ee01-383">ユガバイトDB</span><span class="sxs-lookup"><span data-stu-id="8ee01-383">YugabyteDB</span></span> | <span data-ttu-id="8ee01-384">オープンソースの高性能な分散型 SQL データベース。</span><span class="sxs-lookup"><span data-stu-id="8ee01-384">An open source, high-performance, distributed SQL database.</span></span> <span data-ttu-id="8ee01-385">低いクエリ待機時間、障害に対する復元性、およびグローバル データの分散をサポートします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-385">It supports low query latency, resilience against failures, and global data distribution.</span></span> <span data-ttu-id="8ee01-386">ユガバイト DB は PostgressSQL 互換であり、スケールアウト RDBMS およびインターネット規模の OLTP ワークロードを処理します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-386">YugabyteDB is PostgressSQL-compatible and handles scale-out RDBMS and internet-scale OLTP workloads.</span></span> <span data-ttu-id="8ee01-387">この製品は NoSQL もサポートしており、Cassandra と互換性があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-387">The product also support NoSQL and is compatible with Cassandra.</span></span> |
|<span data-ttu-id="8ee01-388">ヴィテス</span><span class="sxs-lookup"><span data-stu-id="8ee01-388">Vitess</span></span> | <span data-ttu-id="8ee01-389">Vitessは、MySQLインスタンスの大規模なクラスターをデプロイ、スケーリング、管理するためのデータベースソリューションです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-389">Vitess is a database solution for deploying, scaling and managing large clusters of MySQL instances.</span></span> <span data-ttu-id="8ee01-390">パブリックまたはプライベートクラウドアーキテクチャで実行できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-390">It’s can run in a public or private cloud architecture.</span></span> <span data-ttu-id="8ee01-391">これは、多くの重要なMySQL機能と垂直および水平シャーディングサポートの両方を組み合わせた拡張します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-391">It combines and extends many important MySQL features and features both vertical and horizontal sharding support.</span></span> <span data-ttu-id="8ee01-392">YouTube が発信した Vitess は、2011 年以降、すべての YouTube データベース トラフィックを提供しています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-392">Originated by YouTube, Vitess has been serving all YouTube database traffic since 2011 .</span></span> |

<span data-ttu-id="8ee01-393">上の図のオープンソースプロジェクトは、クラウドネイティブコンピューティング財団から入手できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-393">The open-source projects in the previous figure are available from the Cloud Native Computing Foundation.</span></span> <span data-ttu-id="8ee01-394">3 つの製品は、.NET Core サポートを含む完全なデータベース製品です。</span><span class="sxs-lookup"><span data-stu-id="8ee01-394">Three of the offerings are full database products, which include .NET Core support.</span></span> <span data-ttu-id="8ee01-395">もう 1 つの Vitess は、MySQL インスタンスの大規模なクラスターを水平方向にスケーリングするデータベース・クラスタリング・システムです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-395">The other, Vitess, is a database clustering system that horizontally scales large clusters of MySQL instances.</span></span>

<span data-ttu-id="8ee01-396">NewSQL データベースの設計目標の重要な目的は、Kubernetes でネイティブに動作し、プラットフォームの復元力とスケーラビリティを活用することです。</span><span class="sxs-lookup"><span data-stu-id="8ee01-396">A key design goal for NewSQL databases is to work natively in Kubernetes, taking advantage of the platform's resiliency and scalability.</span></span>

<span data-ttu-id="8ee01-397">NewSQL データベースは、基盤となる仮想マシンをすぐに再起動または再スケジュールできる一時的なクラウド環境で繁栄するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-397">NewSQL databases are designed to thrive in ephemeral cloud environments where underlying virtual machines can be restarted or rescheduled at a moment’s notice.</span></span> <span data-ttu-id="8ee01-398">データベースは、データの損失やダウンタイムを伴わずにノード障害を生き残るように設計されています。</span><span class="sxs-lookup"><span data-stu-id="8ee01-398">The databases are designed to survive node failures without data loss nor downtime.</span></span> <span data-ttu-id="8ee01-399">例えば、ゴキブリDBは、クラスター内のノード全体でデータの3つの一貫したレプリカを維持することで、マシンの損失を生き残ることができます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-399">CockroachDB, for example, is able to survive a machine loss by maintaining three consistent replicas of any data across the nodes in a cluster.</span></span>

<span data-ttu-id="8ee01-400">Kubernetes は*Services コンストラクト*を使用して、クライアントが同一の NewSQL データベースプロセスのグループに対して単一の DNS エントリからアドレスを指定できるようにします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-400">Kubernetes uses a *Services construct* to allow a client to address a group of identical NewSQL databases processes from a single DNS entry.</span></span> <span data-ttu-id="8ee01-401">データベース インスタンスと関連付けられているサービスのアドレスを切り離すことで、既存のアプリケーション インスタンスを中断することなく拡張できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-401">By decoupling the database instances from the address of the service with which it's associated, we can scale without disrupting existing application instances.</span></span> <span data-ttu-id="8ee01-402">任意の時点で任意のサービスに要求を送信すると、常に同じ結果が得られます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-402">Sending a request to any service at a given time will always yield the same result.</span></span>

<span data-ttu-id="8ee01-403">このシナリオでは、すべてのデータベース インスタンスが等しくなります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-403">In this scenario, all database instances are equal.</span></span> <span data-ttu-id="8ee01-404">プライマリまたはセカンダリの関係はありません。</span><span class="sxs-lookup"><span data-stu-id="8ee01-404">There are no primary or secondary relationships.</span></span> <span data-ttu-id="8ee01-405">ゴキブリDBで見つかった*コンセンサスレプリケーション*のような技術は、任意のデータベースノードが任意の要求を処理することを可能にします。</span><span class="sxs-lookup"><span data-stu-id="8ee01-405">Techniques like *consensus replication* found in CockroachDB allow any database node to handle any request.</span></span> <span data-ttu-id="8ee01-406">負荷分散要求を受信するノードに必要なデータがローカルに含まれている場合は、すぐに応答します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-406">If the node that receives a load-balanced request has the data it needs locally, it responds immediately.</span></span> <span data-ttu-id="8ee01-407">正しくない場合、ノードはゲートウェイになり、正しい応答を得るために適切なノードに要求を転送します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-407">If not, the node becomes a gateway and forwards the request to the appropriate nodes to get the correct answer.</span></span> <span data-ttu-id="8ee01-408">クライアントの観点から見ると、すべてのデータベース ノードは同じで、1 台のマシン システムの一貫性が保証される単一の*論理*データベースとして表示されます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-408">From the client's perspective, every database node is the same: They appear as a single *logical* database with the consistency guarantees of a single-machine system, despite having dozens or even hundreds of nodes that are working behind the scenes.</span></span>

<span data-ttu-id="8ee01-409">NewSQL データベースの背後にある仕組みを詳しく見る方法については[、「DASH: Kubernetes ネイティブ データベースの 4 つのプロパティ」の記事を参照してください](https://thenewstack.io/dash-four-properties-of-kubernetes-native-databases/)。</span><span class="sxs-lookup"><span data-stu-id="8ee01-409">For a detailed look at the mechanics behind NewSQL databases, see the [DASH: Four Properties of Kubernetes-Native Databases](https://thenewstack.io/dash-four-properties-of-kubernetes-native-databases/) article.</span></span>

## <a name="data-migration-to-the-cloud"></a><span data-ttu-id="8ee01-410">クラウドへのデータ移行</span><span class="sxs-lookup"><span data-stu-id="8ee01-410">Data migration to the cloud</span></span>

<span data-ttu-id="8ee01-411">時間のかかるタスクの 1 つに、データ プラットフォーム間でのデータの移行があります。</span><span class="sxs-lookup"><span data-stu-id="8ee01-411">One of the more time-consuming tasks is migrating data from one data platform to another.</span></span> <span data-ttu-id="8ee01-412">[Azure データ移行サービス](https://azure.microsoft.com/services/database-migration/)は、このような作業を迅速化するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-412">The [Azure Data Migration Service](https://azure.microsoft.com/services/database-migration/) can help expedite such efforts.</span></span> <span data-ttu-id="8ee01-413">最小限のダウンタイムで、複数の外部データベース ソースから Azure Data プラットフォームにデータを移行できます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-413">It can migrate data from several external database sources into Azure Data platforms with minimal downtime.</span></span> <span data-ttu-id="8ee01-414">ターゲット プラットフォームには、次のサービスが含まれます。</span><span class="sxs-lookup"><span data-stu-id="8ee01-414">Target platforms include the following services:</span></span>

- <span data-ttu-id="8ee01-415">Azure SQL データベース</span><span class="sxs-lookup"><span data-stu-id="8ee01-415">Azure SQL Database</span></span>
- <span data-ttu-id="8ee01-416">Azure Database for MySQL</span><span class="sxs-lookup"><span data-stu-id="8ee01-416">Azure Database for MySQL</span></span>
- <span data-ttu-id="8ee01-417">Azure Database for MariaDB</span><span class="sxs-lookup"><span data-stu-id="8ee01-417">Azure Database for MariaDB</span></span>
- <span data-ttu-id="8ee01-418">Azure Database for PostgreSQL</span><span class="sxs-lookup"><span data-stu-id="8ee01-418">Azure Database for PostgreSQL</span></span>
- <span data-ttu-id="8ee01-419">Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="8ee01-419">CosmosDB</span></span>
  
<span data-ttu-id="8ee01-420">このサービスでは、小規模または大規模の両方で移行を実行するために必要な変更について説明する推奨事項を提供します。</span><span class="sxs-lookup"><span data-stu-id="8ee01-420">The service provides recommendations to guide you through the changes required to execute a migration, both small or large.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="8ee01-421">[前へ](database-per-microservice.md)
>[次へ](azure-caching.md)</span><span class="sxs-lookup"><span data-stu-id="8ee01-421">[Previous](database-per-microservice.md)
[Next](azure-caching.md)</span></span>
