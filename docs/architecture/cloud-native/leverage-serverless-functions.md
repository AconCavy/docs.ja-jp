---
title: サーバーレス関数の活用
description: クラウドネイティブアプリケーションでのサーバーレスと Azure Functions の活用
ms.date: 06/30/2019
ms.openlocfilehash: 77ddef0eb8844ea1b55cd2fc5ec8aa12593c8631
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/30/2019
ms.locfileid: "73841745"
---
# <a name="leveraging-serverless-functions"></a><span data-ttu-id="9980f-103">サーバーレス関数の活用</span><span class="sxs-lookup"><span data-stu-id="9980f-103">Leveraging serverless functions</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="9980f-104">クラウドの機能を活用するための完全なコンピューターとオペレーティングシステムの管理の範囲では、サーバーレスが非常に優れています。この場合、責任を負うのはコードだけで、コードの実行時にのみ課金されます。</span><span class="sxs-lookup"><span data-stu-id="9980f-104">In the spectrum of managing full machines and operating systems to leveraging cloud capabilities, serverless lives at the extreme end where the only thing you're responsible for is your code, and you only pay when your code runs.</span></span> <span data-ttu-id="9980f-105">Azure Functions によって、サーバーレス機能をアプリケーションに組み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="9980f-105">Azure Functions provides a way to build serverless capabilities into your applications.</span></span>

## <a name="what-is-serverless"></a><span data-ttu-id="9980f-106">サーバーレスとは</span><span class="sxs-lookup"><span data-stu-id="9980f-106">What is serverless?</span></span>

<span data-ttu-id="9980f-107">サーバーレスコンピューティングは、アプリケーションの実行に関連するサーバーが存在しないという意味ではありません。このコードは、サーバー上のどこかで実行されます。</span><span class="sxs-lookup"><span data-stu-id="9980f-107">Serverless computing doesn't mean there isn't a server involved in running your application - the code still runs on a server somewhere.</span></span> <span data-ttu-id="9980f-108">この違いは、アプリケーション開発チームは、サーバーインフラストラクチャの管理について自身を意識する必要がなくなることです。</span><span class="sxs-lookup"><span data-stu-id="9980f-108">The distinction is that the application development team no longer needs to concern themselves with managing server infrastructure.</span></span> <span data-ttu-id="9980f-109">Azure Functions のようなサーバーレスコンピューティングソリューションでは、チームは生産性を向上させ、組織はリソースを最適化し、ソリューションの提供に専念することができます。</span><span class="sxs-lookup"><span data-stu-id="9980f-109">Serverless computing solutions like Azure Functions help teams increase their productivity and allow organizations to optimize their resources and focus on delivering solutions.</span></span>

<span data-ttu-id="9980f-110">サーバーレスコンピューティングでは、イベントによってトリガーされるステートレスコンテナーを使用して、アプリケーションまたはアプリケーションの一部をホストします。</span><span class="sxs-lookup"><span data-stu-id="9980f-110">Serverless computing uses event-triggered stateless containers to host your application or part of your application.</span></span> <span data-ttu-id="9980f-111">サーバーレスプラットフォームでは、必要に応じてスケールアウトおよびスケールインを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="9980f-111">Serverless platforms can scale out and in to meet demand as-needed.</span></span> <span data-ttu-id="9980f-112">Azure Functions のようなプラットフォームでは、キュー、イベント、ストレージなどの他の Azure サービスに簡単に直接アクセスできます。</span><span class="sxs-lookup"><span data-stu-id="9980f-112">Platforms like Azure Functions have easy direct access to other Azure services like queues, events, and storage.</span></span>

## <a name="what-challenges-are-solved-by-serverless"></a><span data-ttu-id="9980f-113">サーバーレスによって解決される課題</span><span class="sxs-lookup"><span data-stu-id="9980f-113">What challenges are solved by serverless?</span></span>

<span data-ttu-id="9980f-114">サーバーレスは、独自のハードウェアを実行するという究極の抽象化です。</span><span class="sxs-lookup"><span data-stu-id="9980f-114">Serverless is the ultimate abstraction away from running your own hardware.</span></span> <span data-ttu-id="9980f-115">開発者は、独自のサーバーをホストするときに必要になる可能性がある次のタスクについて心配することなく、ビジネス上の問題を解決するコードの記述にのみ集中できます。</span><span class="sxs-lookup"><span data-stu-id="9980f-115">Developers can focus exclusively on writing code to solve business problems, without concern for any of the following tasks that might have been necessary when hosting your own servers:</span></span>

- <span data-ttu-id="9980f-116">購入コンピューターとソフトウェアライセンス</span><span class="sxs-lookup"><span data-stu-id="9980f-116">Purchasing machines and software licenses</span></span>
- <span data-ttu-id="9980f-117">コンピューターとそのネットワーク、電力、および A/C の要件のハウジング、セキュリティ保護、構成、および保守</span><span class="sxs-lookup"><span data-stu-id="9980f-117">Housing, securing, configuring, and maintaining the machines and their networking, power, and A/C requirements</span></span>
- <span data-ttu-id="9980f-118">オペレーティングシステムとソフトウェアの修正プログラムの適用とアップグレード</span><span class="sxs-lookup"><span data-stu-id="9980f-118">Patching and upgrading operating systems and software</span></span>
- <span data-ttu-id="9980f-119">アプリケーションソフトウェアをホストするための web サーバーまたはコンピューターサービスの構成</span><span class="sxs-lookup"><span data-stu-id="9980f-119">Configuring web servers or machine services to host application software</span></span>
- <span data-ttu-id="9980f-120">プラットフォーム内でのアプリケーションソフトウェアの構成</span><span class="sxs-lookup"><span data-stu-id="9980f-120">Configuring application software within its platform</span></span>

<span data-ttu-id="9980f-121">多くの企業では、多数のスタッフメンバーを採用しており、これらのハードウェアインフラストラクチャの問題をサポートするために大きな予算を割り当てています。</span><span class="sxs-lookup"><span data-stu-id="9980f-121">Many companies employ dozens of staff members and allocate large budgets to support these hardware infrastructure concerns.</span></span> <span data-ttu-id="9980f-122">単にクラウドに移行することで、これらの懸念事項の一部が排除されます。アプリケーションをサーバーレスに移行することで、残りの部分を排除できます。</span><span class="sxs-lookup"><span data-stu-id="9980f-122">Simply moving to the cloud eliminates some of these concerns; shifting applications all the way to serverless will eliminate the rest.</span></span>

## <a name="what-scenarios-are-appropriate-for-serverless"></a><span data-ttu-id="9980f-123">サーバーレスに適したシナリオ</span><span class="sxs-lookup"><span data-stu-id="9980f-123">What scenarios are appropriate for serverless?</span></span>

<span data-ttu-id="9980f-124">サーバーレスでは、何らかのトリガーに応答して呼び出される、個々の実行時間の短い関数を使用します。</span><span class="sxs-lookup"><span data-stu-id="9980f-124">Serverless uses individual short-running functions that are called in response to some trigger.</span></span> <span data-ttu-id="9980f-125">これにより、バックグラウンドタスクの処理に最適です。</span><span class="sxs-lookup"><span data-stu-id="9980f-125">This makes them ideal for processing background tasks.</span></span>

<span data-ttu-id="9980f-126">たとえば、アプリケーションでは、要求の処理の一環として電子メールを送信する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="9980f-126">For example, an application might need to send an email as part of processing a request.</span></span> <span data-ttu-id="9980f-127">Web 要求の処理の一環として電子メールを送信する代わりに、電子メールの詳細をキューに配置し、Azure 関数を使用してメッセージを取得し、電子メールを送信することができます。</span><span class="sxs-lookup"><span data-stu-id="9980f-127">Instead of sending the email as part of handling the web request, the details of the email could be placed onto a queue and an Azure Function could be used to pick up the message and send the email.</span></span> <span data-ttu-id="9980f-128">アプリケーションのさまざまな部分 (または多くのアプリケーション) は、この同じ Azure 関数を利用できます。これにより、アプリケーションのパフォーマンスとスケーラビリティが向上し、[キューベースの負荷平準化](https://docs.microsoft.com/azure/architecture/patterns/queue-based-load-leveling)を使用して、電子メールの送信に関連するボトルネックを回避することができます。</span><span class="sxs-lookup"><span data-stu-id="9980f-128">Many different parts of the application, or even many applications, could leverage this same Azure Function, providing improved performance and scalability for the applications and using [queue-based load leveling](https://docs.microsoft.com/azure/architecture/patterns/queue-based-load-leveling) to avoid bottlenecks related to sending the emails.</span></span>

<span data-ttu-id="9980f-129">アプリケーションと Azure Functions 間の[パブリッシャー/サブスクライバーパターン](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber)は最も一般的なパターンですが、他のパターンを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="9980f-129">Although a [Publisher/Subscriber pattern](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) between applications and Azure Functions is the most common pattern, other patterns are possible.</span></span> <span data-ttu-id="9980f-130">Azure Functions は、Azure Blob Storage への変更など、他のイベントによってトリガーできます。</span><span class="sxs-lookup"><span data-stu-id="9980f-130">Azure Functions can be triggered by other events, such as changes to Azure Blob Storage.</span></span> <span data-ttu-id="9980f-131">イメージのアップロードをサポートするアプリケーションには、サムネイル画像を作成したり、アップロードされたイメージのサイズを一貫したサイズに変更したり、イメージのサイズを最適化したりする Azure 関数が含まれる場合があります。</span><span class="sxs-lookup"><span data-stu-id="9980f-131">An application that supported image uploads could have an Azure Function responsible for creating thumbnail images, or resizing uploaded images to consistent dimensions, or optimizing image size.</span></span> <span data-ttu-id="9980f-132">この機能はすべて Azure Blob Storage に挿入することによって直接トリガーされる可能性があり、複雑さとワークロードはアプリケーション自体から除外されます。</span><span class="sxs-lookup"><span data-stu-id="9980f-132">All of this functionality could be triggered directly by inserts to Azure Blob Storage, keeping the complexity and the workload out of the application itself.</span></span>

<span data-ttu-id="9980f-133">多くのアプリケーションは、ワークフローの一部として実行時間の長いプロセスを持ちます。</span><span class="sxs-lookup"><span data-stu-id="9980f-133">Many applications have long-running processes as part of their workflows.</span></span> <span data-ttu-id="9980f-134">多くの場合、これらのタスクはアプリケーションとのユーザー操作の一部として実行されるので、ユーザーは自分のエクスペリエンスを待機して悪影響を与えることになります。</span><span class="sxs-lookup"><span data-stu-id="9980f-134">Often these tasks are done as part of the user's interaction with the application, forcing the user to wait and negatively impacting their experience.</span></span> <span data-ttu-id="9980f-135">サーバーレスコンピューティングは、ユーザー操作ループの外部での低速タスクを実行する優れた方法を提供します。これらのタスクは、アプリケーション全体を拡張する必要がなく、要求に応じて簡単に拡張できます。</span><span class="sxs-lookup"><span data-stu-id="9980f-135">Serverless computing provides a great way to perform slower tasks outside of the user interaction loop, and these tasks can easily scale with demand without requiring the entire application to scale.</span></span>

## <a name="when-should-you-avoid-serverless"></a><span data-ttu-id="9980f-136">サーバーレスを避ける必要がある場合</span><span class="sxs-lookup"><span data-stu-id="9980f-136">When should you avoid serverless?</span></span>

<span data-ttu-id="9980f-137">サーバーレスコンピューティングは、ユーザーインターフェイスをブロックしないタスクに最適です。</span><span class="sxs-lookup"><span data-stu-id="9980f-137">Serverless computing is best-used for tasks that don't block the user interface.</span></span> <span data-ttu-id="9980f-138">これは、web アプリケーションまたは web Api を直接ホストするのに最適ではないことを意味します。</span><span class="sxs-lookup"><span data-stu-id="9980f-138">This means they're not ideal for hosting web applications or web APIs directly.</span></span> <span data-ttu-id="9980f-139">その主な理由は、サーバーレスソリューションがプロビジョニングされ、必要に応じてスケーリングされることです。</span><span class="sxs-lookup"><span data-stu-id="9980f-139">The main reason for this is that serverless solutions are provisioned and scaled on demand.</span></span> <span data-ttu-id="9980f-140">*コールドスタート*と呼ばれる関数の新しいインスタンスが必要な場合は、プロビジョニングに時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="9980f-140">When a new instance of a function is needed, referred to as a *cold start*, it takes time to provision.</span></span> <span data-ttu-id="9980f-141">通常、この時間は数秒ですが、さまざまな要因によってはより長い時間がかかることがあります。</span><span class="sxs-lookup"><span data-stu-id="9980f-141">This time is typically a few seconds, but can be longer depending on a variety of factors.</span></span> <span data-ttu-id="9980f-142">(たとえば、定期的に要求を行うことによって) 1 つのインスタンスを無期限に保持できますが、スケールアップする必要があるインスタンスの数が多い場合は、コールドスタートの問題が残ります。</span><span class="sxs-lookup"><span data-stu-id="9980f-142">A single instance can often be kept alive indefinitely (for instance, by periodically making a request to it), but the cold start issue remains if the number of instances ever needs to scale up.</span></span>

<span data-ttu-id="9980f-143">コールドスタートとウォームスタート ![](./media/cold-start-warm-start.png)
**図 3-10**。</span><span class="sxs-lookup"><span data-stu-id="9980f-143">![Cold versus warm start](./media/cold-start-warm-start.png)
**Figure 3-10**.</span></span> <span data-ttu-id="9980f-144">コールドスタートとウォームスタート。</span><span class="sxs-lookup"><span data-stu-id="9980f-144">Cold start versus warm start.</span></span>

<span data-ttu-id="9980f-145">コールドスタートを完全に回避する必要がある場合は、[従量課金プランから専用プランに](https://azure.microsoft.com/blog/understanding-serverless-cold-start/)切り替えることができます。</span><span class="sxs-lookup"><span data-stu-id="9980f-145">If you need to avoid cold starts entirely, you can choose to switch from a [consumption plan to a dedicated plan](https://azure.microsoft.com/blog/understanding-serverless-cold-start/).</span></span> <span data-ttu-id="9980f-146">また、premium プランで[1 つ以上の事前登録済みの med-v インスタンスを構成](https://docs.microsoft.com/azure/azure-functions/functions-premium-plan#pre-warmed-instances)することもできます。これにより、別のインスタンスを追加する必要があるときに、既に稼働状態になっています。</span><span class="sxs-lookup"><span data-stu-id="9980f-146">You can also [configure one or more pre-warmed instances](https://docs.microsoft.com/azure/azure-functions/functions-premium-plan#pre-warmed-instances) with the premium plan so when you need to add another instance, it's already up and ready to go.</span></span> <span data-ttu-id="9980f-147">これらのオプションを使用すると、サーバーレスコンピューティングに関連する主な問題の1つを軽減できます。</span><span class="sxs-lookup"><span data-stu-id="9980f-147">These options can mitigate one of the key concerns associated with serverless computing.</span></span>

<span data-ttu-id="9980f-148">また、実行時間の長いタスクについては、通常はサーバーレスを使用しないようにしてください。</span><span class="sxs-lookup"><span data-stu-id="9980f-148">You should also typically avoid serverless for long-running tasks.</span></span> <span data-ttu-id="9980f-149">これらは、すばやく完了できる小さな作業に最適です。</span><span class="sxs-lookup"><span data-stu-id="9980f-149">They're best for small pieces of work that can be completed quickly.</span></span> <span data-ttu-id="9980f-150">ほとんどのサーバーレスプラットフォームでは、数分以内に個々の機能が完了する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9980f-150">Most serverless platforms require individual functions to complete within a few minutes.</span></span> <span data-ttu-id="9980f-151">Azure Functions 既定値は5分間です (10 分まで構成できます)。</span><span class="sxs-lookup"><span data-stu-id="9980f-151">Azure Functions defaults to a 5-minute time-out duration (can be configured up to 10 minutes).</span></span> <span data-ttu-id="9980f-152">Azure Functions premium プランでもこの問題を軽減できます。既定では30分にタイムアウトし、無制限の上限を構成することができます。</span><span class="sxs-lookup"><span data-stu-id="9980f-152">The Azure Functions premium plan can mitigate this issue as well, defaulting time outs to 30 minutes and allowing an unbounded higher limit to be configured.</span></span>

<span data-ttu-id="9980f-153">最後に、アプリケーション内の特定のタスクに対してサーバーレスを利用すると、複雑さが増します。</span><span class="sxs-lookup"><span data-stu-id="9980f-153">Finally, leveraging serverless for certain tasks within your application adds complexity.</span></span> <span data-ttu-id="9980f-154">多くの場合、アプリケーションをモジュール化された疎結合方式で設計してから、サーバーレスで提供される利点によって複雑さが増すというメリットがあるかどうかを確認することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="9980f-154">It's often best to architect your application in a modular, loosely coupled manner first, and then identify if there are benefits serverless would offer that make the additional complexity worthwhile.</span></span> <span data-ttu-id="9980f-155">小規模なアプリケーションの多くは、単一のモノリシックデプロイで完全に動作します。サーバーレスコンピューティングに必要な分散アプリケーションアーキテクチャは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="9980f-155">Many smaller applications will run perfectly well in a single monolithic deployment, without the need for the distributed application architecture serverless computing requires.</span></span>

## <a name="references"></a><span data-ttu-id="9980f-156">関連項目</span><span class="sxs-lookup"><span data-stu-id="9980f-156">References</span></span>

- [<span data-ttu-id="9980f-157">サーバーレスコールドスタートについて</span><span class="sxs-lookup"><span data-stu-id="9980f-157">Understanding serverless cold start</span></span>](https://azure.microsoft.com/blog/understanding-serverless-cold-start/)
- [<span data-ttu-id="9980f-158">事前に準備した med-v Azure Functions インスタンス</span><span class="sxs-lookup"><span data-stu-id="9980f-158">Pre-warmed Azure Functions instances</span></span>](https://docs.microsoft.com/azure/azure-functions/functions-premium-plan#pre-warmed-instances)
- [<span data-ttu-id="9980f-159">カスタムイメージを使用して Linux で関数を作成する</span><span class="sxs-lookup"><span data-stu-id="9980f-159">Create a function on Linux using a custom image</span></span>](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image)

>[!div class="step-by-step"]
><span data-ttu-id="9980f-160">[前へ](leverage-containers-orchestrators.md)
>[次へ](combine-containers-serverless-approaches.md)</span><span class="sxs-lookup"><span data-stu-id="9980f-160">[Previous](leverage-containers-orchestrators.md)
[Next](combine-containers-serverless-approaches.md)</span></span>
