---
title: Windows コンテナーとして既存の .NET アプリを展開する
description: Azure Cloud と Windows コンテナーで既存の .NET アプリケーションを最新化する | 既存の .NET アプリを Windows コンテナーとして展開する
ms.date: 12/21/2020
ms.openlocfilehash: f3f164ca0578d5358f2c5365fd5a1d2e8e22d8c5
ms.sourcegitcommit: 5d9cee27d9ffe8f5670e5f663434511e81b8ac38
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/08/2021
ms.locfileid: "98025351"
---
# <a name="deploy-existing-net-apps-as-windows-containers"></a><span data-ttu-id="30434-103">Windows コンテナーとして既存の .NET アプリを展開する</span><span class="sxs-lookup"><span data-stu-id="30434-103">Deploy existing .NET apps as Windows containers</span></span>

<span data-ttu-id="30434-104">Windows コンテナーに基づく展開は、クラウド向けに最適化されたアプリケーションやクラウドネイティブ アプリケーションに適用できます。</span><span class="sxs-lookup"><span data-stu-id="30434-104">Deployments that are based on Windows Containers are applicable to Cloud-Optimized applications and Cloud-Native applications.</span></span>

<span data-ttu-id="30434-105">ただし、このガイド (特に以降のセクション) では、主として、アプリケーションを再設計する必要のない "*クラウド向けに最適化されたアプリケーション*" での Windows コンテナーの使用に重点を置いています。</span><span class="sxs-lookup"><span data-stu-id="30434-105">However, in this guide and especially in the following sections, it mostly focuses on using Windows Containers for *Cloud-Optimized* applications where you don't need to rearchitect your application.</span></span>

## <a name="what-are-containers-linux-or-windows"></a><span data-ttu-id="30434-106">コンテナーとは</span><span class="sxs-lookup"><span data-stu-id="30434-106">What are containers?</span></span> <span data-ttu-id="30434-107">(Linux または Windows)</span><span class="sxs-lookup"><span data-stu-id="30434-107">(Linux or Windows)</span></span>

<span data-ttu-id="30434-108">コンテナーとは、アプリケーションをそれ独自の分離パッケージにラップする方法です。</span><span class="sxs-lookup"><span data-stu-id="30434-108">Containers are a way to wrap up an application into its own isolated package.</span></span> <span data-ttu-id="30434-109">コンテナー内のアプリケーションは、コンテナーの外部に存在するアプリケーションやプロセスの影響を受けません。</span><span class="sxs-lookup"><span data-stu-id="30434-109">In its container, the application is not affected by applications or processes that exist outside of the container.</span></span> <span data-ttu-id="30434-110">アプリケーションがプロセスとして正常に実行するために依存するすべてのものは、コンテナー内にあります。</span><span class="sxs-lookup"><span data-stu-id="30434-110">Everything the application depends on to run successfully as a process is inside the container.</span></span> <span data-ttu-id="30434-111">コンテナーが移動する場所がどこであっても、アプリケーションの要件は、直接的な依存関係の観点から常に満たされます。これは、実行に必要なすべてのもの (ライブラリの依存関係やランタイムなど) がアプリケーションにバンドルされているためです。</span><span class="sxs-lookup"><span data-stu-id="30434-111">Wherever the container might move, the requirements of the application will always be met, in terms of direct dependencies, because it is bundled with everything that it needs to run (library dependencies, runtimes, and so on).</span></span>

<span data-ttu-id="30434-112">コンテナーの主な特徴は、コンテナー自体に必要なすべての依存関係が付属しているために、さまざまな展開にわたり同じ環境が確保されるということです。</span><span class="sxs-lookup"><span data-stu-id="30434-112">The main characteristic of a container is that it makes the environment the same across different deployments because the container itself comes with all the dependencies it needs.</span></span> <span data-ttu-id="30434-113">ご利用のコンピューター上でアプリケーションをデバッグしてから、同じ環境が保証されている別のコンピューターに展開することができます。</span><span class="sxs-lookup"><span data-stu-id="30434-113">You can debug the application on your machine, and then deploy it to another machine, with the same environment guaranteed.</span></span>

<span data-ttu-id="30434-114">コンテナーは、コンテナー イメージのインスタンスです。</span><span class="sxs-lookup"><span data-stu-id="30434-114">A container is an instance of a container image.</span></span> <span data-ttu-id="30434-115">コンテナー イメージとは、(スナップショットのように) アプリやサービスをパッケージ化してから、信頼性が高く、再現可能な方法で展開する方法です。</span><span class="sxs-lookup"><span data-stu-id="30434-115">A container image is a way to package an app or service (like a snapshot), and then deploy it in a reliable and reproducible way.</span></span> <span data-ttu-id="30434-116">Docker はテクノロジであるだけでなく、哲学やプロセスでもあると言うことができます。</span><span class="sxs-lookup"><span data-stu-id="30434-116">You could say that Docker is not only a technology-it's also a philosophy and a process.</span></span>

<span data-ttu-id="30434-117">コンテナーが日常的に使用されるようになるにつれて、コンテナーは業界全体の "展開の単位" になりつつあります。</span><span class="sxs-lookup"><span data-stu-id="30434-117">As containers daily become more common, they are becoming an industry-wide "unit of deployment."</span></span>

## <a name="benefits-of-containers-docker-engine-on-linux-or-windows"></a><span data-ttu-id="30434-118">コンテナーの利点 (Linux または Windows 上の Docker エンジン)</span><span class="sxs-lookup"><span data-stu-id="30434-118">Benefits of containers (Docker Engine on Linux or Windows)</span></span>

<span data-ttu-id="30434-119">コンテナー (軽量な構成要素として定義されている場合もあります) を使用してアプリケーションをビルドすると、インフラストラクチャ全体で任意のアプリケーションをビルド、配布、実行するための機敏性が大幅に向上します。</span><span class="sxs-lookup"><span data-stu-id="30434-119">Building applications by using containers-which also might be defined as lightweight building blocks-offers a significant increase in agility for building, shipping, and running any application, across any infrastructure.</span></span>

<span data-ttu-id="30434-120">コンテナーを使用すると、Microsoft 開発者ツール、オペレーティング システム、およびクラウド全体にわたる Docker 統合により、コードをほとんどまたはまったく変更せずに、開発から運用まで任意のアプリを利用できます。</span><span class="sxs-lookup"><span data-stu-id="30434-120">With containers, you can take any app from development to production with little or no code change, thanks to Docker integration across Microsoft developer tools, operating systems, and the cloud.</span></span>

<span data-ttu-id="30434-121">プレーン VM に展開する場合、ご利用の VM に ASP.NET アプリを展開するための所定の方法が既に用意されているはずです。</span><span class="sxs-lookup"><span data-stu-id="30434-121">When you deploy to plain VMs, you probably already have a method in place for deploying ASP.NET apps to your VMs.</span></span> <span data-ttu-id="30434-122">ただし、その方法には、Puppet などの展開ツールまたは同様のツールを使用して、手動による複数の手順または複雑な自動化プロセスが必要である可能性があります。</span><span class="sxs-lookup"><span data-stu-id="30434-122">It's likely, though, that your method involves multiple manual steps or complex automated processes by using a deployment tool like Puppet, or a similar tool.</span></span> <span data-ttu-id="30434-123">場合によっては、構成項目の変更、サーバー間でのアプリケーション コンテンツのコピー、.msi セットアップに基づく対話型セットアップ プログラムの実行などのタスクを行い、その後でテストを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="30434-123">You might need to perform tasks like modifying configuration items, copying application content between servers, and running interactive setup programs based on .msi setups, followed by testing.</span></span> <span data-ttu-id="30434-124">展開でのそのようなすべての手順を行うと、展開にかかる時間が長くなりリスクが増えます。</span><span class="sxs-lookup"><span data-stu-id="30434-124">All those steps in the deployment add time and risk to deployments.</span></span> <span data-ttu-id="30434-125">ターゲット環境に依存関係が存在しない場合は必ずエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="30434-125">You will get failures whenever a dependency is not present in the target environment.</span></span>

<span data-ttu-id="30434-126">Windows コンテナーでは、アプリケーションをパッケージ化するプロセスが完全に自動化されています。</span><span class="sxs-lookup"><span data-stu-id="30434-126">In Windows Containers, the process of packaging applications is fully automated.</span></span> <span data-ttu-id="30434-127">Windows コンテナーは、コンテナーの展開に対して自動更新およびロールバックを行うことができる Docker プラットフォームに基づいています。</span><span class="sxs-lookup"><span data-stu-id="30434-127">Windows Containers is based on the Docker platform, which offers automatic updates and rollbacks for container deployments.</span></span> <span data-ttu-id="30434-128">Docker エンジンを使用することで得られる主な改善点は、ご利用のアプリケーションとその依存関係をすべて含むスナップショットのようなイメージを作成できることです。</span><span class="sxs-lookup"><span data-stu-id="30434-128">The main improvement you get from using the Docker engine is that you create images, which are like snapshots of your application, with all its dependencies.</span></span> <span data-ttu-id="30434-129">このイメージは Docker イメージです (この場合は Windows コンテナー イメージ)。</span><span class="sxs-lookup"><span data-stu-id="30434-129">The images are Docker images (a Windows container image, in this case).</span></span> <span data-ttu-id="30434-130">イメージでは、ソース コードに戻ることなく、コンテナー内で ASP.NET アプリが実行されます。</span><span class="sxs-lookup"><span data-stu-id="30434-130">The images run ASP.NET apps in containers, without going back to source code.</span></span> <span data-ttu-id="30434-131">コンテナーのスナップショットが展開の単位となります。</span><span class="sxs-lookup"><span data-stu-id="30434-131">The container snapshot becomes the unit of deployment.</span></span>

<span data-ttu-id="30434-132">組織の多くは、次の理由により、既存のモノリシック アプリケーションをコンテナー化しています。</span><span class="sxs-lookup"><span data-stu-id="30434-132">Many organizations are containerizing existing monolithic applications for the following reasons:</span></span>

- <span data-ttu-id="30434-133">**改善された展開によるリリースの機敏性**。</span><span class="sxs-lookup"><span data-stu-id="30434-133">**Release agility through improved deployment**.</span></span> <span data-ttu-id="30434-134">コンテナーにより、開発と運用の間で一貫した展開コントラクトが得られます。</span><span class="sxs-lookup"><span data-stu-id="30434-134">Containers offer a consistent deployment contract between development and operations.</span></span> <span data-ttu-id="30434-135">コンテナーを使用すると、"自分のマシンでは動作するのに運用環境で動作しないのはなぜだ" と言う開発者の言葉を聞くことはありません。</span><span class="sxs-lookup"><span data-stu-id="30434-135">When you use containers, you won't hear developers say, "It works on my machine, why not in production?"</span></span> <span data-ttu-id="30434-136">彼らは "コンテナーとして実行されているので、運用環境でも実行される" と言うことができます。</span><span class="sxs-lookup"><span data-stu-id="30434-136">They can say, "It runs as a container, so it will run in production."</span></span> <span data-ttu-id="30434-137">パッケージ化されたアプリケーションは、そのすべての依存関係と共に、サポートされている任意のコンテナーベースの環境で実行することができます。</span><span class="sxs-lookup"><span data-stu-id="30434-137">The packaged application, with all its dependencies, can be executed in any supported container-based environment.</span></span> <span data-ttu-id="30434-138">すべての展開ターゲット (開発、QA、ステージング、運用) での実行を意図した方法で実行されます。</span><span class="sxs-lookup"><span data-stu-id="30434-138">It will run the way it was intended to run in all deployment targets (dev, QA, staging, production).</span></span> <span data-ttu-id="30434-139">コンテナーでは、あるステージから次のステージに移行するときにほとんどの摩擦が排除されるため、展開が大幅に改善され、より迅速に配布できるようになります。</span><span class="sxs-lookup"><span data-stu-id="30434-139">Containers eliminate most frictions when they move from one stage to the next, which greatly improves deployment, and you can ship faster.</span></span>

- <span data-ttu-id="30434-140">**コスト削減**。</span><span class="sxs-lookup"><span data-stu-id="30434-140">**Cost reductions**.</span></span> <span data-ttu-id="30434-141">コンテナーでは、既存のハードウェアの統合と削除によって、またはハードウェア単位ごとのより高い密度でのアプリケーションの実行により、コスト削減がもたらされます。</span><span class="sxs-lookup"><span data-stu-id="30434-141">Containers lead to lower costs, either by the consolidation and removal of existing hardware, or from running applications at a higher density per unit of hardware.</span></span>

- <span data-ttu-id="30434-142">**移植性**。</span><span class="sxs-lookup"><span data-stu-id="30434-142">**Portability**.</span></span> <span data-ttu-id="30434-143">コンテナーはモジュール式で移植可能です。</span><span class="sxs-lookup"><span data-stu-id="30434-143">Containers are modular and portable.</span></span> <span data-ttu-id="30434-144">Docker コンテナーは、任意のサーバー オペレーティング システム (Linux および Windows)、任意のメジャー パブリック クラウド (Microsoft Azure、Amazon AWS、Google、IBM)、およびオンプレミス環境とプライベートまたはハイブリッドのクラウド環境でサポートされています。</span><span class="sxs-lookup"><span data-stu-id="30434-144">Docker containers are supported on any server operating system (Linux and Windows), in any major public cloud (Microsoft Azure, Amazon AWS, Google, IBM), and in on-premises and private or hybrid cloud environments.</span></span>

- <span data-ttu-id="30434-145">**制御**。</span><span class="sxs-lookup"><span data-stu-id="30434-145">**Control**.</span></span> <span data-ttu-id="30434-146">コンテナーでは、コンテナー レベルで制御される柔軟で安全な環境が実現されます。</span><span class="sxs-lookup"><span data-stu-id="30434-146">Containers offer a flexible and secure environment that's controlled at the container level.</span></span> <span data-ttu-id="30434-147">コンテナーに対して実行制約ポリシーを設定することで、コンテナーをセキュリティで保護し、分離し、さらに制限することができます。</span><span class="sxs-lookup"><span data-stu-id="30434-147">A container can be secured, isolated, and even limited by setting execution constraint policies on the container.</span></span> <span data-ttu-id="30434-148">Windows コンテナーに関するセクションで詳述したように、Windows Server 2016 と Hyper-V コンテナーには、追加のエンタープライズ サポート オプションが用意されています。</span><span class="sxs-lookup"><span data-stu-id="30434-148">As detailed in the section about Windows Containers, Windows Server 2016 and Hyper-V containers offer additional enterprise support options.</span></span>

<span data-ttu-id="30434-149">コンテナーを使用してアプリケーションを開発および管理すると、機敏性、移植性、および制御が大幅に改善され、最終的には大幅なコスト削減につながります。</span><span class="sxs-lookup"><span data-stu-id="30434-149">Significant improvements in agility, portability, and control ultimately lead to significant cost reductions when you use containers to develop and maintain applications.</span></span>

## <a name="what-is-docker"></a><span data-ttu-id="30434-150">Docker について</span><span class="sxs-lookup"><span data-stu-id="30434-150">What is Docker?</span></span>

<span data-ttu-id="30434-151">[Docker](https://www.docker.com/) とは、クラウドまたはオンプレミスで実行できる移植可能な自己完結型のコンテナーとしてアプリケーションの展開を自動化する[オープン ソース プロジェクト](https://github.com/docker/docker)です。</span><span class="sxs-lookup"><span data-stu-id="30434-151">[Docker](https://www.docker.com/) is an [open-source project](https://github.com/docker/docker) that automates the deployment of applications as portable, self-sufficient containers that can run in the cloud or on-premises.</span></span> <span data-ttu-id="30434-152">Docker は、このテクノロジを促進および進化させる[会社](https://www.docker.com/)でもあります。</span><span class="sxs-lookup"><span data-stu-id="30434-152">Docker is also a [company](https://www.docker.com/) that promotes and evolves this technology.</span></span> <span data-ttu-id="30434-153">この会社は、Microsoft を含む、クラウド、Linux、Windows の各ベンダーとの共同作業を行っています。</span><span class="sxs-lookup"><span data-stu-id="30434-153">The company works in collaboration with cloud, Linux, and Windows vendors, including Microsoft.</span></span>

![Docker によってハイブリッド クラウドにコンテナーが展開される方法を示す図。](./media/deploy-existing-net-apps-as-windows-containers/docker-deploys-containers-all-layers.png)

<span data-ttu-id="30434-155">**図 4-6**</span><span class="sxs-lookup"><span data-stu-id="30434-155">**Figure 4-6.**</span></span> <span data-ttu-id="30434-156">Docker は、ハイブリッド クラウドのすべてのレイヤーでコンテナーを展開します。</span><span class="sxs-lookup"><span data-stu-id="30434-156">Docker deploys containers at all layers of the hybrid cloud</span></span>

<span data-ttu-id="30434-157">仮想マシンを使い慣れているユーザーにとって、コンテナーは非常に似ているように見えるかもしれません。</span><span class="sxs-lookup"><span data-stu-id="30434-157">To someone familiar with virtual machines, containers might appear to be remarkably similar.</span></span> <span data-ttu-id="30434-158">物理または仮想コンピューター システムと同様に、コンテナーではオペレーティング システムが実行され、ファイル システムが用意されており、コンテナーにはネットワーク経由でアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="30434-158">A container runs an operating system, has a file system, and can be accessed over a network, just like a physical or virtual computer system.</span></span> <span data-ttu-id="30434-159">ただし、コンテナーの背後にあるテクノロジおよび概念は仮想マシンとは大きく異なります。</span><span class="sxs-lookup"><span data-stu-id="30434-159">However, the technology and concepts behind containers are vastly different from virtual machines.</span></span> <span data-ttu-id="30434-160">開発者の観点から見ると、コンテナーはむしろ 1 つのプロセスのように扱う必要があります。</span><span class="sxs-lookup"><span data-stu-id="30434-160">From a developer point of view, a container must be treated more like a single process.</span></span> <span data-ttu-id="30434-161">実際、コンテナーには 1 つのプロセス用の単一のエントリ ポイントがあります。</span><span class="sxs-lookup"><span data-stu-id="30434-161">In fact, a container has a single entry point for one process.</span></span>

<span data-ttu-id="30434-162">Docker コンテナー (簡単にする場合は、"*コンテナー*") は、Linux と Windows 上でネイティブに実行できます。</span><span class="sxs-lookup"><span data-stu-id="30434-162">Docker containers (for simplicity, *containers*) can run natively on Linux and Windows.</span></span> <span data-ttu-id="30434-163">通常のコンテナーを実行する場合、Windows コンテナーは Windows ホスト (ホスト サーバーまたは VM) 上でのみ実行でき、Linux コンテナーは Linux ホスト上でのみ実行できます。</span><span class="sxs-lookup"><span data-stu-id="30434-163">When running regular containers, Windows containers can run only on Windows hosts (a host server or a VM), and Linux containers can run only on Linux hosts.</span></span> <span data-ttu-id="30434-164">ただし、最新バージョンの Windows Server コンテナーおよび Hyper-V コンテナーでは、現在 Windows Server コンテナーでしか使用できない Hyper-V による分離テクノロジを使用することで、Linux コンテナーを Windows Server 上でネイティブに実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="30434-164">However, in recent versions of Windows Server and Hyper-V containers, a Linux container can also run natively on Windows Server by using the Hyper-V isolation technology that currently is available only in Windows Server Containers.</span></span>

<span data-ttu-id="30434-165">近い将来、Linux コンテナーと Windows コンテナーの両方が混在する環境が可能になり、さらには一般的になります。</span><span class="sxs-lookup"><span data-stu-id="30434-165">In the near future, mixed environments that have both Linux and Windows containers will be possible and even common.</span></span>

## <a name="benefits-of-windows-containers-for-your-existing-net-applications"></a><span data-ttu-id="30434-166">既存の .NET アプリケーションに対する Windows コンテナーの利点</span><span class="sxs-lookup"><span data-stu-id="30434-166">Benefits of Windows Containers for your existing .NET applications</span></span>

<span data-ttu-id="30434-167">Windows コンテナーを使用することの利点は、一般にコンテナーから得られる利点と基本的に同じです。</span><span class="sxs-lookup"><span data-stu-id="30434-167">The benefits of using Windows Containers are fundamentally the same benefits you get from containers in general.</span></span> <span data-ttu-id="30434-168">Windows コンテナーを使用すれば、機敏性、移植性、および制御が大幅に向上します。</span><span class="sxs-lookup"><span data-stu-id="30434-168">Using Windows Containers is about greatly improving agility, portability, and control.</span></span>

<span data-ttu-id="30434-169">既存の .NET アプリケーションは、.NET Framework を使用して作成されたアプリケーションを参照します。</span><span class="sxs-lookup"><span data-stu-id="30434-169">Existing .NET applications refer to those applications that were created using the .NET Framework.</span></span> <span data-ttu-id="30434-170">たとえば、それらが従来の ASP.NET Web アプリケーションである場合、より新しく、Linux、Windows、および MacOS に対してクロスプラットフォームで実行される .NET Core や .NET 5.0 は使用されません。</span><span class="sxs-lookup"><span data-stu-id="30434-170">For example, they might be traditional ASP.NET web applications-they don't use .NET Core or .NET 5.0, which is newer and runs cross-platform on Linux, Windows, and MacOS.</span></span>

<span data-ttu-id="30434-171">.NET Framework 内の主な依存関係は Windows です。</span><span class="sxs-lookup"><span data-stu-id="30434-171">The main dependency in the .NET Framework is Windows.</span></span> <span data-ttu-id="30434-172">また、IIS や、従来の ASP.NET の System.Web などの、セカンダリの依存関係もあります。</span><span class="sxs-lookup"><span data-stu-id="30434-172">It also has secondary dependencies, like IIS, and System.Web in traditional ASP.NET.</span></span>

<span data-ttu-id="30434-173">.NET Framework アプリケーションは、Windows 上で実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="30434-173">A .NET Framework application must run on Windows, period.</span></span> <span data-ttu-id="30434-174">既存の .NET Framework アプリケーションをコンテナー化したいが、.NET Core 以上への移行には投資できない、あるいはしたくない場合 ("正常に動作している場合は移行しないでください")、コンテナーに対する唯一の選択肢は Windows コンテナーを使用することです。</span><span class="sxs-lookup"><span data-stu-id="30434-174">If you want to containerize existing .NET Framework applications and you can't or don't want to invest in a migration to .NET Core or later("If it works properly, don't migrate it"), the only choice you have for containers is to use Windows Containers.</span></span>

<span data-ttu-id="30434-175">したがって、Windows コンテナーの主な利点の 1 つは、Windows 上で実行されている既存の .NET Framework アプリケーションをコンテナー化を使用して最新化する方法を得られるということです。</span><span class="sxs-lookup"><span data-stu-id="30434-175">So, one of the main benefits of Windows Containers is that they offer you a way to modernize your existing .NET Framework applications that are running on Windows-through containerization.</span></span> <span data-ttu-id="30434-176">最終的に、Windows コンテナーでは、コンテナーを使用することで、期待している利点 (機敏性、移植性、およびより優れた制御) が得られます。</span><span class="sxs-lookup"><span data-stu-id="30434-176">Ultimately, Windows Containers gets you the benefits that you are looking for by using containers-agility, portability, and better control.</span></span>

## <a name="choose-an-os-to-target-with-net-based-containers"></a><span data-ttu-id="30434-177">NET ベースのコンテナーでターゲットとする OS を選択する</span><span class="sxs-lookup"><span data-stu-id="30434-177">Choose an OS to target with .NET-based containers</span></span>

<span data-ttu-id="30434-178">Docker でサポートされているオペレーティング システムの多様性に加えて、.NET Framework と .NET Core の違いを考慮し、使用しているフレームワークに基づいて特定の OS と特定のバージョンをターゲットにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="30434-178">Given the diversity of operating systems that are supported by Docker, as well as the differences between .NET Framework and .NET Core, you should target a specific OS and specific versions based on the framework you are using.</span></span>

<span data-ttu-id="30434-179">Windows の場合、Windows Server Core または Windows Nano Server を使用できます。</span><span class="sxs-lookup"><span data-stu-id="30434-179">For Windows, you can use Windows Server Core or Windows Nano Server.</span></span> <span data-ttu-id="30434-180">これらの Windows バージョンは、.NET Framework または .NET アプリケーションで必要とされる可能性があるさまざまな特性を備えています (IIS と、Kestrel のような自己ホスト型 Web サーバーのように)。</span><span class="sxs-lookup"><span data-stu-id="30434-180">These Windows versions provide different characteristics (like IIS versus a self-hosted web server like Kestrel) that might be needed by .NET Framework or .NET applications.</span></span>

<span data-ttu-id="30434-181">Linux の場合、複数のディストリビューションを利用できます。また、Linux は公式の .NET Docker イメージ (Debian など) でサポートされています。</span><span class="sxs-lookup"><span data-stu-id="30434-181">For Linux, multiple distros are available and supported in official .NET Docker images (like Debian).</span></span>

<span data-ttu-id="30434-182">図 4-7 に、.NET Framework のアプリのバージョンに応じてターゲットにすることができる OS バージョンを示します。</span><span class="sxs-lookup"><span data-stu-id="30434-182">Figure 4-7 shows OS versions that you can target, depending on the app's version of the .NET Framework.</span></span>

![.NET Framework のバージョンに基づいてターゲットにする OS を示す図。](./media/deploy-existing-net-apps-as-windows-containers/dotnet-framework-operating-systems.png)

<span data-ttu-id="30434-184">**図 4-7**</span><span class="sxs-lookup"><span data-stu-id="30434-184">**Figure 4-7.**</span></span> <span data-ttu-id="30434-185">.NET Framework のバージョンに基づいてターゲットにするオペレーティング システム</span><span class="sxs-lookup"><span data-stu-id="30434-185">Operating systems to target based on .NET Framework version</span></span>

<span data-ttu-id="30434-186">.NET Framework アプリケーションに基づいた既存のアプリケーションまたはレガシ アプリケーションの移行シナリオでは、主な依存関係は Windows と IIS にあります。</span><span class="sxs-lookup"><span data-stu-id="30434-186">In migration scenarios for existing or legacy applications that are based on .NET Framework applications, the main dependencies are on Windows and IIS.</span></span> <span data-ttu-id="30434-187">唯一のオプションは、Windows Server Core と .NET Framework に基づいた Docker イメージを使用することです。</span><span class="sxs-lookup"><span data-stu-id="30434-187">Your only option is to use Docker images based on Windows Server Core and the .NET Framework.</span></span>

<span data-ttu-id="30434-188">ご利用の Dockerfile ファイルにイメージ名を追加すると、.NET Framework ベースの Windows コンテナー イメージに関する次の例のように、タグを使用してオペレーティング システムとバージョンを選択できます。</span><span class="sxs-lookup"><span data-stu-id="30434-188">When you add the image name to your Dockerfile file, you can select the operating system and version by using a tag, as in the following examples for .NET Framework-based Windows container images:</span></span>

> | <span data-ttu-id="30434-189">**Tag**</span><span class="sxs-lookup"><span data-stu-id="30434-189">**Tag**</span></span> | <span data-ttu-id="30434-190">**システムとバージョン**</span><span class="sxs-lookup"><span data-stu-id="30434-190">**System and version**</span></span> |
> |---|---|
> | <span data-ttu-id="30434-191">**mcr.microsoft.com/dotnet/framework/runtime:4.x-windowsservercore-20H2**</span><span class="sxs-lookup"><span data-stu-id="30434-191">**mcr.microsoft.com/dotnet/framework/runtime:4.x-windowsservercore-20H2**</span></span> | <span data-ttu-id="30434-192">Windows Server Core での .NET Framework 4.x</span><span class="sxs-lookup"><span data-stu-id="30434-192">.NET Framework 4.x on Windows Server Core</span></span> |
> | <span data-ttu-id="30434-193">**mcr.microsoft.com/dotnet/framework/aspnet:4.x-windowsservercore-20H2**</span><span class="sxs-lookup"><span data-stu-id="30434-193">**mcr.microsoft.com/dotnet/framework/aspnet:4.x-windowsservercore-20H2**</span></span> | <span data-ttu-id="30434-194">Windows Server Core 上での、追加の ASP.NET カスタマイズを含む .NET Framework 4.x</span><span class="sxs-lookup"><span data-stu-id="30434-194">.NET Framework 4.x with additional ASP.NET customization, on Windows Server Core</span></span> |

<span data-ttu-id="30434-195">.NET (Linux と Windows のクロスプラットフォーム) の場合、タグは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="30434-195">For .NET (cross-platform for Linux and Windows), the tags would look like the following:</span></span>

> | <span data-ttu-id="30434-196">**Tag**</span><span class="sxs-lookup"><span data-stu-id="30434-196">**Tag**</span></span> | <span data-ttu-id="30434-197">**システムとバージョン**</span><span class="sxs-lookup"><span data-stu-id="30434-197">**System and version**</span></span>
> |---|---|
> | <span data-ttu-id="30434-198">**mcr.microsoft.com/dotnet/runtime:5.0**</span><span class="sxs-lookup"><span data-stu-id="30434-198">**mcr.microsoft.com/dotnet/runtime:5.0**</span></span> | <span data-ttu-id="30434-199">Linux 上の .NET ランタイムのみ</span><span class="sxs-lookup"><span data-stu-id="30434-199">.NET runtime-only on Linux</span></span> |
> | <span data-ttu-id="30434-200">**mcr.microsoft.com/dotnet/runtime:5.0-nanoserver-20H2**</span><span class="sxs-lookup"><span data-stu-id="30434-200">**mcr.microsoft.com/dotnet/runtime:5.0-nanoserver-20H2**</span></span> | <span data-ttu-id="30434-201">Windows Nano Server 上の .NET ランタイムのみ</span><span class="sxs-lookup"><span data-stu-id="30434-201">.NET runtime-only on Windows Nano Server</span></span> |

### <a name="multi-arch-images"></a><span data-ttu-id="30434-202">マルチアーキテクチャ イメージ</span><span class="sxs-lookup"><span data-stu-id="30434-202">Multi-arch images</span></span>

<span data-ttu-id="30434-203">また、2017 年半ばから、[マルチアーキテクチャ](https://github.com/moby/moby/issues/15866) イメージと呼ばれる Docker の新機能を使用できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="30434-203">Beginning in mid-2017, you can also use a new feature in Docker called [multi-arch](https://github.com/moby/moby/issues/15866) images.</span></span> <span data-ttu-id="30434-204">.NET Docker イメージにはマルチアーキテクチャ タグを使用できます。</span><span class="sxs-lookup"><span data-stu-id="30434-204">.NET Docker images can use multi-arch tags.</span></span> <span data-ttu-id="30434-205">ご利用の Dockerfile ファイルでは、ターゲットとするオペレーティング システムを定義する必要がなくなりました。</span><span class="sxs-lookup"><span data-stu-id="30434-205">Your Dockerfile files no longer need to define the operating system that you are targeting.</span></span> <span data-ttu-id="30434-206">マルチアーキテクチャ機能では、1 つのタグを、複数のコンピューター構成にわたって使用できます。</span><span class="sxs-lookup"><span data-stu-id="30434-206">The multi-arch feature allows a single tag to be used across multiple machine configurations.</span></span> <span data-ttu-id="30434-207">たとえば、マルチアーキテクチャでは、**mcr.microsoft.com/dotnet/runtime:5.0** という 1 つの一般的なタグを使用できます。</span><span class="sxs-lookup"><span data-stu-id="30434-207">For instance, with multi-arch, you can use one common tag: **mcr.microsoft.com/dotnet/runtime:5.0**.</span></span> <span data-ttu-id="30434-208">Linux コンテナー環境からそのタグをプルすると、Debian ベースのイメージが得られます。</span><span class="sxs-lookup"><span data-stu-id="30434-208">If you pull that tag from a Linux container environment, you get the Debian-based image.</span></span> <span data-ttu-id="30434-209">Windows コンテナー環境からそのタグをプルすると、Nano Server ベースのイメージが得られます。</span><span class="sxs-lookup"><span data-stu-id="30434-209">If you pull that tag from a Windows container environment, you get the Nano Server-based image.</span></span>

<span data-ttu-id="30434-210">.NET Framework イメージの場合、従来の .NET Framework では Windows しかサポートされていないため、マルチアーキテクチャ機能は使用できません。</span><span class="sxs-lookup"><span data-stu-id="30434-210">For .NET Framework images, because the traditional .NET Framework supports only Windows, you cannot use the multi-arch feature.</span></span>

## <a name="windows-container-types"></a><span data-ttu-id="30434-211">Windows コンテナーの種類</span><span class="sxs-lookup"><span data-stu-id="30434-211">Windows container types</span></span>

<span data-ttu-id="30434-212">Linux コンテナーと同様に、Windows Server コンテナーは Docker エンジンを使用して管理されます。</span><span class="sxs-lookup"><span data-stu-id="30434-212">Like Linux containers, Windows Server containers are managed by using Docker Engine.</span></span> <span data-ttu-id="30434-213">Linux コンテナーとは異なり、Windows コンテナーには 2 つの異なるコンテナー タイプ、つまり実行時 Windows Server コンテナーと Hyper-V による分離が含まれます。</span><span class="sxs-lookup"><span data-stu-id="30434-213">Unlike Linux containers, Windows containers include two different container types, or run times-Windows Server containers and Hyper-V isolation.</span></span>

<span data-ttu-id="30434-214">**Windows Server コンテナー**: プロセスと名前空間の分離テクノロジを使用してアプリケーションの分離を実現します。</span><span class="sxs-lookup"><span data-stu-id="30434-214">**Windows Server containers**: Provides application isolation through process and namespace isolation technology.</span></span> <span data-ttu-id="30434-215">Windows Server コンテナーは、コンテナー ホスト、およびホスト上で実行されているすべてのコンテナーとカーネルを共有します。</span><span class="sxs-lookup"><span data-stu-id="30434-215">A Windows Server container shares a kernel with the container host and all containers that are running on the host.</span></span> <span data-ttu-id="30434-216">これらのコンテナーは敵対的なセキュリティ境界を提供しないため、信頼されていないコードを分離するために使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="30434-216">These containers do not provide a hostile security boundary and should not be used to isolate untrusted code.</span></span> <span data-ttu-id="30434-217">共有されたカーネル空間があるため、これらのコンテナーには同じカーネル バージョンおよび構成が必要です。</span><span class="sxs-lookup"><span data-stu-id="30434-217">Because of the shared kernel space, these containers require the same kernel version and configuration.</span></span>

<span data-ttu-id="30434-218">**Hyper-V による分離**: 高度に最適化された VM で各コンテナーを実行することで、Windows Server コンテナーによって実現される分離を拡張します。</span><span class="sxs-lookup"><span data-stu-id="30434-218">**Hyper-V isolation**: Expands on the isolation provided by Windows Server Containers by running each container on a highly optimized VM.</span></span> <span data-ttu-id="30434-219">この構成では、コンテナー ホストのカーネルは、同じホスト上にある他のコンテナーと共有されません。</span><span class="sxs-lookup"><span data-stu-id="30434-219">In this configuration, the kernel of the container host is not shared with other containers on the same host.</span></span> <span data-ttu-id="30434-220">これらのコンテナーは、VM と同じセキュリティ保証を使用して、敵対的なマルチテナント ホスティング向けに設計されています。</span><span class="sxs-lookup"><span data-stu-id="30434-220">These containers are designed for hostile multitenant hosting, with the same security assurances of a VM.</span></span> <span data-ttu-id="30434-221">これらのコンテナーは、ホスト、またはホスト上のその他のコンテナーとカーネルを共有しないため、さまざまなバージョンおよび構成のカーネルを実行することができます (バージョンがサポートされている場合)。</span><span class="sxs-lookup"><span data-stu-id="30434-221">Because these containers don't share the kernel with the host or other containers on the host, they can run kernels with different versions and configurations (with supported versions).</span></span> <span data-ttu-id="30434-222">たとえば、Windows 10 上のすべての Windows コンテナーでは、Hyper-V による分離を使用して、Windows Server カーネルのバージョンと構成が利用されます。</span><span class="sxs-lookup"><span data-stu-id="30434-222">For example, all Windows containers on Windows 10 use Hyper-V isolation to utilize the Windows Server kernel version and configuration.</span></span>

<span data-ttu-id="30434-223">Windows 上でコンテナーの実行を、Hyper-V による分離を使用して行うか、使用しないで行うかの決定は、実行時に行います。</span><span class="sxs-lookup"><span data-stu-id="30434-223">Running a container on Windows with or without Hyper-V isolation is a run-time decision.</span></span> <span data-ttu-id="30434-224">最初は Hyper-V による分離を使用してコンテナーを作成し、実行時に Windows Server コンテナーとして実行するように選択することもできます。</span><span class="sxs-lookup"><span data-stu-id="30434-224">You might choose to create the container with Hyper-V isolation initially, and at run time, choose to run it as a Windows Server container instead.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="30434-225">その他の技術情報</span><span class="sxs-lookup"><span data-stu-id="30434-225">Additional resources</span></span>

- <span data-ttu-id="30434-226">**Windows コンテナーに関するドキュメント**</span><span class="sxs-lookup"><span data-stu-id="30434-226">**Windows Containers documentation**</span></span>

    <https://docs.microsoft.com/virtualization/windowscontainers/>

- <span data-ttu-id="30434-227">**Windows コンテナーの基礎**</span><span class="sxs-lookup"><span data-stu-id="30434-227">**Windows Containers fundamentals**</span></span>

    <https://docs.microsoft.com/virtualization/windowscontainers/about/>

- <span data-ttu-id="30434-228">**インフォグラフィック: Microsoft とコンテナー**</span><span class="sxs-lookup"><span data-stu-id="30434-228">**Infographic: Microsoft and containers**</span></span>

    <https://info.microsoft.com/rs/157-GQE-382/images/Container%20infographic%201.4.17.pdf>

## <a name="the-container-ecosystem-in-azure"></a><span data-ttu-id="30434-229">Azure でのコンテナー エコシステム</span><span class="sxs-lookup"><span data-stu-id="30434-229">The container ecosystem in Azure</span></span>

<span data-ttu-id="30434-230">前のセクションでは、Docker コンテナーの利点と、.NET アプリケーション用の特定のコンテナー イメージの詳細について説明しました。</span><span class="sxs-lookup"><span data-stu-id="30434-230">In previous sections, it's been explained what the benefits of Docker containers are as well as details on the specific container images for .NET applications.</span></span> <span data-ttu-id="30434-231">その一般的な情報はすべて、アプリケーションを開発またはコンテナー化するための基本となります。</span><span class="sxs-lookup"><span data-stu-id="30434-231">All that generic information is fundamental in order to develop or containerize an application.</span></span>
<span data-ttu-id="30434-232">ただし、運用展開環境または QA および開発/テスト環境について考えた場合、Microsoft Azure では、オープンで多岐にわたる選択肢が用意され、クラウドでの完全なコンテナー エコシステムが実現されます (以下の図を参照)。</span><span class="sxs-lookup"><span data-stu-id="30434-232">However, when thinking about the production deployment environment or even QA and Dev/Test environments, Microsoft Azure provides an open and broad variety of choices, a full container ecosystem in the cloud (shown in the diagram below).</span></span> <span data-ttu-id="30434-233">特定のアプリケーションのニーズに応じて、いずれかの Azure 製品を選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="30434-233">Depending on your specific application's needs, you should choose one or another Azure product.</span></span>

![Azure のコンテナーエコシステムの図。](./media/deploy-existing-net-apps-as-windows-containers/azure-container-ecosystem.png)

<span data-ttu-id="30434-235">**図 4-7.5**</span><span class="sxs-lookup"><span data-stu-id="30434-235">**Figure 4-7.5.**</span></span> <span data-ttu-id="30434-236">Azure でのコンテナー エコシステム</span><span class="sxs-lookup"><span data-stu-id="30434-236">The container ecosystem in Azure</span></span>

<span data-ttu-id="30434-237">Azure でのコンテナー エコシステムから、次の製品によって、インフラストラクチャと見なされるコンテナーがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="30434-237">From the container ecosystem in Azure, the following products supporting containers that are considered infrastructure:</span></span>

- <span data-ttu-id="30434-238">**Azure Container Instances (ACI)**</span><span class="sxs-lookup"><span data-stu-id="30434-238">**Azure Container Instances (ACI)**</span></span>
- <span data-ttu-id="30434-239">**Azure Virtual Machines** (コンテナーをサポート)</span><span class="sxs-lookup"><span data-stu-id="30434-239">**Azure Virtual Machines** (With container's support)</span></span>
- <span data-ttu-id="30434-240">**Azure Virtual Machine Scale Sets** (コンテナーをサポート)</span><span class="sxs-lookup"><span data-stu-id="30434-240">**Azure Virtual Machine Scale Sets** (With container's support)</span></span>

<span data-ttu-id="30434-241">これら 3 つのうち、ACI には大きな利点があります。それは基礎となる OS を維持する必要がなく、アップグレードやパッチなどを行う必要がないという事実です。しかし、このブックの後のセクションで詳しく説明するように、ACI は引き続きインフラストラクチャ レベルに配置されます。</span><span class="sxs-lookup"><span data-stu-id="30434-241">From those three, ACI provides a great benefit, which is the fact that you don't need to maintain the underlying OS, no need for you to upgrade/patch, etc. but ACI still is positioned in the infrastructure level, as better explained in the upcoming sections of this book.</span></span>

<span data-ttu-id="30434-242">同時に PaaS (サービスとしてのプラットフォーム) レベルにも配置される Azure サポート コンテナーの製品は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="30434-242">The products in Azure supporting containers that are at the same time positioned more in the PaaS (Platform as a Service) level are:</span></span>

- <span data-ttu-id="30434-243">**Azure App Service**</span><span class="sxs-lookup"><span data-stu-id="30434-243">**Azure App Service**</span></span>
- <span data-ttu-id="30434-244">**Azure Kubernetes Service (AKS および ACS)**</span><span class="sxs-lookup"><span data-stu-id="30434-244">**Azure Kubernetes Service (AKS and ACS)**</span></span>
- <span data-ttu-id="30434-245">**Azure Batch**</span><span class="sxs-lookup"><span data-stu-id="30434-245">**Azure Batch**</span></span>

<span data-ttu-id="30434-246">次に、Azure Container Registry は、Azure でホストされる拡張性の高いコンテナー レジストリであり、カスタム コンテナー イメージを登録してデプロイするときに、前述のすべての製品から使用することができます。</span><span class="sxs-lookup"><span data-stu-id="30434-246">Then, Azure Container Registry is a high scalable container registry hosted in Azure that you can use from all the previous products when registering and deploying your custom container images.</span></span>

<span data-ttu-id="30434-247">さらに、ご利用のコンテナーからは、Azure SQL Database、Azure Redis Cache、Azure Cosmos DB など、Azure 内の他のマネージド サービスを利用することもできます。</span><span class="sxs-lookup"><span data-stu-id="30434-247">In addition, from your containers, you can consume other managed services in Azure like Azure SQL Database, Azure Redis cache, Azure Cosmos DB, etc.</span></span> <span data-ttu-id="30434-248">また、Azure Marketplace には、Cloud Foundry や OpenShift などのサードパーティ製ソリューション/プラットフォームも用意されており、Azure 内でコンテナーを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="30434-248">plus there are third-party solutions/platforms available in Azure Marketplace like Cloud Foundry and OpenShift where you can also use containers within Azure.</span></span>

<span data-ttu-id="30434-249">次のセクションでは、特に Windows コンテナーをターゲットとする場合に、それらの Azure 製品とソリューションの各々を使用するタイミングに関する Microsoft の推奨事項について説明します。</span><span class="sxs-lookup"><span data-stu-id="30434-249">In the next sections, you can explore Microsoft's recommendations on when to use each of those Azure products and solutions specifically when targeting Windows Containers.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="30434-250">[前へ](what-about-cloud-native-applications.md)
>[次へ](when-not-to-deploy-to-windows-containers.md)</span><span class="sxs-lookup"><span data-stu-id="30434-250">[Previous](what-about-cloud-native-applications.md)
[Next](when-not-to-deploy-to-windows-containers.md)</span></span>
