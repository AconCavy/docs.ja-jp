---
title: アクティビティ定義のスコープ設定と表示
ms.date: 03/30/2017
ms.assetid: ccdffa07-9503-4eea-a61b-17f1564368b7
ms.openlocfilehash: c7f656fee4960a8c43ac58abafba400ed9b35bc1
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/26/2020
ms.locfileid: "96289166"
---
# <a name="activity-definition-scoping-and-visibility"></a><span data-ttu-id="0160c-102">アクティビティ定義のスコープ設定と表示</span><span class="sxs-lookup"><span data-stu-id="0160c-102">Activity Definition Scoping and Visibility</span></span>

<span data-ttu-id="0160c-103">アクティビティ定義のスコープと可視性は、オブジェクトのスコープと可視性と同様に、他のオブジェクトまたはアクティビティがアクティビティのメンバーにアクセスするために必要な機能です。</span><span class="sxs-lookup"><span data-stu-id="0160c-103">Activity definition scoping and visibility, just like scoping and visibility of an object, is the ability of other objects or activities to access members of the activity.</span></span> <span data-ttu-id="0160c-104">アクティビティ定義は次の実装によって実行されます。</span><span class="sxs-lookup"><span data-stu-id="0160c-104">Activity definition is performed by the following implementations:</span></span>  
  
1. <span data-ttu-id="0160c-105">アクティビティによってユーザーに公開されるメンバー (<xref:System.Activities.Argument>、<xref:System.Activities.Variable>、および <xref:System.Activities.ActivityDelegate> オブジェクト、および子アクティビティ) の指定。</span><span class="sxs-lookup"><span data-stu-id="0160c-105">Determining the members (<xref:System.Activities.Argument>, <xref:System.Activities.Variable>, and <xref:System.Activities.ActivityDelegate> objects, and child activities) an activity exposes to its users.</span></span>  
  
2. <span data-ttu-id="0160c-106">アクティビティの実行ロジックの実装。</span><span class="sxs-lookup"><span data-stu-id="0160c-106">Implementing the execution logic of the activity</span></span>  
  
 <span data-ttu-id="0160c-107">この実装には、アクティビティのコンシューマーには公開されないが、実装の詳細であるメンバーが含まれる場合があります。</span><span class="sxs-lookup"><span data-stu-id="0160c-107">The implementation may involve members that are not exposed to consumers of the activity, but are rather details of the implementation.</span></span>  <span data-ttu-id="0160c-108">型定義と同様に、作成者は、アクティビティ モデルを使用することで、定義対象のアクティビティの定義について、アクティビティ メンバーの可視性を指定できます。</span><span class="sxs-lookup"><span data-stu-id="0160c-108">Similar to type definition, the activity model allows an author to qualify the visibility of an activity member regarding the definition of the activity being defined.</span></span>  <span data-ttu-id="0160c-109">この可視性によって、データのスコープなどメンバーの使用法の要素が決定します。</span><span class="sxs-lookup"><span data-stu-id="0160c-109">This visibility governs aspects of member usage, such as data scoping.</span></span>  
  
## <a name="scope"></a><span data-ttu-id="0160c-110">Scope</span><span class="sxs-lookup"><span data-stu-id="0160c-110">Scope</span></span>  

 <span data-ttu-id="0160c-111">データのスコープ以外に、アクティビティ モデルの可視性によって、検証、デバッグ、追跡、トレースなどのアクティビティの他の要素へのアクセスが制限される場合があります。</span><span class="sxs-lookup"><span data-stu-id="0160c-111">In addition to data scoping, activity model visibility can restrict access to other aspects of the activity, such as validation, debugging, tracking, or tracing.</span></span> <span data-ttu-id="0160c-112">実行プロパティでは、実行の特性を特定の定義のスコープに制限するための可視性とスコープを使用します。</span><span class="sxs-lookup"><span data-stu-id="0160c-112">Execution properties use visibility and scoping for constraining execution characteristics to a particular scope of definition.</span></span> <span data-ttu-id="0160c-113">セカンダリ ルートでは、可視性とスコープを使用して、<xref:System.Activities.Statements.CompensableActivity> によってキャプチャされた状態を補正可能なアクティビティが使用される定義のスコープに制限します。</span><span class="sxs-lookup"><span data-stu-id="0160c-113">Secondary roots use visibility and scoping to constrain the state captured by a <xref:System.Activities.Statements.CompensableActivity> to the scope of definition in which the compensable activities are used.</span></span>  
  
## <a name="definition-and-usage"></a><span data-ttu-id="0160c-114">定義と使用法</span><span class="sxs-lookup"><span data-stu-id="0160c-114">Definition and usage</span></span>  

 <span data-ttu-id="0160c-115">ワークフローは、基本アクティビティクラスから継承し、 [組み込みのアクティビティライブラリ](net-framework-4-5-built-in-activity-library.md)のアクティビティを使用して、新しいアクティビティを作成することによって作成されます。</span><span class="sxs-lookup"><span data-stu-id="0160c-115">A workflow is written by authoring new activities by inheriting from base activity classes, and by using activities from the [Built-In Activity Library](net-framework-4-5-built-in-activity-library.md).</span></span> <span data-ttu-id="0160c-116">アクティビティを使用するには、アクティビティ作成者によってその定義の各コンポーネントの可視性が設定される必要があります。</span><span class="sxs-lookup"><span data-stu-id="0160c-116">In order to use an activity, the activity author must configure the visibility of each component of its definition.</span></span>  
  
### <a name="activity-members"></a><span data-ttu-id="0160c-117">アクティビティ メンバー</span><span class="sxs-lookup"><span data-stu-id="0160c-117">Activity Members</span></span>  

 <span data-ttu-id="0160c-118">アクティビティ モデルでは、アクティビティによってコンシューマーが使用できるようになる引数、変数、デリゲート、および子アクティビティが定義されます。</span><span class="sxs-lookup"><span data-stu-id="0160c-118">The activity model defines the arguments, variables, delegates, and child activities that the activity makes available to consumers.</span></span> <span data-ttu-id="0160c-119">各メンバーは、`public` または `private` として宣言できます。</span><span class="sxs-lookup"><span data-stu-id="0160c-119">Each of these members can be declared as `public` or `private`.</span></span> <span data-ttu-id="0160c-120">パブリック メンバーはアクティビティのコンシューマーが設定し、`private` メンバーはアクティビティの作成者によって指定された実装を使用します。</span><span class="sxs-lookup"><span data-stu-id="0160c-120">Public members are configured by the consumer of the activity, whereas `private` members use an implementation fixed by the author of the activity.</span></span> <span data-ttu-id="0160c-121">データのスコープの可視性に関する規則は、次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="0160c-121">The visibility rules for data scoping are as follows:</span></span>  
  
1. <span data-ttu-id="0160c-122">パブリック メンバーおよびパブリック子アクティビティのパブリック メンバーは、パブリック変数を参照できます。</span><span class="sxs-lookup"><span data-stu-id="0160c-122">Public members and the public members of public child activities can reference public variables.</span></span>  
  
2. <span data-ttu-id="0160c-123">プライベート メンバーおよびパブリック子アクティビティのパブリック メンバーは引数およびプライベート変数を参照できます。</span><span class="sxs-lookup"><span data-stu-id="0160c-123">Private members and the public members of public child activities can reference arguments and private variables.</span></span>  
  
 <span data-ttu-id="0160c-124">アクティビティのコンシューマーが設定可能なメンバーは、プライベートに指定できません。</span><span class="sxs-lookup"><span data-stu-id="0160c-124">A member that can be set by the consumer of an activity should never be made private.</span></span>  
  
### <a name="authoring-models"></a><span data-ttu-id="0160c-125">作成モデル</span><span class="sxs-lookup"><span data-stu-id="0160c-125">Authoring Models</span></span>  

 <span data-ttu-id="0160c-126">カスタム アクティビティは、<xref:System.Activities.NativeActivity>、<xref:System.Activities.Activity>、<xref:System.Activities.CodeActivity>、または <xref:System.Activities.AsyncCodeActivity> を使用して定義されます。</span><span class="sxs-lookup"><span data-stu-id="0160c-126">Custom activities are defined by using <xref:System.Activities.NativeActivity>, <xref:System.Activities.Activity>, <xref:System.Activities.CodeActivity>, or <xref:System.Activities.AsyncCodeActivity>.</span></span> <span data-ttu-id="0160c-127">これらのクラスから派生するアクティビティによって、可視性が異なるさまざまなメンバー型が公開されます。</span><span class="sxs-lookup"><span data-stu-id="0160c-127">Activities that derive from these classes can expose different member types with different visibilities.</span></span>  
  
#### <a name="nativeactivity"></a><span data-ttu-id="0160c-128">NativeActivity</span><span class="sxs-lookup"><span data-stu-id="0160c-128">NativeActivity</span></span>  

 <span data-ttu-id="0160c-129"><xref:System.Activities.NativeActivity> から派生したアクティビティの動作は、命令型コードで記述され、任意で既存のアクティビティを使用して定義できます。</span><span class="sxs-lookup"><span data-stu-id="0160c-129">Activities that derive from <xref:System.Activities.NativeActivity> have behavior that is written in imperative code, and can optionally be defined by using existing activities.</span></span> <span data-ttu-id="0160c-130"><xref:System.Activities.NativeActivity> からアクティビティを派生させると、ランタイムによって公開されるすべての機能にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="0160c-130">Deriving activities from <xref:System.Activities.NativeActivity> grants access to all of the features exposed by the runtime.</span></span> <span data-ttu-id="0160c-131">このようなアクティビティのメンバーは、引数を除く `public` としてのみ宣言可能なパブリックまたはプライベートの可視性を使用して定義できます。</span><span class="sxs-lookup"><span data-stu-id="0160c-131">Any member of such an activity can be defined by using either public or private visibility, except arguments, which can only be declared as `public`.</span></span>  
  
 <span data-ttu-id="0160c-132"><xref:System.Activities.NativeActivity> から派生したクラスのメンバーは、<xref:System.Activities.NativeActivityMetadata> メソッドに渡される <xref:System.Activities.NativeActivity.CacheMetadata%2A> 構造体を使用してランタイムに宣言されます。</span><span class="sxs-lookup"><span data-stu-id="0160c-132">Members of classes derived from <xref:System.Activities.NativeActivity> are declared to the runtime using the <xref:System.Activities.NativeActivityMetadata> struct passed to the <xref:System.Activities.NativeActivity.CacheMetadata%2A> method.</span></span>  
  
#### <a name="activity"></a><span data-ttu-id="0160c-133">アクティビティ</span><span class="sxs-lookup"><span data-stu-id="0160c-133">Activity</span></span>  

 <span data-ttu-id="0160c-134"><xref:System.Activities.Activity> を使用して作成されたアクティビティの動作は、他のアクティビティが作成されることで厳密にデザインされます。</span><span class="sxs-lookup"><span data-stu-id="0160c-134">Activities created by using <xref:System.Activities.Activity> have behavior that is designed strictly through composing other activities.</span></span> <span data-ttu-id="0160c-135"><xref:System.Activities.Activity> クラスの 1 つの実装子アクティビティは、<xref:System.Activities.Activity.Implementation%2A> を使用するランタイムによって取得されます。</span><span class="sxs-lookup"><span data-stu-id="0160c-135">The <xref:System.Activities.Activity> class has one implementation child activity, obtained by the runtime using <xref:System.Activities.Activity.Implementation%2A>.</span></span> <span data-ttu-id="0160c-136"><xref:System.Activities.Activity> から派生するアクティビティは、パブリック引数、パブリック変数、インポートされた ActivityDelegates、およびインポートされた Activities を定義します。</span><span class="sxs-lookup"><span data-stu-id="0160c-136">An activity deriving from <xref:System.Activities.Activity> can define public arguments, public variables, imported ActivityDelegates, and imported Activities.</span></span>  
  
 <span data-ttu-id="0160c-137">インポートされた ActivityDelegates および Activities は、パブリックのアクティビティの子として宣言されますが、アクティビティによって直接はスケジュールされません。</span><span class="sxs-lookup"><span data-stu-id="0160c-137">Imported ActivityDelegates and Activities are declared as public children of the activity, but cannot be directly scheduled by the activity.</span></span> <span data-ttu-id="0160c-138">この情報は検証時に使用され、アクティビティが実行されないロケーションで複数の親が同時に検証されるのを防ぎます。</span><span class="sxs-lookup"><span data-stu-id="0160c-138">This information is used during validation to avoid running parent-facing validations at locations where the activity will never execute.</span></span> <span data-ttu-id="0160c-139">また、パブリック子と同様に、インポートされた子は、アクティビティの実装時に参照およびスケジュールされます。</span><span class="sxs-lookup"><span data-stu-id="0160c-139">Also, imported children, just like public children, can be referenced and scheduled by the activity’s implementation.</span></span> <span data-ttu-id="0160c-140">つまり、Activity1 と呼ばれるアクティビティをインポートするアクティビティには、Activity1 をスケジュールする実装の <xref:System.Activities.Statements.Sequence> が含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="0160c-140">This means that an activity which imports an activity called Activity1 can contain a <xref:System.Activities.Statements.Sequence> in its implementation which schedules Activity1.</span></span>  
  
#### <a name="codeactivity-asynccodeactivity"></a><span data-ttu-id="0160c-141">CodeActivity/ AsyncCodeActivity</span><span class="sxs-lookup"><span data-stu-id="0160c-141">CodeActivity/ AsyncCodeActivity</span></span>  

 <span data-ttu-id="0160c-142">この基本クラスは、命令型コードの動作の定義に使用されます。</span><span class="sxs-lookup"><span data-stu-id="0160c-142">This base class is used for authoring behavior in imperative code.</span></span> <span data-ttu-id="0160c-143">このクラスから派生したアクティビティだけが、このアクティビティよって公開された引数にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="0160c-143">Activities that derive from this class only have access to the arguments they expose.</span></span> <span data-ttu-id="0160c-144">つまり、これらのアクティビティによって公開されるメンバーのみがパブリック引数になります。</span><span class="sxs-lookup"><span data-stu-id="0160c-144">This means that the only members that these activities can expose are public arguments.</span></span> <span data-ttu-id="0160c-145">他のメンバーおよび可視性はこれらのアクティビティに適用されません。</span><span class="sxs-lookup"><span data-stu-id="0160c-145">No other members or visibilities apply to these activities.</span></span>  
  
#### <a name="summary-of-visibilities"></a><span data-ttu-id="0160c-146">可視性の概要</span><span class="sxs-lookup"><span data-stu-id="0160c-146">Summary of visibilities</span></span>  

 <span data-ttu-id="0160c-147">このセクションの前半の情報の概要を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="0160c-147">The following table summarizes the information earlier in this section.</span></span>  
  
|<span data-ttu-id="0160c-148">メンバーの型</span><span class="sxs-lookup"><span data-stu-id="0160c-148">Member Type</span></span>|<span data-ttu-id="0160c-149">NativeActivity</span><span class="sxs-lookup"><span data-stu-id="0160c-149">NativeActivity</span></span>|<span data-ttu-id="0160c-150">アクティビティ</span><span class="sxs-lookup"><span data-stu-id="0160c-150">Activity</span></span>|<span data-ttu-id="0160c-151">CodeActivity/ AsyncCodeActivity</span><span class="sxs-lookup"><span data-stu-id="0160c-151">CodeActivity/ AsyncCodeActivity</span></span>|  
|-----------------|--------------------|--------------|--------------------------------------|  
|<span data-ttu-id="0160c-152">引数</span><span class="sxs-lookup"><span data-stu-id="0160c-152">Arguments</span></span>|<span data-ttu-id="0160c-153">パブリック/プライベート</span><span class="sxs-lookup"><span data-stu-id="0160c-153">Public/ Private</span></span>|<span data-ttu-id="0160c-154">パブリック</span><span class="sxs-lookup"><span data-stu-id="0160c-154">Public</span></span>|<span data-ttu-id="0160c-155">適用外</span><span class="sxs-lookup"><span data-stu-id="0160c-155">not applicable</span></span>|  
|<span data-ttu-id="0160c-156">変数</span><span class="sxs-lookup"><span data-stu-id="0160c-156">Variables</span></span>|<span data-ttu-id="0160c-157">パブリック/プライベート</span><span class="sxs-lookup"><span data-stu-id="0160c-157">Public/ Private</span></span>|<span data-ttu-id="0160c-158">パブリック</span><span class="sxs-lookup"><span data-stu-id="0160c-158">Public</span></span>|<span data-ttu-id="0160c-159">適用外</span><span class="sxs-lookup"><span data-stu-id="0160c-159">not applicable</span></span>|  
|<span data-ttu-id="0160c-160">Child Activities</span><span class="sxs-lookup"><span data-stu-id="0160c-160">Child Activities</span></span>|<span data-ttu-id="0160c-161">パブリック/プライベート</span><span class="sxs-lookup"><span data-stu-id="0160c-161">Public/ Private</span></span>|<span data-ttu-id="0160c-162">パブリック (実装時に定義された修正済みのプライベート子)</span><span class="sxs-lookup"><span data-stu-id="0160c-162">Public, one fixed private child defined in Implementation.</span></span>|<span data-ttu-id="0160c-163">適用外</span><span class="sxs-lookup"><span data-stu-id="0160c-163">not applicable</span></span>|  
|<span data-ttu-id="0160c-164">ActivityDelegates</span><span class="sxs-lookup"><span data-stu-id="0160c-164">ActivityDelegates</span></span>|<span data-ttu-id="0160c-165">パブリック/プライベート</span><span class="sxs-lookup"><span data-stu-id="0160c-165">Public/ Private</span></span>|<span data-ttu-id="0160c-166">パブリック</span><span class="sxs-lookup"><span data-stu-id="0160c-166">Public</span></span>|<span data-ttu-id="0160c-167">適用外</span><span class="sxs-lookup"><span data-stu-id="0160c-167">not applicable</span></span>|  
  
 <span data-ttu-id="0160c-168">通常、アクティビティのコンシューマーが設定不可能なメンバーは、パブリックに指定できません。</span><span class="sxs-lookup"><span data-stu-id="0160c-168">In general, a member that cannot be set by the consumer of an activity should not be made public.</span></span>  
  
### <a name="execution-properties"></a><span data-ttu-id="0160c-169">実行プロパティ</span><span class="sxs-lookup"><span data-stu-id="0160c-169">Execution Properties</span></span>  

 <span data-ttu-id="0160c-170">状況によっては、特定の実行プロパティのスコープをアクティビティのパブリック子に限定すると便利な場合があります。</span><span class="sxs-lookup"><span data-stu-id="0160c-170">In some scenarios, it is useful to scope a particular execution property to the public children of an activity.</span></span> <span data-ttu-id="0160c-171"><xref:System.Activities.ExecutionProperties> コレクションによって、<xref:System.Activities.ExecutionProperties.Add%2A> メソッドでこれを実行できます。</span><span class="sxs-lookup"><span data-stu-id="0160c-171">The <xref:System.Activities.ExecutionProperties> collection provides this capability with the <xref:System.Activities.ExecutionProperties.Add%2A> method.</span></span> <span data-ttu-id="0160c-172">このメソッドの Boolean 型パラメーターは、特定のプロパティのスコープがすべての子に限定されているか、パブリックである子にのみ限定されているかを示します。</span><span class="sxs-lookup"><span data-stu-id="0160c-172">This method has a Boolean parameter indicating whether a particular property is scoped to all children, or just those that are public.</span></span> <span data-ttu-id="0160c-173">このパラメーターが `true` に設定されている場合、プロパティはパブリック メンバーおよびパブリック子のパブリック メンバーに可視性が限定されます。</span><span class="sxs-lookup"><span data-stu-id="0160c-173">If this parameter is set to `true`, the property will only be visible to public members and the public members of their public children.</span></span>  
  
### <a name="secondary-roots"></a><span data-ttu-id="0160c-174">セカンダリ ルート</span><span class="sxs-lookup"><span data-stu-id="0160c-174">Secondary Roots</span></span>  

 <span data-ttu-id="0160c-175">セカンダリ ルートは、補正アクティビティの状態を管理するためのランタイムの内部の機構です。</span><span class="sxs-lookup"><span data-stu-id="0160c-175">A secondary root is the runtime’s internal mechanism for managing state for compensation activities.</span></span> <span data-ttu-id="0160c-176"><xref:System.Activities.Statements.CompensableActivity> の実行が終了しても、その状態はすぐにクリーン アップされません。</span><span class="sxs-lookup"><span data-stu-id="0160c-176">When a <xref:System.Activities.Statements.CompensableActivity> has finished running, its state is not cleaned up immediately.</span></span> <span data-ttu-id="0160c-177">代わりに、補正が完了するまで、セカンダリ ルートのランタイムによってこの状態が維持されます。</span><span class="sxs-lookup"><span data-stu-id="0160c-177">Instead, the state is maintained by the runtime in a secondary root until the compensation episode has completed.</span></span> <span data-ttu-id="0160c-178">セカンダリ ルートによってキャプチャされた配置環境は、補正可能なアクティビティが使用される定義のスコープに対応します。</span><span class="sxs-lookup"><span data-stu-id="0160c-178">The location environments captured with the secondary root correspond to the scope of definition in which the Compensable activity is used.</span></span>
