---
title: WorkflowInvoker と WorkflowApplication の使用
description: この記事では、Windows Workflow Foundation で WorkflowInvoker 元と WorkflowApplication を使用したワークフローホスティングについて説明します。
ms.date: 03/30/2017
ms.assetid: cd0e583c-a3f9-4fa2-b247-c7b3368c48a7
ms.openlocfilehash: 1cc84afe002615c317309054179abd1af5800e9c
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/26/2020
ms.locfileid: "96254611"
---
# <a name="using-workflowinvoker-and-workflowapplication"></a><span data-ttu-id="e86e2-103">WorkflowInvoker と WorkflowApplication の使用</span><span class="sxs-lookup"><span data-stu-id="e86e2-103">Using WorkflowInvoker and WorkflowApplication</span></span>

<span data-ttu-id="e86e2-104">Windows Workflow Foundation (WF) では、ワークフローをホストする方法がいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="e86e2-104">Windows Workflow Foundation (WF) provides several methods of hosting workflows.</span></span> <span data-ttu-id="e86e2-105"><xref:System.Activities.WorkflowInvoker> は、メソッド呼び出しのようにワークフローを呼び出す簡単な方法を提供し、永続化を使用しないワークフローのみに使用できます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-105"><xref:System.Activities.WorkflowInvoker> provides a simple way for invoking a workflow as if it were a method call and can be used only for workflows that do not use persistence.</span></span> <span data-ttu-id="e86e2-106"><xref:System.Activities.WorkflowApplication> は、ライフサイクル イベントの通知、実行制御、ブックマークの再開、および永続化を含むワークフローを実行するための豊富なモデルを提供します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-106"><xref:System.Activities.WorkflowApplication> provides a richer model for executing workflows that includes notification of lifecycle events, execution control, bookmark resumption, and persistence.</span></span> <span data-ttu-id="e86e2-107"><xref:System.ServiceModel.Activities.WorkflowServiceHost> は、メッセージング アクティビティをサポートし、主にワーク フロー サービスと一緒に使用されます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-107"><xref:System.ServiceModel.Activities.WorkflowServiceHost> provides support for messaging activities and is primarily used with workflow services.</span></span> <span data-ttu-id="e86e2-108">このトピックでは、<xref:System.Activities.WorkflowInvoker> と <xref:System.Activities.WorkflowApplication> を使用したワークフロー ホスティングついて説明します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-108">This topic introduces you to workflow hosting with <xref:System.Activities.WorkflowInvoker> and <xref:System.Activities.WorkflowApplication>.</span></span> <span data-ttu-id="e86e2-109">を使用したワークフローのホストの詳細につい <xref:System.ServiceModel.Activities.WorkflowServiceHost> ては、「 [ワークフローサービス](../wcf/feature-details/workflow-services.md) と [ホストワークフローサービスの概要](../wcf/feature-details/hosting-workflow-services-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e86e2-109">For more information about hosting workflows with <xref:System.ServiceModel.Activities.WorkflowServiceHost>, see [Workflow Services](../wcf/feature-details/workflow-services.md) and [Hosting Workflow Services Overview](../wcf/feature-details/hosting-workflow-services-overview.md).</span></span>  
  
## <a name="using-workflowinvoker"></a><span data-ttu-id="e86e2-110">WorkflowInvoker の使用</span><span class="sxs-lookup"><span data-stu-id="e86e2-110">Using WorkflowInvoker</span></span>  

 <span data-ttu-id="e86e2-111"><xref:System.Activities.WorkflowInvoker> は、メソッドを呼び出すようにワークフローを実行するモデルを提供します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-111"><xref:System.Activities.WorkflowInvoker> provides a model for executing a workflow as if it were a method call.</span></span> <span data-ttu-id="e86e2-112"><xref:System.Activities.WorkflowInvoker> を使用してワークフローを呼び出すには、<xref:System.Activities.WorkflowInvoker.Invoke%2A> メソッドを呼び出し、呼び出すワークフローのワークフロー定義を渡します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-112">To invoke a workflow using <xref:System.Activities.WorkflowInvoker>, call the <xref:System.Activities.WorkflowInvoker.Invoke%2A> method and pass in the workflow definition of the workflow to invoke.</span></span> <span data-ttu-id="e86e2-113">次の例では、<xref:System.Activities.Statements.WriteLine> を使用して <xref:System.Activities.WorkflowInvoker> アクティビティを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-113">In this example, a <xref:System.Activities.Statements.WriteLine> activity is invoked using <xref:System.Activities.WorkflowInvoker>.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#1](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#1)]  
  
 <span data-ttu-id="e86e2-114"><xref:System.Activities.WorkflowInvoker> を使用してワークフローを呼び出すと、呼び出し元のスレッドでワークフローが実行され、ワークフローが完了するまで (アイドル時間を含む) <xref:System.Activities.WorkflowInvoker.Invoke%2A> メソッドがブロックされます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-114">When a workflow is invoked using <xref:System.Activities.WorkflowInvoker>, the workflow executes on the calling thread and the <xref:System.Activities.WorkflowInvoker.Invoke%2A> method blocks until the workflow is complete, including any idle time.</span></span> <span data-ttu-id="e86e2-115">ワークフローを完了しなければならないタイムアウト期間を構成するには、<xref:System.Activities.WorkflowInvoker.Invoke%2A> パラメーターを受け取る <xref:System.TimeSpan> オーバーロードのいずれかを使用します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-115">To configure a time-out interval in which the workflow must complete, use one of the <xref:System.Activities.WorkflowInvoker.Invoke%2A> overloads that takes a <xref:System.TimeSpan> parameter.</span></span> <span data-ttu-id="e86e2-116">この例では、2 つの異なるタイムアウト期間を使用してワークフローを 2 回呼び出します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-116">In this example, a workflow is invoked twice with two different time-out intervals.</span></span> <span data-ttu-id="e86e2-117">最初のワークフローは完了しますが、2 回目は完了しません。</span><span class="sxs-lookup"><span data-stu-id="e86e2-117">The first workflow complets, but the second does not.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#50](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#50)]  
  
> [!NOTE]
> <span data-ttu-id="e86e2-118"><xref:System.TimeoutException> がスローされるのは、タイムアウト期間が経過してワークフローが実行中にアイドル状態になった場合だけです。</span><span class="sxs-lookup"><span data-stu-id="e86e2-118">The <xref:System.TimeoutException> is only thrown if the time-out interval elapses and the workflow becomes idle during execution.</span></span> <span data-ttu-id="e86e2-119">指定されたタイムアウト時間内には完了しないワークフローが正常に完了するのは、アイドル状態にならない場合です。</span><span class="sxs-lookup"><span data-stu-id="e86e2-119">A workflow that takes longer than the specified time-out interval to complete completes successfully if the workflow does not become idle.</span></span>  
  
 <span data-ttu-id="e86e2-120"><xref:System.Activities.WorkflowInvoker> も非同期バージョンのメソッド呼び出しを提供します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-120"><xref:System.Activities.WorkflowInvoker> also provides asynchronous versions of the invoke method.</span></span> <span data-ttu-id="e86e2-121">詳細については、次のトピックを参照してください。 <xref:System.Activities.WorkflowInvoker.InvokeAsync%2A> および <xref:System.Activities.WorkflowInvoker.BeginInvoke%2A></span><span class="sxs-lookup"><span data-stu-id="e86e2-121">For more information, see <xref:System.Activities.WorkflowInvoker.InvokeAsync%2A> and <xref:System.Activities.WorkflowInvoker.BeginInvoke%2A>.</span></span>  
  
### <a name="setting-input-arguments-of-a-workflow"></a><span data-ttu-id="e86e2-122">ワークフローの入力引数の設定</span><span class="sxs-lookup"><span data-stu-id="e86e2-122">Setting Input Arguments of a Workflow</span></span>  

 <span data-ttu-id="e86e2-123">ワークフローの入力引数にマップされ、引数名によってキー指定されている入力パラメーターの辞書を使用して、データをワークフローに渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-123">Data can be passed into a workflow using a dictionary of input parameters, keyed by argument name, that map to the input arguments of the workflow.</span></span> <span data-ttu-id="e86e2-124">次の例では、<xref:System.Activities.Statements.WriteLine> が呼び出され、その <xref:System.Activities.Statements.WriteLine.Text%2A> 引数の値は入力パラメーターの辞書を使用して指定されています。</span><span class="sxs-lookup"><span data-stu-id="e86e2-124">In this example, a <xref:System.Activities.Statements.WriteLine> is invoked and the value for its <xref:System.Activities.Statements.WriteLine.Text%2A> argument is specified using the dictionary of input parameters.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#3](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#3)]  
  
### <a name="retrieving-output-arguments-of-a-workflow"></a><span data-ttu-id="e86e2-125">ワークフローの出力引数の取得</span><span class="sxs-lookup"><span data-stu-id="e86e2-125">Retrieving Output Arguments of a Workflow</span></span>  

 <span data-ttu-id="e86e2-126">ワークフローの出力パラメーターは、<xref:System.Activities.WorkflowInvoker.Invoke%2A> の呼び出しから返される出力辞書を使用して取得できます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-126">The output parameters of a workflow can be obtained using the outputs dictionary that is returned from the call to <xref:System.Activities.WorkflowInvoker.Invoke%2A>.</span></span> <span data-ttu-id="e86e2-127">次の例は、2 つの入力引数と 2 つの出力引数を持つ 1 つの `Divide` アクティビティで構成されるワークフローを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-127">The following example invokes a workflow consisting of a single `Divide` activity that has two input arguments and two output arguments.</span></span> <span data-ttu-id="e86e2-128">ワークフローを呼び出すと、`arguments` 辞書が渡されます。ここには引数名でキー指定された各入力引数の値が含まれています。</span><span class="sxs-lookup"><span data-stu-id="e86e2-128">When the workflow is invoked, the `arguments` dictionary is passed which contains the values for each input argument, keyed by argument name.</span></span> <span data-ttu-id="e86e2-129">`Invoke` の呼び出しから制御が戻るときに、同様に引数名でキー指定された各出力引数が、`outputs` 辞書で返されます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-129">When the call to `Invoke` returns, each output argument is returned in the `outputs` dictionary, also keyed by argument name.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#120](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#120)]  
  
 [!code-csharp[CFX_WorkflowInvokerExample#20](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#20)]  
  
 <span data-ttu-id="e86e2-130">ワークフローが `CodeActivity<TResult>` や `Activity<TResult>` などの <xref:System.Activities.ActivityWithResult> から派生し、適切に定義された <xref:System.Activities.Activity%601.Result%2A> 出力引数以外にも出力引数がある場合は、`Invoke` の非ジェネリック オーバーロードを使用して、追加の引数を取得する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e86e2-130">If the workflow derives from <xref:System.Activities.ActivityWithResult>, such as `CodeActivity<TResult>` or `Activity<TResult>`, and there are output arguments in addition to the well-defined <xref:System.Activities.Activity%601.Result%2A> output argument, a non-generic overload of `Invoke` must be used in order to retrieve the additional arguments.</span></span> <span data-ttu-id="e86e2-131">これを行うには、`Invoke` に渡されるワークフロー定義は <xref:System.Activities.Activity> 型である必要があります。</span><span class="sxs-lookup"><span data-stu-id="e86e2-131">To do this, the workflow definition passed into `Invoke` must be of type <xref:System.Activities.Activity>.</span></span> <span data-ttu-id="e86e2-132">この例では、`Divide` アクティビティは `CodeActivity<int>` から派生していますが、<xref:System.Activities.Activity> として宣言されているため、1 つの戻り値ではなく引数の辞書を返す、`Invoke` の非ジェネリック オーバーロードが使用されます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-132">In this example the `Divide` activity derives from `CodeActivity<int>`, but is declared as <xref:System.Activities.Activity> so that a non-generic overload of `Invoke` is used which returns a dictionary of arguments instead of a single return value.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#121](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#121)]  
  
 [!code-csharp[CFX_WorkflowInvokerExample#21](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#21)]  
  
## <a name="using-workflowapplication"></a><span data-ttu-id="e86e2-133">WorkflowApplication の使用</span><span class="sxs-lookup"><span data-stu-id="e86e2-133">Using WorkflowApplication</span></span>  

 <span data-ttu-id="e86e2-134"><xref:System.Activities.WorkflowApplication> は、ワークフロー インスタンス管理を実現する豊富な機能を備えています。</span><span class="sxs-lookup"><span data-stu-id="e86e2-134"><xref:System.Activities.WorkflowApplication> provides a rich set of features for workflow instance management.</span></span> <span data-ttu-id="e86e2-135"><xref:System.Activities.WorkflowApplication> は実際の <xref:System.Activities.Hosting.WorkflowInstance> に対してスレッド セーフなプロキシとして動作し、ランタイムをカプセル化します。また、ワークフロー インスタンスの作成と読み込み、ライフサイクル イベントの一時停止と再開、終了、および通知を行うメソッドを提供します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-135"><xref:System.Activities.WorkflowApplication> acts as a thread safe proxy to the actual  <xref:System.Activities.Hosting.WorkflowInstance>, which encapsulates the runtime, and provides methods for creating and loading workflow instances, pausing and resuming, terminating, and notification of lifecycle events.</span></span> <span data-ttu-id="e86e2-136"><xref:System.Activities.WorkflowApplication> を使用してワークフローを実行するには、<xref:System.Activities.WorkflowApplication> を作成して必要なライフサイクル イベントに定期受信し、ワークフローを開始して、それが終了するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-136">To run a workflow using <xref:System.Activities.WorkflowApplication> you create the <xref:System.Activities.WorkflowApplication>, subscribe to any desired lifecycle events, start the workflow, and then wait for it to finish.</span></span> <span data-ttu-id="e86e2-137">この例では、<xref:System.Activities.Statements.WriteLine> アクティビティから成るワークフロー定義が作成され、そのワークフロー定義を使用して <xref:System.Activities.WorkflowApplication> が作成されます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-137">In this example, a workflow definition that consists of a <xref:System.Activities.Statements.WriteLine> activity is created and a <xref:System.Activities.WorkflowApplication> is created using the specified workflow definition.</span></span> <span data-ttu-id="e86e2-138">ワーク フローが完了したときにホストに通知されるように <xref:System.Activities.WorkflowApplication.Completed%2A> が処理され、<xref:System.Activities.WorkflowApplication.Run%2A> の呼び出しによってワーク フローが開始され、ホストはワークフローが完了するのを待ちます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-138"><xref:System.Activities.WorkflowApplication.Completed%2A> is handled so the host is notified when the workflow completes, the workflow is started with a call to <xref:System.Activities.WorkflowApplication.Run%2A>, and then the host waits for the workflow to complete.</span></span> <span data-ttu-id="e86e2-139">次の例に示すように、ワークフローが完了すると <xref:System.Threading.AutoResetEvent> が設定され、ホスト アプリケーションは実行を再開できます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-139">When the workflow completes, the <xref:System.Threading.AutoResetEvent> is set and the host application can resume execution, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#31](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#31)]  
  
### <a name="workflowapplication-lifecycle-events"></a><span data-ttu-id="e86e2-140">WorkflowApplication のライフサイクル イベント</span><span class="sxs-lookup"><span data-stu-id="e86e2-140">WorkflowApplication Lifecycle Events</span></span>  

 <span data-ttu-id="e86e2-141"><xref:System.Activities.WorkflowApplication.Completed%2A> の他にも、ワークフローがアンロードされたとき (<xref:System.Activities.WorkflowApplication.Unloaded%2A>)、中止されたとき (<xref:System.Activities.WorkflowApplication.Aborted%2A>)、アイドル状態になったとき (<xref:System.Activities.WorkflowApplication.Idle%2A> および <xref:System.Activities.WorkflowApplication.PersistableIdle%2A>)、または未処理の例外が発生したとき (<xref:System.Activities.WorkflowApplication.OnUnhandledException%2A>) にホストの作成者に通知されます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-141">In addition to <xref:System.Activities.WorkflowApplication.Completed%2A>, host authors can be notified when a workflow is unloaded (<xref:System.Activities.WorkflowApplication.Unloaded%2A>), aborted (<xref:System.Activities.WorkflowApplication.Aborted%2A>), becomes idle (<xref:System.Activities.WorkflowApplication.Idle%2A> and <xref:System.Activities.WorkflowApplication.PersistableIdle%2A>), or an unhandled exception occurs (<xref:System.Activities.WorkflowApplication.OnUnhandledException%2A>).</span></span> <span data-ttu-id="e86e2-142">次の例に示すように、ワークフロー アプリケーションの開発者はこれらの通知を処理して適切なアクションを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-142">Workflow application developers can handle these notifications and take appropriate action, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#32](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#32)]  
  
### <a name="setting-input-arguments-of-a-workflow"></a><span data-ttu-id="e86e2-143">ワークフローの入力引数の設定</span><span class="sxs-lookup"><span data-stu-id="e86e2-143">Setting Input Arguments of a Workflow</span></span>  

 <span data-ttu-id="e86e2-144"><xref:System.Activities.WorkflowInvoker> を使用しているときにデータを渡す方法と同様に、起動時にパラメーターの辞書を使用してデータをワークフローに渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-144">Data can be passed into a workflow as it is started using a dictionary of parameters, similar to the way data is passed in when using <xref:System.Activities.WorkflowInvoker>.</span></span> <span data-ttu-id="e86e2-145">辞書の各項目は、指定されたワークフローの入力引数にマップされます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-145">Each item in the dictionary maps to an input argument of the specified workflow.</span></span> <span data-ttu-id="e86e2-146">次の例では、<xref:System.Activities.Statements.WriteLine> アクティビティから成るワークフローが呼び出され、その <xref:System.Activities.Statements.WriteLine.Text%2A> 引数が入力パラメーターの辞書を使用して指定されます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-146">In this example, a workflow that consists of a <xref:System.Activities.Statements.WriteLine> activity is invoked and its <xref:System.Activities.Statements.WriteLine.Text%2A> argument is specified using the dictionary of input parameters.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#30](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#30)]  
  
### <a name="retrieving-output-arguments-of-a-workflow"></a><span data-ttu-id="e86e2-147">ワークフローの出力引数の取得</span><span class="sxs-lookup"><span data-stu-id="e86e2-147">Retrieving Output Arguments of a Workflow</span></span>  

 <span data-ttu-id="e86e2-148">ワークフローが完了したら、<xref:System.Activities.WorkflowApplicationCompletedEventArgs.Outputs%2A?displayProperty=nameWithType> 辞書にアクセスして、<xref:System.Activities.WorkflowApplication.Completed%2A> ハンドラーの出力引数を取得できます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-148">When a workflow completes, any output arguments can be retrieved in the <xref:System.Activities.WorkflowApplication.Completed%2A> handler by accessing the <xref:System.Activities.WorkflowApplicationCompletedEventArgs.Outputs%2A?displayProperty=nameWithType> dictionary.</span></span> <span data-ttu-id="e86e2-149">次の例では、<xref:System.Activities.WorkflowApplication> を使用してワークフローをホストしています。</span><span class="sxs-lookup"><span data-stu-id="e86e2-149">The following example hosts a workflow using <xref:System.Activities.WorkflowApplication>.</span></span> <span data-ttu-id="e86e2-150"><xref:System.Activities.WorkflowApplication>1 つのアクティビティで構成されるワークフロー定義を使用して、インスタンスが構築され `DiceRoll` ます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-150">A <xref:System.Activities.WorkflowApplication> instance is constructed using a workflow definition consisting of a single `DiceRoll` activity.</span></span> <span data-ttu-id="e86e2-151">`DiceRoll` アクティビティには、サイコロ振り操作の結果を表す 2 つの出力引数があります。</span><span class="sxs-lookup"><span data-stu-id="e86e2-151">The `DiceRoll` activity has two output arguments that represent the results of the dice roll operation.</span></span> <span data-ttu-id="e86e2-152">ワークフローが完了すると、この出力が <xref:System.Activities.WorkflowApplication.Completed%2A> ハンドラーで取得されます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-152">When the workflow completes, the outputs are retrieved in the <xref:System.Activities.WorkflowApplication.Completed%2A> handler.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#130](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#130)]  
  
 [!code-csharp[CFX_WorkflowApplicationExample#21](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#21)]  
  
> [!NOTE]
> <span data-ttu-id="e86e2-153"><xref:System.Activities.WorkflowApplication> と <xref:System.Activities.WorkflowInvoker> は入力引数の辞書を取得し、`out` 引数の辞書を返します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-153"><xref:System.Activities.WorkflowApplication> and <xref:System.Activities.WorkflowInvoker> take a dictionary of input arguments and return a dictionary of `out` arguments.</span></span> <span data-ttu-id="e86e2-154">これらの辞書のパラメーター、プロパティ、および戻り値は `IDictionary<string, object>` 型です。</span><span class="sxs-lookup"><span data-stu-id="e86e2-154">These dictionary parameters, properties, and return values are of type `IDictionary<string, object>`.</span></span> <span data-ttu-id="e86e2-155">渡される辞書クラスの実際のインスタンスには、`IDictionary<string, object>` を実装した任意のクラスを使用できます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-155">The actual instance of the dictionary class that is passed in can be any class that implements `IDictionary<string, object>`.</span></span> <span data-ttu-id="e86e2-156">これらの例では、`Dictionary<string, object>` が使用されています。</span><span class="sxs-lookup"><span data-stu-id="e86e2-156">In these examples, `Dictionary<string, object>` is used.</span></span> <span data-ttu-id="e86e2-157">ディクショナリの詳細については、「」および「」を参照してください <xref:System.Collections.Generic.IDictionary%602> <xref:System.Collections.Generic.Dictionary%602> 。</span><span class="sxs-lookup"><span data-stu-id="e86e2-157">For more information about dictionaries, see <xref:System.Collections.Generic.IDictionary%602> and <xref:System.Collections.Generic.Dictionary%602>.</span></span>  
  
### <a name="passing-data-into-a-running-workflow-using-bookmarks"></a><span data-ttu-id="e86e2-158">ブックマークを使用した実行中のワークフローへのデータの受け渡し</span><span class="sxs-lookup"><span data-stu-id="e86e2-158">Passing Data into a Running Workflow Using Bookmarks</span></span>  

 <span data-ttu-id="e86e2-159">ブックマークは、アクティビティが再開されるのを受動的に待機するメカニズムです。また、実行中のワークフロー インスタンスにデータを渡すメカニズムでもあります。</span><span class="sxs-lookup"><span data-stu-id="e86e2-159">Bookmarks are the mechanism by which an activity can passively wait to be resumed and are a mechanism for passing data into a running workflow instance.</span></span> <span data-ttu-id="e86e2-160">次の例に示すように、アクティビティがデータを待機している場合、<xref:System.Activities.Bookmark> を作成し、<xref:System.Activities.Bookmark> が再開されたときに呼び出されるコールバック メソッドを登録します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-160">If an activity is waiting for data, it can create a <xref:System.Activities.Bookmark> and register a callback method to be called when the <xref:System.Activities.Bookmark> is resumed, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#15](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#15)]  
  
 <span data-ttu-id="e86e2-161">実行されると、`ReadLine` アクティビティは <xref:System.Activities.Bookmark> を作成し、コールバックを登録してから、<xref:System.Activities.Bookmark> が再開されるのを待機します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-161">When executed, the `ReadLine` activity creates a <xref:System.Activities.Bookmark>, registers a callback, and then waits for the <xref:System.Activities.Bookmark> to be resumed.</span></span> <span data-ttu-id="e86e2-162">再開されると、`ReadLine` アクティビティは <xref:System.Activities.Bookmark> と一緒に渡されたデータを <xref:System.Activities.Activity%601.Result%2A> 引数に代入します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-162">When it is resumed, the `ReadLine` activity assigns the data that was passed with the <xref:System.Activities.Bookmark> to its <xref:System.Activities.Activity%601.Result%2A> argument.</span></span> <span data-ttu-id="e86e2-163">次の例では、`ReadLine` アクティビティを使用してユーザー名を収集し、それをコンソール ウィンドウに表示するワークフローを作成します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-163">In this example, a workflow is created that uses the `ReadLine` activity to gather the user’s name and display it to the console window.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#22](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#22)]  
  
 <span data-ttu-id="e86e2-164">`ReadLine` アクティビティが実行されると、<xref:System.Activities.Bookmark> という名前の `UserName` が作成され、ブックマークが再開されるのを待機します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-164">When the `ReadLine` activity is executed, it creates a <xref:System.Activities.Bookmark> named `UserName` and then waits for the bookmark to be resumed.</span></span> <span data-ttu-id="e86e2-165">ホストは必要なデータを収集し、<xref:System.Activities.Bookmark> を再開します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-165">The host collects the desired data and then resumes the <xref:System.Activities.Bookmark>.</span></span> <span data-ttu-id="e86e2-166">ワークフローが再開されると名前が表示されて、完了します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-166">The workflow resumes, displays the name, and then completes.</span></span>  
  
 <span data-ttu-id="e86e2-167">ホスト アプリケーションでは、ワークフローを調べて、アクティブなブックマークがあるかどうかを確認できます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-167">The host application can inspect the workflow to determine if there are any active bookmarks.</span></span> <span data-ttu-id="e86e2-168">この操作を実行するには、<xref:System.Activities.WorkflowApplication.GetBookmarks%2A> インスタンスの <xref:System.Activities.WorkflowApplication> メソッドを呼び出すか、<xref:System.Activities.WorkflowApplicationIdleEventArgs> ハンドラーの <xref:System.Activities.WorkflowApplication.Idle%2A> を調べます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-168">It can do this by calling the <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> method of a <xref:System.Activities.WorkflowApplication> instance, or by inspecting the <xref:System.Activities.WorkflowApplicationIdleEventArgs> in the <xref:System.Activities.WorkflowApplication.Idle%2A> handler.</span></span>  
  
 <span data-ttu-id="e86e2-169">次のコード例は前の例と似ていますが、ブックマークを再開する前にアクティブなブックマークを列挙する点が異なります。</span><span class="sxs-lookup"><span data-stu-id="e86e2-169">The following code example is like the previous example except that the active bookmarks are enumerated before the bookmark is resumed.</span></span> <span data-ttu-id="e86e2-170">ワークフローが開始され、<xref:System.Activities.Bookmark> が作成されてワークフローがアイドル状態になると、<xref:System.Activities.WorkflowApplication.GetBookmarks%2A> が呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-170">The workflow is started, and once the <xref:System.Activities.Bookmark> is created and the workflow goes idle, <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> is called.</span></span> <span data-ttu-id="e86e2-171">このワークフローが完了すると、次の出力がコンソールに表示されます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-171">When the workflow is completed, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="e86e2-172">**お名前は何ですか。**</span><span class="sxs-lookup"><span data-stu-id="e86e2-172">**What is your name?**</span></span>  
<span data-ttu-id="e86e2-173">**BookmarkName: UserName-OwnerDisplayName: ReadLine** 
**上田** 
**こんにちは、上田さん**</span><span class="sxs-lookup"><span data-stu-id="e86e2-173">**BookmarkName: UserName - OwnerDisplayName: ReadLine**
**Steve**
**Hello, Steve**</span></span>

[!code-csharp[CFX_WorkflowApplicationExample#14](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#14)]  
  
 <span data-ttu-id="e86e2-174"><xref:System.Activities.WorkflowApplicationIdleEventArgs> インスタンスの <xref:System.Activities.WorkflowApplication.Idle%2A> ハンドラーに渡される <xref:System.Activities.WorkflowApplication> を調べるコード サンプルを次に示します。</span><span class="sxs-lookup"><span data-stu-id="e86e2-174">The following code example inspects the <xref:System.Activities.WorkflowApplicationIdleEventArgs> passed into the <xref:System.Activities.WorkflowApplication.Idle%2A> handler of a <xref:System.Activities.WorkflowApplication> instance.</span></span> <span data-ttu-id="e86e2-175">この例では、アイドル状態になるワークフローに、<xref:System.Activities.Bookmark> という名前で `EnterGuess` というアクティビティによって所有されている 1 つの `ReadInt` があります。</span><span class="sxs-lookup"><span data-stu-id="e86e2-175">In this example the workflow going idle has one <xref:System.Activities.Bookmark> with a name of `EnterGuess`, owned by an activity named `ReadInt`.</span></span> <span data-ttu-id="e86e2-176">このコード例は、[はじめにチュートリアル](getting-started-tutorial.md)の一部である[ワークフローを実行する方法](how-to-run-a-workflow.md)に基づいています。</span><span class="sxs-lookup"><span data-stu-id="e86e2-176">This code example is based off of [How to: Run a Workflow](how-to-run-a-workflow.md), which is part of the [Getting Started Tutorial](getting-started-tutorial.md).</span></span> <span data-ttu-id="e86e2-177">この例のコードを含めるようにこの手順の <xref:System.Activities.WorkflowApplication.Idle%2A> ハンドラーを変更すると、次の出力が表示されます。</span><span class="sxs-lookup"><span data-stu-id="e86e2-177">If the <xref:System.Activities.WorkflowApplication.Idle%2A> handler in that step is modified to contain the code from this example, the following output is displayed.</span></span>  
  
 <span data-ttu-id="e86e2-178">**BookmarkName: EnterGuess - OwnerDisplayName: ReadInt**</span><span class="sxs-lookup"><span data-stu-id="e86e2-178">**BookmarkName: EnterGuess - OwnerDisplayName: ReadInt**</span></span>

 [!code-csharp[CFX_WorkflowApplicationExample#2](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#2)]  
  
## <a name="summary"></a><span data-ttu-id="e86e2-179">まとめ</span><span class="sxs-lookup"><span data-stu-id="e86e2-179">Summary</span></span>  

 <span data-ttu-id="e86e2-180"><xref:System.Activities.WorkflowInvoker> はワークフローを呼び出す簡単な方法を提供します。また、ワークフローの開始時にデータを渡し、完了したワークフローからデータを抽出する方法を提供しますが、<xref:System.Activities.WorkflowApplication> を使用できるような複雑なシナリオには使用できません。</span><span class="sxs-lookup"><span data-stu-id="e86e2-180"><xref:System.Activities.WorkflowInvoker> provides a lightweight way to invoke workflows, and although it provides methods for passing data in at the start of a workflow and extracting data from a completed workflow, it does not provide for more complex scenarios which is where <xref:System.Activities.WorkflowApplication> can be used.</span></span>
