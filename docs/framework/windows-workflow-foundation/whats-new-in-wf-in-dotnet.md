---
title: .NET 4.5 での Windows Workflow Foundation の新機能
description: .NET Framework 4.5 の Windows Workflow Foundation には、新しいアクティビティ、デザイナー機能、ワークフロー開発モデルなど、多くの新機能が導入されています。
ms.date: 03/30/2017
ms.assetid: 195c43a8-e0a8-43d9-aead-d65a9e6751ec
ms.openlocfilehash: 85555e48929885b6eef7fde6ac0c9017fa403d4d
ms.sourcegitcommit: 9a4488a3625866335e83a20da5e9c5286b1f034c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/15/2020
ms.locfileid: "83419461"
---
# <a name="whats-new-in-windows-workflow-foundation-in-net-45"></a><span data-ttu-id="8eeaf-103">.NET 4.5 での Windows Workflow Foundation の新機能</span><span class="sxs-lookup"><span data-stu-id="8eeaf-103">What's New in Windows Workflow Foundation in .NET 4.5</span></span>

<span data-ttu-id="8eeaf-104">.NET Framework 4.5 の Windows Workflow Foundation (WF) では、新しいアクティビティ、デザイナー機能、ワークフロー開発モデルなど、多くの新機能が導入されています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-104">Windows Workflow Foundation (WF) in .NET Framework 4.5 introduces many new features, such as new activities, designer capabilities, and workflow development models.</span></span> <span data-ttu-id="8eeaf-105">.NET Framework 4.5 で導入された新しいワークフロー機能の多くは、再ホストされたワークフローデザイナーでサポートされています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-105">Many, but not all, of the new workflow features introduced in .NET Framework 4.5 are supported in the re-hosted workflow designer.</span></span> <span data-ttu-id="8eeaf-106">サポートされる新機能の詳細については、「再ホストされた[ワークフローデザイナーでの新しい Workflow Foundation 4.5 機能のサポート](wf-features-in-the-rehosted-workflow-designer.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-106">For more information about the new features that are supported, see [Support for New Workflow Foundation 4.5 Features in the Rehosted Workflow Designer](wf-features-in-the-rehosted-workflow-designer.md).</span></span> <span data-ttu-id="8eeaf-107">.NET 3.0 と .NET 3.5 ワークフローアプリケーションを移行して最新バージョンを使用する方法の詳細については、「[移行のガイダンス](migration-guidance.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-107">For more information about migrating .NET 3.0 and .NET 3.5 workflow applications to use the latest version, see [Migration Guidance](migration-guidance.md).</span></span> <span data-ttu-id="8eeaf-108">このトピックでは、.NET Framework 4.5 で導入された新しいワークフロー機能の概要について説明します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-108">This topic provides an overview of the new workflow features introduced in .NET Framework 4.5.</span></span>

> [!WARNING]
> <span data-ttu-id="8eeaf-109">.NET Framework 4.5 で導入された新しい Windows Workflow Foundation 機能は、以前のバージョンのフレームワークを対象とするプロジェクトでは使用できません。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-109">The new Windows Workflow Foundation features introduced in .NET Framework 4.5 are not available for projects that target previous versions of the framework.</span></span> <span data-ttu-id="8eeaf-110">.NET Framework 4.5 を対象とするプロジェクトが以前のバージョンのフレームワークを再ターゲットにすると、いくつかの問題が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-110">If a project that targets .NET Framework 4.5 is re-targeted to a previous version of the framework, several issues can occur.</span></span>
>
> - <span data-ttu-id="8eeaf-111">C# の式は、デザイナーでは、 **XAML で設定されたメッセージ値**に置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-111">C# expressions will be replaced in the designer with the message **Value was set in XAML**.</span></span>
> - <span data-ttu-id="8eeaf-112">次のエラーを含む、多くのビルド エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-112">Many build errors will occur, including the following error.</span></span>
>
> <span data-ttu-id="8eeaf-113">**ファイル形式は、現在のターゲットフレームワークと互換性がありません。ファイル形式を変換するには、明示的にファイルを保存してください。このエラーメッセージは、ファイルを保存してデザイナーを再度開いた後に表示されます。**</span><span class="sxs-lookup"><span data-stu-id="8eeaf-113">**The file format is not compatible with current targeting framework. To convert the file format, please explicitly save the file. This error message will go away after you save the file and reopen the designer.**</span></span>

## <a name="workflow-versioning"></a><a name="BKMK_Versioning"></a><span data-ttu-id="8eeaf-114">ワークフローのバージョン管理</span><span class="sxs-lookup"><span data-stu-id="8eeaf-114">Workflow Versioning</span></span>

<span data-ttu-id="8eeaf-115">.NET Framework 4.5 では、新しいクラスに基づいて、いくつかの新しいバージョン管理機能が導入されました <xref:System.Activities.WorkflowIdentity> 。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-115">.NET Framework 4.5 introduced several new versioning features based around the new <xref:System.Activities.WorkflowIdentity> class.</span></span> <span data-ttu-id="8eeaf-116"><xref:System.Activities.WorkflowIdentity> には、ワークフロー アプリケーションの作成者向けに、永続化されたワークフロー インスタンスをその定義でマップするメカニズムが備わっています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-116"><xref:System.Activities.WorkflowIdentity> provides workflow application authors a mechanism for mapping a persisted workflow instance with its definition.</span></span>

- <span data-ttu-id="8eeaf-117"><xref:System.Activities.WorkflowApplication> ホスティングを使用する開発者は、<xref:System.Activities.WorkflowIdentity> を使用して、ワークフローの複数のバージョンを同時にホストできます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-117">Developers using <xref:System.Activities.WorkflowApplication> hosting can use <xref:System.Activities.WorkflowIdentity> to enable hosting multiple versions of a workflow side-by-side.</span></span> <span data-ttu-id="8eeaf-118">永続化されたワークフロー インスタンスは新しい <xref:System.Activities.WorkflowApplicationInstance> クラスを使用して読み込むことができ、ホストは <xref:System.Activities.WorkflowApplicationInstance.DefinitionIdentity%2A> を使用して、<xref:System.Activities.WorkflowApplication> のインスタンス化時に適切なバージョンのワークフロー定義を提供できます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-118">Persisted workflow instances can be loaded using the new <xref:System.Activities.WorkflowApplicationInstance> class, and then the <xref:System.Activities.WorkflowApplicationInstance.DefinitionIdentity%2A> can be used by the host to provide the correct version of the workflow definition when instantiating the <xref:System.Activities.WorkflowApplication>.</span></span> <span data-ttu-id="8eeaf-119">詳細については、「 [WorkflowIdentity とバージョン管理の使用](using-workflowidentity-and-versioning.md)」および「[方法: 複数のバージョンのワークフローをサイドバイサイドでホスト](how-to-host-multiple-versions-of-a-workflow-side-by-side.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-119">For more information, see [Using WorkflowIdentity and Versioning](using-workflowidentity-and-versioning.md) and [How to: Host Multiple Versions of a Workflow Side-by-Side](how-to-host-multiple-versions-of-a-workflow-side-by-side.md).</span></span>

- <span data-ttu-id="8eeaf-120">現在、<xref:System.ServiceModel.WorkflowServiceHost> は複数のバージョンのホストです。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-120"><xref:System.ServiceModel.WorkflowServiceHost> is now a multi-version host.</span></span> <span data-ttu-id="8eeaf-121">ワークフロー サービスの新しいバージョンを配置すると、新しいインスタンスが新しいサービスを使用して作成されますが、既存のインスタンスは以前のバージョンを使用して完了します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-121">When a new version of a workflow service is deployed, new instances are created using the new service, but existing instances complete using the previous version.</span></span> <span data-ttu-id="8eeaf-122">詳細については、「 [WorkflowServiceHost でのサイドバイサイドバージョン管理](../wcf/feature-details/side-by-side-versioning-in-workflowservicehost.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-122">For more information, see [Side by Side Versioning in WorkflowServiceHost](../wcf/feature-details/side-by-side-versioning-in-workflowservicehost.md).</span></span>

- <span data-ttu-id="8eeaf-123">永続化されたワークフロー インスタンスの定義を更新するためのメカニズムを提供する動的更新が導入されました。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-123">Dynamic update is introduced which provides a mechanism for updating the definition of a persisted workflow instance.</span></span> <span data-ttu-id="8eeaf-124">詳細については、「[動的更新](dynamic-update.md)」および「[方法: 実行中のワークフローインスタンスの定義を更新する](how-to-update-the-definition-of-a-running-workflow-instance.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-124">For more information, see [Dynamic Update](dynamic-update.md) and [How to: Update the Definition of a Running Workflow Instance](how-to-update-the-definition-of-a-running-workflow-instance.md).</span></span>

- <span data-ttu-id="8eeaf-125">.NET Framework 4 つのデータベーススクリプトを使用して作成された永続性データベースをアップグレードするために、Sqlworkflowinstancestoreschemaupgrade.sql データベーススクリプトが用意されています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-125">A SqlWorkflowInstanceStoreSchemaUpgrade.sql database script is provided to upgrade persistence databases created using the .NET Framework 4 database scripts.</span></span> <span data-ttu-id="8eeaf-126">このスクリプトは、.NET Framework 4.5 で導入された新しいバージョン管理機能をサポートするために .NET Framework 4 つの永続性データベースを更新します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-126">This script updates .NET Framework 4 persistence databases to support the new versioning capabilities introduced in .NET Framework 4.5.</span></span> <span data-ttu-id="8eeaf-127">データベースで永続化されたワークフロー インスタンスは、既定のバージョン番号が付与されるため、side-by-side 実行および動的更新に参加できるようになります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-127">The persisted workflow instances in the database are given default versioning values, and can participate in side-by-side execution and dynamic update.</span></span> <span data-ttu-id="8eeaf-128">詳細については、「 [.NET Framework 4 の永続性データベースのアップグレード」を](using-workflowidentity-and-versioning.md#UpdatingWF4PersistenceDatabases)参照してください。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-128">For more information, see [Upgrading .NET Framework 4 Persistence Databases to Support Workflow Versioning](using-workflowidentity-and-versioning.md#UpdatingWF4PersistenceDatabases).</span></span>

## <a name="activities"></a><a name="BKMK_NewActivities"></a><span data-ttu-id="8eeaf-129">実習</span><span class="sxs-lookup"><span data-stu-id="8eeaf-129">Activities</span></span>

<span data-ttu-id="8eeaf-130">組み込みのアクティビティ ライブラリには、既存のアクティビティ用の新しいアクティビティと新しい機能が含まれています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-130">The built-in activity library contains new activities and new features for existing activities.</span></span>

### <a name="nopersist-scope"></a><a name="BKMK_NoPersistScope"></a><span data-ttu-id="8eeaf-131">NoPersist スコープ</span><span class="sxs-lookup"><span data-stu-id="8eeaf-131">NoPersist Scope</span></span>

<span data-ttu-id="8eeaf-132"><xref:System.Activities.Statements.NoPersistScope> は、NoPersistScope の子アクティビティの実行時にワークフローが永続化されないようにする新しいコンテナー アクティビティです。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-132"><xref:System.Activities.Statements.NoPersistScope> is a new container activity that prevents a workflow from being persisted when the NoPersistScope’s child activities are executing.</span></span> <span data-ttu-id="8eeaf-133">これは、ワークフローがファイル ハンドルなどのコンピューター固有のリソースを使用している場合、データベース トランザクション中など、ワークフローの永続化が適切でないシナリオで役立ちます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-133">This is useful in scenarios where it is not appropriate for the workflow to be persisted, such as when the workflow is using machine-specific resources such as file handles, or during database transactions.</span></span> <span data-ttu-id="8eeaf-134">以前のバージョンでは、アクティビティ実行中に永続化されないようにするために、<xref:System.Activities.NativeActivity> を使用したカスタム <xref:System.Activities.NoPersistHandle> が必要でした。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-134">Previously, to prevent persistence from occurring during an activity's execution, a custom <xref:System.Activities.NativeActivity> that used a <xref:System.Activities.NoPersistHandle> was required.</span></span>

### <a name="new-flowchart-capabilities"></a><a name="BKMK_NewFlowchartCapabilities"></a><span data-ttu-id="8eeaf-135">新しいフローチャート機能</span><span class="sxs-lookup"><span data-stu-id="8eeaf-135">New Flowchart Capabilities</span></span>

<span data-ttu-id="8eeaf-136">.NET Framework 4.5 のフローチャートが更新され、次の新機能が追加されました。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-136">Flowcharts are updated for .NET Framework 4.5 and have the following new capabilities:</span></span>

- <span data-ttu-id="8eeaf-137">`DisplayName` アクティビティまたは <xref:System.Activities.Statements.FlowSwitch%601> アクティビティの <xref:System.Activities.Statements.FlowDecision> プロパティは編集できます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-137">The `DisplayName` property of a <xref:System.Activities.Statements.FlowSwitch%601> or <xref:System.Activities.Statements.FlowDecision> activity is editable.</span></span> <span data-ttu-id="8eeaf-138">これにより、アクティビティ デザイナーではアクティビティの目的に関する詳細な情報を表示できます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-138">This will let the activity designer show more information about the activity's purpose.</span></span>

- <span data-ttu-id="8eeaf-139">フローチャートには <xref:System.Activities.Statements.Flowchart.ValidateUnconnectedNodes%2A> という新しいプロパティがあります。このプロパティの既定値は `False` です。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-139">Flowcharts have a new property called <xref:System.Activities.Statements.Flowchart.ValidateUnconnectedNodes%2A>; the default for this property is `False`.</span></span> <span data-ttu-id="8eeaf-140">このプロパティを `True` に設定すると、接続されていないフローチャート ノードでは検証エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-140">If this property is set to `True`, then unconnected flowchart nodes will produce validation errors.</span></span>

## <a name="support-for-partial-trust"></a><span data-ttu-id="8eeaf-141">部分信頼のサポート</span><span class="sxs-lookup"><span data-stu-id="8eeaf-141">Support for Partial Trust</span></span>

<span data-ttu-id="8eeaf-142">.NET Framework 4 のワークフローには、完全に信頼されたアプリケーションドメインが必要でした。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-142">Workflows in .NET Framework 4 required a fully trusted application domain.</span></span> <span data-ttu-id="8eeaf-143">.NET Framework 4.5 では、ワークフローは部分信頼環境で動作できます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-143">In .NET Framework 4.5, workflows can operate in a partial trust environment.</span></span> <span data-ttu-id="8eeaf-144">部分信頼環境では、サード パーティのコンポーネントは、ホストのリソースに対するフル アクセスを許可しなくても使用できます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-144">In a partial trust environment, third-party components can be used without granting them full access to the resources of the host.</span></span> <span data-ttu-id="8eeaf-145">部分信頼でのワークフローの実行に関する問題は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-145">Some concerns about running workflows in partial trust are as follows:</span></span>

1. <span data-ttu-id="8eeaf-146">部分信頼環境では、<xref:System.Activities.Statements.Interop> アクティビティに含まれるレガシ コンポーネント (規則など) を使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-146">Using legacy components (including Rules) contained in the <xref:System.Activities.Statements.Interop> activity is not supported under partial trust.</span></span>

2. <span data-ttu-id="8eeaf-147"><xref:System.ServiceModel.WorkflowServiceHost> において部分信頼でワークフローを実行することはできません。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-147">Running workflows in partial trust in <xref:System.ServiceModel.WorkflowServiceHost> is not supported.</span></span>

3. <span data-ttu-id="8eeaf-148">部分信頼シナリオで例外を永続化すると、セキュリティ上の脅威になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-148">Persisting exceptions in a partial-trust scenario is a potential security threat.</span></span> <span data-ttu-id="8eeaf-149">例外の永続化を無効にするには、例外が永続化されないように <xref:System.Activities.ExceptionPersistenceExtension> 型の拡張機能をプロジェクトに追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-149">To disable persisting of exceptions, an extension of type <xref:System.Activities.ExceptionPersistenceExtension> must be added to the project in order to opt out of persisting exceptions.</span></span> <span data-ttu-id="8eeaf-150">この型を実装する方法を示したコード例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-150">The following code example demonstrates how to implement this type.</span></span>

    ```csharp
    public class ExceptionPersistenceExtension
    {
        public ExceptionPersistenceExtension()
        {
            this.PersistExceptions = false;
        }
        public bool PersistExceptions { get; set; }
    }
    ```

     <span data-ttu-id="8eeaf-151">例外がシリアル化されない場合は、例外が <xref:System.Activities.Statements.NoPersistScope> 内で使用されていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-151">If exceptions are not to be serialized, ensure that exceptions are used within a <xref:System.Activities.Statements.NoPersistScope>.</span></span>

4. <span data-ttu-id="8eeaf-152">アクティビティの作成者は、<xref:System.Activities.Activity.CacheMetadata%2A> をオーバーライドして、ワークフロー ランタイムが型に対してリフレクションを自動的に実行しないようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-152">Activity authors should override <xref:System.Activities.Activity.CacheMetadata%2A> to avoid having the workflow runtime automatically execute reflection against the type.</span></span> <span data-ttu-id="8eeaf-153">引数と子アクティビティには null 以外を指定する必要があり、<xref:System.Activities.ActivityMetadata.Bind%2A> は明示的に呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-153">Arguments and child activities must be non-null, and <xref:System.Activities.ActivityMetadata.Bind%2A> must be called explicitly.</span></span> <span data-ttu-id="8eeaf-154">オーバーライドの詳細につい <xref:System.Activities.Activity.CacheMetadata%2A> ては、「 [CacheMetadata を使用したデータの公開](exposing-data-with-cachemetadata.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-154">For more information on overriding <xref:System.Activities.Activity.CacheMetadata%2A>, see [Exposing data with CacheMetadata](exposing-data-with-cachemetadata.md).</span></span> <span data-ttu-id="8eeaf-155">また、 `internal` **private** <xref:System.Activities.Activity.CacheMetadata%2A> リフレクションによって作成されないようにするには、型またはプライベート型の引数のインスタンスをで明示的に作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-155">Also, instances of arguments that are of a type that is `internal` or **private** must be explicitly created in  <xref:System.Activities.Activity.CacheMetadata%2A> to avoid being created by reflection.</span></span>

5. <span data-ttu-id="8eeaf-156">型は、シリアル化に <xref:System.Runtime.Serialization.ISerializable> または <xref:System.SerializableAttribute> を使用しません。シリアル化する型では、<xref:System.Runtime.Serialization.DataContractSerializer> をサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-156">Types will not use <xref:System.Runtime.Serialization.ISerializable> or <xref:System.SerializableAttribute> for serialization; types that are to be serialized must support <xref:System.Runtime.Serialization.DataContractSerializer>.</span></span>

6. <span data-ttu-id="8eeaf-157"><xref:System.Activities.Expressions.LambdaValue%601> を使用する式は <xref:System.Security.Permissions.ReflectionPermissionAttribute.RestrictedMemberAccess%2A> を必要とするため、部分信頼では動作しません。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-157">Expressions that use <xref:System.Activities.Expressions.LambdaValue%601> require <xref:System.Security.Permissions.ReflectionPermissionAttribute.RestrictedMemberAccess%2A>, and thus will not work under partial trust.</span></span> <span data-ttu-id="8eeaf-158"><xref:System.Activities.Expressions.LambdaValue%601> を使用するワークフローでは、これらの式を、<xref:System.Activities.CodeActivity%601> から派生するアクティビティと置き換える必要があります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-158">Workflows that use <xref:System.Activities.Expressions.LambdaValue%601> should replace those expressions with activities that derive from <xref:System.Activities.CodeActivity%601>.</span></span> <span data-ttu-id="8eeaf-159">.</span><span class="sxs-lookup"><span data-stu-id="8eeaf-159">.</span></span>

7. <span data-ttu-id="8eeaf-160">部分信頼では、<xref:System.Activities.XamlIntegration.TextExpressionCompiler> または Visual Basic でホストされているコンパイラを使用して式をコンパイルすることはできませんが、以前コンパイルされた式を実行することはできます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-160">Expressions cannot be compiled using <xref:System.Activities.XamlIntegration.TextExpressionCompiler> or the Visual Basic hosted compiler in partial trust, but previously compiled expressions can be run.</span></span>

8. <span data-ttu-id="8eeaf-161">[レベル2の透過性](https://aka.ms/Level2Transparency)を使用する1つのアセンブリを .NET Framework 4、 [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] 完全信頼、および部分信頼で使用することはできません [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-161">A single assembly that uses [Level 2 Transparency](https://aka.ms/Level2Transparency) cannot be used in .NET Framework 4, [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] in full trust, and [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] in partial trust.</span></span>

## <a name="new-designer-capabilities"></a><a name="BKMK_NewDesignerCapabilites"></a><span data-ttu-id="8eeaf-162">新しいデザイナーの機能</span><span class="sxs-lookup"><span data-stu-id="8eeaf-162">New Designer Capabilities</span></span>

### <a name="designer-search"></a><a name="BKMK_DesignerSearch"></a><span data-ttu-id="8eeaf-163">デザイナー検索</span><span class="sxs-lookup"><span data-stu-id="8eeaf-163">Designer Search</span></span>

<span data-ttu-id="8eeaf-164">より大規模なワークフローを管理しやすくするために、キーワードでワークフローを検索できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-164">To make larger workflows more manageable, workflows can now be searched by keyword.</span></span> <span data-ttu-id="8eeaf-165">この機能は、Visual Studio でのみ使用できます。この機能は、再ホストされたデザイナーでは使用できません。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-165">This feature is only available in Visual Studio; this feature is not available in a rehosted designer.</span></span> <span data-ttu-id="8eeaf-166">利用できる検索機能には 2 種類あります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-166">There are two kinds of searches available:</span></span>

- <span data-ttu-id="8eeaf-167">[クイック検索]。 **Ctrl + F**または **[編集**]、[**検索と置換**]、[**クイック検索**] のいずれかを使用して開始されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-167">Quick Find, initiated with either **Ctrl+F** or **Edit**, **Find and Replace**, **Quick Find**.</span></span>

- <span data-ttu-id="8eeaf-168">**Ctrl + Shift + F キー**または [**編集**]、[**検索と置換**]、[**フォルダー**を使用して検索] のいずれかで開始されたフォルダーを検索します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-168">Find in Files, initiated with either **Ctrl+Shift+F** or **Edit**, **Find and Replace**, **Find in Files**.</span></span>

<span data-ttu-id="8eeaf-169">置換はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-169">Note that Replace is not supported.</span></span>

#### <a name="quick-find"></a><a name="BKMK_QuickFind"></a><span data-ttu-id="8eeaf-170">クイック検索</span><span class="sxs-lookup"><span data-stu-id="8eeaf-170">Quick Find</span></span>

<span data-ttu-id="8eeaf-171">ワークフロー内で検索されるキーワードは、次のデザイナー項目に一致します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-171">Keywords searched in workflows will match the following designer items:</span></span>

- <span data-ttu-id="8eeaf-172"><xref:System.Activities.Activity> オブジェクト、<xref:System.Activities.Statements.FlowNode> オブジェクト、<xref:System.Activities.Statements.State> オブジェクト、<xref:System.Activities.Statements.Transition> オブジェクト、およびその他のカスタム フロー制御項目のプロパティ。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-172">Properties of <xref:System.Activities.Activity> objects, <xref:System.Activities.Statements.FlowNode> objects, <xref:System.Activities.Statements.State> objects, <xref:System.Activities.Statements.Transition> objects, and other custom flow-control items.</span></span>

- <span data-ttu-id="8eeaf-173">変数</span><span class="sxs-lookup"><span data-stu-id="8eeaf-173">Variables</span></span>

- <span data-ttu-id="8eeaf-174">引数</span><span class="sxs-lookup"><span data-stu-id="8eeaf-174">Arguments</span></span>

- <span data-ttu-id="8eeaf-175">式</span><span class="sxs-lookup"><span data-stu-id="8eeaf-175">Expressions</span></span>

<span data-ttu-id="8eeaf-176">クイック検索はデザイナーの <xref:System.Activities.Presentation.Model.ModelItem> ツリーで実行されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-176">Quick Find is performed on the designer's <xref:System.Activities.Presentation.Model.ModelItem> tree.</span></span> <span data-ttu-id="8eeaf-177">クイック検索は、ワークフロー定義にインポートされた名前空間を検索しません。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-177">Quick Find will not locate namespaces imported in the workflow definition.</span></span>

#### <a name="find-in-files"></a><a name="BKMK_FindInFiles"></a><span data-ttu-id="8eeaf-178">フォルダーを検索する</span><span class="sxs-lookup"><span data-stu-id="8eeaf-178">Find in Files</span></span>

<span data-ttu-id="8eeaf-179">ワークフロー内で検索されるキーワードは、ワークフロー ファイルの実際のコンテンツに一致します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-179">Keywords searched in workflows will match the actual content of the workflow files.</span></span> <span data-ttu-id="8eeaf-180">検索結果は Visual Studio の検索結果ビュー ペインに表示されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-180">The search results will be shown in Visual Studio Find Results view pane.</span></span> <span data-ttu-id="8eeaf-181">結果の項目をダブルクリックすると、ワークフロー デザイナーで一致を含むアクティビティに移動します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-181">Double-clicking the result item will navigate to the activity which contains the match in workflow designer.</span></span>

### <a name="delete-context-menu-item-in-variable-and-argument-designer"></a><a name="BKMK_VariableDeleteContextMenu"></a><span data-ttu-id="8eeaf-182">変数および引数デザイナーのコンテキストメニュー項目の削除</span><span class="sxs-lookup"><span data-stu-id="8eeaf-182">Delete context menu item in variable and argument designer</span></span>

<span data-ttu-id="8eeaf-183">.NET Framework 4 では、変数と引数は、キーボードを使用してデザイナーでのみ削除できました。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-183">In .NET Framework 4, variables and arguments could only be deleted in the designer using the keyboard.</span></span> <span data-ttu-id="8eeaf-184">.NET Framework 4.5 以降では、コンテキストメニューを使用して変数と引数を削除できます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-184">Starting with .NET Framework 4.5, variables and arguments can be deleted using the context menu.</span></span>

<span data-ttu-id="8eeaf-185">変数デザイナーと引数デザイナーのコンテキスト メニューを次のスクリーンショットに示しています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-185">The following screenshot shows the variable and argument designer context menu.</span></span>

![変数/引数デザイナーのコンテキスト メニュー](./media/whats-new-in-wf-in-dotnet/designer-context-menu.png)

### <a name="auto-surround-with-sequence"></a><a name="BKMK_AutoSurround"></a><span data-ttu-id="8eeaf-187">シーケンスを使用した自動ブロック</span><span class="sxs-lookup"><span data-stu-id="8eeaf-187">Auto-surround with Sequence</span></span>

<span data-ttu-id="8eeaf-188">ワークフローまたは特定のコンテナー アクティビティ (<xref:System.Activities.Statements.NoPersistScope> など) には Body アクティビティを 1 つしか含めることができないため、2 つ目のアクティビティを追加するには、開発者が最初のアクティビティを削除し、<xref:System.Activities.Statements.Sequence> アクティビティを追加してから、シーケンス アクティビティに両方のアクティビティを追加する必要がありました。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-188">Since a workflow or certain container activities (such as <xref:System.Activities.Statements.NoPersistScope>) can only contain a single body activity, adding a second activity required the developer to delete the first activity, add a <xref:System.Activities.Statements.Sequence> activity, and then add both activities to the sequence activity.</span></span> <span data-ttu-id="8eeaf-189">.NET Framework 4.5 以降では、デザイナー画面に2つ目のアクティビティを追加すると、両方のアクティビティを `Sequence` ラップするアクティビティが自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-189">Starting with .NET Framework 4.5, when adding a second activity to the designer surface, a `Sequence` activity will be automatically created to wrap both activities.</span></span>

<span data-ttu-id="8eeaf-190">次のスクリーンショットは、`WriteLine` の `Body` 内の `NoPersistScope` アクティビティを示しています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-190">The following screenshot shows a `WriteLine` activity in the `Body` of a `NoPersistScope`.</span></span>

![NoPersistScope アクティビティの本体の WriteLine アクティビティ。](./media/whats-new-in-wf-in-dotnet/auto-surround-write-line-activity.png)

<span data-ttu-id="8eeaf-192">次のスクリーンショットは、2 つ目の `WriteLine` を 1 つ目の下にドロップしたときに `Body` 内に自動的に作成された `Sequence` アクティビティを示しています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-192">The following screenshot shows the automatically created `Sequence` activity in the `Body` when a second `WriteLine` is dropped below the first.</span></span>

![NoPersistScope の本体に自動的に作成されたシーケンス。](./media/whats-new-in-wf-in-dotnet/auto-surround-sequence-activity.png)

### <a name="pan-mode"></a><a name="BKMK_PanMode"></a><span data-ttu-id="8eeaf-194">パンモード</span><span class="sxs-lookup"><span data-stu-id="8eeaf-194">Pan Mode</span></span>

<span data-ttu-id="8eeaf-195">デザイナーで大規模なワークフロー内をより簡単に移動するには、パン モードを有効にすると、開発者は、スクロール バーを使用する必要なく、ワークフローの表示される部分をクリックおよびドラッグして移動できるようになります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-195">To more easily navigate a large workflow in the designer, pan mode can be enabled, allowing the developer to click and drag to move the visible portion of the workflow, rather than needing to use the scroll bars.</span></span> <span data-ttu-id="8eeaf-196">パン モードをアクティブ化するボタンは、デザイナーの右下隅にあります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-196">The button to activate pan mode is in the lower right corner of the designer.</span></span>

<span data-ttu-id="8eeaf-197">次のスクリーンショットは、ワークフロー デザイナーの右下隅にあるパン ボタンを示しています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-197">The following screenshot shows the pan button which is located at the bottom right corner of the workflow designer.</span></span>

![ワークフローデザイナーで [パン] ボタンが強調表示されています。](./media/whats-new-in-wf-in-dotnet/pan-button-workflow-designer.png)

<span data-ttu-id="8eeaf-199">マウスの中央ボタンまたは Space キーを使用して、ワークフロー デザイナーをパンすることもできます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-199">The middle mouse button or space bar can also be used to pan the workflow designer.</span></span>

### <a name="multi-select"></a><a name="BKMK_MultiSelect"></a><span data-ttu-id="8eeaf-200">複数選択</span><span class="sxs-lookup"><span data-stu-id="8eeaf-200">Multi-select</span></span>

<span data-ttu-id="8eeaf-201">複数のアクティビティを同時に選択できます。これを行うには、複数のアクティビティを囲むようにドラッグするか (パン モードが無効な場合)、Ctrl キーを押したまま目的のアクティビティを 1 つずつクリックします。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-201">Multiple activities can be selected at one time, either by dragging a rectangle around them (when pan mode is not enabled), or by holding down Ctrl and click the desired activities one by one.</span></span>

<span data-ttu-id="8eeaf-202">選択した複数のアクティビティは、デザイナー内でドラッグ アンド ドロップすることも、コンテキスト メニューを使用して操作することもできます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-202">Multiple activity selections can also be dragged and dropped within the designer, and can also be interacted with using the context menu.</span></span>

### <a name="outline-view-of-workflow-items"></a><a name="BKMK_DocumentOutline"></a><span data-ttu-id="8eeaf-203">ワークフロー項目のアウトラインビュー</span><span class="sxs-lookup"><span data-stu-id="8eeaf-203">Outline view of workflow items</span></span>

<span data-ttu-id="8eeaf-204">階層ワークフローを移動しやすくするため、ワークフローのコンポーネントはツリー スタイルのアウトライン表示で示されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-204">In order to make hierarchical workflows easier to navigate, components of a workflow are shown in a tree-style outline view.</span></span> <span data-ttu-id="8eeaf-205">[アウトライン] ビューは、[**ドキュメントアウトライン**] ビューに表示されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-205">The outline view is displayed in the **Document Outline** view.</span></span> <span data-ttu-id="8eeaf-206">このビューを開くには、上部のメニューで [**表示**]、[**その他のウィンドウ**]、[**ドキュメントアウトライン**] の順に選択するか、Ctrl W キーを押しながら U キーを押します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-206">To open this view, from the top menu, select **View**, **Other Windows**, **Document Outline**, or press Ctrl W,U.</span></span> <span data-ttu-id="8eeaf-207">アウトライン表示でノードをクリックすると、ワークフロー デザイナーの対応するアクティビティに移動し、アウトライン表示が更新されて、デザイナーで選択されているアクティビティが表示されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-207">Clicking on a node in outline view will navigate to the corresponding activity in the workflow designer, and the outline view will be updated to show activities that are selected in the designer.</span></span>

<span data-ttu-id="8eeaf-208">[はじめにチュートリアル](getting-started-tutorial.md)の完成したワークフローの次のスクリーンショットは、シーケンシャルワークフローを含むアウトラインビューを示しています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-208">The following screenshot of the completed workflow from the [Getting Started Tutorial](getting-started-tutorial.md) shows the outline view with a sequential workflow.</span></span>

![Visual Studio のシーケンシャルワークフローを含むアウトラインビューのスクリーンショット。](./media/whats-new-in-wf-in-dotnet/outline-view-in-workflow-designer.jpg)

### <a name="c-expressions"></a><a name="BKMK_CSharpExpressions"></a><span data-ttu-id="8eeaf-210">C# の式</span><span class="sxs-lookup"><span data-stu-id="8eeaf-210">C# Expressions</span></span>

<span data-ttu-id="8eeaf-211">.NET Framework 4.5 より前では、ワークフロー内のすべての式は Visual Basic でのみ記述できました。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-211">Prior to .NET Framework 4.5, all expressions in workflows could only be written in Visual Basic.</span></span> <span data-ttu-id="8eeaf-212">.NET Framework 4.5 では、Visual Basic 式は Visual Basic を使用して作成されたプロジェクトにのみ使用されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-212">In .NET Framework 4.5, Visual Basic expressions are only used for projects created using Visual Basic.</span></span> <span data-ttu-id="8eeaf-213">Visual C# プロジェクトでは、式に C# が使用されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-213">Visual C# projects now use C# for expressions.</span></span> <span data-ttu-id="8eeaf-214">文法強調表示や Intellisense などの機能を備えた、フル機能の C# 式エディターが用意されています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-214">A fully functional C# expression editor is provided which capabilities such as grammar highlighting and intellisense.</span></span> <span data-ttu-id="8eeaf-215">以前のバージョンで作成された、Visual Basic の式を使用する C# ワークフロー プロジェクトは引き続き動作します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-215">C# workflow projects created in previous versions that use Visual Basic expressions will continue to work.</span></span>

<span data-ttu-id="8eeaf-216">C# の式はデザイン時に検証されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-216">C# expressions are validated at design-time.</span></span> <span data-ttu-id="8eeaf-217">C# 式のエラーは赤い波下線でマークされます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-217">Errors in C# expressions will be marked with a red wavy underline.</span></span>

<span data-ttu-id="8eeaf-218">C# の式の詳細については、「 [C# の式](csharp-expressions.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-218">For more information about C# expressions, see [C# Expressions](csharp-expressions.md).</span></span>

### <a name="more-control-of-visibility-of-shell-bar-and-header-items"></a><a name="BKMK_Visibility"></a><span data-ttu-id="8eeaf-219">シェルバーとヘッダー項目の表示をより詳細に制御する</span><span class="sxs-lookup"><span data-stu-id="8eeaf-219">More control of visibility of shell bar and header items</span></span>

<span data-ttu-id="8eeaf-220">再ホストされたデザイナーでは、標準 UI コントロールの中に、特定のワークフローにとって意味がないものもあれば、無効になっているものもあります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-220">In a rehosted designer, some of the standard UI controls may not have meaning for a given workflow, and may be turned off.</span></span> <span data-ttu-id="8eeaf-221">.NET Framework 4 では、このカスタマイズはデザイナーの下部にあるシェルバーでのみサポートされています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-221">In .NET Framework 4, this customization is only supported by the shell bar at the bottom of the designer.</span></span> <span data-ttu-id="8eeaf-222">.NET Framework 4.5 では、デザイナーの上部にあるシェルヘッダー項目の表示を適切な値に設定することによって調整でき <xref:System.Activities.Presentation.View.DesignerView.WorkflowShellHeaderItemsVisibility%2A> <xref:System.Activities.Presentation.View.ShellHeaderItemsVisibility> ます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-222">In .NET Framework 4.5, the visibility of shell header items at the top of the designer can be adjusted by setting <xref:System.Activities.Presentation.View.DesignerView.WorkflowShellHeaderItemsVisibility%2A> with the appropriate <xref:System.Activities.Presentation.View.ShellHeaderItemsVisibility> value.</span></span>

### <a name="auto-connect-and-auto-insert-in-flowchart-and-state-machine-workflows"></a><a name="BKMK_AutoConnect"></a><span data-ttu-id="8eeaf-223">フローチャートおよびステートマシンワークフローでの自動接続と自動挿入</span><span class="sxs-lookup"><span data-stu-id="8eeaf-223">Auto-connect and auto-insert in Flowchart and State Machine workflows</span></span>

<span data-ttu-id="8eeaf-224">.NET Framework 4 では、フローチャートワークフロー内のノード間の接続を手動で追加する必要がありました。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-224">In .NET Framework 4, connections between nodes in a Flowchart workflow had to be added manually.</span></span> <span data-ttu-id="8eeaf-225">.NET Framework 4.5 では、フローチャートおよびステートマシンノードには、アクティビティをツールボックスからデザイナー画面にドラッグしたときに表示される自動接続ポイントがあります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-225">In .NET Framework 4.5, Flowchart and State Machine nodes have auto-connect points that become visible when an activity is dragged from the toolbox onto the designer surface.</span></span> <span data-ttu-id="8eeaf-226">アクティビティをこれらのポイントのうち 1 つにドロップすると、アクティビティが必要な接続と共に自動的に追加されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-226">Dropping an activity on one of these points automatically adds the activity along with the necessary connection.</span></span>

<span data-ttu-id="8eeaf-227">次のスクリーンショットは、アクティビティがツールボックスからドラッグされるときに表示されるアタッチ ポイントを示します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-227">The following screenshot shows the attachment points that become visible when an activity is dragged from the toolbox.</span></span>

![自動接続ポイントを示すフローチャートの開始ノード](./media/whats-new-in-wf-in-dotnet/auto-connect-points-start-node.png)

<span data-ttu-id="8eeaf-229">アクティビティは、フローチャート ノードと状態の間の接続にドラッグすることで、その他 2 つのノード間にノードを自動挿入することもできます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-229">Activities can also be dragged onto connections between flowchart nodes and states to auto-insert the node between two other nodes.</span></span> <span data-ttu-id="8eeaf-230">次のスクリーンショットは、アクティビティをツールボックスからドラッグ アンド ドロップできる、強調表示された接続線を示しています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-230">The following screenshot shows the highlighted connecting line where activities can be dragged from the toolbox and dropped.</span></span>

![アクティビティをドロップするための自動挿入ハンドル](./media/whats-new-in-wf-in-dotnet/auto-insert-connecting-line.png)

### <a name="designer-annotations"></a><a name="BKMK_Annotations"></a><span data-ttu-id="8eeaf-232">デザイナー注釈</span><span class="sxs-lookup"><span data-stu-id="8eeaf-232">Designer Annotations</span></span>

<span data-ttu-id="8eeaf-233">より大規模なワークフローの開発を容易にするため、デザイン プロセスを追跡できるよう注釈の追加がサポートされるようになりました。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-233">To facilitate developing larger workflows, the designer now supports adding annotations to help keep track of the design process.</span></span> <span data-ttu-id="8eeaf-234">注釈は、アクティビティ、状態、フローチャート ノード、変数、および引数に追加できます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-234">Annotation can be added to activities, states, flowchart nodes, variables and arguments.</span></span> <span data-ttu-id="8eeaf-235">次のスクリーンショットは、デザイナーに注釈を追加するためのコンテキスト メニューを示しています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-235">The following screenshot shows the context menu used to add annotations to the designer.</span></span>

![注釈を追加するためのメニューを示すスクリーンショット。](./media/whats-new-in-wf-in-dotnet/designer-annotations-context-menu.png)

### <a name="debugging-states"></a><span data-ttu-id="8eeaf-237">デバッグ状態</span><span class="sxs-lookup"><span data-stu-id="8eeaf-237">Debugging states</span></span>

<span data-ttu-id="8eeaf-238">.NET Framework 4 では、アクティビティ以外の要素は実行単位ではないため、デバッグブレークポイントをサポートできませんでした。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-238">In .NET Framework 4, non-activity elements could not support debug breakpoints since they were not units of execution.</span></span> <span data-ttu-id="8eeaf-239">このリリースでは、<xref:System.Activities.Statements.State> オブジェクトにブレークポイントを追加する機能が用意されています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-239">This release provides a mechanism for adding breakpoints to <xref:System.Activities.Statements.State> objects.</span></span> <span data-ttu-id="8eeaf-240">ブレークポイントを <xref:System.Activities.Statements.State> に設定した場合、そのエントリ アクティビティまたはトリガーがスケジュールされる前に、状態が遷移すると実行が停止します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-240">When a breakpoint is set on a <xref:System.Activities.Statements.State>, execution will break when the state is transitioned to, before its entry activities or triggers are scheduled.</span></span>

### <a name="define-and-consume-activitydelegate-objects-in-the-designer"></a><a name="BKMK_ActivityDelegates"></a><span data-ttu-id="8eeaf-241">デザイナーでの ActivityDelegate オブジェクトの定義と使用</span><span class="sxs-lookup"><span data-stu-id="8eeaf-241">Define and consume ActivityDelegate objects in the designer</span></span>

<span data-ttu-id="8eeaf-242">.NET Framework 4 のアクティビティは、 <xref:System.Activities.ActivityDelegate> ワークフローの他の部分がワークフローの実行と対話できる実行ポイントを公開するために使用されます。ただし、通常、これらの実行ポイントを使用するには、かなりの量のコードが必要です。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-242">Activities in .NET Framework 4 used <xref:System.Activities.ActivityDelegate> objects to expose execution points where other parts of the workflow could interact with a workflow's execution, but using these execution points usually required a fair amount of code.</span></span> <span data-ttu-id="8eeaf-243">このリリースでは、開発者はワークフロー デザイナーを使用してアクティビティ デリゲートを定義および使用できます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-243">In this release, developers can define and consume activity delegates using the workflow designer.</span></span> <span data-ttu-id="8eeaf-244">詳細については、「[方法: ワークフローデザイナーでアクティビティデリゲートを定義および使用する](/visualstudio/workflow-designer/how-to-define-and-consume-activity-delegates-in-the-workflow-designer)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-244">For more information, see [How to: Define and consume activity delegates in the Workflow Designer](/visualstudio/workflow-designer/how-to-define-and-consume-activity-delegates-in-the-workflow-designer).</span></span>

### <a name="build-time-validation"></a><a name="BKMK_BuildTimeValidation"></a><span data-ttu-id="8eeaf-245">ビルド時の検証</span><span class="sxs-lookup"><span data-stu-id="8eeaf-245">Build-time validation</span></span>

<span data-ttu-id="8eeaf-246">.NET Framework 4 では、ワークフロープロジェクトのビルド中に、ワークフローの検証エラーがビルドエラーとしてカウントされませんでした。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-246">In .NET Framework 4, workflow validation errors weren’t counted as build errors during the build of a workflow project.</span></span> <span data-ttu-id="8eeaf-247">つまり、ワークフローの検証エラーが発生した場合でも、ワークフロー プロジェクトのビルドは成功している可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-247">This meant that building a workflow project could succeed even when there were workflow validation errors.</span></span> <span data-ttu-id="8eeaf-248">.NET Framework 4.5 では、ワークフローの検証エラーによってビルドが失敗します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-248">In .NET Framework 4.5, workflow validation errors cause the build to fail.</span></span>

### <a name="design-time-background-validation"></a><a name="BKMK_DesignTimeValidation"></a><span data-ttu-id="8eeaf-249">デザイン時のバックグラウンド検証</span><span class="sxs-lookup"><span data-stu-id="8eeaf-249">Design-time background validation</span></span>

<span data-ttu-id="8eeaf-250">.NET Framework 4 では、ワークフローがフォアグラウンドプロセスとして検証されました。これにより、複雑な、または時間のかかる検証プロセスで UI がブロックされる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-250">In .NET Framework 4, workflows were validated as a foreground process, which could potentially block the UI during complex or time-consuming validation processes.</span></span> <span data-ttu-id="8eeaf-251">現在、ワークフローの検証はバックグラウンド スレッドで実行されるため、UI がブロックされることはありません。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-251">Workflow validation now takes place on a background thread, so that the UI is not blocked.</span></span>

### <a name="view-state-located-in-a-separate-location-in-xaml-files"></a><a name="BKMK_ViewState"></a><span data-ttu-id="8eeaf-252">XAML ファイル内の別の場所にあるビューステート</span><span class="sxs-lookup"><span data-stu-id="8eeaf-252">View state located in a separate location in XAML files</span></span>

<span data-ttu-id="8eeaf-253">.NET Framework 4 では、ワークフローのビューステート情報は、さまざまな場所にある XAML ファイルに格納されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-253">In .NET Framework 4, the view state information for a workflow is stored across the XAML file in many different locations.</span></span> <span data-ttu-id="8eeaf-254">これは、XAML を直接読み取ったり、ビューステート情報を削除するコードを記述したりする開発者にとっては不便です。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-254">This is inconvenient for developers who want to read XAML directly, or write code to remove the view state information.</span></span> <span data-ttu-id="8eeaf-255">.NET Framework 4.5 では、XAML ファイル内のビューステート情報が XAML ファイル内の個別の要素としてシリアル化されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-255">In .NET Framework 4.5, the view state information in the XAML file is serialized as a separate element in the XAML file.</span></span> <span data-ttu-id="8eeaf-256">開発者は、アクティビティのビューステート情報を簡単に見つけて編集したり、ビューステートを完全に削除したりできます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-256">Developers can easily locate and edit the view state information of an activity, or remove the view state altogether.</span></span>

### <a name="expression-extensibility"></a><a name="BKMK_ExpressionExtensibility"></a><span data-ttu-id="8eeaf-257">式の拡張</span><span class="sxs-lookup"><span data-stu-id="8eeaf-257">Expression extensibility</span></span>

<span data-ttu-id="8eeaf-258">.NET Framework 4.5 では、開発者がワークフローデザイナーにプラグインできる独自の式および式作成操作を作成する方法を提供しています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-258">In .NET Framework 4.5, we provide a way for developers to create their own expression and expression authoring experience that can be plugged into the workflow designer.</span></span>

### <a name="opt-in-for-workflow-45-features-in-rehosted-designer"></a><a name="BKMK_BackwardCompatRehostedDesigner"></a><span data-ttu-id="8eeaf-259">再ホストされたデザイナーのワークフロー4.5 機能のオプトイン</span><span class="sxs-lookup"><span data-stu-id="8eeaf-259">Opt-in for Workflow 4.5 features in rehosted designer</span></span>

<span data-ttu-id="8eeaf-260">旧バージョンとの互換性を維持するために、再ホストされたデザイナーでは、.NET Framework 4.5 に含まれるいくつかの新機能が既定で有効になっていません。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-260">To preserve backward compatibility, some new features included in .NET Framework 4.5 are not enabled by default in the rehosted designer.</span></span> <span data-ttu-id="8eeaf-261">これは、再ホストされたデザイナーを使用する既存のアプリケーションが、最新バージョンに更新することで壊れないようにするためです。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-261">This is to ensure that existing applications that use the rehosted designer are not broken by updating to the latest version.</span></span> <span data-ttu-id="8eeaf-262">再ホストされたデザイナーで新機能を有効にするには、<xref:System.Activities.Presentation.DesignerConfigurationService.TargetFrameworkName%2A> を ".NET Framework 4.5" に設定するか、<xref:System.Activities.Presentation.DesignerConfigurationService> の各メンバーを設定して各機能を有効にします。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-262">To enable new features in the rehosted designer, either set <xref:System.Activities.Presentation.DesignerConfigurationService.TargetFrameworkName%2A> to ".NET Framework 4.5", or set individual members of <xref:System.Activities.Presentation.DesignerConfigurationService> to enable individual features.</span></span>

## <a name="new-workflow-development-models"></a><a name="BKMK_NewWFModels"></a><span data-ttu-id="8eeaf-263">新しいワークフロー開発モデル</span><span class="sxs-lookup"><span data-stu-id="8eeaf-263">New Workflow Development Models</span></span>

<span data-ttu-id="8eeaf-264">このリリースには、フローチャートおよびシーケンシャル ワークフロー開発モデルに加えて、ステート マシンのワークフロー、およびコントラクト優先ワークフロー サービスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-264">In addition to flowchart and sequential workflow development models, this release includes State Machine workflows, and contract-first workflow services.</span></span>

### <a name="state-machine-workflows"></a><a name="BKMK_StateMachine"></a><span data-ttu-id="8eeaf-265">ステートマシンのワークフロー</span><span class="sxs-lookup"><span data-stu-id="8eeaf-265">State machine workflows</span></span>

<span data-ttu-id="8eeaf-266">ステートマシンのワークフローは、 [Microsoft .NET Framework 4 Platform Update 1](https://docs.microsoft.com/archive/blogs/endpoint/microsoft-net-framework-4-platform-update-1)で .NET Framework 4 バージョン4.0.1 の一部として導入されました。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-266">State machine workflows were introduced as part of the .NET Framework 4, version 4.0.1 in the [Microsoft .NET Framework 4 Platform Update 1](https://docs.microsoft.com/archive/blogs/endpoint/microsoft-net-framework-4-platform-update-1).</span></span> <span data-ttu-id="8eeaf-267">この更新プログラムには、開発者がステート マシンのワークフローを作成できるようにする、いくつかの新しいクラスとアクティビティが含まれていました。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-267">This update included several new classes and activities which allowed developers to create state machine workflows.</span></span> <span data-ttu-id="8eeaf-268">これらのクラスとアクティビティは .NET Framework 4.5 に対して更新されました。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-268">These classes and activities have been updated for .NET Framework 4.5.</span></span> <span data-ttu-id="8eeaf-269">更新プログラムには次のものが含まれています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-269">Updates include:</span></span>

1. <span data-ttu-id="8eeaf-270">状態にブレークポイントを設定する機能。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-270">The ability to set breakpoints on states</span></span>

2. <span data-ttu-id="8eeaf-271">ワークフロー デザイナーで遷移をコピーして貼り付ける機能。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-271">The ability to copy and paste transitions in the workflow designer</span></span>

3. <span data-ttu-id="8eeaf-272">トリガーを共有する遷移の作成に対するデザイナーのサポート。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-272">Designer support for shared trigger transition creation</span></span>

4. <span data-ttu-id="8eeaf-273">ステート マシンのワークフロー作成に使用するアクティビティ (<xref:System.Activities.Statements.StateMachine><xref:System.Activities.Statements.State>、<xref:System.Activities.Statements.Transition> など)。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-273">Activities used to create State Machine workflows, including: <xref:System.Activities.Statements.StateMachine>, <xref:System.Activities.Statements.State>, and <xref:System.Activities.Statements.Transition></span></span>

<span data-ttu-id="8eeaf-274">次のスクリーンショットは、[はじめにチュートリアル](getting-started-tutorial.md)の手順[「ステートマシンワークフローを作成する方法](how-to-create-a-state-machine-workflow.md)」の完成したステートマシンワークフローを示しています。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-274">The following screenshot shows the completed state machine workflow from the [Getting Started Tutorial](getting-started-tutorial.md) step [How to: Create a State Machine Workflow](how-to-create-a-state-machine-workflow.md).</span></span>

![完成したステートマシンのワークフローを示す図。](./media/whats-new-in-wf-in-dotnet/complete-state-machine-workflow.jpg)

<span data-ttu-id="8eeaf-276">ステートマシンワークフローの作成の詳細については、「[ステートマシンワークフロー](state-machine-workflows.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-276">For more information on creating state machine workflows, see [State Machine Workflows](state-machine-workflows.md).</span></span>

### <a name="contract-first-workflow-development"></a><a name="BKMK_ContractFirst"></a><span data-ttu-id="8eeaf-277">コントラクト優先ワークフローの開発</span><span class="sxs-lookup"><span data-stu-id="8eeaf-277">Contract-first workflow development</span></span>

<span data-ttu-id="8eeaf-278">コントラクト優先ワークフロー開発ツールを使用すると、開発者は code first でコントラクトをデザインできます。 Visual Studio で数回クリックするだけで、各操作を表すアクティビティテンプレートがツールボックスに自動的に生成されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-278">The contract-first workflow development tool allows the developer to design a contract in code first, then, with a few clicks in Visual Studio, automatically generate an activity template in the toolbox representing each operation.</span></span> <span data-ttu-id="8eeaf-279">これらのアクティビティは、コントラクトで定義された操作を実装するワークフローを作成するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-279">These activities are then used to create a workflow that implements the operations defined by the contract.</span></span> <span data-ttu-id="8eeaf-280">ワークフロー デザイナーは、ワークフロー サービスを検証し、これらの操作が実装され、ワークフローの署名がコントラクトの署名と一致することを確認します。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-280">The workflow designer will validate the workflow service to ensure that these operations are implemented and the signature of the workflow matches the contract signature.</span></span> <span data-ttu-id="8eeaf-281">また、開発者は、ワークフロー サービスを、実装済みコントラクトのコレクションと関連付けることもできます。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-281">The developer can also associate a workflow service with a collection of implemented contracts.</span></span> <span data-ttu-id="8eeaf-282">コントラクト優先ワークフローサービスの開発の詳細については、「[方法: 既存のサービスコントラクトを使用するワークフローサービスを作成](how-to-create-a-workflow-service-that-consumes-an-existing-service-contract.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8eeaf-282">For more information on contract-first workflow service development, see [How to: Create a workflow service that consumes an existing service contract](how-to-create-a-workflow-service-that-consumes-an-existing-service-contract.md).</span></span>
