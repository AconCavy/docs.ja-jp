---
title: .NET アプリでのリソースのパッケージ化と配置
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- deploying applications [.NET Framework], resources
- resource files, deploying
- hub-and-spoke resource deployment model
- resource files, packaging
- application resources, packaging
- single resource assembly
- satellite assemblies
- default culture for applications
- names [.NET Framework], resources
- fallback process for resources
- grouping cultures
- application resources, deploying
- application resources, naming conventions
- culture, packaging and deploying resources
- resource files, naming conventions
- packaging application resources
- application resources, fallback processes
- resource files, fallback processes
- localizing resources
- neutral cultures
ms.assetid: b224d7c0-35f8-4e82-a705-dd76795e8d16
ms.openlocfilehash: d64e3b5201e34541fdafa5724b0c7e8c3f6c0c0d
ms.sourcegitcommit: 7980a91f90ae5eca859db7e6bfa03e23e76a1a50
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/13/2020
ms.locfileid: "81243051"
---
# <a name="packaging-and-deploying-resources-in-net-apps"></a><span data-ttu-id="679f7-102">.NET アプリでのリソースのパッケージ化と配置</span><span class="sxs-lookup"><span data-stu-id="679f7-102">Packaging and Deploying Resources in .NET Apps</span></span>

<span data-ttu-id="679f7-103">アプリケーションは、<xref:System.Resources.ResourceManager> クラスによって表される .NET Framework リソース マネージャーに依存して、ローカライズされたリソースを取得します。</span><span class="sxs-lookup"><span data-stu-id="679f7-103">Applications rely on the .NET Framework Resource Manager, represented by the <xref:System.Resources.ResourceManager> class, to retrieve localized resources.</span></span> <span data-ttu-id="679f7-104">リソース マネージャーでは、リソースのパッケージ化と配置にハブ アンド スポーク モデルを使うことが想定されています。</span><span class="sxs-lookup"><span data-stu-id="679f7-104">The Resource Manager assumes that a hub and spoke model is used to package and deploy resources.</span></span> <span data-ttu-id="679f7-105">ハブは、ローカライズできない実行可能コードと、ニュートラル カルチャまたは既定のカルチャと呼ばれる単一カルチャ用のリソースを含む、メイン アセンブリです。</span><span class="sxs-lookup"><span data-stu-id="679f7-105">The hub is the main assembly that contains the nonlocalizable executable code and the resources for a single culture, called the neutral or default culture.</span></span> <span data-ttu-id="679f7-106">既定のカルチャはアプリケーション用のフォールバック カルチャです。つまり、ローカライズされたリソースが見つからない場合に使われるリソースのカルチャです。</span><span class="sxs-lookup"><span data-stu-id="679f7-106">The default culture is the fallback culture for the application; it is the culture whose resources are used if localized resources cannot be found.</span></span> <span data-ttu-id="679f7-107">各スポークは、単一のカルチャ用のリソースを含むがコードは含まないサテライト アセンブリに接続します。</span><span class="sxs-lookup"><span data-stu-id="679f7-107">Each spoke connects to a satellite assembly that contains the resources for a single culture, but does not contain any code.</span></span>

<span data-ttu-id="679f7-108">このモデルにいくつかの利点があります。</span><span class="sxs-lookup"><span data-stu-id="679f7-108">There are several advantages to this model:</span></span>

- <span data-ttu-id="679f7-109">アプリケーションを配置した後で、段階的に新しいカルチャのリソースを追加できます。</span><span class="sxs-lookup"><span data-stu-id="679f7-109">You can incrementally add resources for new cultures after you have deployed an application.</span></span> <span data-ttu-id="679f7-110">カルチャに固有のリソースを後で開発するには多くの時間を必要とすることがあるため、後から追加できれば、メイン アプリケーションを最初にリリースしておき、カルチャ固有のリソースを後で配布できます。</span><span class="sxs-lookup"><span data-stu-id="679f7-110">Because subsequent development of culture-specific resources can require a significant amount of time, this allows you to release your main application first, and deliver culture-specific resources at a later date.</span></span>
- <span data-ttu-id="679f7-111">アプリケーションを再コンパイルすることなく、アプリケーションのサテライト アセンブリを更新および変更することができます。</span><span class="sxs-lookup"><span data-stu-id="679f7-111">You can update and change an application's satellite assemblies without recompiling the application.</span></span>
- <span data-ttu-id="679f7-112">アプリケーションで読み込む必要があるのは、特定のカルチャに必要なリソースを含むサテライト アセンブリだけです。</span><span class="sxs-lookup"><span data-stu-id="679f7-112">An application needs to load only those satellite assemblies that contain the resources needed for a particular culture.</span></span> <span data-ttu-id="679f7-113">このようにすると、システム リソースの使用を大幅に減らすことができます。</span><span class="sxs-lookup"><span data-stu-id="679f7-113">This can significantly reduce the use of system resources.</span></span>

 <span data-ttu-id="679f7-114">ただし、このモデルにも短所はあります。</span><span class="sxs-lookup"><span data-stu-id="679f7-114">However, there are also disadvantages to this model:</span></span>

- <span data-ttu-id="679f7-115">複数のリソース セットを管理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="679f7-115">You must manage multiple sets of resources.</span></span>
- <span data-ttu-id="679f7-116">複数の構成をテストする必要があるため、アプリケーションのテストの初期コストが増えます。</span><span class="sxs-lookup"><span data-stu-id="679f7-116">The initial cost of testing an application increases, because you must test several configurations.</span></span> <span data-ttu-id="679f7-117">長期的に見れば、複数の各国語バージョンを並列にテストして管理するより、複数のサテライトを持つ 1 つの中核アプリケーションをテストする方が簡単かつ安価であることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="679f7-117">Note that in the long term it will be easier and less expensive to test one core application with several satellites, than to test and maintain several parallel international versions.</span></span>

## <a name="resource-naming-conventions"></a><span data-ttu-id="679f7-118">リソースの名前付け規則</span><span class="sxs-lookup"><span data-stu-id="679f7-118">Resource naming conventions</span></span>

<span data-ttu-id="679f7-119">アプリケーションのリソースをパッケージ化するときは、共通言語ランタイムで想定されているリソース名前付け規則を使って、リソースに名前を付ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="679f7-119">When you package your application's resources, you must name them using the resource naming conventions that the common language runtime expects.</span></span> <span data-ttu-id="679f7-120">ランタイムは、そのカルチャ名でリソースを識別します。</span><span class="sxs-lookup"><span data-stu-id="679f7-120">The runtime identifies a resource by its culture name.</span></span> <span data-ttu-id="679f7-121">各カルチャには一意の名前が指定されています。通常は、言語に関連付けられた小文字 2 文字のカルチャ名と、必要に応じて、国または地域に関連付けられた大文字 2 文字のサブカルチャ名を組み合わせたものです。</span><span class="sxs-lookup"><span data-stu-id="679f7-121">Each culture is given a unique name, which is usually a combination of a two-letter, lowercase culture name associated with a language and, if required, a two-letter, uppercase subculture name associated with a country or region.</span></span> <span data-ttu-id="679f7-122">カルチャ名の後にダッシュ (-) で区切ってサブカルチャ名は記述します。</span><span class="sxs-lookup"><span data-stu-id="679f7-122">The subculture name follows the culture name, separated by a dash (-).</span></span> <span data-ttu-id="679f7-123">日本で話される日本語は ja-JP、米国で話される英語は en-US、ドイツで話されるドイツ語は de-DE、オーストリアで話されるドイツ語は de-AT などとなります。</span><span class="sxs-lookup"><span data-stu-id="679f7-123">Examples include ja-JP for Japanese as spoken in Japan, en-US for English as spoken in the United States, de-DE for German as spoken in Germany, or de-AT for German as spoken in Austria.</span></span> <span data-ttu-id="679f7-124">[Windows でサポートされている言語/地域名の一覧](https://docs.microsoft.com/openspecs/windows_protocols/ms-lcid/a9eac961-e77d-41a6-90a5-ce1a8b0cdb9c)の「**Language tag (言語タグ)**」列をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="679f7-124">See the **Language tag** column in the [list of language/region names supported by Windows](https://docs.microsoft.com/openspecs/windows_protocols/ms-lcid/a9eac961-e77d-41a6-90a5-ce1a8b0cdb9c).</span></span> <span data-ttu-id="679f7-125">カルチャ名は、[BCP 47](https://tools.ietf.org/html/bcp47) によって定義されている標準に準拠します。</span><span class="sxs-lookup"><span data-stu-id="679f7-125">Culture names follow the standard defined by [BCP 47](https://tools.ietf.org/html/bcp47).</span></span>

> [!NOTE]
> <span data-ttu-id="679f7-126">中国語 (簡体字) など`zh-Hans`、2 文字のカルチャ名には例外があります。</span><span class="sxs-lookup"><span data-stu-id="679f7-126">There are some exceptions for the two-letter culture names, such as `zh-Hans` for Chinese (Simplified).</span></span>

> [!NOTE]
> <span data-ttu-id="679f7-127">リソース ファイルの作成については、「[リソース ファイルの作成](creating-resource-files-for-desktop-apps.md)」および「[サテライト アセンブリの作成](creating-satellite-assemblies-for-desktop-apps.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="679f7-127">For information about creating resource files, see [Creating Resource Files](creating-resource-files-for-desktop-apps.md) and [Creating Satellite Assemblies](creating-satellite-assemblies-for-desktop-apps.md).</span></span>

<a name="cpconpackagingdeployingresourcesanchor1"></a>

## <a name="the-resource-fallback-process"></a><span data-ttu-id="679f7-128">リソース フォールバック プロセス</span><span class="sxs-lookup"><span data-stu-id="679f7-128">The Resource Fallback Process</span></span>

<span data-ttu-id="679f7-129">リソースのパッケージ化と配置のハブ アンド スポーク モデルでは、適切なリソースを見つけるためにフォールバック プロセスが使われます。</span><span class="sxs-lookup"><span data-stu-id="679f7-129">The hub and spoke model for packaging and deploying resources uses a fallback process to locate appropriate resources.</span></span> <span data-ttu-id="679f7-130">アプリケーションが使用できないローカライズされたリソースを要求した場合、共通言語ランタイムは、カルチャの階層で、ユーザーのアプリケーションの要求と最もよく一致する適切なフォールバック リソースを検索し、例外がスローされるのは最終的な手段としてのみです。</span><span class="sxs-lookup"><span data-stu-id="679f7-130">If an application requests a localized resource  that is unavailable, the common language runtime searches the hierarchy of cultures for an appropriate fallback resource that most closely matches the user's application's request, and throws an exception only as a last resort.</span></span> <span data-ttu-id="679f7-131">階層の各レベルで適切なリソースが見つかった場合、ランタイムはそれを使います。</span><span class="sxs-lookup"><span data-stu-id="679f7-131">At each level of the hierarchy, if an appropriate resource is found, the runtime uses it.</span></span> <span data-ttu-id="679f7-132">リソースが見つからない場合、次のレベルで検索が続けられます。</span><span class="sxs-lookup"><span data-stu-id="679f7-132">If the resource is not found, the search continues at the next level.</span></span>

<span data-ttu-id="679f7-133">検索のパフォーマンスを向上させるには、<xref:System.Resources.NeutralResourcesLanguageAttribute> 属性をメイン アセンブリに適用し、メイン アセンブリで動作するニュートラル言語の名前をそれに渡します。</span><span class="sxs-lookup"><span data-stu-id="679f7-133">To improve lookup performance, apply the <xref:System.Resources.NeutralResourcesLanguageAttribute> attribute to your main assembly, and pass it the name of the neutral language that will work with your main assembly.</span></span>

### <a name="net-framework-resource-fallback-process"></a><span data-ttu-id="679f7-134">.NET Framework のリソース フォールバック プロセス</span><span class="sxs-lookup"><span data-stu-id="679f7-134">.NET Framework resource fallback process</span></span>

<span data-ttu-id="679f7-135">.NET Framework のリソース フォールバック プロセスには次の手順が含まれます。</span><span class="sxs-lookup"><span data-stu-id="679f7-135">The .NET Framework resource fallback process involves the following steps:</span></span>

> [!TIP]
> <span data-ttu-id="679f7-136">リソース フォールバック プロセスおよびランタイムがリソース アセンブリをプローブするプロセスを最適化するのに[は、相対 BindForResources>構成要素を使用できます。 \<](../configure-apps/file-schema/runtime/relativebindforresources-element.md)</span><span class="sxs-lookup"><span data-stu-id="679f7-136">You may be able to use the [\<relativeBindForResources>](../configure-apps/file-schema/runtime/relativebindforresources-element.md) configuration element to optimize the resource fallback process and the process by which the runtime probes for resource assemblies.</span></span> <span data-ttu-id="679f7-137">詳しくは、「[リソース フォールバック プロセスの最適化](packaging-and-deploying-resources-in-desktop-apps.md#Optimizing)」セクションをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="679f7-137">For more information, see the [Optimizing the Resource Fallback Process](packaging-and-deploying-resources-in-desktop-apps.md#Optimizing) section.</span></span>

1. <span data-ttu-id="679f7-138">ランタイムは最初に、[グローバル アセンブリ キャッシュ](../app-domains/gac.md)で、アプリケーションに対して要求されたカルチャと一致するアセンブリを調べます。</span><span class="sxs-lookup"><span data-stu-id="679f7-138">The runtime first checks the [global assembly cache](../app-domains/gac.md) for an assembly that matches the requested culture for your application.</span></span>

     <span data-ttu-id="679f7-139">グローバル アセンブリ キャッシュには、多くのアプリケーションで共有されるリソース アセンブリを格納できます。</span><span class="sxs-lookup"><span data-stu-id="679f7-139">The global assembly cache can store resource assemblies that are shared by many applications.</span></span> <span data-ttu-id="679f7-140">これにより、作成するすべてのアプリケーションのディレクトリ構造に特定のリソース セットを含める必要がなくなります。</span><span class="sxs-lookup"><span data-stu-id="679f7-140">This frees you from having to include specific sets of resources in the directory structure of every application you create.</span></span> <span data-ttu-id="679f7-141">アセンブリへの参照が見つかると、ランタイムは要求されたリソースのアセンブリを検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-141">If the runtime finds a reference to the assembly, it searches the assembly for the requested resource.</span></span> <span data-ttu-id="679f7-142">アセンブリでエントリが見つかると、ランタイムは要求されたリソースを使います。</span><span class="sxs-lookup"><span data-stu-id="679f7-142">If it finds the entry in the assembly, it uses the requested resource.</span></span> <span data-ttu-id="679f7-143">エントリが見つからない場合は、検索を続けます。</span><span class="sxs-lookup"><span data-stu-id="679f7-143">If it doesn't find the entry, it continues the search.</span></span>

2. <span data-ttu-id="679f7-144">次に、ランタイムは、現在実行中のアセンブリのサブディレクトリで、要求されたカルチャと一致するディレクトリを調べます。</span><span class="sxs-lookup"><span data-stu-id="679f7-144">The runtime next checks the directory of the currently executing assembly for a subdirectory that matches the requested culture.</span></span> <span data-ttu-id="679f7-145">サブディレクトリが見つかった場合、要求されたカルチャの有効なサテライト アセンブリをそのサブディレクトリで検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-145">If it finds the subdirectory, it searches that subdirectory for a valid satellite assembly for the requested culture.</span></span> <span data-ttu-id="679f7-146">ランタイムはその後、要求されたリソースのサテライト アセンブリを検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-146">The runtime then searches the satellite assembly for the requested resource.</span></span> <span data-ttu-id="679f7-147">アセンブリでリソースが見つかると、それを使用します。</span><span class="sxs-lookup"><span data-stu-id="679f7-147">If it finds the resource in the assembly, it uses it.</span></span> <span data-ttu-id="679f7-148">リソースが見つからない場合は、検索を続けます。</span><span class="sxs-lookup"><span data-stu-id="679f7-148">If it doesn't find the resource, it continues the search.</span></span>

3. <span data-ttu-id="679f7-149">ランタイムは次に、Windows インストーラーに問い合わせて、サテライト アセンブリをオンデマンドでインストールする必要があるかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="679f7-149">The runtime next queries the Windows Installer to determine whether the satellite assembly is to be installed on demand.</span></span> <span data-ttu-id="679f7-150">必要がある場合は、インストールを処理し、アセンブリを読み込んで要求されたリソースを検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-150">If so, it handles the installation, loads the assembly, and searches it or the requested resource.</span></span> <span data-ttu-id="679f7-151">アセンブリでリソースが見つかると、それを使用します。</span><span class="sxs-lookup"><span data-stu-id="679f7-151">If it finds the resource in the assembly, it uses it.</span></span> <span data-ttu-id="679f7-152">リソースが見つからない場合は、検索を続けます。</span><span class="sxs-lookup"><span data-stu-id="679f7-152">If it doesn't find the resource, it continues the search.</span></span>

4. <span data-ttu-id="679f7-153">ランタイムは <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> イベントを生成し、サテライト アセンブリが見つからないことを示します。</span><span class="sxs-lookup"><span data-stu-id="679f7-153">The runtime raises the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event to indicate that it is unable to find the satellite assembly.</span></span> <span data-ttu-id="679f7-154">イベントを処理することを選択した場合、イベント ハンドラーはリソースを検索に使用するサテライト アセンブリへの参照を返すことができます。</span><span class="sxs-lookup"><span data-stu-id="679f7-154">If you choose to handle the event, your event handler can return a reference to the satellite assembly whose resources will be used for the lookup.</span></span> <span data-ttu-id="679f7-155">それ以外の場合、イベント ハンドラーは `null` を返し、検索が続けられます。</span><span class="sxs-lookup"><span data-stu-id="679f7-155">Otherwise, the event handler returns `null` and the search continues.</span></span>

5. <span data-ttu-id="679f7-156">ランタイムは次に、再びグローバル アセンブリ キャッシュで、今度は要求されたカルチャの親アセンブリを検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-156">The runtime next searches the global assembly cache again, this time for the parent assembly of the requested culture.</span></span> <span data-ttu-id="679f7-157">親アセンブリがグローバル アセンブリ キャッシュに存在する場合、ランタイムはそのアセンブリで要求されたリソースを検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-157">If the parent assembly exists in the global assembly cache, the runtime searches the assembly for the requested resource.</span></span>

     <span data-ttu-id="679f7-158">親カルチャは、適切なフォールバック カルチャとして定義されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-158">The parent culture is defined as the appropriate fallback culture.</span></span> <span data-ttu-id="679f7-159">例外をスローするよりは何らかのリソースを提供する方がよいので、親をフォールバック候補として考えます。</span><span class="sxs-lookup"><span data-stu-id="679f7-159">Consider parents as fallback candidates, because providing any resource is preferable to throwing an exception.</span></span> <span data-ttu-id="679f7-160">このプロセスでは、リソースを再利用することもできます。</span><span class="sxs-lookup"><span data-stu-id="679f7-160">This process also allows you to reuse resources.</span></span> <span data-ttu-id="679f7-161">子カルチャが要求されたリソースをローカライズする必要がない場合にのみ、親レベルで特定のリソースを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="679f7-161">You should include a particular resource at the parent level only if the child culture doesn't need to localize the requested resource.</span></span> <span data-ttu-id="679f7-162">たとえば、`en` (ニュートラル英語)、`en-GB` (イギリスで話される英語)、および `en-US` (米国で話される英語) のサテライト アセンブリを提供する場合、`en` サテライトには一般的な用語が含まれます。また、`en-GB` および `en-US` サテライトに異なる用語のみのオーバーライドを用意することができます。</span><span class="sxs-lookup"><span data-stu-id="679f7-162">For example, if you supply satellite assemblies for `en` (neutral English), `en-GB` (English as spoken in the United Kingdom), and `en-US` (English as spoken in the United States), the `en` satellite would contain the common terminology, and the `en-GB` and `en-US` satellites could provide overrides for only those terms that differ.</span></span>

6. <span data-ttu-id="679f7-163">次に、ランタイムは、現在実行中のアセンブリのディレクトリが親ディレクトリを含むかどうかを調べます。</span><span class="sxs-lookup"><span data-stu-id="679f7-163">The runtime next checks the directory of the currently executing assembly to see if it contains a parent directory.</span></span> <span data-ttu-id="679f7-164">親ディレクトリが存在する場合、ランタイムはそのディレクトリで、親カルチャの有効なサテライト アセンブリを検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-164">If a parent directory exists, the runtime searches the directory for a valid satellite assembly for the parent culture.</span></span> <span data-ttu-id="679f7-165">アセンブリが見つかると、ランタイムは要求されたリソースのアセンブリを検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-165">If it finds the assembly, the runtime searches the assembly for the requested resource.</span></span> <span data-ttu-id="679f7-166">リソースが見つかった場合は、それを使用します。</span><span class="sxs-lookup"><span data-stu-id="679f7-166">If it finds the resource, it uses it.</span></span> <span data-ttu-id="679f7-167">リソースが見つからない場合は、検索を続けます。</span><span class="sxs-lookup"><span data-stu-id="679f7-167">If it doesn't find the resource, it continues the search.</span></span>

7. <span data-ttu-id="679f7-168">ランタイムは次に、Windows インストーラーに問い合わせて、親サテライト アセンブリをオンデマンドでインストールする必要があるかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="679f7-168">The runtime next queries the Windows Installer to determine whether the parent satellite assembly is to be installed on demand.</span></span> <span data-ttu-id="679f7-169">必要がある場合は、インストールを処理し、アセンブリを読み込んで要求されたリソースを検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-169">If so, it handles the installation, loads the assembly, and searches it or the requested resource.</span></span> <span data-ttu-id="679f7-170">アセンブリでリソースが見つかると、それを使用します。</span><span class="sxs-lookup"><span data-stu-id="679f7-170">If it finds the resource in the assembly, it uses it.</span></span> <span data-ttu-id="679f7-171">リソースが見つからない場合は、検索を続けます。</span><span class="sxs-lookup"><span data-stu-id="679f7-171">If it doesn't find the resource, it continues the search.</span></span>

8. <span data-ttu-id="679f7-172">ランタイムは <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> イベントを生成し、適切なフォールバック リソースが見つからないことを示します。</span><span class="sxs-lookup"><span data-stu-id="679f7-172">The runtime raises the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event to indicate that it is unable to find an appropriate fallback resource.</span></span> <span data-ttu-id="679f7-173">イベントを処理することを選択した場合、イベント ハンドラーはリソースを検索に使用するサテライト アセンブリへの参照を返すことができます。</span><span class="sxs-lookup"><span data-stu-id="679f7-173">If you choose to handle the event, your event handler can return a reference to the satellite assembly whose resources will be used for the lookup.</span></span> <span data-ttu-id="679f7-174">それ以外の場合、イベント ハンドラーは `null` を返し、検索が続けられます。</span><span class="sxs-lookup"><span data-stu-id="679f7-174">Otherwise, the event handler returns `null` and the search continues.</span></span>

9. <span data-ttu-id="679f7-175">ランタイムは次に、前の 3 つの手順と同じように、可能性のある多くのレベルで親アセンブリを検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-175">The runtime next searches parent assemblies, as in the previous three steps, through many potential levels.</span></span> <span data-ttu-id="679f7-176">各カルチャの親は 1 つだけで、<xref:System.Globalization.CultureInfo.Parent%2A?displayProperty=nameWithType> プロパティによって定義されていますが、親がそれ自身の親を持つ可能性があります。</span><span class="sxs-lookup"><span data-stu-id="679f7-176">Each culture has only one parent, which is defined by the <xref:System.Globalization.CultureInfo.Parent%2A?displayProperty=nameWithType> property, but a parent might have its own parent.</span></span> <span data-ttu-id="679f7-177">親カルチャの検索は、<xref:System.Globalization.CultureInfo.Parent%2A> プロパティが <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> を返した時点で停止します。リソース フォールバックでは、インバリアント カルチャは、親カルチャまたはリソースを持つことができるカルチャと見なされません。</span><span class="sxs-lookup"><span data-stu-id="679f7-177">The search for parent cultures stops when a culture's <xref:System.Globalization.CultureInfo.Parent%2A> property returns <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType>; for resource fallback, the invariant culture is not considered a parent culture or a culture that can have resources.</span></span>

10. <span data-ttu-id="679f7-178">もともと指定されていたカルチャおよびすべての親を検索してもリソースが見つからない場合は、既定の (フォールバック) カルチャのリソースが使われます。</span><span class="sxs-lookup"><span data-stu-id="679f7-178">If the culture that was originally specified and all parents have been searched and the resource is still not found, the resource for the default (fallback) culture is used.</span></span> <span data-ttu-id="679f7-179">通常、既定のカルチャのリソースは、メイン アプリケーション アセンブリに格納されています。</span><span class="sxs-lookup"><span data-stu-id="679f7-179">Typically, the resources for the default culture are included in the main application assembly.</span></span> <span data-ttu-id="679f7-180">ただし、<xref:System.Resources.NeutralResourcesLanguageAttribute> 属性の <xref:System.Resources.NeutralResourcesLanguageAttribute.Location%2A> プロパティに値 <xref:System.Resources.UltimateResourceFallbackLocation.Satellite> を指定することで、リソースの最終的なフォールバックの場所が、メイン アセンブリではなくサテライト アセンブリであることを示すことができます。</span><span class="sxs-lookup"><span data-stu-id="679f7-180">However, you can specify a value of <xref:System.Resources.UltimateResourceFallbackLocation.Satellite> for the <xref:System.Resources.NeutralResourcesLanguageAttribute.Location%2A> property of the <xref:System.Resources.NeutralResourcesLanguageAttribute> attribute to indicate that the ultimate fallback location for resources is a satellite assembly, rather than the main assembly.</span></span>

    > [!NOTE]
    > <span data-ttu-id="679f7-181">既定のリソースは、メイン アセンブリでコンパイルできる唯一のリソースです。</span><span class="sxs-lookup"><span data-stu-id="679f7-181">The default resource is the only resource that can be compiled with the main assembly.</span></span> <span data-ttu-id="679f7-182"><xref:System.Resources.NeutralResourcesLanguageAttribute> 属性を使ってサテライト アセンブリを指定していない場合、最終的なフォールバック (最後の親) になります。</span><span class="sxs-lookup"><span data-stu-id="679f7-182">Unless you specify a satellite assembly by using the <xref:System.Resources.NeutralResourcesLanguageAttribute> attribute, it is the ultimate fallback (final parent).</span></span> <span data-ttu-id="679f7-183">したがって、常に既定のリソース セットをメイン アセンブリに含めることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="679f7-183">Therefore, we recommend that you always include a default set of resources in your main assembly.</span></span> <span data-ttu-id="679f7-184">これは、例外がスローされるのを防ぐのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="679f7-184">This helps prevent exceptions from being thrown.</span></span> <span data-ttu-id="679f7-185">既定のリソース ファイルを含めることにより、すべてのリソースに対してフォールバックが提供され、固有のカルチャではなくても、常に少なくとも 1 つのリソースがユーザーに存在することが保証されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-185">By including a default resource, file you provide a fallback for all resources and ensure that at least one resource is always present for the user, even if it is not culturally specific.</span></span>

11. <span data-ttu-id="679f7-186">最後に、既定の (フォールバック) カルチャのリソースが見つからない場合は、<xref:System.Resources.MissingManifestResourceException> または <xref:System.Resources.MissingSatelliteAssemblyException> 例外がスローされて、リソースが見つからなかったことが示されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-186">Finally, if the runtime doesn't find a resource for a default (fallback) culture, a <xref:System.Resources.MissingManifestResourceException> or <xref:System.Resources.MissingSatelliteAssemblyException> exception is thrown to indicate that the resource could not be found.</span></span>

<span data-ttu-id="679f7-187">たとえば、アプリケーションがスペイン語 (メキシコ) (`es-MX` カルチャ) にローカライズされたリソースを要求しているものとします。</span><span class="sxs-lookup"><span data-stu-id="679f7-187">For example, suppose the application requests a resource localized for Spanish (Mexico) (the `es-MX` culture).</span></span> <span data-ttu-id="679f7-188">ランタイムは最初に、グローバル アセンブリ キャッシュで `es-MX` と一致するアセンブリを検索しますが、見つかりません。</span><span class="sxs-lookup"><span data-stu-id="679f7-188">The runtime first searches the global assembly cache for the assembly that matches `es-MX`, but doesn't find it.</span></span> <span data-ttu-id="679f7-189">ランタイムは、現在実行中のアセンブリのディレクトリで `es-MX` のディレクトリを検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-189">The runtime then searches the directory of the currently executing assembly for an `es-MX` directory.</span></span> <span data-ttu-id="679f7-190">見つからない場合、ランタイムは再びグローバル アセンブリ キャッシュで、適切なフォールバック カルチャ (この場合は `es` (スペイン語)) を反映する親アセンブリを検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-190">Failing that, the runtime searches the global assembly cache again for a parent assembly that reflects the appropriate fallback culture — in this case, `es` (Spanish).</span></span> <span data-ttu-id="679f7-191">親アセンブリが見つからない場合、ランタイムは、対応するリソースが見つかるまで、親アセンブリのすべての可能性のあるレベルで、`es-MX` カルチャを検索します。</span><span class="sxs-lookup"><span data-stu-id="679f7-191">If the parent assembly is not found, the runtime searches all potential levels of parent assemblies for the `es-MX` culture until it finds a corresponding resource.</span></span> <span data-ttu-id="679f7-192">それでもリソースが見つからない場合、ランタイムは、既定のカルチャのリソースを使います。</span><span class="sxs-lookup"><span data-stu-id="679f7-192">If a resource isn't found, the runtime uses the resource for the default culture.</span></span>

<a name="Optimizing"></a>

#### <a name="optimizing-the-net-framework-resource-fallback-process"></a><span data-ttu-id="679f7-193">.NET Framework のリソース フォールバック プロセスの最適化</span><span class="sxs-lookup"><span data-stu-id="679f7-193">Optimizing the .NET Framework Resource Fallback Process</span></span>

<span data-ttu-id="679f7-194">次の条件が満たされていれば、ランタイムがサテライト アセンブリでリソースを検索するプロセスを最適化することができます。</span><span class="sxs-lookup"><span data-stu-id="679f7-194">Under the following conditions, you can optimize the process by which the runtime searches for resources in satellite assemblies</span></span>

- <span data-ttu-id="679f7-195">サテライト アセンブリが、コード アセンブリと同じ場所に配置されていること。</span><span class="sxs-lookup"><span data-stu-id="679f7-195">Satellite assemblies are deployed in the same location as the code assembly.</span></span> <span data-ttu-id="679f7-196">コード アセンブリが[グローバル アセンブリ キャッシュ](../app-domains/gac.md)にインストールされている場合、サテライト アセンブリもグローバル アセンブリ キャッシュにインストールされます。</span><span class="sxs-lookup"><span data-stu-id="679f7-196">If the code assembly is installed in the [Global Assembly Cache](../app-domains/gac.md), satellite assemblies are also installed in the global assembly cache.</span></span> <span data-ttu-id="679f7-197">コード アセンブリがディレクトリにインストールされている場合、サテライト アセンブリはそのディレクトリのカルチャ固有のフォルダーにインストールされます。</span><span class="sxs-lookup"><span data-stu-id="679f7-197">If the code assembly is installed in a directory, satellite assemblies are installed in culture-specific folders of that directory.</span></span>

- <span data-ttu-id="679f7-198">サテライト アセンブリは、オンデマンドではインストールされません。</span><span class="sxs-lookup"><span data-stu-id="679f7-198">Satellite assemblies are not installed on demand.</span></span>

- <span data-ttu-id="679f7-199">アプリケーションのコードは、<xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> イベントを処理しません。</span><span class="sxs-lookup"><span data-stu-id="679f7-199">Application code does not handle the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event.</span></span>

<span data-ttu-id="679f7-200">次の例に示すように、[\<相対 BindForResources>](../configure-apps/file-schema/runtime/relativebindforresources-element.md)要素を含め、その`enabled`属性を`true`アプリケーション構成ファイルに設定することで、サテライト アセンブリのプローブを最適化します。</span><span class="sxs-lookup"><span data-stu-id="679f7-200">You optimize the probe for satellite assemblies by including the [\<relativeBindForResources>](../configure-apps/file-schema/runtime/relativebindforresources-element.md) element and setting its `enabled` attribute to `true` in the application configuration file, as shown in the following example.</span></span>

```xml
<configuration>
   <runtime>
      <relativeBindForResources enabled="true" />
   </runtime>
</configuration>
```

<span data-ttu-id="679f7-201">サテライト アセンブリの最適化されたプローブは、オプトイン機能です。</span><span class="sxs-lookup"><span data-stu-id="679f7-201">The optimized probe for satellite assemblies is an opt-in feature.</span></span> <span data-ttu-id="679f7-202">つまり、アプリケーションの構成ファイルに `enabled` 属性が `true` に設定されている [\<relativeBindForResources>](../configure-apps/file-schema/runtime/relativebindforresources-element.md) 要素が存在しない限り、ランタイムは「[リソース フォールバック プロセス](packaging-and-deploying-resources-in-desktop-apps.md#cpconpackagingdeployingresourcesanchor1)」で説明されている手順に従います。</span><span class="sxs-lookup"><span data-stu-id="679f7-202">That is, the runtime follows the steps documented in [The Resource Fallback Process](packaging-and-deploying-resources-in-desktop-apps.md#cpconpackagingdeployingresourcesanchor1) unless the [\<relativeBindForResources>](../configure-apps/file-schema/runtime/relativebindforresources-element.md) element is present in the application's configuration file and its `enabled` attribute is set to `true`.</span></span> <span data-ttu-id="679f7-203">その場合、サテライト アセンブリをプローブするプロセスは次のように変更されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-203">If this is the case, the process of probing for a satellite assembly is modified as follows:</span></span>

- <span data-ttu-id="679f7-204">ランタイムは、親コード アセンブリの場所を使って、サテライト アセンブリをプローブします。</span><span class="sxs-lookup"><span data-stu-id="679f7-204">The runtime uses the location of the parent code assembly to probe for the satellite assembly.</span></span> <span data-ttu-id="679f7-205">親アセンブリがグローバル アセンブリ キャッシュにインストールされている場合、ランタイムはアプリケーションのディレクトリではなくキャッシュ内をプローブします。</span><span class="sxs-lookup"><span data-stu-id="679f7-205">If the parent assembly is installed in the global assembly cache, the runtime probes in the cache but not in the application's directory.</span></span> <span data-ttu-id="679f7-206">親アセンブリがアプリケーション ディレクトリにインストールされている場合、ランタイムはグローバル アセンブリ キャッシュではなくアプリケーション ディレクトリをプローブします。</span><span class="sxs-lookup"><span data-stu-id="679f7-206">If the parent assembly is installed in an application directory, the runtime probes in the application directory but not in the global assembly cache.</span></span>

- <span data-ttu-id="679f7-207">ランタイムは、Windows インストーラーでサテライト アセンブリのオンデマンド インストールを照会しません。</span><span class="sxs-lookup"><span data-stu-id="679f7-207">The runtime doesn't query the Windows Installer for on-demand installation of satellite assemblies.</span></span>

- <span data-ttu-id="679f7-208">特定のリソース アセンブリのプローブが失敗した場合、ランタイムは <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> イベントを生成しません。</span><span class="sxs-lookup"><span data-stu-id="679f7-208">If the probe for a particular resource assembly fails, the runtime does not raise the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event.</span></span>

### <a name="net-core-resource-fallback-process"></a><span data-ttu-id="679f7-209">.NET Core リソース フォールバック プロセス</span><span class="sxs-lookup"><span data-stu-id="679f7-209">.NET Core resource fallback process</span></span>

<span data-ttu-id="679f7-210">.NET Core リソース フォールバック プロセスには次の手順が含まれます。</span><span class="sxs-lookup"><span data-stu-id="679f7-210">The .NET Core resource fallback process involves the following steps:</span></span>

1. <span data-ttu-id="679f7-211">要求されたカルチャのサテライト アセンブリの読み込みがランタイムで試行されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-211">The runtime attempts to load a satellite assembly for the requested culture.</span></span>
     - <span data-ttu-id="679f7-212">現在実行中のアセンブリのサブディレクトリで、要求されたカルチャと一致するディレクトリを調べます。</span><span class="sxs-lookup"><span data-stu-id="679f7-212">Checks the directory of the currently executing assembly for a subdirectory that matches the requested culture.</span></span> <span data-ttu-id="679f7-213">サブディレクトリが見つかった場合、要求されたカルチャの有効なサテライト アセンブリがそのサブディレクトリで検索され、読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="679f7-213">If it finds the subdirectory, it searches that subdirectory for a valid satellite assembly for the requested culture and loads it.</span></span>

       > [!NOTE]
       > <span data-ttu-id="679f7-214">大文字と小文字を区別するファイル システム (つまり Linux と macOS) を持つオペレーティング システムでは、カルチャ名のサブディレクトリ検索では大文字と小文字が区別されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-214">On operating systems with case-sensitive file systems (that is, Linux and macOS), the culture name subdirectory search is case-sensitive.</span></span> <span data-ttu-id="679f7-215">サブディレクトリ名は、<xref:System.Globalization.CultureInfo.Name?displayProperty=nameWithType> の大文字と小文字が完全に一致する必要があります (たとえば `es`、`es-MX`)。</span><span class="sxs-lookup"><span data-stu-id="679f7-215">The subdirectory name must exactly match the case of the <xref:System.Globalization.CultureInfo.Name?displayProperty=nameWithType> (for example, `es` or `es-MX`).</span></span>

       > [!NOTE]
       > <span data-ttu-id="679f7-216">プログラマーが <xref:System.Runtime.Loader.AssemblyLoadContext> からカスタム アセンブリの読み込みコンテキストを派生させた場合、状況は複雑になります。</span><span class="sxs-lookup"><span data-stu-id="679f7-216">If the programmer has derived a custom assembly load context from <xref:System.Runtime.Loader.AssemblyLoadContext>, the situation is complicated.</span></span> <span data-ttu-id="679f7-217">実行中のアセンブリがカスタム コンテキストに読み込まれた場合、ランタイムによってサテライト アセンブリがカスタム コンテキストに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="679f7-217">If the executing assembly was loaded into the custom context, the runtime loads the satellite assembly into the custom context.</span></span> <span data-ttu-id="679f7-218">このドキュメントでは詳細について説明しません。</span><span class="sxs-lookup"><span data-stu-id="679f7-218">The details are out of scope for this document.</span></span> <span data-ttu-id="679f7-219">「<xref:System.Runtime.Loader.AssemblyLoadContext>」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="679f7-219">See  <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>

     - <span data-ttu-id="679f7-220">サテライト アセンブリが見つからない場合、<xref:System.Runtime.Loader.AssemblyLoadContext> は <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving?displayProperty=nameWithType> イベントを発生させ、サテライト アセンブリが見つからないことを示します。</span><span class="sxs-lookup"><span data-stu-id="679f7-220">If a satellite assemble has not been found, the <xref:System.Runtime.Loader.AssemblyLoadContext> raises the <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving?displayProperty=nameWithType> event to indicate that it is unable to find the satellite assembly.</span></span> <span data-ttu-id="679f7-221">イベントを処理することを選択した場合、イベント ハンドラーでサテライト アセンブリの参照を読み込んで返すことができます。</span><span class="sxs-lookup"><span data-stu-id="679f7-221">If you choose to handle the event, your event handler can load and return a reference to the satellite assembly.</span></span>
     - <span data-ttu-id="679f7-222">まだサテライト アセンブリが見つからない場合は、AssemblyLoadContext は AppDomain に <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> イベントをトリガーさせて、サテライト アセンブリが見つからないことを示します。</span><span class="sxs-lookup"><span data-stu-id="679f7-222">If a satellite assembly still has not been found, the AssemblyLoadContext causes the AppDomain to trigger an <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event to indicate that it is unable to find the satellite assembly.</span></span> <span data-ttu-id="679f7-223">イベントを処理することを選択した場合、イベント ハンドラーでサテライト アセンブリの参照を読み込んで返すことができます。</span><span class="sxs-lookup"><span data-stu-id="679f7-223">If you choose to handle the event, your event handler can load and return a reference to the satellite assembly.</span></span>

2. <span data-ttu-id="679f7-224">サテライト アセンブリが見つかった場合、要求されたリソースのサテライト アセンブリがランタイムによって検索されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-224">If a satellite assembly is found, the runtime searches it for the requested resource.</span></span> <span data-ttu-id="679f7-225">アセンブリでリソースが見つかると、それを使用します。</span><span class="sxs-lookup"><span data-stu-id="679f7-225">If it finds the resource in the assembly, it uses it.</span></span> <span data-ttu-id="679f7-226">リソースが見つからない場合は、検索を続けます。</span><span class="sxs-lookup"><span data-stu-id="679f7-226">If it doesn't find the resource, it continues the search.</span></span>

     > [!NOTE]
     > <span data-ttu-id="679f7-227">サテライト アセンブリ内のリソースを見つけるために、ランタイムでは現在の <xref:System.Globalization.CultureInfo.Name?displayProperty=nameWithType> の <xref:System.Resources.ResourceManager> によって要求されたリソース ファイルが検索されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-227">To find a resource within the satellite assembly, the runtime searches for the resource file requested by the <xref:System.Resources.ResourceManager> for the current <xref:System.Globalization.CultureInfo.Name?displayProperty=nameWithType>.</span></span> <span data-ttu-id="679f7-228">リソース ファイル内で、要求されたリソース名が検索されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-228">Within the resource file it searches for the requested resource name.</span></span> <span data-ttu-id="679f7-229">いずれかが見つからない場合、リソースは見つからなかったものとして扱われます。</span><span class="sxs-lookup"><span data-stu-id="679f7-229">If either is not found, the resource is treated as not found.</span></span>

3. <span data-ttu-id="679f7-230">次に、ランタイムでは、手順 1 および 2 を繰り返す度に、考えられる多数のレベルについて親カルチャ アセンブリが検索されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-230">The runtime next searches the parent culture assemblies through many potential levels, each time repeating steps 1 & 2.</span></span>

     <span data-ttu-id="679f7-231">親カルチャは、適切なフォールバック カルチャとして定義されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-231">The parent culture is defined as an appropriate fallback culture.</span></span> <span data-ttu-id="679f7-232">例外をスローするよりは何らかのリソースを提供する方がよいので、親をフォールバック候補として考えます。</span><span class="sxs-lookup"><span data-stu-id="679f7-232">Consider parents as fallback candidates, because providing any resource is preferable to throwing an exception.</span></span> <span data-ttu-id="679f7-233">このプロセスでは、リソースを再利用することもできます。</span><span class="sxs-lookup"><span data-stu-id="679f7-233">This process also allows you to reuse resources.</span></span> <span data-ttu-id="679f7-234">子カルチャが要求されたリソースをローカライズする必要がない場合にのみ、親レベルで特定のリソースを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="679f7-234">You should include a particular resource at the parent level only if the child culture doesn't need to localize the requested resource.</span></span> <span data-ttu-id="679f7-235">たとえば、`en` (ニュートラル英語)、`en-GB` (イギリスで話される英語)、および `en-US` (米国で話される英語) のサテライト アセンブリを提供する場合、`en` サテライトには一般的な用語が含まれます。また、`en-GB` および `en-US` サテライトには異なる用語のみのオーバーライドが用意されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-235">For example, if you supply satellite assemblies for `en` (neutral English), `en-GB` (English as spoken in the United Kingdom), and `en-US` (English as spoken in the United States), the `en` satellite contains the common terminology, and the `en-GB` and `en-US` satellites provides overrides for only those terms that differ.</span></span>

     <span data-ttu-id="679f7-236">各カルチャの親は 1 つだけで、<xref:System.Globalization.CultureInfo.Parent%2A?displayProperty=nameWithType> プロパティによって定義されていますが、親がそれ自身の親を持つ可能性があります。</span><span class="sxs-lookup"><span data-stu-id="679f7-236">Each culture has only one parent, which is defined by the <xref:System.Globalization.CultureInfo.Parent%2A?displayProperty=nameWithType> property, but a parent might have its own parent.</span></span> <span data-ttu-id="679f7-237">カルチャの <xref:System.Globalization.CultureInfo.Parent%2A> プロパティから <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> が返されると、親カルチャの検索は停止します。</span><span class="sxs-lookup"><span data-stu-id="679f7-237">The search for parent cultures stops when a culture's <xref:System.Globalization.CultureInfo.Parent%2A> property returns <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="679f7-238">リソースのフォールバックの場合、インバリアント カルチャは、親カルチャ (つまりリソースを持つことができるカルチャ) と見なされません。</span><span class="sxs-lookup"><span data-stu-id="679f7-238">For resource fallback, the invariant culture is not considered a parent culture or a culture that can have resources.</span></span>

4. <span data-ttu-id="679f7-239">もともと指定されていたカルチャおよびすべての親を検索してもリソースが見つからない場合は、既定の (フォールバック) カルチャのリソースが使われます。</span><span class="sxs-lookup"><span data-stu-id="679f7-239">If the culture that was originally specified and all parents have been searched and the resource is still not found, the resource for the default (fallback) culture is used.</span></span> <span data-ttu-id="679f7-240">通常、既定のカルチャのリソースは、メイン アプリケーション アセンブリに格納されています。</span><span class="sxs-lookup"><span data-stu-id="679f7-240">Typically, the resources for the default culture are included in the main application assembly.</span></span> <span data-ttu-id="679f7-241">ただし、<xref:System.Resources.NeutralResourcesLanguageAttribute.Location%2A> プロパティに値 <xref:System.Resources.UltimateResourceFallbackLocation.Satellite?displayProperty.nameWithType> を指定することで、リソースの最終的なフォールバックの場所が、メイン アセンブリではなくサテライト アセンブリであることを示すことができます。</span><span class="sxs-lookup"><span data-stu-id="679f7-241">However, you can specify a value of <xref:System.Resources.UltimateResourceFallbackLocation.Satellite?displayProperty.nameWithType> for the <xref:System.Resources.NeutralResourcesLanguageAttribute.Location%2A> property to indicate that the ultimate fallback location for resources is a satellite assembly rather than the main assembly.</span></span>

    > [!NOTE]
    > <span data-ttu-id="679f7-242">既定のリソースは、メイン アセンブリでコンパイルできる唯一のリソースです。</span><span class="sxs-lookup"><span data-stu-id="679f7-242">The default resource is the only resource that can be compiled with the main assembly.</span></span> <span data-ttu-id="679f7-243"><xref:System.Resources.NeutralResourcesLanguageAttribute> 属性を使ってサテライト アセンブリを指定していない場合、最終的なフォールバック (最後の親) になります。</span><span class="sxs-lookup"><span data-stu-id="679f7-243">Unless you specify a satellite assembly by using the <xref:System.Resources.NeutralResourcesLanguageAttribute> attribute, it is the ultimate fallback (final parent).</span></span> <span data-ttu-id="679f7-244">したがって、常に既定のリソース セットをメイン アセンブリに含めることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="679f7-244">Therefore, we recommend that you always include a default set of resources in your main assembly.</span></span> <span data-ttu-id="679f7-245">これは、例外がスローされるのを防ぐのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="679f7-245">This helps prevent exceptions from being thrown.</span></span> <span data-ttu-id="679f7-246">既定のリソース ファイルを含めることにより、すべてのリソースに対してフォールバックが提供され、固有のカルチャではなくても、常に少なくとも 1 つのリソースがユーザーに存在することが保証されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-246">By including a default resource file, you provide a fallback for all resources and ensure that at least one resource is always present for the user, even if it is not culturally specific.</span></span>

5. <span data-ttu-id="679f7-247">最後に、既定の (フォールバック) カルチャのリソース ファイルが見つからない場合は、<xref:System.Resources.MissingManifestResourceException> または <xref:System.Resources.MissingSatelliteAssemblyException> 例外がスローされて、リソースが見つからなかったことが示されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-247">Finally, if the runtime doesn't find a resource file for a default (fallback) culture, a <xref:System.Resources.MissingManifestResourceException> or <xref:System.Resources.MissingSatelliteAssemblyException> exception is thrown to indicate that the resource could not be found.</span></span> <span data-ttu-id="679f7-248">リソース ファイルが見つかり、要求されたリソースが存在しない場合は、要求から `null` が返されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-248">If the resource file is found but the requested resource is not present the request returns `null`.</span></span>

### <a name="ultimate-fallback-to-satellite-assembly"></a><span data-ttu-id="679f7-249">サテライト アセンブリへの最終的なフォールバック</span><span class="sxs-lookup"><span data-stu-id="679f7-249">Ultimate Fallback to Satellite Assembly</span></span>

<span data-ttu-id="679f7-250">必要に応じて、メイン アセンブリからリソースを削除し、特定のカルチャに対応するサテライト アセンブリから最終的なフォールバック リソースを読み込む必要があることをランタイムに指定できます。</span><span class="sxs-lookup"><span data-stu-id="679f7-250">You can optionally remove resources from the main assembly and specify that the runtime should load the ultimate fallback resources from a satellite assembly that corresponds to a specific culture.</span></span> <span data-ttu-id="679f7-251">フォールバック プロセスを制御するには、<xref:System.Resources.NeutralResourcesLanguageAttribute.%23ctor%28System.String%2CSystem.Resources.UltimateResourceFallbackLocation%29> コンストラクターを使用し、リソース マネージャーがメイン アセンブリまたはサテライト アセンブリからフォールバック リソースを抽出する必要があるかどうかを指定する <xref:System.Resources.UltimateResourceFallbackLocation> パラメーターの値を指定します。</span><span class="sxs-lookup"><span data-stu-id="679f7-251">To control the fallback process, you use the <xref:System.Resources.NeutralResourcesLanguageAttribute.%23ctor%28System.String%2CSystem.Resources.UltimateResourceFallbackLocation%29> constructor and supply a value for the <xref:System.Resources.UltimateResourceFallbackLocation> parameter that specifies whether Resource Manager should extract the fallback resources from the main assembly or from a satellite assembly.</span></span>

<span data-ttu-id="679f7-252">次の .NET Framework の例では、<xref:System.Resources.NeutralResourcesLanguageAttribute> 属性を使って、フランス語 (`fr`) のサテライト アセンブリにアプリケーションのフォールバック リソースを格納しています。</span><span class="sxs-lookup"><span data-stu-id="679f7-252">The following .NET Framework example uses the <xref:System.Resources.NeutralResourcesLanguageAttribute> attribute to store an application's fallback resources in a satellite assembly for the French (`fr`) language.</span></span> <span data-ttu-id="679f7-253">この例には、`Greeting` という名前の 1 つの文字列リソースを定義するテキスト ベースのリソース ファイルが 2 つあります。</span><span class="sxs-lookup"><span data-stu-id="679f7-253">The example has two text-based resource files that define a single string resource named `Greeting`.</span></span> <span data-ttu-id="679f7-254">1 番目の resources.fr.txt には、フランス語の言語リソースが含まれています。</span><span class="sxs-lookup"><span data-stu-id="679f7-254">The first, resources.fr.txt, contains a French language resource.</span></span>

```text
Greeting=Bon jour!
```

<span data-ttu-id="679f7-255">2 番目の resources,ru.txt には、ロシア語の言語リソースが含まれています。</span><span class="sxs-lookup"><span data-stu-id="679f7-255">The second, resources,ru.txt, contains a Russian language resource.</span></span>

```text
Greeting=Добрый день
```

<span data-ttu-id="679f7-256">コマンド ラインから[リソース ファイル ジェネレーター (Resgen.exe)](../tools/resgen-exe-resource-file-generator.md) を実行することで、これら 2 つのファイルを .resources にコンパイルします。</span><span class="sxs-lookup"><span data-stu-id="679f7-256">These two files are compiled to .resources files by running the [resource file generator (Resgen.exe)](../tools/resgen-exe-resource-file-generator.md) from the command line.</span></span> <span data-ttu-id="679f7-257">フランス語リソースの場合、コマンドは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="679f7-257">For the French language resource, the command is:</span></span>

<span data-ttu-id="679f7-258">**resgen.exe resources.fr.txt**</span><span class="sxs-lookup"><span data-stu-id="679f7-258">**resgen.exe resources.fr.txt**</span></span>

<span data-ttu-id="679f7-259">ロシア語リソースの場合、コマンドは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="679f7-259">For the Russian language resource, the command is:</span></span>

<span data-ttu-id="679f7-260">**resgen.exe resources.ru.txt**</span><span class="sxs-lookup"><span data-stu-id="679f7-260">**resgen.exe resources.ru.txt**</span></span>

<span data-ttu-id="679f7-261">コマンド ラインから[アセンブリ リンカー (Al.exe)](../tools/al-exe-assembly-linker.md) を実行することにより、.resources ファイルをダイナミック リンク ライブラリに埋め込みます。フランス語リソースの場合のコマンドは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="679f7-261">The .resources files are embedded into dynamic link libraries by running [assembly linker (Al.exe)](../tools/al-exe-assembly-linker.md) from the command line for the French language resource as follows:</span></span>

<span data-ttu-id="679f7-262">**al /t:lib /embed:resources.fr.resources /culture:fr /out:fr\Example1.resources.dll**</span><span class="sxs-lookup"><span data-stu-id="679f7-262">**al /t:lib /embed:resources.fr.resources /culture:fr /out:fr\Example1.resources.dll**</span></span>

<span data-ttu-id="679f7-263">ロシア語リソースの場合のコマンドは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="679f7-263">and for the Russian language resource as follows:</span></span>

<span data-ttu-id="679f7-264">**al /t:lib /embed:resources.ru.resources /culture:ru /out:ru\Example1.resources.dll**</span><span class="sxs-lookup"><span data-stu-id="679f7-264">**al /t:lib /embed:resources.ru.resources /culture:ru /out:ru\Example1.resources.dll**</span></span>

<span data-ttu-id="679f7-265">アプリケーションのソース コードは、Example1.cs または Example1.vb という名前のファイルに存在します。</span><span class="sxs-lookup"><span data-stu-id="679f7-265">The application source code resides in a file named Example1.cs or Example1.vb.</span></span> <span data-ttu-id="679f7-266">このファイルには、既定のアプリケーション リソースが fr サブディレクトリにあることを示す <xref:System.Resources.NeutralResourcesLanguageAttribute> 属性が含まれます。</span><span class="sxs-lookup"><span data-stu-id="679f7-266">It includes the <xref:System.Resources.NeutralResourcesLanguageAttribute> attribute to indicate that the default application resource is in the fr subdirectory.</span></span> <span data-ttu-id="679f7-267">リソース マネージャーをインスタンス化し、`Greeting` リソースの値を取得して、コンソールに表示します。</span><span class="sxs-lookup"><span data-stu-id="679f7-267">It instantiates the Resource Manager, retrieves the value of the `Greeting` resource, and displays it to the console.</span></span>

[!code-csharp[Conceptual.Resources.Packaging#1](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.packaging/cs/example1.cs#1)]
[!code-vb[Conceptual.Resources.Packaging#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.packaging/vb/example1.vb#1)]

<span data-ttu-id="679f7-268">その後、次のようにコマンド ラインから C# のソース コードをコンパイルできます。</span><span class="sxs-lookup"><span data-stu-id="679f7-268">You can then compile C# source code from the command line as follows:</span></span>

```console
csc Example1.cs
```

<span data-ttu-id="679f7-269">Visual Basic コンパイラのコマンドは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="679f7-269">The command for the Visual Basic compiler is very similar:</span></span>

```console
vbc Example1.vb
```

<span data-ttu-id="679f7-270">メイン アセンブリにはリソースが埋め込まれていないため、`/resource` スイッチを使ってコンパイルする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="679f7-270">Because there are no resources embedded in the main assembly, you do not have to compile by using the `/resource` switch.</span></span>

<span data-ttu-id="679f7-271">言語がロシア語以外のシステムから例を実行すると、次の出力が表示されます。</span><span class="sxs-lookup"><span data-stu-id="679f7-271">When you run the example from a system whose language is anything other than Russian, it displays the following output:</span></span>

```output
Bon jour!
```

## <a name="suggested-packaging-alternative"></a><span data-ttu-id="679f7-272">推奨されるパッケージ化の代替方法</span><span class="sxs-lookup"><span data-stu-id="679f7-272">Suggested Packaging Alternative</span></span>

<span data-ttu-id="679f7-273">時間や予算の制約により、アプリケーションがサポートするすべてのサブカルチャのリソース セットを作成できない場合があります。</span><span class="sxs-lookup"><span data-stu-id="679f7-273">Time or budget constraints might prevent you from creating a set of resources for every subculture that your application supports.</span></span> <span data-ttu-id="679f7-274">そのような場合は、関連のあるすべてのサブカルチャで使うことができる親カルチャ用の単一のサテライト アセンブリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="679f7-274">Instead, you can create a single satellite assembly for a parent culture that all related subcultures can use.</span></span> <span data-ttu-id="679f7-275">たとえば、地域固有の英語リソースを要求するユーザーによって取得される単一の英語サテライト アセンブリ (en) と、地域固有のドイツ語リソースを要求するユーザー用の単一のドイツ語サテライト アセンブリ (de) を提供することができます。</span><span class="sxs-lookup"><span data-stu-id="679f7-275">For example, you can provide a single English satellite assembly (en) that is retrieved by users who request region-specific English resources, and a single German satellite assembly (de) for users who request region-specific German resources.</span></span> <span data-ttu-id="679f7-276">たとえば、ドイツ (de-DE)、オーストリア (de-AT)、スイス (de-CH) で話されるドイツ語の要求は、ドイツ語のサテライト アセンブリ (de) にフォールバックします。</span><span class="sxs-lookup"><span data-stu-id="679f7-276">For example, requests for German as spoken in Germany (de-DE), Austria (de-AT), and Switzerland (de-CH) would fall back to the German satellite assembly (de).</span></span> <span data-ttu-id="679f7-277">既定のリソースは最終的なフォールバックであり、アプリケーションのほとんどのユーザーによって要求されるリソースであるため、これらのリソースは慎重に選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="679f7-277">The default resources are the final fallback and therefore should be the resources that will be requested by the majority of your application's users, so choose these resources carefully.</span></span> <span data-ttu-id="679f7-278">この方法では、カルチャ固有性の低いリソースが配置されますが、アプリケーションのローカライズ費用を大幅に削減できます。</span><span class="sxs-lookup"><span data-stu-id="679f7-278">This approach deploys resources that are less culturally specific, but can significantly reduce your application's localization costs.</span></span>

## <a name="see-also"></a><span data-ttu-id="679f7-279">関連項目</span><span class="sxs-lookup"><span data-stu-id="679f7-279">See also</span></span>

- [<span data-ttu-id="679f7-280">デスクトップ アプリのリソース</span><span class="sxs-lookup"><span data-stu-id="679f7-280">Resources in Desktop Apps</span></span>](index.md)
- [<span data-ttu-id="679f7-281">グローバル アセンブリ キャッシュ</span><span class="sxs-lookup"><span data-stu-id="679f7-281">Global Assembly Cache</span></span>](../app-domains/gac.md)
- [<span data-ttu-id="679f7-282">リソース ファイルの作成</span><span class="sxs-lookup"><span data-stu-id="679f7-282">Creating Resource Files</span></span>](creating-resource-files-for-desktop-apps.md)
- [<span data-ttu-id="679f7-283">サテライト アセンブリの作成</span><span class="sxs-lookup"><span data-stu-id="679f7-283">Creating Satellite Assemblies</span></span>](creating-satellite-assemblies-for-desktop-apps.md)
