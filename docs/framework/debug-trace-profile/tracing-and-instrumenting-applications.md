---
title: アプリケーションのトレースとインストルメント化
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- tracing [.NET Framework]
- debugging [.NET Framework], instrumentation
- performance monitoring, instrumentation
- instrumentation, about instrumentation
- tracing [.NET Framework], about tracing
- performance monitoring, tracing code
- Trace class, instrumentation for .NET applications
ms.assetid: 773b6fc4-9013-4322-b728-5dec7a72e743
author: mairaw
ms.author: mairaw
ms.openlocfilehash: 9e1b8d5cb25445ffc3ce08e8c73e1d3742067e21
ms.sourcegitcommit: 5a28f8eb071fcc09b045b0c4ae4b96898673192e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/31/2019
ms.locfileid: "73196710"
---
# <a name="tracing-and-instrumenting-applications"></a><span data-ttu-id="30f23-102">アプリケーションのトレースとインストルメント化</span><span class="sxs-lookup"><span data-stu-id="30f23-102">Tracing and Instrumenting Applications</span></span>
<span data-ttu-id="30f23-103">トレースとは、実行中のアプリケーションの実行状態を監視する方法です。</span><span class="sxs-lookup"><span data-stu-id="30f23-103">Tracing is a way for you to monitor the execution of your application while it is running.</span></span> <span data-ttu-id="30f23-104">.NET Framework アプリケーションの開発時に、トレースとデバッグのインストルメンテーションをアプリケーションに追加できます。このインストルメンテーションは、アプリケーションの開発中でも開発したアプリケーションの配置後でも使用できます。</span><span class="sxs-lookup"><span data-stu-id="30f23-104">You can add tracing and debugging instrumentation to your .NET Framework application when you develop it, and you can use that instrumentation both while you are developing the application and after you have deployed it.</span></span> <span data-ttu-id="30f23-105"><xref:System.Diagnostics.Trace?displayProperty=nameWithType>、<xref:System.Diagnostics.Debug?displayProperty=nameWithType>、および <xref:System.Diagnostics.TraceSource?displayProperty=nameWithType> の各クラスを使用すると、エラーおよびアプリケーションの実行についての情報を後で分析するために、ログ、テキスト ファイル、またはその他のデバイスに記録できます。</span><span class="sxs-lookup"><span data-stu-id="30f23-105">You can use the <xref:System.Diagnostics.Trace?displayProperty=nameWithType>, <xref:System.Diagnostics.Debug?displayProperty=nameWithType>, and <xref:System.Diagnostics.TraceSource?displayProperty=nameWithType> classes to record information about errors and application execution in logs, text files, or other devices for later analysis.</span></span>  
  
 <span data-ttu-id="30f23-106">ここでの*インストルメンテーション*という用語は、製品のパフォーマンスのレベルを監視または測定し、エラーを診断する具体的な機能を意味しています。</span><span class="sxs-lookup"><span data-stu-id="30f23-106">The term *instrumentation* refers to an ability to monitor or measure the level of a product's performance and to diagnose errors.</span></span> <span data-ttu-id="30f23-107">プログラミングでは、組み込むアプリケーションの機能を指します。</span><span class="sxs-lookup"><span data-stu-id="30f23-107">In programming, this means the ability of an application to incorporate:</span></span>  
  
- <span data-ttu-id="30f23-108">**コードのトレース** - 実行時に、アプリケーションの実行状態について示すメッセージを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="30f23-108">**Code tracing** - Receiving informative messages about the execution of an application at run time.</span></span>  
  
- <span data-ttu-id="30f23-109">**デバッグ** - 開発中のアプリケーションのプログラミング エラーを追跡して修正します。</span><span class="sxs-lookup"><span data-stu-id="30f23-109">**Debugging** - Tracking down and fixing programming errors in an application under development.</span></span> <span data-ttu-id="30f23-110">詳細については、「[デバッグ](/visualstudio/debugger/debugger-feature-tour)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-110">For more information, see [Debugging](/visualstudio/debugger/debugger-feature-tour).</span></span>  
  
- <span data-ttu-id="30f23-111">**パフォーマンス カウンター** - アプリケーションのパフォーマンスを追跡するためのコンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="30f23-111">**Performance counters** - Components that allow you to track the performance of your application.</span></span> <span data-ttu-id="30f23-112">詳細については、「[パフォーマンス カウンター](performance-counters.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-112">For more information, see [Performance Counters](performance-counters.md).</span></span>  
  
- <span data-ttu-id="30f23-113">**イベント ログ** - アプリケーションの実行中に発生した重要なイベントを受け取って追跡するためのコンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="30f23-113">**Event logs** - Components that allow you receive and track major events in the execution of your application.</span></span> <span data-ttu-id="30f23-114">詳細については、<xref:System.Diagnostics.EventLog> クラスを参照してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-114">For more information, see the <xref:System.Diagnostics.EventLog> class.</span></span>  
  
 <span data-ttu-id="30f23-115">トレース ステートメントをコード内に計画的に配置することによってアプリケーションをインストルメントすることは、分散アプリケーションでは特に便利です。</span><span class="sxs-lookup"><span data-stu-id="30f23-115">Instrumenting your application by placing trace statements at strategic locations in your code is especially useful for distributed applications.</span></span> <span data-ttu-id="30f23-116">トレース ステートメントを使用してアプリケーションをインストルメントすると、不適切な動作についての情報を表示できるだけでなく、アプリケーションの実行状態を監視するための情報も表示できます。</span><span class="sxs-lookup"><span data-stu-id="30f23-116">By using trace statements you can instrument an application not only to display information when things go wrong, but also to monitor how well the application is performing.</span></span>  
  
 <span data-ttu-id="30f23-117"><xref:System.Diagnostics.TraceSource> クラスは拡張されたトレース機能を備えており、以前の <xref:System.Diagnostics.Trace> トレース クラスと <xref:System.Diagnostics.Debug> トレース クラスの静的メソッドの代わりに使用できます。</span><span class="sxs-lookup"><span data-stu-id="30f23-117">The <xref:System.Diagnostics.TraceSource> class provides enhanced tracing features and can be used in place of the static methods of the older <xref:System.Diagnostics.Trace> and <xref:System.Diagnostics.Debug> tracing classes.</span></span> <span data-ttu-id="30f23-118">従来の <xref:System.Diagnostics.Trace> クラスと <xref:System.Diagnostics.Debug> クラスも引き続き広く使用されますが、<xref:System.Diagnostics.TraceSource.TraceEvent%2A> や <xref:System.Diagnostics.TraceSource.TraceData%2A> などの新しいトレース コマンドには <xref:System.Diagnostics.TraceSource> クラスが推奨されます。</span><span class="sxs-lookup"><span data-stu-id="30f23-118">The familiar <xref:System.Diagnostics.Trace> and <xref:System.Diagnostics.Debug> classes are still widely used, but the <xref:System.Diagnostics.TraceSource> class is recommended for new tracing commands, such as <xref:System.Diagnostics.TraceSource.TraceEvent%2A> and <xref:System.Diagnostics.TraceSource.TraceData%2A>.</span></span>  
  
 <span data-ttu-id="30f23-119"><xref:System.Diagnostics.Trace> と <xref:System.Diagnostics.Debug> はほぼ同一のクラスですが、<xref:System.Diagnostics.Trace> クラスのプロシージャおよび関数は既定でリリース ビルドにコンパイルされる点が <xref:System.Diagnostics.Debug> クラスのプロシージャおよび関数と異なります。</span><span class="sxs-lookup"><span data-stu-id="30f23-119">The <xref:System.Diagnostics.Trace> and <xref:System.Diagnostics.Debug> classes are identical, except that procedures and functions of the <xref:System.Diagnostics.Trace> class are compiled by default into release builds, but those of the <xref:System.Diagnostics.Debug> class are not.</span></span>  
  
 <span data-ttu-id="30f23-120"><xref:System.Diagnostics.Trace> クラスおよび <xref:System.Diagnostics.Debug> クラスは、アプリケーションの開発中または配置後に、アプリケーションのパフォーマンスをモニターおよび検査する手段を提供します。</span><span class="sxs-lookup"><span data-stu-id="30f23-120">The <xref:System.Diagnostics.Trace> and <xref:System.Diagnostics.Debug> classes provide the means to monitor and examine application performance either during development or after deployment.</span></span> <span data-ttu-id="30f23-121">たとえば、(新しいデータベース接続の作成など) が配置されたアプリケーションの操作の特定の種類を追跡するために <xref:System.Diagnostics.Trace> クラスを使用すると、アプリケーションの効率を監視できるようになります。</span><span class="sxs-lookup"><span data-stu-id="30f23-121">For example, you can use the <xref:System.Diagnostics.Trace> class to track particular types of actions in a deployed application as they occur (for example, creation of new database connections), and can therefore monitor the application's efficiency.</span></span>  
  
## <a name="code-tracing-and-debugging"></a><span data-ttu-id="30f23-122">コードのトレースとデバッグ</span><span class="sxs-lookup"><span data-stu-id="30f23-122">Code Tracing and Debugging</span></span>  
 <span data-ttu-id="30f23-123">開発時に、Visual Studio 統合開発環境 (IDE) の出力ウィンドウにメッセージを表示するために <xref:System.Diagnostics.Debug> クラスの出力メソッドを使用できます。</span><span class="sxs-lookup"><span data-stu-id="30f23-123">During development, you can use the output methods of the <xref:System.Diagnostics.Debug> class to display messages in the Output window of the Visual Studio integrated development environment (IDE).</span></span> <span data-ttu-id="30f23-124">次に例を示します。</span><span class="sxs-lookup"><span data-stu-id="30f23-124">For example:</span></span>  
  
```vb  
Trace.WriteLine("Hello World!")  
Debug.WriteLine("Hello World!")  
```  
  
```csharp  
System.Diagnostics.Trace.WriteLine("Hello World!");  
System.Diagnostics.Debug.WriteLine("Hello World!");  
```  
  
 <span data-ttu-id="30f23-125">いずれの例でも、デバッガーで</span><span class="sxs-lookup"><span data-stu-id="30f23-125">Each of these examples will display "Hello World!"</span></span> <span data-ttu-id="30f23-126">アプリケーションを実行したとき、出力ウィンドウに "Hello World!" が表示されます。</span><span class="sxs-lookup"><span data-stu-id="30f23-126">in the Output window when the application is run in the debugger.</span></span>  
  
 <span data-ttu-id="30f23-127">これにより、アプリケーションをデバッグし、テスト環境での動作に基づいてアプリケーションのパフォーマンスを最適化できます。</span><span class="sxs-lookup"><span data-stu-id="30f23-127">This enables you to debug your applications and optimize their performance based on their behavior in your test environment.</span></span> <span data-ttu-id="30f23-128">すべてのデバッグ出力を受け取ることができるよう、<xref:System.Diagnostics.Debug> 条件属性をオンにしてデバッグ ビルドでアプリケーションをデバッグできます。</span><span class="sxs-lookup"><span data-stu-id="30f23-128">You can debug your application in your debug build with the <xref:System.Diagnostics.Debug> conditional attribute turned on so that you receive all debugging output.</span></span> <span data-ttu-id="30f23-129">アプリケーションのリリースの準備が整ったら、コンパイラが最終的な実行可能ファイルにデバッグ コードを含めないように <xref:System.Diagnostics.Debug> の条件属性をオンにしないでリリース ビルドをコンパイルできます。</span><span class="sxs-lookup"><span data-stu-id="30f23-129">When your application is ready for release, you can compile your release build without turning on the <xref:System.Diagnostics.Debug> conditional attribute, so that the compiler will not include your debugging code in the final executable.</span></span> <span data-ttu-id="30f23-130">詳細については、[トレースとデバッグを指定して条件付きコンパイルを実行する](how-to-compile-conditionally-with-trace-and-debug.md)。</span><span class="sxs-lookup"><span data-stu-id="30f23-130">For more information, see [How to: Compile Conditionally with Trace and Debug](how-to-compile-conditionally-with-trace-and-debug.md).</span></span> <span data-ttu-id="30f23-131">アプリケーションのさまざまなビルド構成の詳細については、「[Compiling and Building](/visualstudio/ide/compiling-and-building-in-visual-studio)」(コンパイルとビルド) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-131">For more information on different build configurations for your application, see [Compiling and Building](/visualstudio/ide/compiling-and-building-in-visual-studio).</span></span>  
  
 <span data-ttu-id="30f23-132"><xref:System.Diagnostics.Trace> クラスのメソッドを使用してインストールされたアプリケーションのコード実行をトレースすることもできます。</span><span class="sxs-lookup"><span data-stu-id="30f23-132">You can also trace code execution in an installed application, using methods of the <xref:System.Diagnostics.Trace> class.</span></span> <span data-ttu-id="30f23-133">コードに[トレース スイッチ](trace-switches.md)を配置することで、トレースが実行されるかどうかと、その対象範囲について、制御することができます。</span><span class="sxs-lookup"><span data-stu-id="30f23-133">By placing [Trace Switches](trace-switches.md) in your code, you can control whether tracing occurs and how extensive it is.</span></span> <span data-ttu-id="30f23-134">これにより、運用環境におけるアプリケーションのステータスを監視できます。</span><span class="sxs-lookup"><span data-stu-id="30f23-134">This lets you monitor the status of your application in a production environment.</span></span> <span data-ttu-id="30f23-135">複数のコンポーネントが複数のコンピューターで実行されるビジネス アプリケーションでは、この監視が特に重要です。</span><span class="sxs-lookup"><span data-stu-id="30f23-135">This is especially important in a business application that uses multiple components running on multiple computers.</span></span> <span data-ttu-id="30f23-136">配置後のスイッチの機能は、構成ファイルで制御できます。</span><span class="sxs-lookup"><span data-stu-id="30f23-136">You can control how the switches are used after deployment through the configuration file.</span></span> <span data-ttu-id="30f23-137">詳細については、[トレーススイッチを作成、初期化、および構成](how-to-create-initialize-and-configure-trace-switches.md)ます。</span><span class="sxs-lookup"><span data-stu-id="30f23-137">For more information, see [How to: Create, Initialize and Configure Trace Switches](how-to-create-initialize-and-configure-trace-switches.md).</span></span>  
  
 <span data-ttu-id="30f23-138">トレースを使用するアプリケーションの開発時には、通常、アプリケーション コードにトレース メッセージとデバッグ メッセージの両方を組み込みます。</span><span class="sxs-lookup"><span data-stu-id="30f23-138">When you are developing an application for which you intend to use tracing, you usually include both tracing and debugging messages in the application code.</span></span> <span data-ttu-id="30f23-139">アプリケーションを配置する準備が整ったら、**Debug** 条件属性をオンにせずに、リリース ビルドをコンパイルできます。</span><span class="sxs-lookup"><span data-stu-id="30f23-139">When you are ready to deploy the application, you can compile your release build without turning on the **Debug** conditional attribute.</span></span> <span data-ttu-id="30f23-140">ただし、**Trace** 条件属性をオンにして、コンパイラがトレース コードを実行可能ファイルに組み込むようにすることもできます。</span><span class="sxs-lookup"><span data-stu-id="30f23-140">However, you can turn on the **Trace** conditional attribute so that the compiler includes your trace code in the executable.</span></span> <span data-ttu-id="30f23-141">詳細については、[トレースとデバッグを指定して条件付きコンパイルを実行する](how-to-compile-conditionally-with-trace-and-debug.md)。</span><span class="sxs-lookup"><span data-stu-id="30f23-141">For more information, see [How to: Compile Conditionally with Trace and Debug](how-to-compile-conditionally-with-trace-and-debug.md).</span></span>  
  
### <a name="phases-of-code-tracing"></a><span data-ttu-id="30f23-142">コードのトレースの段階</span><span class="sxs-lookup"><span data-stu-id="30f23-142">Phases of Code Tracing</span></span>  
 <span data-ttu-id="30f23-143">コードのトレースには、次の 3 つの段階があります。</span><span class="sxs-lookup"><span data-stu-id="30f23-143">There are three phases of code tracing:</span></span>  
  
1. <span data-ttu-id="30f23-144">**インストルメンテーション** - トレース コードをアプリケーションに追加します。</span><span class="sxs-lookup"><span data-stu-id="30f23-144">**Instrumentation** — you add trace code to your application.</span></span>  
  
2. <span data-ttu-id="30f23-145">**トレース** - トレース コードが、指定された場所に情報を書き込みます。</span><span class="sxs-lookup"><span data-stu-id="30f23-145">**Tracing** — the tracing code writes information to the specified target.</span></span>  
  
3. <span data-ttu-id="30f23-146">**分析** - トレース情報を分析して、アプリケーションの問題を識別および理解します。</span><span class="sxs-lookup"><span data-stu-id="30f23-146">**Analysis** — you evaluate the tracing information to identify and understand problems in the application.</span></span>  
  
 <span data-ttu-id="30f23-147">既定の設定では、開発中は、すべてのデバッグ出力メソッドおよびトレース出力メソッドが、Visual Studio の出力ウィンドウに情報を書き込みます。</span><span class="sxs-lookup"><span data-stu-id="30f23-147">During development, all debug and trace output methods write information to the Output window in Visual Studio by default.</span></span> <span data-ttu-id="30f23-148">配置後のアプリケーションでは、メソッドは指定された場所にトレース情報を書き込みます。</span><span class="sxs-lookup"><span data-stu-id="30f23-148">In a deployed application, the methods write tracing information to the targets you specify.</span></span> <span data-ttu-id="30f23-149">トレースまたはデバッグの出力対象を指定する詳細については、「[トレース リスナー](trace-listeners.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-149">For more information on specifying an output target for tracing or debugging, see [Trace Listeners](trace-listeners.md).</span></span>  
  
 <span data-ttu-id="30f23-150">配置されたアプリケーションで起こりうる問題を、トレースを使用して分析したり修正したりするためにしばしば使用される主要な手順を次に示します。</span><span class="sxs-lookup"><span data-stu-id="30f23-150">The following is an overall view of the major steps typically involved in using tracing to analyze and correct potential problems in deployed applications.</span></span> <span data-ttu-id="30f23-151">これらの手順を実行する方法の詳細については、適切なリンクを参照してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-151">For more information on how to perform these steps, see the appropriate link.</span></span>  
  
##### <a name="to-use-tracing-in-an-application"></a><span data-ttu-id="30f23-152">アプリケーションでトレースを使用するには</span><span class="sxs-lookup"><span data-stu-id="30f23-152">To use tracing in an application</span></span>  
  
1. <span data-ttu-id="30f23-153">アプリケーションを配置した後で受け取るトレース出力の種類を検討します。</span><span class="sxs-lookup"><span data-stu-id="30f23-153">Consider which tracing output you will want to receive onsite after you have deployed the application.</span></span>  
  
2. <span data-ttu-id="30f23-154">スイッチのセットを作成します。</span><span class="sxs-lookup"><span data-stu-id="30f23-154">Create a set of switches.</span></span> <span data-ttu-id="30f23-155">詳細については、[トレーススイッチ](how-to-create-initialize-and-configure-trace-switches.md)を構成します。</span><span class="sxs-lookup"><span data-stu-id="30f23-155">For more information, see [How to: Configure Trace Switches](how-to-create-initialize-and-configure-trace-switches.md).</span></span>  
  
3. <span data-ttu-id="30f23-156">アプリケーションのコードにトレース ステートメントを追加します。</span><span class="sxs-lookup"><span data-stu-id="30f23-156">Add the trace statements to the application code.</span></span>  
  
4. <span data-ttu-id="30f23-157">トレース出力を表示する場所を決定し、適切なリスナーを追加します。</span><span class="sxs-lookup"><span data-stu-id="30f23-157">Determine where you want the tracing output to appear and add the appropriate listeners.</span></span> <span data-ttu-id="30f23-158">詳細については「[トレース リスナーの作成と初期化](how-to-create-and-initialize-trace-listeners.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-158">For more information, see [Creating and Initializing Trace Listeners](how-to-create-and-initialize-trace-listeners.md).</span></span>  
  
5. <span data-ttu-id="30f23-159">アプリケーションおよびそのアプリケーションに含まれるトレース コードをテストおよびデバッグします。</span><span class="sxs-lookup"><span data-stu-id="30f23-159">Test and debug your application and the tracing code it contains.</span></span>  
  
6. <span data-ttu-id="30f23-160">次のいずれかのプロシージャを使用して、アプリケーションを実行可能なコードにコンパイルします。</span><span class="sxs-lookup"><span data-stu-id="30f23-160">Compile the application into executable code using one of the following procedures:</span></span>  
  
    - <span data-ttu-id="30f23-161">**ソリューション エクスプローラー**の **[プロパティ ページ]** ダイアログ ボックスの **[デバッグ]** ページで **[ビルド]** メニューを使用します。</span><span class="sxs-lookup"><span data-stu-id="30f23-161">Use the **Build** menu along with the **Debug** page of the **Property Pages** dialog box in **Solution Explorer**.</span></span> <span data-ttu-id="30f23-162">Visual Studio でコンパイルをする場合は、この方法を使用してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-162">Use this when compiling in Visual Studio.</span></span>  
  
         <span data-ttu-id="30f23-163">\- または</span><span class="sxs-lookup"><span data-stu-id="30f23-163">\- or -</span></span>  
  
    - <span data-ttu-id="30f23-164">コマンド ラインによるコンパイル用の **Trace** コンパイラ ディレクティブおよび **Debug** コンパイラ ディレクティブを使用します。</span><span class="sxs-lookup"><span data-stu-id="30f23-164">Use the **Trace** and **Debug** compiler directives for the command-line method of compiling.</span></span> <span data-ttu-id="30f23-165">詳細については、「[トレースとデバッグによる条件付きコンパイル](how-to-compile-conditionally-with-trace-and-debug.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-165">For more information, see [Compiling Conditionally with Trace and Debug](how-to-compile-conditionally-with-trace-and-debug.md).</span></span> <span data-ttu-id="30f23-166">コマンド ラインからコンパイルする場合はこの方法を使用してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-166">Use this when compiling from the command line.</span></span>  
  
7. <span data-ttu-id="30f23-167">問題が実行時に発生する場合は、適切なトレース スイッチをオンにしてください。</span><span class="sxs-lookup"><span data-stu-id="30f23-167">If a problem occurs during run time, turn on the appropriate trace switch.</span></span> <span data-ttu-id="30f23-168">詳細については、「[トレース スイッチを設定する](how-to-create-initialize-and-configure-trace-switches.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-168">For more information, see [Configuring Trace Switches](how-to-create-initialize-and-configure-trace-switches.md).</span></span>  
  
     <span data-ttu-id="30f23-169">トレース コードは、指定された場所 (画面、テキスト ファイル、イベント ログなど) にトレース メッセージを書き込みます。</span><span class="sxs-lookup"><span data-stu-id="30f23-169">The tracing code writes tracing messages to a specified target, for example, a screen, a text file, or an event log.</span></span> <span data-ttu-id="30f23-170">**Trace.Listeners** コレクションに含めたリスナーの種類によって、この場所が決定されます。</span><span class="sxs-lookup"><span data-stu-id="30f23-170">The type of listener you included in the **Trace.Listeners** collection determines the target.</span></span>  
  
8. <span data-ttu-id="30f23-171">トレース メッセージを分析して、アプリケーションの問題を識別および理解します。</span><span class="sxs-lookup"><span data-stu-id="30f23-171">Analyze the tracing messages to identify and understand the problem in the application.</span></span>  
  
## <a name="trace-instrumentation-and-distributed-applications"></a><span data-ttu-id="30f23-172">トレースの実装および分散アプリケーション</span><span class="sxs-lookup"><span data-stu-id="30f23-172">Trace Instrumentation and Distributed Applications</span></span>  
 <span data-ttu-id="30f23-173">分散アプリケーションを作成するときに、アプリケーションが使用される環境でテストをすることが難しい場合があります。</span><span class="sxs-lookup"><span data-stu-id="30f23-173">When you create a distributed application, you might find it difficult to test the application in the manner in which it will be used.</span></span> <span data-ttu-id="30f23-174">オペレーティング システムや Web ブラウザーのすべての組み合わせ (ローカライズ言語オプションのすべてのケースも含む) をテストしたり、アプリケーションに同時にアクセスする最大ユーザー数をシミュレートしたりできる開発チームはほとんどありません。</span><span class="sxs-lookup"><span data-stu-id="30f23-174">Few development teams have the capability to test all possible combinations of operating systems or Web browsers (including all the localized language options), or to simulate the high number of users that will access the application at the same time.</span></span> <span data-ttu-id="30f23-175">このため、大量の情報、異なる設定、エンド ユーザー固有の動作などの要因に対して分散アプリケーションがどのように応答するかをテストすることはできません。</span><span class="sxs-lookup"><span data-stu-id="30f23-175">Under these circumstances, you cannot test how a distributed application will respond to high volumes, different setups, and unique end-user behaviors.</span></span> <span data-ttu-id="30f23-176">また、分散アプリケーションを構成する要素の大半には、直接対話したりこれらの構成要素の利用状況を表示したりするためのユーザー インターフェイスは備わっていません。</span><span class="sxs-lookup"><span data-stu-id="30f23-176">Also, many parts of a distributed application have no user interface with which you can interact directly or view the activity of those parts.</span></span>  
  
 <span data-ttu-id="30f23-177">ただし、アプリケーションの*実装* (つまりコード内にトレース ステートメントを計画的に配置すること) によって、分散アプリケーションが特定のイベント、特に不当な動作をシステム管理者に説明できるようにすることにより補うことができます。</span><span class="sxs-lookup"><span data-stu-id="30f23-177">However, you can compensate for this by enabling distributed applications to describe certain events of interest to system administrators, especially things that go wrong, by *instrumenting* the application — that is, by placing trace statements at strategic locations in your code.</span></span> <span data-ttu-id="30f23-178">これにより、予測不可能な動作 (極度に遅い応答時間など) が実行時に発生した場合でも、原因を判断できます。</span><span class="sxs-lookup"><span data-stu-id="30f23-178">Then if something unexpected occurs at run time (for example, excessively slow response time), you can determine the likely cause.</span></span>  
  
 <span data-ttu-id="30f23-179">トレース ステートメントを使用すると、オリジナル ソース コードを検査、変更、および再コンパイルしたり、デバッグ環境で実行時エラーを生成したりするなど、困難なタスクを避けることができます。</span><span class="sxs-lookup"><span data-stu-id="30f23-179">With trace statements you can avoid the difficult task of examining the original source code, modifying it, recompiling, and attempting to produce the run-time error within the debugging environment.</span></span> <span data-ttu-id="30f23-180">アプリケーションの実装は、エラーの表示だけでなく、パフォーマンスを監視するためにもすることができます。</span><span class="sxs-lookup"><span data-stu-id="30f23-180">Remember that you can instrument an application not only to display errors, but also to monitor performance.</span></span>  
  
## <a name="strategic-placement-of-trace-statements"></a><span data-ttu-id="30f23-181">トレース ステートメントの計画的な配置</span><span class="sxs-lookup"><span data-stu-id="30f23-181">Strategic Placement of Trace Statements</span></span>  
 <span data-ttu-id="30f23-182">実行時に使用するトレース ステートメントを配置するときには、十分に注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="30f23-182">You must exercise special care when placing your trace statements for use during run time.</span></span> <span data-ttu-id="30f23-183">考えられるすべてのトレース シナリオが適切に処理されるように、配置されるアプリケーションで必要とされるトレース情報を考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="30f23-183">You must consider what tracing information is likely to be needed in a deployed application, so that all likely tracing scenarios are adequately covered.</span></span> <span data-ttu-id="30f23-184">しかし、トレースを使用するアプリケーションは多岐にわたっており、トレースの計画的な配置にあたっての一般的なガイドラインはありません。</span><span class="sxs-lookup"><span data-stu-id="30f23-184">Because applications that use tracing vary widely, however, there are no general guidelines for strategic placement of tracing.</span></span> <span data-ttu-id="30f23-185">トレースステートメントの配置の詳細については、「[方法:トレースステートメントをアプリケーションコード](how-to-add-trace-statements-to-application-code.md)に追加します。</span><span class="sxs-lookup"><span data-stu-id="30f23-185">For more information on placing trace statements, see [How to: Add Trace Statements to Application Code](how-to-add-trace-statements-to-application-code.md).</span></span>  
  
## <a name="output-from-tracing"></a><span data-ttu-id="30f23-186">トレースの出力</span><span class="sxs-lookup"><span data-stu-id="30f23-186">Output from Tracing</span></span>  
 <span data-ttu-id="30f23-187">トレースの出力は*リスナー*と呼ばれるオブジェクトによって収集されます。</span><span class="sxs-lookup"><span data-stu-id="30f23-187">Trace output is collected by objects called *listeners*.</span></span> <span data-ttu-id="30f23-188">リスナーは、トレースの出力を受け取り、出力デバイス (通常は、ウィンドウ、ログ、またはテキスト ファイル) に書き込むためのオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="30f23-188">A listener is an object that receives trace output and writes it to an output device (usually a window, log, or text file).</span></span> <span data-ttu-id="30f23-189">トレース リスナーが作成されると、多くの場合、<xref:System.Diagnostics.Trace.Listeners%2A?displayProperty=nameWithType> のコレクションに追加され、リスナーがすべてのトレース出力を受け取ることを許可します。</span><span class="sxs-lookup"><span data-stu-id="30f23-189">When a trace listener is created, it is typically added to the <xref:System.Diagnostics.Trace.Listeners%2A?displayProperty=nameWithType> collection, allowing the listener to receive all trace output.</span></span>  
  
 <span data-ttu-id="30f23-190">トレース情報は、既定の <xref:System.Diagnostics.Trace> の出力対象、<xref:System.Diagnostics.DefaultTraceListener> に少なくとも常に書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="30f23-190">Tracing information is always written at least to the default <xref:System.Diagnostics.Trace> output target, the <xref:System.Diagnostics.DefaultTraceListener>.</span></span> <span data-ttu-id="30f23-191">なんらかの理由 <xref:System.Diagnostics.Trace.Listeners%2A> のコレクションに他のリスナーを追加せずに <xref:System.Diagnostics.DefaultTraceListener> を削除する場合、トレース メッセージは表示されません。</span><span class="sxs-lookup"><span data-stu-id="30f23-191">If for some reason you have deleted the <xref:System.Diagnostics.DefaultTraceListener> without adding any other listeners to the <xref:System.Diagnostics.Trace.Listeners%2A> collection, you will not receive any tracing messages.</span></span> <span data-ttu-id="30f23-192">詳細については、「[トレース リスナー](trace-listeners.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-192">For more information, see [Trace Listeners](trace-listeners.md).</span></span>  
  
 <span data-ttu-id="30f23-193">トレース情報を書き込む <xref:System.Diagnostics.Trace> の <xref:System.Diagnostics.Debug> の 6 種類のメンバーとメソッドを次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="30f23-193">The six <xref:System.Diagnostics.Debug> members and <xref:System.Diagnostics.Trace> methods that write tracing information are listed in the following table.</span></span>  
  
|<span data-ttu-id="30f23-194">メソッド</span><span class="sxs-lookup"><span data-stu-id="30f23-194">Method</span></span>|<span data-ttu-id="30f23-195">[出力]</span><span class="sxs-lookup"><span data-stu-id="30f23-195">Output</span></span>|  
|------------|------------|  
|<span data-ttu-id="30f23-196">**Assert**</span><span class="sxs-lookup"><span data-stu-id="30f23-196">**Assert**</span></span>|<span data-ttu-id="30f23-197">指定されたテキスト。何も指定されない場合は、呼び出し履歴。</span><span class="sxs-lookup"><span data-stu-id="30f23-197">The specified text; or, if none is specified, the Call Stack.</span></span> <span data-ttu-id="30f23-198">**Assert** ステートメントの引数として指定された条件が **false** の場合にだけ、出力が書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="30f23-198">The output is written only if the condition specified as an argument in the **Assert** statement is **false**.</span></span>|  
|<span data-ttu-id="30f23-199">**失敗**</span><span class="sxs-lookup"><span data-stu-id="30f23-199">**Fail**</span></span>|<span data-ttu-id="30f23-200">指定されたテキスト。何も指定されない場合は、呼び出し履歴。</span><span class="sxs-lookup"><span data-stu-id="30f23-200">The specified text; or, if none is specified, the Call Stack.</span></span>|  
|<span data-ttu-id="30f23-201">**Write**</span><span class="sxs-lookup"><span data-stu-id="30f23-201">**Write**</span></span>|<span data-ttu-id="30f23-202">指定されたテキスト。</span><span class="sxs-lookup"><span data-stu-id="30f23-202">The specified text.</span></span>|  
|<span data-ttu-id="30f23-203">**WriteIf**</span><span class="sxs-lookup"><span data-stu-id="30f23-203">**WriteIf**</span></span>|<span data-ttu-id="30f23-204">指定されたテキスト。**WriteIf** ステートメントの引数として指定された条件が満たされた場合にだけ出力されます。</span><span class="sxs-lookup"><span data-stu-id="30f23-204">The specified text, if the condition specified as an argument in the **WriteIf** statement is satisfied.</span></span>|  
|<span data-ttu-id="30f23-205">**WriteLine**</span><span class="sxs-lookup"><span data-stu-id="30f23-205">**WriteLine**</span></span>|<span data-ttu-id="30f23-206">指定されたテキストおよびキャリッジ リターン。</span><span class="sxs-lookup"><span data-stu-id="30f23-206">The specified text and a carriage return.</span></span>|  
|<span data-ttu-id="30f23-207">**WriteLineIf**</span><span class="sxs-lookup"><span data-stu-id="30f23-207">**WriteLineIf**</span></span>|<span data-ttu-id="30f23-208">指定されたテキストおよびキャリッジ リターン。**WriteLineIf** ステートメントの引数として指定された条件が満たされた場合にだけ出力されます。</span><span class="sxs-lookup"><span data-stu-id="30f23-208">The specified text and a carriage return, if the condition specified as an argument in the **WriteLineIf** statement is satisfied.</span></span>|  
  
 <span data-ttu-id="30f23-209"><xref:System.Diagnostics.Trace.Listeners%2A> のコレクションのすべてのリスナーは、上の表で説明したメッセージを受け取りますが、取られるアクションは、どのリスナーがメッセージを受け取るかによって異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="30f23-209">All listeners in the <xref:System.Diagnostics.Trace.Listeners%2A> collection receive the messages described in the above table, but the actions taken may vary depending on what kind of listener receives the message.</span></span> <span data-ttu-id="30f23-210">たとえば、<xref:System.Diagnostics.DefaultTraceListener> は **Assert** の **Fail** に障害通知を受信し、<xref:System.Diagnostics.TextWriterTraceListener> は出力をストリームに単純に書き込むときにアサーションの追加ダイアログ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="30f23-210">For example, the <xref:System.Diagnostics.DefaultTraceListener> displays an assertion dialog box when it receives a **Fail** or failed **Assert** notification, but a <xref:System.Diagnostics.TextWriterTraceListener> simply writes the output to its stream.</span></span>  
  
 <span data-ttu-id="30f23-211">独自のリスナーを実装することにより、結果をカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="30f23-211">You can produce custom results by implementing your own listener.</span></span> <span data-ttu-id="30f23-212">たとえば、メッセージ ボックスにメッセージを表示するカスタム トレース リスナーや、データベースに接続してメッセージをテーブルに追加するトレース リスナーなどを実装できます。</span><span class="sxs-lookup"><span data-stu-id="30f23-212">A custom trace listener might, for example, display the messages to a message box, or connect to a database to add messages to a table.</span></span> <span data-ttu-id="30f23-213">すべてのカスタム リスナーは、前に示した 6 つのメソッドをサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="30f23-213">All custom listeners should support the six methods mentioned above.</span></span> <span data-ttu-id="30f23-214">開発者が定義するリスナーの作成については、「.NET Framework リファレンス」の「<xref:System.Diagnostics.TraceListener>」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="30f23-214">For more information on creating developer-defined listeners, see <xref:System.Diagnostics.TraceListener> in the .NET Framework reference.</span></span>  
  
 <span data-ttu-id="30f23-215">**Write** メソッドおよび **WriteLine** メソッドでは、必ず指定されたテキストが書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="30f23-215">The **Write** and **WriteLine** methods always write the text that you specify.</span></span> <span data-ttu-id="30f23-216">**Assert**、**WriteIf**、および **WriteLineIf** は、指定されたテキストを書き込むかどうかを制御するブール型の引数を必要とします。式が **true** (**WriteIf** および **WriteLineIf** の場合)、または **false** (**Assert** の場合) の場合のみ、指定されたテキストを書き込みます。</span><span class="sxs-lookup"><span data-stu-id="30f23-216">**Assert**, **WriteIf**, and **WriteLineIf** require a Boolean argument that controls whether or not they write the specified text; they write the specified text only if the expression is **true** (for **WriteIf** and **WriteLineIf**), or **false** (for **Assert**).</span></span> <span data-ttu-id="30f23-217">**Fail** メソッドでは、常に指定されたテキストが書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="30f23-217">The **Fail** method always writes the specified text.</span></span> <span data-ttu-id="30f23-218">詳細については、[アプリケーションコード](how-to-add-trace-statements-to-application-code.md) と .NET Framework 参照にトレースステートメントを追加します。</span><span class="sxs-lookup"><span data-stu-id="30f23-218">For more information, see [How to: Add Trace Statements to Application Code](how-to-add-trace-statements-to-application-code.md) and the .NET Framework reference.</span></span>  
  
## <a name="security-concerns"></a><span data-ttu-id="30f23-219">セキュリティに関する注意事項</span><span class="sxs-lookup"><span data-stu-id="30f23-219">Security Concerns</span></span>  
 <span data-ttu-id="30f23-220">ASP.NET アプリケーションを配置する前にトレースとデバッグを無効にしないと、アプリケーションに関する情報が公開され、悪意を持ったプログラムによって利用される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="30f23-220">If you do not disable tracing and debugging before deploying an ASP.NET application, your application may reveal information about itself that could be exploited by a malicious program.</span></span> <span data-ttu-id="30f23-221">詳細については、[トレースとデバッグ](how-to-compile-conditionally-with-trace-and-debug.md)、[コンパイルとビルド](/visualstudio/ide/compiling-and-building-in-visual-studio)、および [方法を使用して、条件に応じてコンパイルします。トレーススイッチを作成、初期化、および構成](how-to-create-initialize-and-configure-trace-switches.md)ます。</span><span class="sxs-lookup"><span data-stu-id="30f23-221">For more information, see [How to: Compile Conditionally with Trace and Debug](how-to-compile-conditionally-with-trace-and-debug.md), [Compiling and Building](/visualstudio/ide/compiling-and-building-in-visual-studio), and [How to: Create, Initialize and Configure Trace Switches](how-to-create-initialize-and-configure-trace-switches.md).</span></span> <span data-ttu-id="30f23-222">デバッグは、IIS (Internet Information Services) で設定することもできます。</span><span class="sxs-lookup"><span data-stu-id="30f23-222">Debugging is also configurable through Internet Information Services (IIS).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="30f23-223">関連項目</span><span class="sxs-lookup"><span data-stu-id="30f23-223">See also</span></span>

- <xref:System.Diagnostics.Trace>
- <xref:System.Diagnostics.TraceSource>
- [<span data-ttu-id="30f23-224">コード コントラクト</span><span class="sxs-lookup"><span data-stu-id="30f23-224">Code Contracts</span></span>](code-contracts.md)
- [<span data-ttu-id="30f23-225">C#、F#、および Visual Basic のプロジェクト</span><span class="sxs-lookup"><span data-stu-id="30f23-225">C#, F#, and Visual Basic Project Types</span></span>](/visualstudio/debugger/debugging-preparation-csharp-f-hash-and-visual-basic-project-types)
- [<span data-ttu-id="30f23-226">方法: アプリケーション コードにトレース ステートメントを追加する</span><span class="sxs-lookup"><span data-stu-id="30f23-226">How to: Add Trace Statements to Application Code</span></span>](how-to-add-trace-statements-to-application-code.md)
- [<span data-ttu-id="30f23-227">方法: トレースとデバッグを指定して条件付きコンパイルを実行する</span><span class="sxs-lookup"><span data-stu-id="30f23-227">How to: Compile Conditionally with Trace and Debug</span></span>](how-to-compile-conditionally-with-trace-and-debug.md)
- [<span data-ttu-id="30f23-228">方法: トレーススイッチを作成、初期化、および構成</span><span class="sxs-lookup"><span data-stu-id="30f23-228">How to: Create, Initialize and Configure Trace Switches</span></span>](how-to-create-initialize-and-configure-trace-switches.md)
- [<span data-ttu-id="30f23-229">方法: トレースソースの作成と初期化</span><span class="sxs-lookup"><span data-stu-id="30f23-229">How to: Create and Initialize Trace Sources</span></span>](how-to-create-and-initialize-trace-sources.md)
- [<span data-ttu-id="30f23-230">方法: TraceSource とフィルターをトレースリスナーと共に使用</span><span class="sxs-lookup"><span data-stu-id="30f23-230">How to: Use TraceSource and Filters with Trace Listeners</span></span>](how-to-use-tracesource-and-filters-with-trace-listeners.md)
- [<span data-ttu-id="30f23-231">トレース リスナー</span><span class="sxs-lookup"><span data-stu-id="30f23-231">Trace Listeners</span></span>](trace-listeners.md)
- [<span data-ttu-id="30f23-232">トレース スイッチ</span><span class="sxs-lookup"><span data-stu-id="30f23-232">Trace Switches</span></span>](trace-switches.md)
