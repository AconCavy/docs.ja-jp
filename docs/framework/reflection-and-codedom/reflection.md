---
title: .NET のリフレクション
ms.date: 03/30/2017
helpviewer_keywords:
- assemblies [.NET], reflection
- EventInfo class, reflection
- common language runtime, reflection
- FieldInfo class, reflection
- ParameterInfo class, reflection
- ConstructorInfo class, reflection
- Assembly class, reflection
- value types, reflection
- reflection, about reflection
- modules, reflection
- runtime, reflection
- Module class, reflection
- MethodInfo class, reflection
- PropertyInfo class, reflection
- type browsers
- reflection
- discovering type information at run time
- type system, reflection
ms.assetid: d1a58e7f-fb39-4d50-bf84-e3b8f9bf9775
ms.openlocfilehash: 90d9cf4c473d73d1eeeb5f2a1098f8626c20359f
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/12/2020
ms.locfileid: "79180475"
---
# <a name="reflection-in-net"></a><span data-ttu-id="69f7d-102">.NET のリフレクション</span><span class="sxs-lookup"><span data-stu-id="69f7d-102">Reflection in .NET</span></span>

<span data-ttu-id="69f7d-103"><xref:System.Reflection>名前空間のクラスと共<xref:System.Type?displayProperty=nameWithType>に、 を使用すると、読み込まれた[アセンブリ](../../standard/assembly/index.md)と、その中で定義されている型 ([クラス](../../standard/base-types/common-type-system.md#classes)、[インターフェイス](../../standard/base-types/common-type-system.md#interfaces)、値型など)[structures](../../standard/base-types/common-type-system.md#structures)に関する情報を[取得できます。](../../standard/base-types/common-type-system.md#enumerations)</span><span class="sxs-lookup"><span data-stu-id="69f7d-103">The classes in the <xref:System.Reflection> namespace, together with <xref:System.Type?displayProperty=nameWithType>, enable you to obtain information about loaded [assemblies](../../standard/assembly/index.md) and the types defined within them, such as [classes](../../standard/base-types/common-type-system.md#classes), [interfaces](../../standard/base-types/common-type-system.md#interfaces), and value types (that is, [structures](../../standard/base-types/common-type-system.md#structures) and [enumerations](../../standard/base-types/common-type-system.md#enumerations)).</span></span> <span data-ttu-id="69f7d-104">また、リフレクションを使用すると、実行時に型インスタンスを作成したり、作成した型インスタンスを呼び出したり、アクセスしたりできます。</span><span class="sxs-lookup"><span data-stu-id="69f7d-104">You can also use reflection to create type instances at run time, and to invoke and access them.</span></span> <span data-ttu-id="69f7d-105">リフレクションのさまざまな面に関するトピックについては、この概要の最後の「[関連トピック](#related_topics)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="69f7d-105">For topics about specific aspects of reflection, see [Related Topics](#related_topics) at the end of this overview.</span></span>
  
<span data-ttu-id="69f7d-106">[共通言語ランタイム](../../standard/clr.md) ローダーは、[アプリケーション ドメイン](../app-domains/application-domains.md)を管理します。アプリケーション ドメインは、同じアプリケーション スコープのオブジェクトの周りに定義された境界を構成します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-106">The [common language runtime](../../standard/clr.md) loader manages [application domains](../app-domains/application-domains.md), which constitute defined boundaries around objects that have the same application scope.</span></span> <span data-ttu-id="69f7d-107">アプリケーション ドメインの管理には、該当アプリケーション ドメインへの各アセンブリの読み込み、および各アセンブリ内の型階層のメモリ レイアウトの制御などが含まれます。</span><span class="sxs-lookup"><span data-stu-id="69f7d-107">This management includes loading each assembly into the appropriate application domain and controlling the memory layout of the type hierarchy within each assembly.</span></span>  
  
<span data-ttu-id="69f7d-108">[アセンブリ](../app-domains/index.md)には、モジュールが含まれています。モジュールには、型が含まれています。また、型にはメンバーが含まれています。</span><span class="sxs-lookup"><span data-stu-id="69f7d-108">[Assemblies](../app-domains/index.md) contain modules, modules contain types, and types contain members.</span></span> <span data-ttu-id="69f7d-109">リフレクションは、アセンブリ、モジュール、および型をカプセル化するオブジェクトを提供します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-109">Reflection provides objects that encapsulate assemblies, modules, and types.</span></span> <span data-ttu-id="69f7d-110">リフレクションを使用すると、動的に型のインスタンスを作成したり、その型を既存のオブジェクトにバインドしたり、既存のオブジェクトから型を取得できます。</span><span class="sxs-lookup"><span data-stu-id="69f7d-110">You can use reflection to dynamically create an instance of a type, bind the type to an existing object, or get the type from an existing object.</span></span> <span data-ttu-id="69f7d-111">その後で、型のメソッドを呼び出したり、型のフィールドやプロパティにアクセスしたりできます。</span><span class="sxs-lookup"><span data-stu-id="69f7d-111">You can then invoke the type's methods or access its fields and properties.</span></span> <span data-ttu-id="69f7d-112">リフレクションの代表的な用途は、次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="69f7d-112">Typical uses of reflection include the following:</span></span>  
  
- <span data-ttu-id="69f7d-113"><xref:System.Reflection.Assembly> を使用して、アセンブリを定義または読み込み、アセンブリ マニフェストにリストされているモジュールを読み込み、そのアセンブリから型を検索し、そのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-113">Use <xref:System.Reflection.Assembly> to define and load assemblies, load modules that are listed in the assembly manifest, and locate a type from this assembly and create an instance of it.</span></span>  
  
- <span data-ttu-id="69f7d-114">モジュールを含んでいるアセンブリや、モジュール内のクラスなどの情報を探索するには、<xref:System.Reflection.Module> を使用します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-114">Use <xref:System.Reflection.Module> to discover information such as the assembly that contains the module and the classes in the module.</span></span> <span data-ttu-id="69f7d-115">また、すべてのグローバル メソッドも取得できます。その他、モジュールに定義されている固有の非グローバルなメソッドも取得できます。</span><span class="sxs-lookup"><span data-stu-id="69f7d-115">You can also get all global methods or other specific, nonglobal methods defined on the module.</span></span>  
  
- <span data-ttu-id="69f7d-116">名前、パラメーター、アクセス修飾子 (`public` または `private` など)、およびコンストラクターの実装詳細 (`abstract` または `virtual` など) の情報を探索するには、<xref:System.Reflection.ConstructorInfo> を使用します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-116">Use <xref:System.Reflection.ConstructorInfo> to discover information such as the name, parameters, access modifiers (such as `public` or `private`), and implementation details (such as `abstract` or `virtual`) of a constructor.</span></span> <span data-ttu-id="69f7d-117">特定のコンストラクターを呼び出すには、<xref:System.Type> の <xref:System.Type.GetConstructors%2A> メソッドまたは <xref:System.Type.GetConstructor%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-117">Use the <xref:System.Type.GetConstructors%2A> or <xref:System.Type.GetConstructor%2A> method of a <xref:System.Type> to invoke a specific constructor.</span></span>  
  
- <span data-ttu-id="69f7d-118">名前、戻り値の型、パラメーター、アクセス修飾子 (`public` または `private` など)、およびメソッドの実装詳細 (`abstract` または `virtual` など) の情報を探索するには、<xref:System.Reflection.MethodInfo> を使用します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-118">Use <xref:System.Reflection.MethodInfo> to discover information such as the name, return type, parameters, access modifiers (such as `public` or `private`), and implementation details (such as `abstract` or `virtual`) of a method.</span></span> <span data-ttu-id="69f7d-119">特定のメソッドを呼び出すには、<xref:System.Type> の <xref:System.Type.GetMethods%2A> メソッドまたは <xref:System.Type.GetMethod%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-119">Use the <xref:System.Type.GetMethods%2A> or <xref:System.Type.GetMethod%2A> method of a <xref:System.Type> to invoke a specific method.</span></span>  
  
- <span data-ttu-id="69f7d-120">フィールドの名前、アクセス修飾子 (`public` または `private` など)、フィールドの実装詳細 (`static` など) などの情報を探索したり、フィールドの値を取得または設定したりするには、<xref:System.Reflection.FieldInfo> を使用します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-120">Use <xref:System.Reflection.FieldInfo> to discover information such as the name, access modifiers (such as `public` or `private`) and implementation details (such as `static`) of a field, and to get or set field values.</span></span>  
  
- <span data-ttu-id="69f7d-121">名前、イベント ハンドラーのデータ型、カスタム属性、宣言型、イベントのリフレクションされた型などの情報を探索したり、イベント ハンドラーを追加および削除したりするには、<xref:System.Reflection.EventInfo> を使用します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-121">Use <xref:System.Reflection.EventInfo> to discover information such as the name, event-handler data type, custom attributes, declaring type, and reflected type of an event, and to add or remove event handlers.</span></span>  
  
- <span data-ttu-id="69f7d-122">プロパティの名前、データ型、宣言型、リフレクションされた型、読み取り専用または書き込み可能のステータスなどの情報を探索したり、プロパティの値を取得または設定したりするには、<xref:System.Reflection.PropertyInfo> を使用します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-122">Use <xref:System.Reflection.PropertyInfo> to discover information such as the name, data type, declaring type, reflected type, and read-only or writable status of a property, and to get or set property values.</span></span>  
  
- <span data-ttu-id="69f7d-123">パラメーターの名前、データ型、パラメーターが入力パラメーターか出力パラメーターかなどの情報を探索したり、メソッド シグネチャ内のパラメーターの位置を探索したりするには、<xref:System.Reflection.ParameterInfo> を使用します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-123">Use <xref:System.Reflection.ParameterInfo> to discover information such as a parameter's name, data type, whether a parameter is an input or output parameter, and the position of the parameter in a method signature.</span></span>  
  
- <span data-ttu-id="69f7d-124">アプリケーション ドメインのリフレクション専用のコンテキストで作業する際に、カスタム属性に関する情報を検索するには、<xref:System.Reflection.CustomAttributeData> を使用します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-124">Use <xref:System.Reflection.CustomAttributeData> to discover information about custom attributes when you are working in the reflection-only context of an application domain.</span></span> <span data-ttu-id="69f7d-125"><xref:System.Reflection.CustomAttributeData> を使用すると、それらのインスタンスを作成せずに属性を調べることができます。</span><span class="sxs-lookup"><span data-stu-id="69f7d-125"><xref:System.Reflection.CustomAttributeData> allows you to examine attributes without creating instances of them.</span></span>  
  
<span data-ttu-id="69f7d-126"><xref:System.Reflection.Emit> 名前空間のクラスは、実行時に型を作成できる特殊な形態のリフレクションを提供します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-126">The classes of the <xref:System.Reflection.Emit> namespace provide a specialized form of reflection that enables you to build types at run time.</span></span>  
  
<span data-ttu-id="69f7d-127">また、リフレクションを使用すると、ユーザーが型を選択し、型についての情報を表示できる、型ブラウザーと呼ばれるアプリケーションを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="69f7d-127">Reflection can also be used to create applications called type browsers, which enable users to select types and then view the information about those types.</span></span>  
  
<span data-ttu-id="69f7d-128">リフレクションには、他の用途もあります。</span><span class="sxs-lookup"><span data-stu-id="69f7d-128">There are other uses for reflection.</span></span> <span data-ttu-id="69f7d-129">JScript のような言語のコンパイラは、リフレクションを使用してシンボル テーブルを構築します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-129">Compilers for languages such as JScript use reflection to construct symbol tables.</span></span> <span data-ttu-id="69f7d-130"><xref:System.Runtime.Serialization> 名前空間のクラスは、リフレクションを使用して、データにアクセスし、永続化するフィールドを決定します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-130">The classes in the <xref:System.Runtime.Serialization> namespace use reflection to access data and to determine which fields to persist.</span></span> <span data-ttu-id="69f7d-131"><xref:System.Runtime.Remoting> 名前空間のクラスは、シリアル化を通じて間接的にリフレクションを使用します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-131">The classes in the <xref:System.Runtime.Remoting> namespace use reflection indirectly through serialization.</span></span>  
  
## <a name="runtime-types-in-reflection"></a><span data-ttu-id="69f7d-132">リフレクションのランタイム型</span><span class="sxs-lookup"><span data-stu-id="69f7d-132">Runtime Types in Reflection</span></span>  
<span data-ttu-id="69f7d-133">リフレクションは <xref:System.Type> や <xref:System.Reflection.MethodInfo> などのクラスを提供して、型、メンバー、パラメーター、およびその他のコード エンティティを示します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-133">Reflection provides classes, such as <xref:System.Type> and <xref:System.Reflection.MethodInfo>, to represent types, members, parameters, and other code entities.</span></span> <span data-ttu-id="69f7d-134">ただし、リフレクションを使用する場合は、これらのクラスを直接利用しません。これらの大部分は抽象 (Visual Basic では `MustInherit`) です。</span><span class="sxs-lookup"><span data-stu-id="69f7d-134">However, when you use reflection, you don't work directly with these classes, most of which are abstract (`MustInherit` in Visual Basic).</span></span> <span data-ttu-id="69f7d-135">代わりに、共通言語ランタイム (CLR) によって提供される型を利用します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-135">Instead, you work with types provided by the common language runtime (CLR).</span></span>  
  
<span data-ttu-id="69f7d-136">たとえば、C# `typeof` 演算子 (Visual Basic では `GetType`) を使用して <xref:System.Type> オブジェクトを取得する場合、オブジェクトは実際には `RuntimeType` です。</span><span class="sxs-lookup"><span data-stu-id="69f7d-136">For example, when you use the C# `typeof` operator (`GetType` in Visual Basic) to obtain a <xref:System.Type> object, the object is really a `RuntimeType`.</span></span> <span data-ttu-id="69f7d-137">`RuntimeType` は <xref:System.Type> から派生し、すべての抽象メソッドの実装を提供します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-137">`RuntimeType` derives from <xref:System.Type> and provides implementations of all the abstract methods.</span></span>  
  
<span data-ttu-id="69f7d-138">これらのランタイム クラスは `internal` (Visual Basic では `Friend`) です。</span><span class="sxs-lookup"><span data-stu-id="69f7d-138">These runtime classes are `internal` (`Friend` in Visual Basic).</span></span> <span data-ttu-id="69f7d-139">それらは基本クラスと別のドキュメントでは説明していません。それらの動作は基本クラスのドキュメントで説明されています。</span><span class="sxs-lookup"><span data-stu-id="69f7d-139">They are not documented separately from their base classes, because their behavior is described by the base class documentation.</span></span>  
  
<a name="related_topics"></a>

## <a name="related-topics"></a><span data-ttu-id="69f7d-140">関連トピック</span><span class="sxs-lookup"><span data-stu-id="69f7d-140">Related Topics</span></span>  
  
|<span data-ttu-id="69f7d-141">タイトル</span><span class="sxs-lookup"><span data-stu-id="69f7d-141">Title</span></span>|<span data-ttu-id="69f7d-142">説明</span><span class="sxs-lookup"><span data-stu-id="69f7d-142">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="69f7d-143">型情報の表示</span><span class="sxs-lookup"><span data-stu-id="69f7d-143">Viewing Type Information</span></span>](viewing-type-information.md)|<span data-ttu-id="69f7d-144"><xref:System.Type> クラスについて説明します。<xref:System.Type> をさまざまなリフレクション クラスと共に使用して、コンストラクター、メソッド、フィールド、プロパティ、およびイベントについての情報を取得する方法を示すコード例を提供します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-144">Describes the <xref:System.Type> class and provides code examples that illustrate how to use <xref:System.Type> with several reflection classes to obtain information about constructors, methods, fields, properties, and events.</span></span>|  
|[<span data-ttu-id="69f7d-145">リフレクションとジェネリック型</span><span class="sxs-lookup"><span data-stu-id="69f7d-145">Reflection and Generic Types</span></span>](reflection-and-generic-types.md)|<span data-ttu-id="69f7d-146">ジェネリック型およびジェネリック メソッドの型パラメーターと型引数がリフレクションでどのように処理されるかについて説明します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-146">Explains how reflection handles the type parameters and type arguments of generic types and generic methods.</span></span>|  
|[<span data-ttu-id="69f7d-147">リフレクションに関するセキュリティ上の考慮事項</span><span class="sxs-lookup"><span data-stu-id="69f7d-147">Security Considerations for Reflection</span></span>](security-considerations-for-reflection.md)|<span data-ttu-id="69f7d-148">型情報を探索し、型にアクセスするためにどの程度までリフレクションを使用できるかを決定する規則を説明します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-148">Describes the rules that determine to what degree reflection can be used to discover type information and access types.</span></span>|  
|[<span data-ttu-id="69f7d-149">型の動的な読み込みおよび使用</span><span class="sxs-lookup"><span data-stu-id="69f7d-149">Dynamically Loading and Using Types</span></span>](dynamically-loading-and-using-types.md)|<span data-ttu-id="69f7d-150">遅延バインディングをサポートするリフレクション カスタム バインド インターフェイスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-150">Describes the reflection custom-binding interface that supports late binding.</span></span>|  
|[<span data-ttu-id="69f7d-151">方法 : リフレクションのみのコンテキストにアセンブリを読み込む</span><span class="sxs-lookup"><span data-stu-id="69f7d-151">How to: Load Assemblies into the Reflection-Only Context</span></span>](how-to-load-assemblies-into-the-reflection-only-context.md)|<span data-ttu-id="69f7d-152">リフレクションのみの読み込みのコンテキストについて説明します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-152">Describes the reflection-only load context.</span></span> <span data-ttu-id="69f7d-153">アセンブリを読み込む方法、そのコンテキストをテストする方法、およびリフレクションのみのコンテキストでアセンブリに適用されている属性を調べる方法を紹介します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-153">Shows how to load an assembly, how to test the context, and how to examine attributes applied to an assembly in the reflection-only context.</span></span>|  
|[<span data-ttu-id="69f7d-154">カスタム属性へのアクセス</span><span class="sxs-lookup"><span data-stu-id="69f7d-154">Accessing Custom Attributes</span></span>](accessing-custom-attributes.md)|<span data-ttu-id="69f7d-155">リフレクションを使用して、属性の有無および属性値を照会する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-155">Demonstrates using reflection to query attribute existence and values.</span></span>|  
|[<span data-ttu-id="69f7d-156">完全修飾型名の指定</span><span class="sxs-lookup"><span data-stu-id="69f7d-156">Specifying Fully Qualified Type Names</span></span>](specifying-fully-qualified-type-names.md)|<span data-ttu-id="69f7d-157">Backus-Naur form (BNF) に基づく完全修飾型名の書式と、特殊文字、アセンブリ名、ポインター、参照、および配列を指定する際に必要な構文を説明します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-157">Describes the format of fully qualified type names in terms of the Backus-Naur form (BNF), and the syntax required for specifying special characters, assembly names, pointers, references, and arrays.</span></span>|  
|[<span data-ttu-id="69f7d-158">方法 : リフレクションを使用してデリゲートをフックする</span><span class="sxs-lookup"><span data-stu-id="69f7d-158">How to: Hook Up a Delegate Using Reflection</span></span>](how-to-hook-up-a-delegate-using-reflection.md)|<span data-ttu-id="69f7d-159">メソッドのデリゲートを作成し、デリゲートをイベントにフックする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-159">Explains how to create a delegate for a method and hook the delegate up to an event.</span></span> <span data-ttu-id="69f7d-160">また、<xref:System.Reflection.Emit.DynamicMethod> を使用して実行時にイベント処理メソッドを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-160">Explains how to create an event-handling method at run time using <xref:System.Reflection.Emit.DynamicMethod>.</span></span>|  
|[<span data-ttu-id="69f7d-161">動的メソッドおよびアセンブリの出力</span><span class="sxs-lookup"><span data-stu-id="69f7d-161">Emitting Dynamic Methods and Assemblies</span></span>](emitting-dynamic-methods-and-assemblies.md)|<span data-ttu-id="69f7d-162">動的アセンブリや動的メソッドを生成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="69f7d-162">Explains how to generate dynamic assemblies and dynamic methods.</span></span>|  
  
## <a name="reference"></a><span data-ttu-id="69f7d-163">リファレンス</span><span class="sxs-lookup"><span data-stu-id="69f7d-163">Reference</span></span>  

<xref:System.Type?displayProperty=nameWithType>  
  
<xref:System.Reflection>  
  
<xref:System.Reflection.Emit>  
