---
title: リフレクションに関するセキュリティ上の考慮事項
description: .NET のリフレクションに関するセキュリティ上の考慮事項について説明します。 型とメンバーに関する情報の取得は許可されますが、メンバーへのアクセスには制限があります。
ms.date: 03/30/2017
helpviewer_keywords:
- permissions [.NET Framework], reflection
- MethodInfo parameters
- reflection, security
- partial trust,reflection
- nonpublic members
- reflection,partial trust
- link demands
ms.assetid: 42d9dc2a-8fcc-4ff3-b002-4ff260ef3dc5
ms.openlocfilehash: 9ef2ac4897b3f8c48a0b0f402ab06eb073a5c1fa
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/15/2020
ms.locfileid: "90556337"
---
# <a name="security-considerations-for-reflection"></a><span data-ttu-id="0fc01-104">リフレクションに関するセキュリティ上の考慮事項</span><span class="sxs-lookup"><span data-stu-id="0fc01-104">Security Considerations for Reflection</span></span>

<span data-ttu-id="0fc01-105">リフレクションを使用すると、型とメンバーに関する情報を取得し、メンバーにアクセスできます (つまり、メソッドやコンストラクターの呼び出し、プロパティ値の取得と設定、イベント ハンドラーの追加と削除などを実行できます)。</span><span class="sxs-lookup"><span data-stu-id="0fc01-105">Reflection provides the ability to obtain information about types and members, and to access members (that is, to call methods and constructors, to get and set property values, to add and remove event handlers, and so on).</span></span> <span data-ttu-id="0fc01-106">リフレクションを使用した型とメンバーに関する情報の取得には、制限がありません。</span><span class="sxs-lookup"><span data-stu-id="0fc01-106">The use of reflection to obtain information about types and members is not restricted.</span></span> <span data-ttu-id="0fc01-107">すべてのコードで、次のタスクを実行するためにリフレクションを使用できます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-107">All code can use reflection to perform the following tasks:</span></span>

- <span data-ttu-id="0fc01-108">型とメンバーを列挙し、そのメタデータを確認する。</span><span class="sxs-lookup"><span data-stu-id="0fc01-108">Enumerate types and members, and examine their metadata.</span></span>

- <span data-ttu-id="0fc01-109">アセンブリとモジュールを列挙し、確認する。</span><span class="sxs-lookup"><span data-stu-id="0fc01-109">Enumerate and examine assemblies and modules.</span></span>

<span data-ttu-id="0fc01-110">これに対して、リフレクションを使用したメンバーへのアクセスには、制限があります。</span><span class="sxs-lookup"><span data-stu-id="0fc01-110">Using reflection to access members, by contrast, is subject to restrictions.</span></span> <span data-ttu-id="0fc01-111">.NET Framework 4 以降、リフレクションを使用してセキュリティ クリティカルなメンバーにアクセスできるのは、信頼されているコードだけです。</span><span class="sxs-lookup"><span data-stu-id="0fc01-111">Beginning with the .NET Framework 4, only trusted code can use reflection to access security-critical members.</span></span> <span data-ttu-id="0fc01-112">さらに、コンパイル済みコードに直接アクセスできない非パブリック メンバーに、リフレクションを使用してアクセスできるのも信頼されたコードだけです。</span><span class="sxs-lookup"><span data-stu-id="0fc01-112">Furthermore, only trusted code can use reflection to access nonpublic members that would not be directly accessible to compiled code.</span></span> <span data-ttu-id="0fc01-113">最後に、セーフ クリティカルなメンバーにアクセスするリフレクションを使用するコードには、コンパイル済みコードと同様、セーフ クリティカル メンバーが要求するすべてのアクセス許可が必要です。</span><span class="sxs-lookup"><span data-stu-id="0fc01-113">Finally, code that uses reflection to access a safe-critical member must have whatever permissions the safe-critical member demands, just as with compiled code.</span></span>

<span data-ttu-id="0fc01-114">必要なアクセス許可がある場合、コードはリフレクションを使用して次の種類のアクセスを実行できます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-114">Subject to necessary permissions, code can use reflection to perform the following kinds of access:</span></span>

- <span data-ttu-id="0fc01-115">セキュリティ クリティカルではないをパブリック メンバーへのアクセス。</span><span class="sxs-lookup"><span data-stu-id="0fc01-115">Access public members that are not security-critical.</span></span>

- <span data-ttu-id="0fc01-116">コンパイル済みコードにアクセスできる非パブリック メンバーへのアクセス (そのメンバーがセキュリティ クリティカルでない場合)。</span><span class="sxs-lookup"><span data-stu-id="0fc01-116">Access nonpublic members that would be accessible to compiled code, if those members are not security-critical.</span></span> <span data-ttu-id="0fc01-117">このような非パブリック メンバーの例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="0fc01-117">Examples of such nonpublic members include:</span></span>

  - <span data-ttu-id="0fc01-118">呼び出し元コードの基本クラスのプロテクト メンバー。</span><span class="sxs-lookup"><span data-stu-id="0fc01-118">Protected members of the calling code's base classes.</span></span> <span data-ttu-id="0fc01-119">(リフレクションの場合、これはファミリレベル アクセスと呼ばれます。)</span><span class="sxs-lookup"><span data-stu-id="0fc01-119">(In reflection, this is referred to as family-level access.)</span></span>

  - <span data-ttu-id="0fc01-120">呼び出し元コードのアセンブリの `internal` メンバー (Visual Basic では `Friend` メンバー)</span><span class="sxs-lookup"><span data-stu-id="0fc01-120">`internal` members (`Friend` members in Visual Basic) in the calling code's assembly.</span></span> <span data-ttu-id="0fc01-121">(リフレクションの場合、これはアセンブリレベル アクセスと呼ばれます)。</span><span class="sxs-lookup"><span data-stu-id="0fc01-121">(In reflection, this is referred to as assembly-level access.)</span></span>

  - <span data-ttu-id="0fc01-122">呼び出し元コードを含むクラスの他のインスタンスのプライベート メンバー。</span><span class="sxs-lookup"><span data-stu-id="0fc01-122">Private members of other instances of the class that contains the calling code.</span></span>

<span data-ttu-id="0fc01-123">たとえば、サンドボックス化されたアプリケーション ドメインで実行されるコードは、アプリケーション ドメインから追加のアクセス許可が付与されていない限り、この一覧に示したアクセスに限定されます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-123">For example, code that is run in a sandboxed application domain is limited to the access described in this list, unless the application domain grants additional permissions.</span></span>

<span data-ttu-id="0fc01-124">.NET Framework 2.0 Service Pack 1 以降では、通常はアクセスできないメンバーにアクセスしようとすると、対象オブジェクトと <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> フラグが設定された <xref:System.Security.Permissions.ReflectionPermission> の許可セットに対する要求が生成されます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-124">Starting with the .NET Framework 2.0 Service Pack 1, attempting to access members that are normally inaccessible generates a demand for the grant set of the target object plus <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag.</span></span> <span data-ttu-id="0fc01-125">完全な信頼で実行されているコード (コマンド ラインから起動されるアプリケーションのコードなど) には、必要とされるこれらのアクセス許可が常にあります。</span><span class="sxs-lookup"><span data-stu-id="0fc01-125">Code that is running with full trust (for example, code in an application that is launched from the command line) can always satisfy these permissions.</span></span> <span data-ttu-id="0fc01-126">(ただし、後で説明するように、セキュリティ クリティカルなメンバーにアクセスする場合は制限があります)。</span><span class="sxs-lookup"><span data-stu-id="0fc01-126">(This is subject to limitations in accessing security-critical members, as described later in this article.)</span></span>

<span data-ttu-id="0fc01-127">必要に応じて、サンドボックス化されたアプリケーション ドメインから、<xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> フラグが設定された <xref:System.Security.Permissions.ReflectionPermission> を付与できます。これについては、後半の「[通常はアクセスできないメンバーへのアクセス](#accessingNormallyInaccessible)」で説明します。</span><span class="sxs-lookup"><span data-stu-id="0fc01-127">Optionally, a sandboxed application domain can grant <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag, as described in the section [Accessing Members That Are Normally Inaccessible](#accessingNormallyInaccessible), later in this article.</span></span>

<a name="accessingSecurityCritical"></a>

## <a name="accessing-security-critical-members"></a><span data-ttu-id="0fc01-128">セキュリティ クリティカルなメンバーへのアクセス</span><span class="sxs-lookup"><span data-stu-id="0fc01-128">Accessing Security-Critical Members</span></span>

<span data-ttu-id="0fc01-129">メンバーは、<xref:System.Security.SecurityCriticalAttribute> が指定されている場合、<xref:System.Security.SecurityCriticalAttribute> が指定されている型に属する場合、またはセキュリティ クリティカルなアセンブリ内にある場合は、セキュリティ クリティカルです。</span><span class="sxs-lookup"><span data-stu-id="0fc01-129">A member is security-critical if it has the <xref:System.Security.SecurityCriticalAttribute>, if it belongs to a type that has the <xref:System.Security.SecurityCriticalAttribute>, or if it is in a security-critical assembly.</span></span> <span data-ttu-id="0fc01-130">.NET Framework 4 以降では、セキュリティ クリティカルなメンバーにアクセスする場合の規則は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="0fc01-130">Beginning with the .NET Framework 4, the rules for accessing security-critical members are as follows:</span></span>

- <span data-ttu-id="0fc01-131">透過的なコードでは、コードが完全に信頼されている場合でも、リフレクションを使用してセキュリティ クリティカルなメンバーにアクセスすることはできません。</span><span class="sxs-lookup"><span data-stu-id="0fc01-131">Transparent code cannot use reflection to access security-critical members, even if the code is fully trusted.</span></span> <span data-ttu-id="0fc01-132"><xref:System.MethodAccessException>、<xref:System.FieldAccessException>、または <xref:System.TypeAccessException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-132">A <xref:System.MethodAccessException>, <xref:System.FieldAccessException>, or <xref:System.TypeAccessException> is thrown.</span></span>

- <span data-ttu-id="0fc01-133">部分信頼で実行されているコードは透過的として扱われます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-133">Code that is running with partial trust is treated as transparent.</span></span>

<span data-ttu-id="0fc01-134">これらの規則は、セキュリティ クリティカルなメンバーにコンパイルされたコードから直接アクセスする場合でも、リフレクションを使用してアクセスする場合でも同じです。</span><span class="sxs-lookup"><span data-stu-id="0fc01-134">These rules are the same whether a security-critical member is accessed directly by compiled code, or accessed by using reflection.</span></span>

<span data-ttu-id="0fc01-135">コマンド ラインから実行されるアプリケーション コードは完全信頼で実行されます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-135">Application code that is run from the command line runs with full trust.</span></span> <span data-ttu-id="0fc01-136">この場合、透過的とマークされていない限り、リフレクションを使用してセキュリティ クリティカルなメンバーにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-136">As long as it is not marked as transparent, it can use reflection to access security-critical members.</span></span> <span data-ttu-id="0fc01-137">同じコードが部分信頼で実行される場合 (サンドボックス化されたアプリケーション ドメイン内など)、セキュリティ クリティカル コードにアクセスできるかどうかは、アセンブリの信頼レベルによって決まります。アセンブリが厳密な名前を持ち、グローバル アセンブリ キャッシュにインストールされている場合は、信頼されたアセンブリとして、セキュリティ クリティカルなメンバーを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-137">When the same code is run with partial trust (for example, in a sandboxed application domain) the assembly's trust level determines whether it can access security-critical code: If the assembly has a strong name and is installed in the global assembly cache, it is a trusted assembly and can call security-critical members.</span></span> <span data-ttu-id="0fc01-138">信頼されない場合は、透過的とマークされていなくても透過的として扱われ、セキュリティ クリティカルなメンバーにはアクセスできません。</span><span class="sxs-lookup"><span data-stu-id="0fc01-138">If it is not trusted, it becomes transparent even though it was not marked as transparent, and it cannot access security-critical members.</span></span>

<span data-ttu-id="0fc01-139">.NET Framework 4 のセキュリティ モデルの詳細については、「[.NET Framework におけるセキュリティの変更点](/previous-versions/dotnet/framework/security/security-changes)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0fc01-139">For more information about the security model in the .NET Framework 4, see [Security Changes](/previous-versions/dotnet/framework/security/security-changes).</span></span>

## <a name="reflection-and-transparency"></a><span data-ttu-id="0fc01-140">リフレクションと透過</span><span class="sxs-lookup"><span data-stu-id="0fc01-140">Reflection and Transparency</span></span>

<span data-ttu-id="0fc01-141">.NET Framework 4 以降では、型またはメンバーの透過度は、アセンブリの信頼レベルやアプリケーション ドメインの信頼レベルなど、複数の要素に基づいて共通言語ランタイムによって決定されます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-141">Beginning with the .NET Framework 4, the common language runtime determines the transparency level of a type or member from several factors, including the trust level of the assembly and the trust level of the application domain.</span></span> <span data-ttu-id="0fc01-142">リフレクションには、型の透過度を確認できる <xref:System.Type.IsSecurityCritical%2A>、<xref:System.Type.IsSecuritySafeCritical%2A>、<xref:System.Type.IsSecurityTransparent%2A> の各プロパティが用意されています。</span><span class="sxs-lookup"><span data-stu-id="0fc01-142">Reflection provides the <xref:System.Type.IsSecurityCritical%2A>, <xref:System.Type.IsSecuritySafeCritical%2A>, and <xref:System.Type.IsSecurityTransparent%2A> properties to enable you to discover the transparency level of a type.</span></span> <span data-ttu-id="0fc01-143">これらのプロパティの有効な組み合わせを、次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="0fc01-143">The following table shows the valid combinations of these properties.</span></span>

|<span data-ttu-id="0fc01-144">セキュリティ レベル</span><span class="sxs-lookup"><span data-stu-id="0fc01-144">Security level</span></span>|<span data-ttu-id="0fc01-145">IsSecurityCritical</span><span class="sxs-lookup"><span data-stu-id="0fc01-145">IsSecurityCritical</span></span>|<span data-ttu-id="0fc01-146">IsSecuritySafeCritical</span><span class="sxs-lookup"><span data-stu-id="0fc01-146">IsSecuritySafeCritical</span></span>|<span data-ttu-id="0fc01-147">IsSecurityTransparent</span><span class="sxs-lookup"><span data-stu-id="0fc01-147">IsSecurityTransparent</span></span>|
|--------------------|------------------------|----------------------------|---------------------------|
|<span data-ttu-id="0fc01-148">重大</span><span class="sxs-lookup"><span data-stu-id="0fc01-148">Critical</span></span>|`true`|`false`|`false`|
|<span data-ttu-id="0fc01-149">セーフ クリティカル</span><span class="sxs-lookup"><span data-stu-id="0fc01-149">Safe-critical</span></span>|`true`|`true`|`false`|
|<span data-ttu-id="0fc01-150">透明</span><span class="sxs-lookup"><span data-stu-id="0fc01-150">Transparent</span></span>|`false`|`false`|`true`|

<span data-ttu-id="0fc01-151">これらのプロパティを使用する方が、アセンブリとその型のセキュリティの注釈を調べたり、現在の信頼レベルを確認したり、ランタイムの規則を複製したりするより、はるかに簡単です。</span><span class="sxs-lookup"><span data-stu-id="0fc01-151">Using these properties is much simpler than examining the security annotations of an assembly and its types, checking the current trust level, and attempting to duplicate the runtime's rules.</span></span> <span data-ttu-id="0fc01-152">たとえば、同じ型でも、コマンド ラインから実行される場合はセキュリティ クリティカルとなり、サンドボックス化されたアプリケーション ドメインで実行される場合は透過的セキュリティとなります。</span><span class="sxs-lookup"><span data-stu-id="0fc01-152">For example, the same type can be security-critical when it is run from the command line, or security-transparent when it is run in a sandboxed application domain.</span></span>

<span data-ttu-id="0fc01-153"><xref:System.Reflection.MethodBase>、<xref:System.Reflection.FieldInfo>、<xref:System.Reflection.Emit.TypeBuilder>、<xref:System.Reflection.Emit.MethodBuilder>、<xref:System.Reflection.Emit.DynamicMethod> の各クラスには、同様のプロパティがあります</span><span class="sxs-lookup"><span data-stu-id="0fc01-153">There are similar properties on the <xref:System.Reflection.MethodBase>, <xref:System.Reflection.FieldInfo>, <xref:System.Reflection.Emit.TypeBuilder>, <xref:System.Reflection.Emit.MethodBuilder>, and <xref:System.Reflection.Emit.DynamicMethod> classes.</span></span> <span data-ttu-id="0fc01-154">(プロパティ アクセサーに適用されるプロパティの場合など、その他のリフレクションとリフレクション出力の抽象クラスでは、関連付けられたメソッドにセキュリティ属性が適用されます)。</span><span class="sxs-lookup"><span data-stu-id="0fc01-154">(For other reflection and reflection emit abstractions, security attributes are applied to the associated methods; for example, in the case of properties they are applied to the property accessors.)</span></span>

<a name="accessingNormallyInaccessible"></a>

## <a name="accessing-members-that-are-normally-inaccessible"></a><span data-ttu-id="0fc01-155">通常はアクセスできないメンバーへのアクセス</span><span class="sxs-lookup"><span data-stu-id="0fc01-155">Accessing Members That Are Normally Inaccessible</span></span>

<span data-ttu-id="0fc01-156">リフレクションを使用して、共通言語ランタイムのアクセシビリティ規則によりアクセスできないメンバーを呼び出すには、次の 2 つのアクセス許可のどちらかをコードに許可する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0fc01-156">To use reflection to invoke members that are inaccessible according to the accessibility rules of the common language runtime, your code must be granted one of two permissions:</span></span>

- <span data-ttu-id="0fc01-157">コードから非パブリック メンバーを呼び出せるようにするには、<xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> フラグが設定された <xref:System.Security.Permissions.ReflectionPermission> をコードに与える必要があります。</span><span class="sxs-lookup"><span data-stu-id="0fc01-157">To allow code to invoke any nonpublic member:Your code must be granted <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag.</span></span>

  > [!NOTE]
  > <span data-ttu-id="0fc01-158">既定で、インターネットを起源とするコードにこのアクセス許可を与えることは、セキュリティ ポリシーによって禁じられています。</span><span class="sxs-lookup"><span data-stu-id="0fc01-158">By default, security policy denies this permission to code that originates from the Internet.</span></span> <span data-ttu-id="0fc01-159">インターネットを起源とするコードには、このアクセス許可を絶対に与えないでください。</span><span class="sxs-lookup"><span data-stu-id="0fc01-159">This permission should never be granted to code that originates from the Internet.</span></span>

- <span data-ttu-id="0fc01-160">呼び出されるメンバーが格納されているアセンブリの許可セットが、呼び出し元のコードが格納されているアセンブリの許可セットと同じか、またはそのサブセットである場合に限り、コードから非パブリック メンバーを呼び出せるようにするには、<xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> フラグが設定された <xref:System.Security.Permissions.ReflectionPermission> をコードに与える必要があります。</span><span class="sxs-lookup"><span data-stu-id="0fc01-160">To allow code to invoke any nonpublic member, as long as the grant set of the assembly that contains the invoked member is the same as, or a subset of, the grant set of the assembly that contains the invoking code: Your code must be granted <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag.</span></span>

<span data-ttu-id="0fc01-161">たとえば、アプリケーション ドメインにインターネット アクセス許可を付与すると共に、<xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> に <xref:System.Security.Permissions.ReflectionPermission> フラグを指定するとします。次に、A と B の 2 つのアセンブリを使用して、インターネット アプリケーションを実行します。</span><span class="sxs-lookup"><span data-stu-id="0fc01-161">For example, suppose you grant an application domain Internet permissions plus <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag, and then run an Internet application with two assemblies, A and B.</span></span>

- <span data-ttu-id="0fc01-162">アセンブリ B の許可セットには、アセンブリ A に付与されていないアクセス許可が含まれていないため、アセンブリ A でリフレクションを使用してアセンブリ B のプライベート メンバーにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-162">Assembly A can use reflection to access private members of assembly B, because the grant set of assembly B does not include any permissions that A has not been granted.</span></span>

- <span data-ttu-id="0fc01-163">アセンブリ A では、リフレクションを使用して mscorlib.dll などの .NET Framework アセンブリのプライベート メンバーにアクセスすることはできません。これは、mscorlib.dll が完全に信頼されており、アセンブリ A に付与されていないアクセス許可を持つためです。実行時にコード アクセス セキュリティによりスタックが走査されると、<xref:System.MemberAccessException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-163">Assembly A cannot use reflection to access private members of .NET Framework assemblies such as mscorlib.dll, because mscorlib.dll is fully trusted and therefore has permissions that have not been granted to assembly A. A <xref:System.MemberAccessException> is thrown when code access security walks the stack at run time.</span></span>

## <a name="serialization"></a><span data-ttu-id="0fc01-164">シリアル化</span><span class="sxs-lookup"><span data-stu-id="0fc01-164">Serialization</span></span>

<span data-ttu-id="0fc01-165">シリアル化の目的で、<xref:System.Security.Permissions.SecurityPermission> に <xref:System.Security.Permissions.SecurityPermissionAttribute.SerializationFormatter%2A?displayProperty=nameWithType> フラグを指定することで、アクセシビリティに関係なく、シリアル化が可能な型のメンバーを取得および設定できるようになります。</span><span class="sxs-lookup"><span data-stu-id="0fc01-165">For serialization, <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionAttribute.SerializationFormatter%2A?displayProperty=nameWithType> flag provides the ability to get and set members of serializable types, regardless of accessibility.</span></span> <span data-ttu-id="0fc01-166">このアクセス許可があると、コードで、インスタンスのプライベート状態を探索したり、変更したりできます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-166">This permission enables code to discover and change the private state of an instance.</span></span> <span data-ttu-id="0fc01-167">型に対して適切なアクセス許可が与えられていると同時に、メタデータ内でシリアル化可能として[マークされている](../../standard/attributes/applying-attributes.md)必要があります。</span><span class="sxs-lookup"><span data-stu-id="0fc01-167">(In addition to being granted the appropriate permissions, the type must be [marked](../../standard/attributes/applying-attributes.md) as serializable in metadata.)</span></span>

## <a name="parameters-of-type-methodinfo"></a><span data-ttu-id="0fc01-168">MethodInfo 型のパラメーター</span><span class="sxs-lookup"><span data-stu-id="0fc01-168">Parameters of Type MethodInfo</span></span>

<span data-ttu-id="0fc01-169">特に、信頼されているコードには、<xref:System.Reflection.MethodInfo> パラメーターを受け取るパブリック メンバーを記述しないでください。</span><span class="sxs-lookup"><span data-stu-id="0fc01-169">Avoid writing public members that take <xref:System.Reflection.MethodInfo> parameters, especially for trusted code.</span></span> <span data-ttu-id="0fc01-170">このようなメンバーは、悪意のあるコードの攻撃を受けやすい場合があります。</span><span class="sxs-lookup"><span data-stu-id="0fc01-170">Such members might be more vulnerable to malicious code.</span></span> <span data-ttu-id="0fc01-171">たとえば、信頼性の高いコード内で、<xref:System.Reflection.MethodInfo> パラメーターを受け取るパブリック メンバーの場合を考えてみましょう。</span><span class="sxs-lookup"><span data-stu-id="0fc01-171">For example, consider a public member in highly trusted code that takes a <xref:System.Reflection.MethodInfo> parameter.</span></span> <span data-ttu-id="0fc01-172">このパブリック メンバーが、渡されたパラメーターに対して間接的に <xref:System.Reflection.MethodBase.Invoke%2A> メソッドを呼び出すとします。</span><span class="sxs-lookup"><span data-stu-id="0fc01-172">Assume that the public member indirectly calls the <xref:System.Reflection.MethodBase.Invoke%2A> method on the supplied parameter.</span></span> <span data-ttu-id="0fc01-173">パブリック メンバーが必要なアクセス許可を確認しない場合、セキュリティ システムは呼び出し元が大きな権限を持っていると判断するため、その <xref:System.Reflection.MethodBase.Invoke%2A> メソッド呼び出しは常に成功します。</span><span class="sxs-lookup"><span data-stu-id="0fc01-173">If the public member does not perform the necessary permission checks, the call to the <xref:System.Reflection.MethodBase.Invoke%2A> method will always succeed, because the security system determines that the caller is highly trusted.</span></span> <span data-ttu-id="0fc01-174">悪意のあるコードがそのメソッドを直接呼び出すアクセス許可を持っていなくても、パブリック メンバーを呼び出すことによって間接的にこのメソッドを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="0fc01-174">Even if malicious code does not have the permission to directly invoke the method, it can still do so indirectly by calling the public member.</span></span>

## <a name="version-information"></a><span data-ttu-id="0fc01-175">バージョン情報</span><span class="sxs-lookup"><span data-stu-id="0fc01-175">Version Information</span></span>

- <span data-ttu-id="0fc01-176">.NET Framework 4 以降では、透過的なコードからリフレクションを使用してセキュリティ クリティカルなメンバーにアクセスすることはできません。</span><span class="sxs-lookup"><span data-stu-id="0fc01-176">Beginning with the .NET Framework 4, transparent code cannot use reflection to access security-critical members.</span></span>

- <span data-ttu-id="0fc01-177"><xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> フラグは、.NET Framework 2.0 Service Pack 1 で導入されています。</span><span class="sxs-lookup"><span data-stu-id="0fc01-177">The <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag is introduced in the .NET Framework 2.0 Service Pack 1.</span></span> <span data-ttu-id="0fc01-178">以前のバージョンの .NET Framework では、コードから非パブリック メンバーにアクセスするためにリフレクションを使用するには <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> フラグを指定する必要がありました。</span><span class="sxs-lookup"><span data-stu-id="0fc01-178">Earlier versions of the .NET Framework require the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag for code that uses reflection to access nonpublic members.</span></span> <span data-ttu-id="0fc01-179">このアクセス許可は、部分的に信頼されるコードには絶対に付与しないでください。</span><span class="sxs-lookup"><span data-stu-id="0fc01-179">This is a permission that should never be granted to partially trusted code.</span></span>

- <span data-ttu-id="0fc01-180">.NET Framework 2.0 以降、リフレクションを使用して非パブリックな型とメンバーに関する情報を取得する場合、アクセス許可が不要になりました。</span><span class="sxs-lookup"><span data-stu-id="0fc01-180">Beginning with the .NET Framework 2.0, using reflection to obtain information about nonpublic types and members does not require any permissions.</span></span> <span data-ttu-id="0fc01-181">以前のバージョンでは、<xref:System.Security.Permissions.ReflectionPermission> に <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType> フラグを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0fc01-181">In earlier versions, <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType> flag is required.</span></span>

## <a name="see-also"></a><span data-ttu-id="0fc01-182">関連項目</span><span class="sxs-lookup"><span data-stu-id="0fc01-182">See also</span></span>

- <xref:System.Security.Permissions.ReflectionPermissionFlag>
- <xref:System.Security.Permissions.ReflectionPermission>
- <xref:System.Security.Permissions.SecurityPermission>
- [<span data-ttu-id="0fc01-183">セキュリティの変更</span><span class="sxs-lookup"><span data-stu-id="0fc01-183">Security Changes</span></span>](/previous-versions/dotnet/framework/security/security-changes)
- [<span data-ttu-id="0fc01-184">コード アクセス セキュリティ</span><span class="sxs-lookup"><span data-stu-id="0fc01-184">Code Access Security</span></span>](../misc/code-access-security.md)
- [<span data-ttu-id="0fc01-185">リフレクション出力のセキュリティ関連事項</span><span class="sxs-lookup"><span data-stu-id="0fc01-185">Security Issues in Reflection Emit</span></span>](security-issues-in-reflection-emit.md)
- [<span data-ttu-id="0fc01-186">型情報の表示</span><span class="sxs-lookup"><span data-stu-id="0fc01-186">Viewing Type Information</span></span>](viewing-type-information.md)
- [<span data-ttu-id="0fc01-187">属性の適用</span><span class="sxs-lookup"><span data-stu-id="0fc01-187">Applying Attributes</span></span>](../../standard/attributes/applying-attributes.md)
- [<span data-ttu-id="0fc01-188">カスタム属性へのアクセス</span><span class="sxs-lookup"><span data-stu-id="0fc01-188">Accessing Custom Attributes</span></span>](accessing-custom-attributes.md)
