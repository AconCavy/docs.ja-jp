---
title: DataGridView コントロールのスケーリングのベストプラクティス
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], row sharing
- data grids [Windows Forms], best practices
- DataGridView control [Windows Forms], shared rows
- DataGridView control [Windows Forms], best practices
- best practices [Windows Forms], dataGridView control
- DataGridView control [Windows Forms], scaling
ms.assetid: 8321a8a6-6340-4fd1-b475-fa090b905aaf
ms.openlocfilehash: 63500a79def89510b4bc7a436abc4620a7265a79
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/24/2020
ms.locfileid: "76744123"
---
# <a name="best-practices-for-scaling-the-windows-forms-datagridview-control"></a><span data-ttu-id="6e4f3-102">Windows フォーム DataGridView コントロールを拡張するための推奨される手順</span><span class="sxs-lookup"><span data-stu-id="6e4f3-102">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>

<span data-ttu-id="6e4f3-103"><xref:System.Windows.Forms.DataGridView> コントロールは、最大のスケーラビリティを提供するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-103">The <xref:System.Windows.Forms.DataGridView> control is designed to provide maximum scalability.</span></span> <span data-ttu-id="6e4f3-104">大量のデータを表示する必要がある場合は、このトピックで説明されているガイドラインに従って、大量のメモリを消費したり、ユーザーインターフェイス (UI) の応答性を低下させたりすることは避けてください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-104">If you need to display large amounts of data, you should follow the guidelines described in this topic to avoid consuming large amounts of memory or degrading the responsiveness of the user interface (UI).</span></span> <span data-ttu-id="6e4f3-105">このトピックでは、次の問題について説明します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-105">This topic discusses the following issues:</span></span>

- <span data-ttu-id="6e4f3-106">セルスタイルの効率的な使用</span><span class="sxs-lookup"><span data-stu-id="6e4f3-106">Using cell styles efficiently</span></span>

- <span data-ttu-id="6e4f3-107">ショートカットメニューの効率的な使用</span><span class="sxs-lookup"><span data-stu-id="6e4f3-107">Using shortcut menus efficiently</span></span>

- <span data-ttu-id="6e4f3-108">自動サイズ変更の効率的な使用</span><span class="sxs-lookup"><span data-stu-id="6e4f3-108">Using automatic resizing efficiently</span></span>

- <span data-ttu-id="6e4f3-109">選択したセル、行、および列のコレクションを効率的に使用する</span><span class="sxs-lookup"><span data-stu-id="6e4f3-109">Using the selected cells, rows, and columns collections efficiently</span></span>

- <span data-ttu-id="6e4f3-110">共有行の使用</span><span class="sxs-lookup"><span data-stu-id="6e4f3-110">Using shared rows</span></span>

- <span data-ttu-id="6e4f3-111">行が非共有になるのを防ぐ</span><span class="sxs-lookup"><span data-stu-id="6e4f3-111">Preventing rows from becoming unshared</span></span>

<span data-ttu-id="6e4f3-112">特別なパフォーマンスのニーズがある場合は、仮想モードを実装し、独自のデータ管理操作を提供できます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-112">If you have special performance needs, you can implement virtual mode and provide your own data management operations.</span></span> <span data-ttu-id="6e4f3-113">詳細については、「 [Windows フォーム DataGridView コントロールのデータ表示モード](data-display-modes-in-the-windows-forms-datagridview-control.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-113">For more information, see [Data Display Modes in the Windows Forms DataGridView Control](data-display-modes-in-the-windows-forms-datagridview-control.md).</span></span>

## <a name="using-cell-styles-efficiently"></a><span data-ttu-id="6e4f3-114">セルスタイルの効率的な使用</span><span class="sxs-lookup"><span data-stu-id="6e4f3-114">Using Cell Styles Efficiently</span></span>

<span data-ttu-id="6e4f3-115">各セル、行、および列には、独自のスタイル情報を設定できます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-115">Each cell, row, and column can have its own style information.</span></span> <span data-ttu-id="6e4f3-116">スタイル情報は <xref:System.Windows.Forms.DataGridViewCellStyle> オブジェクトに格納されます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-116">Style information is stored in <xref:System.Windows.Forms.DataGridViewCellStyle> objects.</span></span> <span data-ttu-id="6e4f3-117">特に大量のデータを使用する場合、多くの個別の <xref:System.Windows.Forms.DataGridView> 要素に対してセルスタイルオブジェクトを作成することは非効率的です。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-117">Creating cell style objects for many individual <xref:System.Windows.Forms.DataGridView> elements can be inefficient, especially when working with large amounts of data.</span></span> <span data-ttu-id="6e4f3-118">パフォーマンスへの影響を回避するには、次のガイドラインに従います。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-118">To avoid a performance impact, use the following guidelines:</span></span>

- <span data-ttu-id="6e4f3-119">個々の <xref:System.Windows.Forms.DataGridViewCell> または <xref:System.Windows.Forms.DataGridViewRow> オブジェクトのセルスタイルプロパティを設定しないようにします。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-119">Avoid setting cell style properties for individual <xref:System.Windows.Forms.DataGridViewCell> or <xref:System.Windows.Forms.DataGridViewRow> objects.</span></span> <span data-ttu-id="6e4f3-120">これには、<xref:System.Windows.Forms.DataGridView.RowTemplate%2A> プロパティによって指定された row オブジェクトも含まれます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-120">This includes the row object specified by the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A> property.</span></span> <span data-ttu-id="6e4f3-121">行テンプレートから複製された新しい行はそれぞれ、テンプレートのセルスタイルオブジェクトの独自のコピーを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-121">Each new row that is cloned from the row template will receive its own copy of the template's cell style object.</span></span> <span data-ttu-id="6e4f3-122">最大限のスケーラビリティを実現するには、<xref:System.Windows.Forms.DataGridView> レベルでセルスタイルプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-122">For maximum scalability, set cell style properties at the <xref:System.Windows.Forms.DataGridView> level.</span></span> <span data-ttu-id="6e4f3-123">たとえば、<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> プロパティではなく、<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType> プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-123">For example, set the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="6e4f3-124">既定の書式設定以外の書式設定が必要なセルがある場合は、セル、行、または列のグループ間で同じ <xref:System.Windows.Forms.DataGridViewCellStyle> インスタンスを使用します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-124">If some cells require formatting other than default formatting, use the same <xref:System.Windows.Forms.DataGridViewCellStyle> instance across groups of cells, rows, or columns.</span></span> <span data-ttu-id="6e4f3-125">個々のセル、行、および列に対して <xref:System.Windows.Forms.DataGridViewCellStyle> 型のプロパティを直接設定することは避けてください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-125">Avoid directly setting properties of type <xref:System.Windows.Forms.DataGridViewCellStyle> on individual cells, rows, and columns.</span></span> <span data-ttu-id="6e4f3-126">セルスタイル共有の例については、「[方法: Windows フォーム DataGridView コントロールの既定のセルスタイルを設定する](how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-126">For an example of cell style sharing, see [How to: Set Default Cell Styles for the Windows Forms DataGridView Control](how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md).</span></span> <span data-ttu-id="6e4f3-127"><xref:System.Windows.Forms.DataGridView.CellFormatting> イベントハンドラーを処理することによって、セルスタイルを個別に設定するときにパフォーマンスが低下しないようにすることもできます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-127">You can also avoid a performance penalty when setting cell styles individually by handling the <xref:System.Windows.Forms.DataGridView.CellFormatting> event handler.</span></span> <span data-ttu-id="6e4f3-128">例については、「[方法: Windows フォーム DataGridView コントロールでデータの書式をカスタマイズする](how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-128">For an example, see [How to: Customize Data Formatting in the Windows Forms DataGridView Control](how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md).</span></span>

- <span data-ttu-id="6e4f3-129">セルのスタイルを決定するときは、<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> プロパティではなく、<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType> プロパティを使用します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-129">When determining a cell's style, use the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="6e4f3-130">プロパティがまだ使用されていない場合は、<xref:System.Windows.Forms.DataGridViewCell.Style%2A> プロパティにアクセスすると、<xref:System.Windows.Forms.DataGridViewCellStyle> クラスの新しいインスタンスが作成されます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-130">Accessing the <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property creates a new instance of the <xref:System.Windows.Forms.DataGridViewCellStyle> class if the property has not already been used.</span></span> <span data-ttu-id="6e4f3-131">また、行、列、またはコントロールからいくつかのスタイルが継承されている場合、このオブジェクトにはセルの完全なスタイル情報が含まれていない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-131">Additionally, this object might not contain the complete style information for the cell if some styles are inherited from the row, column, or control.</span></span> <span data-ttu-id="6e4f3-132">セルスタイルの継承の詳細については、「 [Windows フォーム DataGridView コントロールのセルのスタイル](cell-styles-in-the-windows-forms-datagridview-control.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-132">For more information about cell style inheritance, see [Cell Styles in the Windows Forms DataGridView Control](cell-styles-in-the-windows-forms-datagridview-control.md).</span></span>

## <a name="using-shortcut-menus-efficiently"></a><span data-ttu-id="6e4f3-133">ショートカットメニューの効率的な使用</span><span class="sxs-lookup"><span data-stu-id="6e4f3-133">Using Shortcut Menus Efficiently</span></span>

<span data-ttu-id="6e4f3-134">各セル、行、および列には、独自のショートカットメニューを設定できます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-134">Each cell, row, and column can have its own shortcut menu.</span></span> <span data-ttu-id="6e4f3-135"><xref:System.Windows.Forms.DataGridView> コントロールのショートカットメニューは、<xref:System.Windows.Forms.ContextMenuStrip> コントロールによって表されます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-135">Shortcut menus in the <xref:System.Windows.Forms.DataGridView> control are represented by <xref:System.Windows.Forms.ContextMenuStrip> controls.</span></span> <span data-ttu-id="6e4f3-136">セルスタイルオブジェクトと同様に、多くの個別の <xref:System.Windows.Forms.DataGridView> 要素のショートカットメニューを作成すると、パフォーマンスが低下します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-136">Just as with cell style objects, creating shortcut menus for many individual <xref:System.Windows.Forms.DataGridView> elements will negatively impact performance.</span></span> <span data-ttu-id="6e4f3-137">このようにペナルティを回避するには、次のガイドラインに従います。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-137">To avoid this penalty, use the following guidelines:</span></span>

- <span data-ttu-id="6e4f3-138">個々のセルおよび行のショートカットメニューを作成しないようにします。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-138">Avoid creating shortcut menus for individual cells and rows.</span></span> <span data-ttu-id="6e4f3-139">これには、新しい行がコントロールに追加されたときに、そのショートカットメニューと共に複製される行テンプレートが含まれます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-139">This includes the row template, which is cloned along with its shortcut menu when new rows are added to the control.</span></span> <span data-ttu-id="6e4f3-140">最大限のスケーラビリティを実現するには、コントロールの <xref:System.Windows.Forms.Control.ContextMenuStrip%2A> プロパティのみを使用して、コントロール全体に1つのショートカットメニューを指定します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-140">For maximum scalability, use only the control's <xref:System.Windows.Forms.Control.ContextMenuStrip%2A> property to specify a single shortcut menu for the entire control.</span></span>

- <span data-ttu-id="6e4f3-141">複数の行またはセルに複数のショートカットメニューが必要な場合は、<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> イベントまたは <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded> イベントを処理します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-141">If you require multiple shortcut menus for multiple rows or cells, handle the <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> or <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded> events.</span></span> <span data-ttu-id="6e4f3-142">これらのイベントを使用すると、ショートカットメニューオブジェクトを自分で管理できるため、パフォーマンスを調整できます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-142">These events let you manage the shortcut menu objects yourself, allowing you to tune performance.</span></span>

## <a name="using-automatic-resizing-efficiently"></a><span data-ttu-id="6e4f3-143">自動サイズ変更の効率的な使用</span><span class="sxs-lookup"><span data-stu-id="6e4f3-143">Using Automatic Resizing Efficiently</span></span>

<span data-ttu-id="6e4f3-144">セルの内容全体がクリッピングなしで表示されるように、行、列、およびヘッダーをセルの内容の変更に合わせて自動的にサイズ変更することができます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-144">Rows, columns, and headers can be automatically resized as cell content changes so that the entire contents of cells are displayed without clipping.</span></span> <span data-ttu-id="6e4f3-145">サイズ変更モードを変更すると、行、列、およびヘッダーのサイズも変更される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-145">Changing sizing modes can also resize rows, columns, and headers.</span></span> <span data-ttu-id="6e4f3-146">正しいサイズを判断するには、<xref:System.Windows.Forms.DataGridView> コントロールで、対応が必要な各セルの値を確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-146">To determine the correct size, the <xref:System.Windows.Forms.DataGridView> control must examine the value of each cell that it must accommodate.</span></span> <span data-ttu-id="6e4f3-147">大きなデータセットを使用する場合、自動サイズ変更が発生すると、この分析によってコントロールのパフォーマンスが低下する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-147">When working with large data sets, this analysis can negatively impact the performance of the control when automatic resizing occurs.</span></span> <span data-ttu-id="6e4f3-148">パフォーマンスの低下を回避するには、次のガイドラインに従います。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-148">To avoid performance penalties, use the following guidelines:</span></span>

- <span data-ttu-id="6e4f3-149">大量の行を含む <xref:System.Windows.Forms.DataGridView> コントロールでは、自動サイズ設定を使用しないようにしてください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-149">Avoid using automatic sizing on a <xref:System.Windows.Forms.DataGridView> control with a large set of rows.</span></span> <span data-ttu-id="6e4f3-150">自動サイズ変更を使用する場合は、表示されている行に基づいてサイズを変更するだけです。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-150">If you do use automatic sizing, only resize based on the displayed rows.</span></span> <span data-ttu-id="6e4f3-151">仮想モードでも表示されている行のみを使用します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-151">Use only the displayed rows in virtual mode as well.</span></span>

  - <span data-ttu-id="6e4f3-152">行と列の場合は、<xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>、<xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>、および <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode> 列挙型の `DisplayedCells` フィールドまたは `DisplayedCellsExceptHeaders` フィールドを使用します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-152">For rows and columns, use the `DisplayedCells` or `DisplayedCellsExceptHeaders` field of the <xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>, <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>, and <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode> enumerations.</span></span>

  - <span data-ttu-id="6e4f3-153">行ヘッダーの場合は、<xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode> 列挙の <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders> または <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader> フィールドを使用します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-153">For row headers, use the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders> or <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader> field of the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode> enumeration.</span></span>

- <span data-ttu-id="6e4f3-154">最大限のスケーラビリティを実現するには、自動サイズ変更をオフにし、プログラムによるサイズ変更を使用します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-154">For maximum scalability, turn off automatic sizing and use programmatic resizing.</span></span>

<span data-ttu-id="6e4f3-155">詳細については、「 [Windows フォーム DataGridView コントロールのサイズ変更オプション](sizing-options-in-the-windows-forms-datagridview-control.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-155">For more information, see [Sizing Options in the Windows Forms DataGridView Control](sizing-options-in-the-windows-forms-datagridview-control.md).</span></span>

## <a name="using-the-selected-cells-rows-and-columns-collections-efficiently"></a><span data-ttu-id="6e4f3-156">選択したセル、行、および列のコレクションを効率的に使用する</span><span class="sxs-lookup"><span data-stu-id="6e4f3-156">Using the Selected Cells, Rows, and Columns Collections Efficiently</span></span>

<span data-ttu-id="6e4f3-157"><xref:System.Windows.Forms.DataGridView.SelectedCells%2A> コレクションは、大きな選択によって効率的には実行されません。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-157">The <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection does not perform efficiently with large selections.</span></span> <span data-ttu-id="6e4f3-158"><xref:System.Windows.Forms.DataGridView.SelectedRows%2A> コレクションと <xref:System.Windows.Forms.DataGridView.SelectedColumns%2A> コレクションも非効率的ですが、一般的な <xref:System.Windows.Forms.DataGridView> コントロールのセルよりも多くの行があり、行よりも多くの列が少ないため、効率が悪くなります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-158">The <xref:System.Windows.Forms.DataGridView.SelectedRows%2A> and <xref:System.Windows.Forms.DataGridView.SelectedColumns%2A> collections can also be inefficient, although to a lesser degree because there are many fewer rows than cells in a typical <xref:System.Windows.Forms.DataGridView> control, and many fewer columns than rows.</span></span> <span data-ttu-id="6e4f3-159">これらのコレクションを操作するときのパフォーマンスの低下を回避するには、次のガイドラインに従います。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-159">To avoid performance penalties when working with these collections, use the following guidelines:</span></span>

- <span data-ttu-id="6e4f3-160"><xref:System.Windows.Forms.DataGridView.SelectedCells%2A> コレクションの内容にアクセスする前に、<xref:System.Windows.Forms.DataGridView> 内のすべてのセルが選択されているかどうかを確認するには、<xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A> メソッドの戻り値を確認します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-160">To determine whether all the cells in the <xref:System.Windows.Forms.DataGridView> have been selected before you access the contents of the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection, check the return value of the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A> method.</span></span> <span data-ttu-id="6e4f3-161">ただし、この方法では、行が共有されなくなる可能性があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-161">Note, however, that this method can cause rows to become unshared.</span></span> <span data-ttu-id="6e4f3-162">詳細については、次のセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-162">For more information, see the next section.</span></span>

- <span data-ttu-id="6e4f3-163"><xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType> の <xref:System.Collections.ICollection.Count%2A> プロパティを使用して、選択したセルの数を決定するのは避けてください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-163">Avoid using the <xref:System.Collections.ICollection.Count%2A> property of the <xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType> to determine the number of selected cells.</span></span> <span data-ttu-id="6e4f3-164">代わりに、<xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType> メソッドを使用し、<xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType> の値を渡します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-164">Instead, use the <xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType> method and pass in the <xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType> value.</span></span> <span data-ttu-id="6e4f3-165">同様に、選択した行および列のコレクションにアクセスするのではなく、<xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType> および <xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType> メソッドを使用して、選択した要素の数を決定します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-165">Similarly, use the <xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType> and <xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType> methods to determine the number of selected elements, rather than accessing the selected row and column collections.</span></span>

- <span data-ttu-id="6e4f3-166">セルベースの選択モードは避けてください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-166">Avoid cell-based selection modes.</span></span> <span data-ttu-id="6e4f3-167">代わりに、<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> プロパティを <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> または <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>に設定します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-167">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>

## <a name="using-shared-rows"></a><span data-ttu-id="6e4f3-168">共有行の使用</span><span class="sxs-lookup"><span data-stu-id="6e4f3-168">Using Shared Rows</span></span>

<span data-ttu-id="6e4f3-169">効率的なメモリ使用は、共有行によって <xref:System.Windows.Forms.DataGridView> 制御で実現されます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-169">Efficient memory use is achieved in the <xref:System.Windows.Forms.DataGridView> control through shared rows.</span></span> <span data-ttu-id="6e4f3-170">行は、<xref:System.Windows.Forms.DataGridViewRow> クラスのインスタンスを共有することで、その外観と動作に関する情報を可能な限り共有します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-170">Rows will share as much information about their appearance and behavior as possible by sharing instances of the <xref:System.Windows.Forms.DataGridViewRow> class.</span></span>

<span data-ttu-id="6e4f3-171">行インスタンスを共有するとメモリが節約されますが、行は簡単に非共有になります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-171">While sharing row instances saves memory, rows can easily become unshared.</span></span> <span data-ttu-id="6e4f3-172">たとえば、ユーザーが直接セルを操作すると、その行の共有が解除されます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-172">For example, whenever a user interacts directly with a cell, its row becomes unshared.</span></span> <span data-ttu-id="6e4f3-173">このことは避けられないため、このトピックのガイドラインは、非常に大量のデータを扱う場合、およびプログラムを実行するたびにユーザーが比較的小さなデータの一部を操作する場合にのみ役立ちます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-173">Because this cannot be avoided, the guidelines in this topic are useful only when working with very large amounts of data and only when users will interact with a relatively small part of the data each time your program is run.</span></span>

<span data-ttu-id="6e4f3-174">セルに値が含まれている場合、バインドされていない <xref:System.Windows.Forms.DataGridView> コントロールで行を共有することはできません。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-174">A row cannot be shared in an unbound <xref:System.Windows.Forms.DataGridView> control if any of its cells contain values.</span></span> <span data-ttu-id="6e4f3-175"><xref:System.Windows.Forms.DataGridView> コントロールが外部データソースにバインドされている場合、または仮想モードを実装して独自のデータソースを指定した場合、セル値はセルオブジェクトではなく、コントロールの外部に格納されるので、行を共有することができます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-175">When the <xref:System.Windows.Forms.DataGridView> control is bound to an external data source or when you implement virtual mode and provide your own data source, the cell values are stored outside the control rather than in cell objects, allowing the rows to be shared.</span></span>

<span data-ttu-id="6e4f3-176">行オブジェクトを共有できるのは、すべてのセルの状態が行の状態とセルを含む列の状態から決まる場合だけです。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-176">A row object can only be shared if the state of all its cells can be determined from the state of the row and the states of the columns containing the cells.</span></span> <span data-ttu-id="6e4f3-177">行と列の状態から推測できないようにセルの状態を変更すると、その行を共有することはできません。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-177">If you change the state of a cell so that it can no longer be deduced from the state of its row and column, the row cannot be shared.</span></span>

<span data-ttu-id="6e4f3-178">たとえば、次のような状況では、行を共有することはできません。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-178">For example, a row cannot be shared in any of the following situations:</span></span>

- <span data-ttu-id="6e4f3-179">この行には、選択された列に含まれていない1つの選択されたセルが含まれています。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-179">The row contains a single selected cell that is not in a selected column.</span></span>

- <span data-ttu-id="6e4f3-180">この行には、<xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A> または <xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> プロパティが設定されたセルが含まれています。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-180">The row contains a cell with its <xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A> or <xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> properties set.</span></span>

- <span data-ttu-id="6e4f3-181">この行には、<xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A> プロパティが設定された <xref:System.Windows.Forms.DataGridViewComboBoxCell> が含まれています。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-181">The row contains a <xref:System.Windows.Forms.DataGridViewComboBoxCell> with its <xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A> property set.</span></span>

<span data-ttu-id="6e4f3-182">バインドモードまたは仮想モードでは、<xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded> イベントと <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> イベントを処理することによって、個々のセルのツールヒントやショートカットメニューを提供できます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-182">In bound mode or virtual mode, you can provide ToolTips and shortcut menus for individual cells by handling the <xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded> and <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> events.</span></span>

<span data-ttu-id="6e4f3-183"><xref:System.Windows.Forms.DataGridView> コントロールは、行が <xref:System.Windows.Forms.DataGridViewRowCollection>に追加されるたびに、共有行を自動的に使用しようとします。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-183">The <xref:System.Windows.Forms.DataGridView> control will automatically attempt to use shared rows whenever rows are added to the <xref:System.Windows.Forms.DataGridViewRowCollection>.</span></span> <span data-ttu-id="6e4f3-184">次のガイドラインを使用して、行が共有されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-184">Use the following guidelines to ensure that rows are shared:</span></span>

- <span data-ttu-id="6e4f3-185"><xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> メソッドの `Add(Object[])` オーバーロードと、<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> コレクションの <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> メソッドの `Insert(Object[])` オーバーロードを呼び出さないでください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-185">Avoid calling the `Add(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method and the `Insert(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="6e4f3-186">これらのオーバーロードは、自動的に非共有行を作成します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-186">These overloads automatically create unshared rows.</span></span>

- <span data-ttu-id="6e4f3-187">次の場合は、<xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType> プロパティで指定された行を共有できることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-187">Be sure that the row specified in the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType> property can be shared in the following cases:</span></span>

  - <span data-ttu-id="6e4f3-188">`Add()` を呼び出す場合、または <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> メソッドの `Add(Int32)` オーバーロード、または <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> コレクションの <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> メソッドの `Insert(Int32,Int32)` オーバーロード。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-188">When calling the `Add()` or `Add(Int32)` overloads of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method or the `Insert(Int32,Int32)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>

  - <span data-ttu-id="6e4f3-189"><xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType> プロパティの値を増やす場合。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-189">When increasing the value of the <xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType> property.</span></span>

  - <span data-ttu-id="6e4f3-190"><xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType> プロパティを設定する場合。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-190">When setting the <xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="6e4f3-191"><xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A> コレクションの <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>、<xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>、<xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>、および <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> の各メソッドを呼び出すときに、`indexSource` パラメーターによって示される行を共有できることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-191">Be sure that the row indicated by the `indexSource` parameter can be shared when calling the <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>, and <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A> methods of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>

- <span data-ttu-id="6e4f3-192"><xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> メソッド、<xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A> メソッド、<xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> メソッドの `Insert(Int32,DataGridViewRow)` オーバーロード、および <xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A> コレクションの <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> メソッドの `Add(DataGridViewRow)` オーバーロードを呼び出すときに、指定された行を共有できることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-192">Be sure that the specified row or rows can be shared when calling the `Add(DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method, the <xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A> method, the `Insert(Int32,DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method, and the <xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>

<span data-ttu-id="6e4f3-193">行が共有されているかどうかを判断するには、<xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> メソッドを使用して行オブジェクトを取得し、オブジェクトの <xref:System.Windows.Forms.DataGridViewBand.Index%2A> プロパティを確認します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-193">To determine whether a row is shared, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method to retrieve the row object, and then check the object's <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property.</span></span> <span data-ttu-id="6e4f3-194">共有行には、常に、<xref:System.Windows.Forms.DataGridViewBand.Index%2A> のプロパティ値が-1 に設定されています。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-194">Shared rows always have an <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property value of –1.</span></span>

## <a name="preventing-rows-from-becoming-unshared"></a><span data-ttu-id="6e4f3-195">行が非共有になるのを防ぐ</span><span class="sxs-lookup"><span data-stu-id="6e4f3-195">Preventing Rows from Becoming Unshared</span></span>

<span data-ttu-id="6e4f3-196">共有行は、コードまたはユーザー操作の結果として非共有になることがあります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-196">Shared rows can become unshared as a result of code or user action.</span></span> <span data-ttu-id="6e4f3-197">パフォーマンスへの影響を回避するには、行が共有されなくなるのを避ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-197">To avoid a performance impact, you should avoid causing rows to become unshared.</span></span> <span data-ttu-id="6e4f3-198">アプリケーションの開発中に、<xref:System.Windows.Forms.DataGridView.RowUnshared> のイベントを処理して、行の共有を解除するタイミングを判断できます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-198">During application development, you can handle the <xref:System.Windows.Forms.DataGridView.RowUnshared> event to determine when rows become unshared.</span></span> <span data-ttu-id="6e4f3-199">これは、行共有の問題をデバッグする場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-199">This is useful when debugging row-sharing problems.</span></span>

<span data-ttu-id="6e4f3-200">行が非共有にならないようにするには、次のガイドラインに従います。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-200">To prevent rows from becoming unshared, use the following guidelines:</span></span>

- <span data-ttu-id="6e4f3-201"><xref:System.Windows.Forms.DataGridView.Rows%2A> コレクションにインデックスを作成したり、`foreach` ループで反復処理したりしないでください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-201">Avoid indexing the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection or iterating through it with a `foreach` loop.</span></span> <span data-ttu-id="6e4f3-202">通常、行に直接アクセスする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-202">You will not typically need to access rows directly.</span></span> <span data-ttu-id="6e4f3-203">行を操作する <xref:System.Windows.Forms.DataGridView> メソッドは、行インスタンスではなく行インデックス引数を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-203"><xref:System.Windows.Forms.DataGridView> methods that operate on rows take row index arguments rather than row instances.</span></span> <span data-ttu-id="6e4f3-204">さらに、行関連のイベントのハンドラーは、行プロパティを持つイベント引数オブジェクトを受け取ります。このオブジェクトを使用して、共有を解除することなく行を操作できます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-204">Additionally, handlers for row-related events receive event argument objects with row properties that you can use to manipulate rows without causing them to become unshared.</span></span>

- <span data-ttu-id="6e4f3-205">行オブジェクトにアクセスする必要がある場合は、<xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> メソッドを使用して、行の実際のインデックスを渡します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-205">If you need to access a row object, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method and pass in the row's actual index.</span></span> <span data-ttu-id="6e4f3-206">ただし、このメソッドを使用して取得した共有行オブジェクトを変更すると、このオブジェクトを共有するすべての行が変更されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-206">Note, however, that modifying a shared row object retrieved through this method will modify all the rows that share this object.</span></span> <span data-ttu-id="6e4f3-207">ただし、新しいレコードの行は他の行と共有されないため、他の行を変更しても影響はありません。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-207">The row for new records is not shared with other rows, however, so it will not be affected when you modify any other row.</span></span> <span data-ttu-id="6e4f3-208">また、共有行によって表される異なる行のショートカットメニューが異なる場合もあります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-208">Note also that different rows represented by a shared row may have different shortcut menus.</span></span> <span data-ttu-id="6e4f3-209">共有行インスタンスから正しいショートカットメニューを取得するには、<xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A> メソッドを使用して、行の実際のインデックスを渡します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-209">To retrieve the correct shortcut menu from a shared row instance, use the <xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A> method and pass in the row's actual index.</span></span> <span data-ttu-id="6e4f3-210">代わりに、共有行の <xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> プロパティにアクセスすると、共有行インデックス-1 が使用され、正しいショートカットメニューは取得されません。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-210">If you access the shared row's <xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> property instead, it will use the shared row index of -1 and will not retrieve the correct shortcut menu.</span></span>

- <span data-ttu-id="6e4f3-211"><xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType> コレクションのインデックス作成は避けてください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-211">Avoid indexing the <xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="6e4f3-212">セルに直接アクセスすると、親の行が非共有になり、新しい <xref:System.Windows.Forms.DataGridViewRow>がインスタンス化されます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-212">Accessing a cell directly will cause its parent row to become unshared, instantiating a new <xref:System.Windows.Forms.DataGridViewRow>.</span></span> <span data-ttu-id="6e4f3-213">セル関連イベントのハンドラーは、セルプロパティを使用してイベント引数オブジェクトを受け取ります。このオブジェクトを使用すると、行の共有を解除せずにセルを操作できます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-213">Handlers for cell-related events receive event argument objects with cell properties that you can use to manipulate cells without causing rows to become unshared.</span></span> <span data-ttu-id="6e4f3-214">また、<xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A> プロパティを使用して、セルに直接アクセスせずに、現在のセルの行インデックスと列インデックスを取得することもできます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-214">You can also use the <xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A> property to retrieve the row and column indexes of the current cell without accessing the cell directly.</span></span>

- <span data-ttu-id="6e4f3-215">セルベースの選択モードは避けてください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-215">Avoid cell-based selection modes.</span></span> <span data-ttu-id="6e4f3-216">これらのモードでは、行が共有されなくなります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-216">These modes cause rows to become unshared.</span></span> <span data-ttu-id="6e4f3-217">代わりに、<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> プロパティを <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> または <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>に設定します。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-217">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>

- <span data-ttu-id="6e4f3-218"><xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType> イベントまたは <xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType> イベントは処理しないようにします。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-218">Do not handle the <xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType> events.</span></span> <span data-ttu-id="6e4f3-219">これらのイベントにより、行が共有されなくなります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-219">These events cause rows to become unshared.</span></span> <span data-ttu-id="6e4f3-220">また、これらのイベントを発生させる <xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType> または <xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType> メソッドを呼び出さないでください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-220">Also, do not call the <xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType> methods, which raise these events.</span></span>

- <span data-ttu-id="6e4f3-221"><xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> プロパティの値が <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>、<xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>、<xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>、または <xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>の場合は、<xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType> コレクションにアクセスしないでください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-221">Do not access the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType> collection when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>, or <xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>.</span></span> <span data-ttu-id="6e4f3-222">これにより、選択したすべての行の共有が解除されます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-222">This causes all selected rows to become unshared.</span></span>

- <span data-ttu-id="6e4f3-223"><xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType> メソッドを呼び出さないでください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-223">Do not call the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="6e4f3-224">このメソッドは、行が共有されなくなる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-224">This method can cause rows to become unshared.</span></span>

- <span data-ttu-id="6e4f3-225"><xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> プロパティ値が <xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>場合は、<xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType> メソッドを呼び出さないでください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-225">Do not call the <xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType> method when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>.</span></span> <span data-ttu-id="6e4f3-226">これにより、すべての行が非共有になります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-226">This causes all rows to become unshared.</span></span>

- <span data-ttu-id="6e4f3-227">列の対応するプロパティが `true`に設定されている場合は、セルの <xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A> または <xref:System.Windows.Forms.DataGridViewCell.Selected%2A> プロパティを `false` に設定しないでください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-227">Do not set the <xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A> or <xref:System.Windows.Forms.DataGridViewCell.Selected%2A> property of a cell to `false` when the corresponding property in its column is set to `true`.</span></span> <span data-ttu-id="6e4f3-228">これにより、すべての行が非共有になります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-228">This causes all rows to become unshared.</span></span>

- <span data-ttu-id="6e4f3-229"><xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType> プロパティにはアクセスしないでください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-229">Do not access the <xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="6e4f3-230">これにより、すべての行が非共有になります。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-230">This causes all rows to become unshared.</span></span>

- <span data-ttu-id="6e4f3-231"><xref:System.Windows.Forms.DataGridView.Sort%2A> メソッドの `Sort(IComparer)` オーバーロードは呼び出さないでください。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-231">Do not call the `Sort(IComparer)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method.</span></span> <span data-ttu-id="6e4f3-232">カスタム比較子を使用して並べ替えると、すべての行の共有が解除されます。</span><span class="sxs-lookup"><span data-stu-id="6e4f3-232">Sorting with a custom comparer causes all rows to become unshared.</span></span>

## <a name="see-also"></a><span data-ttu-id="6e4f3-233">関連項目</span><span class="sxs-lookup"><span data-stu-id="6e4f3-233">See also</span></span>

- <xref:System.Windows.Forms.DataGridView>
- [<span data-ttu-id="6e4f3-234">Windows フォーム DataGridView コントロールでのパフォーマンス チューニング</span><span class="sxs-lookup"><span data-stu-id="6e4f3-234">Performance Tuning in the Windows Forms DataGridView Control</span></span>](performance-tuning-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="6e4f3-235">Windows フォーム DataGridView コントロールでの仮想モード</span><span class="sxs-lookup"><span data-stu-id="6e4f3-235">Virtual Mode in the Windows Forms DataGridView Control</span></span>](virtual-mode-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="6e4f3-236">Windows フォーム DataGridView コントロールでのデータ表示モード</span><span class="sxs-lookup"><span data-stu-id="6e4f3-236">Data Display Modes in the Windows Forms DataGridView Control</span></span>](data-display-modes-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="6e4f3-237">Windows フォーム DataGridView コントロールでのセルのスタイル</span><span class="sxs-lookup"><span data-stu-id="6e4f3-237">Cell Styles in the Windows Forms DataGridView Control</span></span>](cell-styles-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="6e4f3-238">方法: Windows フォーム DataGridView コントロールの既定のセル スタイルを設定する</span><span class="sxs-lookup"><span data-stu-id="6e4f3-238">How to: Set Default Cell Styles for the Windows Forms DataGridView Control</span></span>](how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="6e4f3-239">Windows フォーム DataGridView コントロールのサイズ変更オプション</span><span class="sxs-lookup"><span data-stu-id="6e4f3-239">Sizing Options in the Windows Forms DataGridView Control</span></span>](sizing-options-in-the-windows-forms-datagridview-control.md)
