---
title: Windows Communication Foundation のアーキテクチャ
description: コントラクト、サービスランタイム、メッセージング、アクティブ化 & ホストなど、Windows Communication Foundation アーキテクチャの主要な層について説明します。
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Communication Foundation [WCF], architecture
- WCF [WCF], architecture
- architecture [WCF]
ms.assetid: a3bcb0a1-56ea-4ba6-9736-d260d90dade5
ms.openlocfilehash: 7cb03ddd7207fbea23577ff18e984e90779333bc
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/26/2020
ms.locfileid: "96294886"
---
# <a name="windows-communication-foundation-architecture"></a><span data-ttu-id="a70f5-103">Windows Communication Foundation のアーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="a70f5-103">Windows Communication Foundation Architecture</span></span>

<span data-ttu-id="a70f5-104">次の図は、Windows Communication Foundation (WCF) アーキテクチャの主要な層を示しています。</span><span class="sxs-lookup"><span data-stu-id="a70f5-104">The following graphic illustrates the major layers of the Windows Communication Foundation (WCF) architecture.</span></span>  
  
## <a name="wcf-architecture"></a><span data-ttu-id="a70f5-105">WCF アーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="a70f5-105">WCF Architecture</span></span>  

 <span data-ttu-id="a70f5-106">![WCF アーキテクチャ](./media/wcf-architecture.gif "WCF_Architecture")</span><span class="sxs-lookup"><span data-stu-id="a70f5-106">![The WCF Architecture](./media/wcf-architecture.gif "WCF_Architecture")</span></span>  
  
### <a name="contracts-and-descriptions"></a><span data-ttu-id="a70f5-107">コントラクトと記述</span><span class="sxs-lookup"><span data-stu-id="a70f5-107">Contracts and Descriptions</span></span>  

 <span data-ttu-id="a70f5-108">コントラクトは、メッセージ システムのさまざまな側面を定義します。</span><span class="sxs-lookup"><span data-stu-id="a70f5-108">Contracts define various aspects of the message system.</span></span> <span data-ttu-id="a70f5-109">データ コントラクトには、サービスが作成または処理できるすべてのメッセージを構成するすべてのパラメーターが記述されます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-109">The data contract describes every parameter that makes up every message that a service can create or consume.</span></span> <span data-ttu-id="a70f5-110">メッセージ パラメーターは、XML を理解できるすべてのシステムがドキュメントを処理できるように XML スキーマ定義言語 (XSD) ドキュメントによって定義されます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-110">The message parameters are defined by XML Schema definition language (XSD) documents, enabling any system that understands XML to process the documents.</span></span> <span data-ttu-id="a70f5-111">メッセージ コントラクトは、SOAP プロトコルを使用する特定のメッセージ部分を定義し、相互運用性機能によって正確さが要求される場合に、よりきめ細かな制御を許可します。</span><span class="sxs-lookup"><span data-stu-id="a70f5-111">The message contract defines specific message parts using SOAP protocols, and allows finer-grained control over parts of the message, when interoperability demands such precision.</span></span> <span data-ttu-id="a70f5-112">サービス コントラクトは、サービスの実際のメソッド署名を指定し、サポートされているプログラミング言語のいずれか (Visual Basic や Visual C# など) で記述されたインターフェイスとして配布されます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-112">The service contract specifies the actual method signatures of the service, and is distributed as an interface in one of the supported programming languages, such as Visual Basic or Visual C#.</span></span>  
  
 <span data-ttu-id="a70f5-113">ポリシーとバインディングは、サービスとの通信に必要な条件を規定します。</span><span class="sxs-lookup"><span data-stu-id="a70f5-113">Policies and bindings stipulate the conditions required to communicate with a service.</span></span>  <span data-ttu-id="a70f5-114">たとえば、バインディングでは、使用するトランスポート (HTTP や TCP など) とエンコーディングを少なくとも指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a70f5-114">For example, the binding must (at a minimum) specify the transport used (for example, HTTP or TCP), and an encoding.</span></span> <span data-ttu-id="a70f5-115">ポリシーには、セキュリティ要件、およびサービスと通信するために満たす必要があるその他の条件が含まれます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-115">Policies include security requirements and other conditions that must be met to communicate with a service.</span></span>  
  
### <a name="service-runtime"></a><span data-ttu-id="a70f5-116">サービス ランタイム</span><span class="sxs-lookup"><span data-stu-id="a70f5-116">Service Runtime</span></span>  

 <span data-ttu-id="a70f5-117">サービス ランタイム レイヤーには、サービスの実際の操作の実行中にのみ発生する動作 (つまり、サービスのランタイム動作) が含まれます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-117">The service runtime layer contains the behaviors that occur only during the actual operation of the service, that is, the runtime behaviors of the service.</span></span> <span data-ttu-id="a70f5-118">調整コントロールでは、処理されるメッセージの数を制御します。サービスの需要が事前設定した上限に達した場合は、この数を変更できます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-118">Throttling controls how many messages are processed, which can be varied if the demand for the service grows to a preset limit.</span></span> <span data-ttu-id="a70f5-119">エラー動作では、サービスで内部エラーが発生した場合の処理方法 (たとえば、クライアントに伝達される情報を制御するなど) を指定します </span><span class="sxs-lookup"><span data-stu-id="a70f5-119">An error behavior specifies what occurs when an internal error occurs on the service, for example, by controlling what information is communicated to the client.</span></span> <span data-ttu-id="a70f5-120">(情報が多すぎると、悪意のあるユーザーが攻撃のマウントに利点を与える可能性があります)。メタデータの動作により、メタデータを外部の環境で使用できるようにする方法と方法が決まります。</span><span class="sxs-lookup"><span data-stu-id="a70f5-120">(Too much information can give a malicious user an advantage in mounting an attack.) Metadata behavior governs how and whether metadata is made available to the outside world.</span></span> <span data-ttu-id="a70f5-121">インスタンスの動作では、サービスのインスタンスをいくつ実行できるかを指定します (たとえば、シングルトンは、1 つのインスタンスですべてのメッセージを処理するように指定します)。</span><span class="sxs-lookup"><span data-stu-id="a70f5-121">Instance behavior specifies how many instances of the service can be run (for example, a singleton specifies only one instance to process all messages).</span></span> <span data-ttu-id="a70f5-122">トランザクションの動作では、エラーが発生した場合にトランザクション操作をロールバックできるようにします。</span><span class="sxs-lookup"><span data-stu-id="a70f5-122">Transaction behavior enables the rollback of transacted operations if a failure occurs.</span></span> <span data-ttu-id="a70f5-123">ディスパッチ動作は、WCF インフラストラクチャによってメッセージがどのように処理されるかを制御します。</span><span class="sxs-lookup"><span data-stu-id="a70f5-123">Dispatch behavior is the control of how a message is processed by the WCF infrastructure.</span></span>  
  
 <span data-ttu-id="a70f5-124">拡張機能を使用すると、ランタイム プロセスをカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-124">Extensibility enables customization of runtime processes.</span></span> <span data-ttu-id="a70f5-125">たとえば、メッセージの検査はメッセージの各部分を検査する機能です。また、パラメーターのフィルター処理を使用すると、メッセージ ヘッダーに作用するフィルターに基づいて、事前設定されたアクションを実行できます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-125">For example, message inspection is the facility to inspect parts of a message, and parameter filtering enables preset actions to occur based on filters acting on message headers.</span></span>  
  
### <a name="messaging"></a><span data-ttu-id="a70f5-126">メッセージング</span><span class="sxs-lookup"><span data-stu-id="a70f5-126">Messaging</span></span>  

 <span data-ttu-id="a70f5-127">メッセージング層は、 *チャネル* で構成されます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-127">The messaging layer is composed of *channels*.</span></span> <span data-ttu-id="a70f5-128">チャネルは、何らかの方法 (たとえば、メッセージを認証するなど) によってメッセージを処理するコンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="a70f5-128">A channel is a component that processes a message in some way, for example, by authenticating a message.</span></span> <span data-ttu-id="a70f5-129">チャネルのセットは、 *チャネルスタック* とも呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-129">A set of channels is also known as a *channel stack*.</span></span> <span data-ttu-id="a70f5-130">チャネルは、メッセージおよびメッセージ ヘッダーに対して作用します。</span><span class="sxs-lookup"><span data-stu-id="a70f5-130">Channels operate on messages and message headers.</span></span> <span data-ttu-id="a70f5-131">これは、主にメッセージ本文の内容の処理に関係するサービス ランタイム レイヤーとは異なります。</span><span class="sxs-lookup"><span data-stu-id="a70f5-131">This is different from the service runtime layer, which is primarily concerned about processing the contents of message bodies.</span></span>  
  
 <span data-ttu-id="a70f5-132">チャネルの種類としては、トランスポート チャネルとプロトコル チャネルの 2 つがあります。</span><span class="sxs-lookup"><span data-stu-id="a70f5-132">There are two types of channels: transport channels and protocol channels.</span></span>  
  
 <span data-ttu-id="a70f5-133">トランスポート チャネルは、ネットワーク (または外部との通信ポイント) からのメッセージの読み取りと書き込みを行います。</span><span class="sxs-lookup"><span data-stu-id="a70f5-133">Transport channels read and write messages from the network (or some other communication point with the outside world).</span></span> <span data-ttu-id="a70f5-134">一部のトランスポートはエンコーダーを使用して、(XML Infoset として表現される) メッセージを、ネットワークで使用されるバイト ストリーム表現に (またはその逆に) 変換します。</span><span class="sxs-lookup"><span data-stu-id="a70f5-134">Some transports use an encoder to convert messages (which are represented as XML Infosets) to and from the byte stream representation used by the network.</span></span> <span data-ttu-id="a70f5-135">トランスポートの例としては、HTTP、名前付きパイプ、TCP、MSMQ などがあります。</span><span class="sxs-lookup"><span data-stu-id="a70f5-135">Examples of transports are HTTP, named pipes, TCP, and MSMQ.</span></span> <span data-ttu-id="a70f5-136">エンコーディングの例としては、XML と最適化されたバイナリがあります。</span><span class="sxs-lookup"><span data-stu-id="a70f5-136">Examples of encodings are XML and optimized binary.</span></span>  
  
 <span data-ttu-id="a70f5-137">プロトコル チャネルは、メッセージ処理プロトコルを実装します。多くの場合、これはメッセージから追加のヘッダーを読み取るまたは書き込むことによって行います。</span><span class="sxs-lookup"><span data-stu-id="a70f5-137">Protocol channels implement message processing protocols, often by reading or writing additional headers to the message.</span></span> <span data-ttu-id="a70f5-138">このようなプロトコルの例としては、WS-Security と WS-Reliability があります。</span><span class="sxs-lookup"><span data-stu-id="a70f5-138">Examples of such protocols include WS-Security and WS-Reliability.</span></span>  
  
 <span data-ttu-id="a70f5-139">メッセージング レイヤーは、データに使用できる形式と交換パターンを示します。</span><span class="sxs-lookup"><span data-stu-id="a70f5-139">The messaging layer illustrates the possible formats and exchange patterns of the data.</span></span> <span data-ttu-id="a70f5-140">WS-Security は、メッセージ レイヤーでのセキュリティを有効にする WS-Security 仕様の実装です。</span><span class="sxs-lookup"><span data-stu-id="a70f5-140">WS-Security is an implementation of the WS-Security specification enabling security at the message layer.</span></span> <span data-ttu-id="a70f5-141">WS-ReliableMessaging チャネルは、メッセージ配信の保証を有効にします。</span><span class="sxs-lookup"><span data-stu-id="a70f5-141">The WS-Reliable Messaging channel enables the guarantee of message delivery.</span></span> <span data-ttu-id="a70f5-142">エンコーダーは、メッセージのニーズに合わせて使用できるさまざまなエンコーディングを提供します。</span><span class="sxs-lookup"><span data-stu-id="a70f5-142">The encoders present a variety of encodings that can be used to suit the needs of the message.</span></span> <span data-ttu-id="a70f5-143">HTTP チャネルは、ハイパーテキスト転送プロトコルをメッセージ配信に使用することを指定します。</span><span class="sxs-lookup"><span data-stu-id="a70f5-143">The HTTP channel specifies that the HyperText Transport Protocol is used for message delivery.</span></span> <span data-ttu-id="a70f5-144">同様に、TCP チャネルは TCP プロトコルを指定します。</span><span class="sxs-lookup"><span data-stu-id="a70f5-144">The TCP channel similarly specifies the TCP protocol.</span></span> <span data-ttu-id="a70f5-145">トランザクション フロー チャネルは、トランザクション メッセージ パターンを制御します。</span><span class="sxs-lookup"><span data-stu-id="a70f5-145">The Transaction Flow channel governs transacted message patterns.</span></span> <span data-ttu-id="a70f5-146">名前付きパイプ チャネルは、プロセス間通信を有効にします。</span><span class="sxs-lookup"><span data-stu-id="a70f5-146">The Named Pipe channel enables interprocess communication.</span></span> <span data-ttu-id="a70f5-147">MSMQ チャネルは、MSMQ アプリケーションとの相互運用を有効にします。</span><span class="sxs-lookup"><span data-stu-id="a70f5-147">The MSMQ channel enables interoperation with MSMQ applications.</span></span>  
  
### <a name="hosting-and-activation"></a><span data-ttu-id="a70f5-148">ホストとアクティブ化</span><span class="sxs-lookup"><span data-stu-id="a70f5-148">Hosting and Activation</span></span>  

 <span data-ttu-id="a70f5-149">サービスの最終的な形はプログラムです。</span><span class="sxs-lookup"><span data-stu-id="a70f5-149">In its final form, a service is a program.</span></span> <span data-ttu-id="a70f5-150">他のプログラムと同様、サービスは実行可能ファイルで実行される必要があります。</span><span class="sxs-lookup"><span data-stu-id="a70f5-150">Like other programs, a service must be run in an executable.</span></span> <span data-ttu-id="a70f5-151">これは、 *自己ホスト型* サービスと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-151">This is known as a *self-hosted* service.</span></span>  
  
 <span data-ttu-id="a70f5-152">また、サービスを *ホスト* したり、IIS や Windows Activation SERVICE (WAS) などの外部エージェントで管理される実行可能ファイルで実行したりすることもできます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-152">Services can also be *hosted*, or run in an executable managed by an external agent, such as IIS or Windows Activation Service (WAS).</span></span> <span data-ttu-id="a70f5-153">WAS を実行しているコンピューターに展開すると、WCF アプリケーションを自動的にアクティブにすることができます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-153">WAS enables WCF applications to be activated automatically when deployed on a computer running WAS.</span></span> <span data-ttu-id="a70f5-154">サービスは、実行可能ファイル (.exe ファイル) として手動で実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-154">Services can also be manually run as executables (.exe files).</span></span> <span data-ttu-id="a70f5-155">また、Windows サービスとして自動的に実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-155">A service can also be run automatically as a Windows service.</span></span> <span data-ttu-id="a70f5-156">COM + コンポーネントは、WCF サービスとしてホストすることもできます。</span><span class="sxs-lookup"><span data-stu-id="a70f5-156">COM+ components can also be hosted as WCF services.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a70f5-157">関連項目</span><span class="sxs-lookup"><span data-stu-id="a70f5-157">See also</span></span>

- [<span data-ttu-id="a70f5-158">Windows Communication Foundation とは</span><span class="sxs-lookup"><span data-stu-id="a70f5-158">What Is Windows Communication Foundation</span></span>](whats-wcf.md)
- [<span data-ttu-id="a70f5-159">Windows Communication Foundation の基本概念</span><span class="sxs-lookup"><span data-stu-id="a70f5-159">Fundamental Windows Communication Foundation Concepts</span></span>](fundamental-concepts.md)
