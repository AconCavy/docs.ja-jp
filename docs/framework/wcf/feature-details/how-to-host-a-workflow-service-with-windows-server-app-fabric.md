---
title: '方法 : Windows Server AppFabric を使用してワークフロー サービスをホストする'
ms.date: 03/30/2017
ms.assetid: 83b62cce-5fc2-4c6d-b27c-5742ba3bac73
ms.openlocfilehash: ecc7a954b2d88cdbcf934cc836e9ad6e3ef7ed52
ms.sourcegitcommit: c01c18755bb7b0f82c7232314ccf7955ea7834db
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/15/2020
ms.locfileid: "75964761"
---
# <a name="how-to-host-a-workflow-service-with-windows-server-app-fabric"></a><span data-ttu-id="b6fd4-102">方法 : Windows Server AppFabric を使用してワークフロー サービスをホストする</span><span class="sxs-lookup"><span data-stu-id="b6fd4-102">How to: Host a Workflow Service with Windows Server App Fabric</span></span>

<span data-ttu-id="b6fd4-103">AppFabric でのワークフロー サービスのホスティングは IIS/WAS でのホスティングに似ています。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-103">Hosting workflow services in App Fabric is similar to hosting under IIS/WAS.</span></span> <span data-ttu-id="b6fd4-104">唯一の違いは、ワークフロー サービスの投入、監視、および管理のために AppFabric に用意されているツールです。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-104">The only difference is the tools App Fabric provides for deploying, monitoring, and managing workflow services.</span></span> <span data-ttu-id="b6fd4-105">このトピックでは、[実行時間の長いワークフローサービスの作成](../../../../docs/framework/wcf/feature-details/creating-a-long-running-workflow-service.md)によって作成されたワークフローサービスを使用します。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-105">This topic uses the workflow service created in the [Creating a Long-running Workflow Service](../../../../docs/framework/wcf/feature-details/creating-a-long-running-workflow-service.md).</span></span> <span data-ttu-id="b6fd4-106">ワークフロー サービスの作成方法はそちらのトピックで説明されています。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-106">That topic will walk you through creating a workflow service.</span></span> <span data-ttu-id="b6fd4-107">このトピックでは、AppFabric を使用したワークフロー サービスのホスティング方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-107">This topic will explain how to host the workflow service using App Fabric.</span></span> <span data-ttu-id="b6fd4-108">Windows Server App Fabric の詳細については、 [Windows Server App fabric のドキュメント](https://docs.microsoft.com/previous-versions/appfabric/ff384253(v=azure.10))を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-108">For more information about Windows Server App Fabric, see [Windows Server App Fabric Documentation](https://docs.microsoft.com/previous-versions/appfabric/ff384253(v=azure.10)).</span></span> <span data-ttu-id="b6fd4-109">下の手順を完了する前に、Windows Server AppFabric がインストールされていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-109">Before completing the steps below make sure you have Windows Server App Fabric installed.</span></span>  <span data-ttu-id="b6fd4-110">これを行うには、インターネットインフォメーションサービス (inetmgr.exe) を開き、 **[接続]** ビューでサーバー名をクリックし、サイト をクリックして、 **[既定の Web サイト]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-110">To do this open up Internet Information Services (inetmgr.exe), click your server name in the **Connections** view, click Sites, and click **Default Web Site**.</span></span> <span data-ttu-id="b6fd4-111">画面の右側には、 **[App Fabric]** というセクションが表示されます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-111">In the right-hand side of the screen you should see a section called **App Fabric**.</span></span> <span data-ttu-id="b6fd4-112">(右側のペインの一番上に表示される) このセクションが表示されない場合は、AppFabric がインストールされていません。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-112">If you don’t see this section (it will be on the top of the right-hand pane) you do not have App Fabric installed.</span></span> <span data-ttu-id="b6fd4-113">Windows Server App Fabric のインストールの詳細については、「 [Windows Server App fabric のインストール](https://docs.microsoft.com/previous-versions/appfabric/ee790960(v=azure.10))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-113">For more information about installing Windows Server App Fabric see [Installing Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee790960(v=azure.10)).</span></span>  
  
### <a name="creating-a-simple-workflow-service"></a><span data-ttu-id="b6fd4-114">単純なワークフロー サービスの作成</span><span class="sxs-lookup"><span data-stu-id="b6fd4-114">Creating a Simple Workflow Service</span></span>  
  
1. <span data-ttu-id="b6fd4-115">Visual Studio 2012 を開き、[実行時間の長いワークフローサービスの作成](../../../../docs/framework/wcf/feature-details/creating-a-long-running-workflow-service.md)に関するトピックで作成した orderprocessing ソリューションを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-115">Open Visual Studio 2012 and load the OrderProcessing solution you created in the [Creating a Long-running Workflow Service](../../../../docs/framework/wcf/feature-details/creating-a-long-running-workflow-service.md) topic.</span></span>  
  
2. <span data-ttu-id="b6fd4-116">**Orderservice**プロジェクトを右クリックし、 **[プロパティ]** をクリックして、 **[Web]** タブを選択します。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-116">Right click the **OrderService** project and select **Properties** and select the **Web** tab.</span></span>  
  
3. <span data-ttu-id="b6fd4-117">プロパティページの **[開始アクション]** セクションで、**特定のページ**を選択し、編集ボックスに「Service1. .xamlx」と入力します。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-117">In the **Start Action** section of the property page select **Specific Page** and type Service1.xamlx in the edit box.</span></span>  
  
4. <span data-ttu-id="b6fd4-118">プロパティ ページの **サーバー** セクションで、**ローカル IIS Web サーバーを使用する** を選択し、次の URL を入力します: `http://localhost/OrderService`。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-118">In the **Servers** section of the property page select **Use Local IIS Web Server** and type in the following URL: `http://localhost/OrderService`.</span></span>  
  
5. <span data-ttu-id="b6fd4-119">**[仮想ディレクトリの作成]** ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-119">Click the **Create Virtual Directory** button.</span></span> <span data-ttu-id="b6fd4-120">これで新しい仮想ディレクトリが作成され、プロジェクトが作成されるときに必要なファイルが仮想ディレクトリにコピーされるようにプロジェクトが設定されます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-120">This will create a new virtual directory and set up the project to copy the needed files to the virtual directory when the project is built.</span></span>  <span data-ttu-id="b6fd4-121">または、仮想ディレクトリに .xamlx、web.config、および必要な DLL を手動でコピーすることもできます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-121">Alternatively you could manually copy the .xamlx, the web.config, and any needed DLLs to the virtual directory.</span></span>  
  
### <a name="configuring-a-workflow-service-hosted-in-windows-server-app-fabric"></a><span data-ttu-id="b6fd4-122">Windows Server AppFabric でホストされるワークフロー サービスの構成</span><span class="sxs-lookup"><span data-stu-id="b6fd4-122">Configuring a Workflow Service Hosted in Windows Server App Fabric</span></span>  
  
1. <span data-ttu-id="b6fd4-123">インターネット インフォメーション サービス マネージャー (inetmgr.exe) を開きます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-123">Open Internet Information Services Manager (inetmgr.exe).</span></span>  
  
2. <span data-ttu-id="b6fd4-124">**[接続]** ウィンドウで、orderservice 仮想ディレクトリに移動します。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-124">Navigate to the OrderService virtual directory in the **Connections** pane.</span></span>  
  
3. <span data-ttu-id="b6fd4-125">[Orderservice] を右クリックし、選択**管理の WCF と WF サービス**、**構成しています**.</span><span class="sxs-lookup"><span data-stu-id="b6fd4-125">Right click OrderService and select **Manage WCF and WF Services**, **Configure…**.</span></span> <span data-ttu-id="b6fd4-126">**WCF と WF アプリケーションの構成** ダイアログ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-126">The **Configure WCF and WF for Application** dialog box is displayed.</span></span>  
  
4. <span data-ttu-id="b6fd4-127">**[全般]** タブを選択すると、次のスクリーンショットに示すように、アプリケーションに関する全般的な情報が表示されます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-127">Select the **General** tab to display general information about the application as shown in the following screenshot.</span></span>  
  
     <span data-ttu-id="b6fd4-128">![App Fabric の構成ダイアログの [全般] タブ](../../../../docs/framework/wcf/feature-details/media/appfabricconfiguration-general.gif "AppFabricConfiguration-全般")</span><span class="sxs-lookup"><span data-stu-id="b6fd4-128">![General tab of the App Fabric Configuration dialog](../../../../docs/framework/wcf/feature-details/media/appfabricconfiguration-general.gif "AppFabricConfiguration-General")</span></span>  
  
5. <span data-ttu-id="b6fd4-129">**[監視]** タブを選択します。次のスクリーンショットに示すように、さまざまな監視設定が表示されます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-129">Select the **Monitoring** tab. This shows various monitoring settings as shown in the following screenshot.</span></span>  
  
     <span data-ttu-id="b6fd4-130">![[App Fabric の構成の監視] タブ](../../../../docs/framework/wcf/feature-details/media/appfabricconfiguration-monitoring.gif "AppFabricConfiguration-監視")</span><span class="sxs-lookup"><span data-stu-id="b6fd4-130">![App Fabric Configuration Monitoring tab](../../../../docs/framework/wcf/feature-details/media/appfabricconfiguration-monitoring.gif "AppFabricConfiguration-Monitoring")</span></span>  
  
     <span data-ttu-id="b6fd4-131">App Fabric でのワークフローサービスの監視の構成の詳細については、「 [App fabric で監視を構成する](https://docs.microsoft.com/previous-versions/appfabric/ee677384(v=azure.10))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-131">For more information about configuring workflow service monitoring in App Fabric see [Configuring monitoring with App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677384(v=azure.10)).</span></span>  
  
6. <span data-ttu-id="b6fd4-132">[**ワークフローの永続**化] タブを選択します。これにより、次のスクリーンショットに示すように、App Fabric の既定の永続化プロバイダーを使用するようにアプリケーションを構成できます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-132">Select the **Workflow Persistence** tab. This allows you to configure your application to use App Fabric’s default persistence provider as shown in the following screenshot.</span></span>  
  
     <span data-ttu-id="b6fd4-133">![App Fabric の&#45;構成の永続化](../../../../docs/framework/wcf/feature-details/media/appfabricconfiguration-persistence.gif "AppFabricConfiguration-永続化")</span><span class="sxs-lookup"><span data-stu-id="b6fd4-133">![App Fabric Configuration &#45; Persistence](../../../../docs/framework/wcf/feature-details/media/appfabricconfiguration-persistence.gif "AppFabricConfiguration-Persistence")</span></span>  
  
     <span data-ttu-id="b6fd4-134">Windows Server App Fabric でのワークフロー永続化の構成の詳細については、「 [App fabric でのワークフロー永続化の構成](https://docs.microsoft.com/previous-versions/appfabric/ee677353(v=azure.10))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-134">For more information about configuring workflow persistence in Windows Server App Fabric see [Configuring Workflow Persistence in App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677353(v=azure.10)).</span></span>  
  
7. <span data-ttu-id="b6fd4-135">**[ワークフローホストの管理]** タブを選択します。これにより、次のスクリーンショットに示すように、アイドル状態のワークフローサービスインスタンスをアンロードして永続化する必要があることを指定できます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-135">Select the **Workflow Host Management** tab. This allows you to specify when idle workflow service instances should be unloaded and persisted as shown in the following screenshot.</span></span>  
  
     <span data-ttu-id="b6fd4-136">![App Fabric の構成ワークフローのホスト管理](../../../../docs/framework/wcf/feature-details/media/appfabricconfiguration-management.gif "AppFabricConfiguration-管理")</span><span class="sxs-lookup"><span data-stu-id="b6fd4-136">![App Fabric Configuration  Workflow Host Management](../../../../docs/framework/wcf/feature-details/media/appfabricconfiguration-management.gif "AppFabricConfiguration-Management")</span></span>  
  
     <span data-ttu-id="b6fd4-137">ワークフローホスト管理の構成の詳細については、「 [App Fabric でのワークフローホスト管理の構成](https://docs.microsoft.com/previous-versions/appfabric/ff383424(v=azure.10))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-137">For more information about workflow host management configuration see [Configuring Workflow Host Management in App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ff383424(v=azure.10)).</span></span>  
  
8. <span data-ttu-id="b6fd4-138">**[自動開始]** タブを選択します。これにより、次のスクリーンショットに示すように、アプリケーションのワークフローサービスの自動開始設定を指定できます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-138">Select the **Auto-Start** tab. This allows you to specify auto-start settings for the workflow services in the application as shown in the following screenshot.</span></span>  
  
     ![App Fabric の自動&#45;開始構成を示すスクリーンショット。](./media/how-to-host-a-workflow-service-with-windows-server-app-fabric/app-fabric-auto-start-configuration.gif)  
  
     <span data-ttu-id="b6fd4-140">自動開始の構成の詳細については、「 [App Fabric を使用した自動開始の構成](https://docs.microsoft.com/previous-versions/appfabric/ee677261(v=azure.10))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-140">For more information about configuring Auto-Start see [Configuring Auto-Start with App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677261(v=azure.10)).</span></span>  
  
9. <span data-ttu-id="b6fd4-141">**[調整]** タブを選択します。これにより、次のスクリーンショットに示すように、ワークフローサービスの制限設定を構成できます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-141">Select the **Throttling** tab. This allows you to configure throttling settings for the workflow service as shown in the following screenshot.</span></span>  
  
     ![App Fabric の制限の構成を示すスクリーンショット。](./media/how-to-host-a-workflow-service-with-windows-server-app-fabric/app-fabric-throttling-configuration.gif)  
  
     <span data-ttu-id="b6fd4-143">スロットルの構成の詳細については、「 [App Fabric でのスロットルの構成](https://docs.microsoft.com/previous-versions/appfabric/ee677261(v=azure.10))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-143">For more information about configuring throttling see [Configuring Throttling with App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677261(v=azure.10)).</span></span>  
  
10. <span data-ttu-id="b6fd4-144">**[セキュリティ]** タブを選択します。これにより、次のスクリーンショットに示すように、アプリケーションのセキュリティ設定を構成できます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-144">Select the **Security** tab. This allows you to configure security settings for the application as shown in the following screenshot.</span></span>  
  
     <span data-ttu-id="b6fd4-145">![App Fabric のセキュリティ構成](../../../../docs/framework/wcf/feature-details/media/appfabricconfiguration-security.gif "AppFabricConfiguration-セキュリティ")</span><span class="sxs-lookup"><span data-stu-id="b6fd4-145">![App Fabric Security Configuration](../../../../docs/framework/wcf/feature-details/media/appfabricconfiguration-security.gif "AppFabricConfiguration-Security")</span></span>  
  
     <span data-ttu-id="b6fd4-146">Windows Server App Fabric でセキュリティを構成する方法の詳細については、「 [App fabric でのセキュリティの構成](https://docs.microsoft.com/previous-versions/appfabric/ee677278(v=azure.10))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-146">For more information about configuring security with Windows Server App Fabric see [Configuring Security with App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677278(v=azure.10)).</span></span>  
  
### <a name="using-windows-server-app-fabric"></a><span data-ttu-id="b6fd4-147">Windows Server AppFabric の使用</span><span class="sxs-lookup"><span data-stu-id="b6fd4-147">Using Windows Server App Fabric</span></span>  
  
1. <span data-ttu-id="b6fd4-148">ソリューションを作成して、仮想ディレクトリに必要なファイルをコピーします。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-148">Build the solution to copy the necessary files to the virtual directory.</span></span>  
  
2. <span data-ttu-id="b6fd4-149">OrderClient プロジェクトを右クリックし、 **[デバッグ]** 、 **[新しいインスタンスを開始]** の順に選択して、クライアントアプリケーションを起動します。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-149">Right click the OrderClient project and select **Debug**, **Start New Instance** to launch the client application.</span></span>  
  
3. <span data-ttu-id="b6fd4-150">クライアントが実行され、Visual Studio に **[セキュリティ警告の添付]** ダイアログボックスが表示されます。 **[アタッチしない]** ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-150">The client will run and Visual Studio will display an **Attach Security Warning** dialog box, click the **Don’t Attach** button.</span></span> <span data-ttu-id="b6fd4-151">これにより、IIS プロセスにアタッチしてデバッグしないように Visual Studio に指示します。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-151">This tells Visual Studio to not attach to the IIS process for debugging.</span></span>  
  
4. <span data-ttu-id="b6fd4-152">クライアント アプリケーションは直ちにワークフロー サービスを呼び出して待機します。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-152">The client application will immediately call the Workflow service and then wait.</span></span> <span data-ttu-id="b6fd4-153">ワークフロー サービスはアイドル状態になり永続化されます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-153">The workflow service will go idle and be persisted.</span></span> <span data-ttu-id="b6fd4-154">これは、インターネット インフォメーション サービス (inetmgr.exe) を開始して、[接続] ペインで [OrderService] に移動し、それを選択することによって確認できます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-154">You can verify this by starting Internet Information Services (inetmgr.exe), navigating to the OrderService in the Connections pane and selecting it.</span></span> <span data-ttu-id="b6fd4-155">次に、右側のペインで [App Fabric ダッシュボード] のアイコンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-155">Next, click the App Fabric Dashboard icon in the right-hand pane.</span></span> <span data-ttu-id="b6fd4-156">[永続化された WF インスタンス] には、次のスクリーンショットに示すように、永続化されたワークフローサービスインスタンスが1つ表示されます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-156">Under Persisted WF Instances you will see there is one persisted workflow service instance as shown in the following screenshot.</span></span>  
  
     ![App Fabric ダッシュボードを示すスクリーンショット。](./media/how-to-host-a-workflow-service-with-windows-server-app-fabric/app-fabric-dashboard.gif)  
  
     <span data-ttu-id="b6fd4-158">**WF インスタンス履歴**には、ワークフローサービスのアクティブ化の数、ワークフローサービスインスタンスの入力候補の数、失敗したワークフローインスタンスの数など、ワークフローサービスに関する情報が表示されます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-158">The **WF Instance History** lists information about the workflow service such as the number of workflow service activations, the number of workflow service instance completions, and the number of workflow instances with failures.</span></span> <span data-ttu-id="b6fd4-159">アクティブまたはアイドル状態のインスタンスの下にリンクが表示されます。リンクをクリックすると、次のスクリーンショットに示すように、アイドル状態のワークフローインスタンスに関する詳細情報が表示されます。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-159">Under Active or Idle instances a link will be displayed, clicking on the link will display more information about the idle workflow instances as shown in the following screenshot.</span></span>  
  
     ![永続化されたワークフローインスタンスの詳細を示すスクリーンショット。](./media/how-to-host-a-workflow-service-with-windows-server-app-fabric/persisted-workflow-instance-detail.gif)  
  
     <span data-ttu-id="b6fd4-161">Windows Server App Fabric の機能とその使用方法の詳細については、「 [Windows Server App fabric のホスト機能](https://docs.microsoft.com/previous-versions/appfabric/ee677189(v=azure.10))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6fd4-161">For more information about Windows Server App Fabric features and how to use them see [Windows Server App Fabric Hosting Features](https://docs.microsoft.com/previous-versions/appfabric/ee677189(v=azure.10))</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b6fd4-162">関連項目</span><span class="sxs-lookup"><span data-stu-id="b6fd4-162">See also</span></span>

- [<span data-ttu-id="b6fd4-163">長時間のワークフロー サービスの作成</span><span class="sxs-lookup"><span data-stu-id="b6fd4-163">Creating a Long-running Workflow Service</span></span>](../../../../docs/framework/wcf/feature-details/creating-a-long-running-workflow-service.md)
- <span data-ttu-id="b6fd4-164">[AppFabric のホスティング機能](https://docs.microsoft.com/previous-versions/appfabric/ee677189(v=azure.10))</span><span class="sxs-lookup"><span data-stu-id="b6fd4-164">[Windows Server App Fabric Hosting Features](https://docs.microsoft.com/previous-versions/appfabric/ee677189(v=azure.10))</span></span>
- <span data-ttu-id="b6fd4-165">[Windows Server App Fabric のインストール](https://docs.microsoft.com/previous-versions/appfabric/ee790960(v=azure.10))</span><span class="sxs-lookup"><span data-stu-id="b6fd4-165">[Installing Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee790960(v=azure.10))</span></span>
- <span data-ttu-id="b6fd4-166">[Windows Server App Fabric のドキュメント](https://docs.microsoft.com/previous-versions/appfabric/ff384253(v=azure.10))</span><span class="sxs-lookup"><span data-stu-id="b6fd4-166">[Windows Server App Fabric Documentation](https://docs.microsoft.com/previous-versions/appfabric/ff384253(v=azure.10))</span></span>
