---
title: '方法 : WSFederationHttpBinding を作成する'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF, federation
- federation
ms.assetid: e54897d7-aa6c-46ec-a278-b2430c8c2e10
ms.openlocfilehash: c3ce90c74ae61dfcbfc0b05fc17b25fe0118e071
ms.sourcegitcommit: fbb8a593a511ce667992502a3ce6d8f65c594edf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/16/2019
ms.locfileid: "74141696"
---
# <a name="how-to-create-a-wsfederationhttpbinding"></a><span data-ttu-id="99d6c-102">方法 : WSFederationHttpBinding を作成する</span><span class="sxs-lookup"><span data-stu-id="99d6c-102">How to: Create a WSFederationHttpBinding</span></span>

<span data-ttu-id="99d6c-103">Windows Communication Foundation (WCF) では、<xref:System.ServiceModel.WSFederationHttpBinding> クラス ([\<wsFederationHttpBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md)構成) は、フェデレーションサービスを公開するためのメカニズムを提供します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-103">In Windows Communication Foundation (WCF), the <xref:System.ServiceModel.WSFederationHttpBinding> class ([\<wsFederationHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md) in configuration) provides a mechanism for exposing a federated service.</span></span> <span data-ttu-id="99d6c-104">これはクライアントに対して認証を要求するサービスであって、認証にはセキュリティ トークン サービスが発行するセキュリティ トークンが必要となります。</span><span class="sxs-lookup"><span data-stu-id="99d6c-104">That is, a service that requires clients to authenticate using a security token issued by a security token service.</span></span> <span data-ttu-id="99d6c-105">このトピックでは、必要な処理をコード中に埋め込む形、あるいは構成ファイルに必要な記述を加える形で、<xref:System.ServiceModel.WSFederationHttpBinding> の設定をする手順を説明します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-105">This topic shows how to set up a <xref:System.ServiceModel.WSFederationHttpBinding> in both code and configuration.</span></span> <span data-ttu-id="99d6c-106">バインディングを作成すると、エンドポイントを設定してこのバインディングを使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="99d6c-106">Once the binding is created, you can set up an endpoint to use that binding.</span></span>

 <span data-ttu-id="99d6c-107">基本的な手順の概略を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-107">The basic steps are outlined as follows:</span></span>

1. <span data-ttu-id="99d6c-108">セキュリティ モードを選択します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-108">Select a security mode.</span></span> <span data-ttu-id="99d6c-109"><xref:System.ServiceModel.WSFederationHttpBinding> には、メッセージ レベルでエンドツーエンドのセキュリティを提供する `Message` を指定できます。複数のホップや `TransportWithMessageCredential` にまたがる通信であってもこれは有効です。クライアントとサービスが HTTPS 上で直接接続できる場合に、特に性能を発揮します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-109">The <xref:System.ServiceModel.WSFederationHttpBinding> supports `Message`, which provides end-to-end security at the message level, even across multiple hops, and `TransportWithMessageCredential`, which provides better performance in cases where the client and the service can make a direct connection over HTTPS.</span></span>

    > [!NOTE]
    > <span data-ttu-id="99d6c-110"><xref:System.ServiceModel.WSFederationHttpBinding> には、セキュリティ モードとして `None` を指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="99d6c-110">The <xref:System.ServiceModel.WSFederationHttpBinding> also supports `None` as a security mode.</span></span> <span data-ttu-id="99d6c-111">このモードは安全性が低く、デバッグ目的での使用のみを目的としています。</span><span class="sxs-lookup"><span data-stu-id="99d6c-111">This mode is not secure and is provided for debugging purposes only.</span></span> <span data-ttu-id="99d6c-112">サービスエンドポイントが <xref:System.ServiceModel.WSFederationHttpBinding> と共に展開され、そのセキュリティモードが [`None`] に設定されている場合、( [ServiceModel メタデータユーティリティツール (svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)によって生成される) クライアントバインディングは、セキュリティモードが `None`の <xref:System.ServiceModel.WSHttpBinding> になります。</span><span class="sxs-lookup"><span data-stu-id="99d6c-112">If a service endpoint is deployed with a <xref:System.ServiceModel.WSFederationHttpBinding> with its security mode set to `None`, the resulting client binding (generated by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)) is a <xref:System.ServiceModel.WSHttpBinding> with a security mode of `None`.</span></span>

     <span data-ttu-id="99d6c-113">`WSFederationHttpBinding` の場合、システムに組み込まれている他のバインディングとは違って、クライアント資格情報の種類を選択する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="99d6c-113">Unlike other system-provided bindings, it is not necessary to select a client credential type when using the `WSFederationHttpBinding`.</span></span> <span data-ttu-id="99d6c-114">これは、常に、発行されたトークンを資格情報として使うからです。</span><span class="sxs-lookup"><span data-stu-id="99d6c-114">This is because the client credential type is always an issued token.</span></span> <span data-ttu-id="99d6c-115">WCF は、指定された発行者からトークンを取得し、そのトークンをサービスに提示してクライアントを認証します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-115">WCF acquires a token from a specified issuer and presents that token to the service to authenticate the client.</span></span>

2. <span data-ttu-id="99d6c-116">フェデレーション クライアントの場合、<xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerAddress%2A> プロパティの値として、セキュリティ トークン サービスの URL を指定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-116">On federated clients, set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerAddress%2A> property to the URL of the security token service.</span></span> <span data-ttu-id="99d6c-117"><xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerBinding%2A> としてバインディングを指定し、セキュリティ トークン サービスとの通信に使用します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-117">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerBinding%2A> to the binding to use to communicate with the security token service.</span></span>

3. <span data-ttu-id="99d6c-118">省略可能です。</span><span class="sxs-lookup"><span data-stu-id="99d6c-118">Optional.</span></span> <span data-ttu-id="99d6c-119"><xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedTokenType%2A> プロパティの値として、トークンの種類の URI (Uniform Resource Identifier) を指定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-119">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedTokenType%2A> property to the Uniform Resource Identifier (URI) of a token type.</span></span> <span data-ttu-id="99d6c-120">フェデレーション サービスについては、提示されれば受理できるトークンの種類を指定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-120">On federated services, specify the token type that the service expects.</span></span> <span data-ttu-id="99d6c-121">フェデレーション クライアントについては、セキュリティ トークン サービスに要求するトークンの種類を指定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-121">On federated clients, specify the token type the client requests from the security token service.</span></span>

     <span data-ttu-id="99d6c-122">トークンの種類を指定しなければ、クライアント側ではその URI なしで WS-Trust のセキュリティ トークン要求 (RTS) を生成します。また、サービス側では、クライアントが既定で SAML (Security Assertions Markup Language) 1.1 のトークンを提示して認証するものと想定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-122">If no token type is specified, clients generate WS-Trust Request Security Tokens (RSTs) without a token type URI, and services expect client authentication using a Security Assertions Markup Language (SAML) 1.1 token by default.</span></span>

     <span data-ttu-id="99d6c-123">SAML 1.1 トークンの URI は `http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1`。</span><span class="sxs-lookup"><span data-stu-id="99d6c-123">The URI for a SAML 1.1 token is `http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1`.</span></span>

4. <span data-ttu-id="99d6c-124">省略可能です。</span><span class="sxs-lookup"><span data-stu-id="99d6c-124">Optional.</span></span> <span data-ttu-id="99d6c-125">フェデレーション サービスの場合、<xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerMetadataAddress%2A> プロパティの値として、セキュリティ トークン サービスのメタデータ URL を指定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-125">On federated services, set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerMetadataAddress%2A> property to the metadata URL of a security token service.</span></span> <span data-ttu-id="99d6c-126">メタデータ エンドポイントは、サービスがメタデータを公開するよう設定されている場合に、クライアントが適切なバインディング/エンドポイントのペアを選択するために必要です。</span><span class="sxs-lookup"><span data-stu-id="99d6c-126">The metadata endpoint enables clients of the service to select an appropriate binding/endpoint pair, if the service is configured to publish metadata.</span></span> <span data-ttu-id="99d6c-127">メタデータの公開の詳細については、「[メタデータの公開](publishing-metadata.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="99d6c-127">For more information about publishing metadata, see [Publishing Metadata](publishing-metadata.md).</span></span>

 <span data-ttu-id="99d6c-128">他に設定できるプロパティとしては、発行されたトークンの証明キーとして使用するキーの種類、クライアント/サーバー間で使用するアルゴリズム スイート、サービス資格情報をネゴシエートするか明示的に指定するか、トークンに入っていればそれに応じてサービス側で処理できるクレームの種類、クライアントがセキュリティ トークン サービスに送信する要求に追加しなければならない他の XML 要素などがあります。</span><span class="sxs-lookup"><span data-stu-id="99d6c-128">You can also set other properties, including the type of key used as a proof key in the issued token, the algorithm suite to use between the client and the service, whether to negotiate or explicitly specify the service credential, any specific claims the service expects the issued token to contain, and any additional XML elements that must be added to the request the client sends to the security token service.</span></span>

> [!NOTE]
> <span data-ttu-id="99d6c-129">`NegotiateServiceCredential` プロパティが意味をなすのは、`SecurityMode` の設定値が `Message` である場合に限ります。</span><span class="sxs-lookup"><span data-stu-id="99d6c-129">The `NegotiateServiceCredential` property is only relevant when the `SecurityMode` is set to `Message`.</span></span> <span data-ttu-id="99d6c-130">`SecurityMode` の設定値が `TransportWithMessageCredential` であれば、`NegotiateServiceCredential` プロパティは無視されます。</span><span class="sxs-lookup"><span data-stu-id="99d6c-130">If `SecurityMode` is set to `TransportWithMessageCredential`, then the `NegotiateServiceCredential` property is ignored.</span></span>

## <a name="to-configure-a-wsfederationhttpbinding-in-code"></a><span data-ttu-id="99d6c-131">必要な処理をコード中に埋め込む形で WSFederationHttpBinding を設定するには</span><span class="sxs-lookup"><span data-stu-id="99d6c-131">To configure a WSFederationHttpBinding in code</span></span>

1. <span data-ttu-id="99d6c-132"><xref:System.ServiceModel.WSFederationHttpBinding>のインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-132">Create an instance of the <xref:System.ServiceModel.WSFederationHttpBinding>.</span></span>

2. <span data-ttu-id="99d6c-133">必要に応じて、<xref:System.ServiceModel.WSFederationHttpSecurity.Mode%2A> プロパティを <xref:System.ServiceModel.WSFederationHttpSecurityMode> または <xref:System.ServiceModel.WSFederationHttpSecurityMode.Message> に設定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-133">Set the <xref:System.ServiceModel.WSFederationHttpSecurity.Mode%2A> property to <xref:System.ServiceModel.WSFederationHttpSecurityMode> or <xref:System.ServiceModel.WSFederationHttpSecurityMode.Message> as required.</span></span> <span data-ttu-id="99d6c-134"><xref:System.ServiceModel.Security.SecurityAlgorithmSuite.Basic256%2A> 以外のアルゴリズムスイートが必要な場合は、<xref:System.ServiceModel.FederatedMessageSecurityOverHttp.AlgorithmSuite%2A> プロパティを <xref:System.ServiceModel.Security.SecurityAlgorithmSuite>から取得した値に設定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-134">If an algorithm suite other than <xref:System.ServiceModel.Security.SecurityAlgorithmSuite.Basic256%2A> is required, set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.AlgorithmSuite%2A> property to a value taken from <xref:System.ServiceModel.Security.SecurityAlgorithmSuite>.</span></span>

3. <span data-ttu-id="99d6c-135"><xref:System.ServiceModel.FederatedMessageSecurityOverHttp.NegotiateServiceCredential%2A> プロパティに適切な値を設定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-135">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.NegotiateServiceCredential%2A> property as appropriate.</span></span>

4. <span data-ttu-id="99d6c-136"><xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedKeyType%2A> プロパティを `SymmetricKey` または <xref:System.IdentityModel.Tokens.SecurityKeyType>に設定します。`AsymmetricKey`</span><span class="sxs-lookup"><span data-stu-id="99d6c-136">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedKeyType%2A> property to <xref:System.IdentityModel.Tokens.SecurityKeyType>`SymmetricKey` or .`AsymmetricKey`</span></span> <span data-ttu-id="99d6c-137">必要に応じて。</span><span class="sxs-lookup"><span data-stu-id="99d6c-137">as required.</span></span>

5. <span data-ttu-id="99d6c-138"><xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedTokenType%2A> プロパティに適切な値を設定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-138">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedTokenType%2A> property to the appropriate value.</span></span> <span data-ttu-id="99d6c-139">値が設定されていない場合、WCF の既定値は `http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1`になります。これは SAML 1.1 トークンを示します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-139">If no value is set, WCF defaults to `http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1`, which indicates SAML 1.1 tokens.</span></span>

6. <span data-ttu-id="99d6c-140">クライアント側ではローカル発行者が指定されていなければ必須。サービス側では省略可能。</span><span class="sxs-lookup"><span data-stu-id="99d6c-140">Required on the client if no local issuer is specified; optional on the service.</span></span> <span data-ttu-id="99d6c-141">セキュリティ トークン サービスのアドレスと ID 情報が設定された <xref:System.ServiceModel.EndpointAddress> を作成し、この <xref:System.ServiceModel.EndpointAddress> インスタンスを <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerAddress%2A> プロパティに代入します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-141">Create an <xref:System.ServiceModel.EndpointAddress> that contains the address and identity information of the security token service and assign the <xref:System.ServiceModel.EndpointAddress> instance to the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerAddress%2A> property.</span></span>

7. <span data-ttu-id="99d6c-142">クライアント側ではローカル発行者が指定されていなければ必須。サービス側では不要。</span><span class="sxs-lookup"><span data-stu-id="99d6c-142">Required on the client if no local issuer is specified; not used on the service.</span></span> <span data-ttu-id="99d6c-143">`SecurityTokenService` の <xref:System.ServiceModel.Channels.Binding> を作成し、<xref:System.ServiceModel.Channels.Binding> インスタンスを <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerBinding%2A> プロパティに割り当てます。</span><span class="sxs-lookup"><span data-stu-id="99d6c-143">Create a <xref:System.ServiceModel.Channels.Binding> for the `SecurityTokenService` and assign the <xref:System.ServiceModel.Channels.Binding> instance to the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerBinding%2A> property.</span></span>

8. <span data-ttu-id="99d6c-144">クライアント側では不要。サービス側では省略可能。</span><span class="sxs-lookup"><span data-stu-id="99d6c-144">Not used on the client; optional on the service.</span></span> <span data-ttu-id="99d6c-145">セキュリティ トークン サービスのメタデータ用の <xref:System.ServiceModel.EndpointAddress> インスタンスを作成し、`IssuerMetadataAddress` プロパティに代入します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-145">Create an <xref:System.ServiceModel.EndpointAddress> instance for the metadata of the security token service and assign it to the `IssuerMetadataAddress` property.</span></span>

9. <span data-ttu-id="99d6c-146">クライアント側、サービス側とも省略可能。</span><span class="sxs-lookup"><span data-stu-id="99d6c-146">Optional on both the client and the service.</span></span> <span data-ttu-id="99d6c-147">必要な数の <xref:System.ServiceModel.Security.Tokens.ClaimTypeRequirement> インスタンスを生成し、<xref:System.ServiceModel.FederatedMessageSecurityOverHttp.ClaimTypeRequirements%2A> プロパティで返されたコレクションに追加します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-147">Create and add one or more <xref:System.ServiceModel.Security.Tokens.ClaimTypeRequirement> instances to the collection returned by the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.ClaimTypeRequirements%2A> property.</span></span>

10. <span data-ttu-id="99d6c-148">クライアント側、サービス側とも省略可能。</span><span class="sxs-lookup"><span data-stu-id="99d6c-148">Optional on both the client and the service.</span></span> <span data-ttu-id="99d6c-149">必要な数の <xref:System.Xml.XmlElement> インスタンスを生成し、<xref:System.ServiceModel.FederatedMessageSecurityOverHttp.TokenRequestParameters%2A> プロパティで返されたコレクションに追加します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-149">Create and add one or more <xref:System.Xml.XmlElement> instances to the collection returned by the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.TokenRequestParameters%2A> property.</span></span>

## <a name="to-create-a-federated-endpoint-in-configuration"></a><span data-ttu-id="99d6c-150">構成ファイルに必要な記述を加える形でフェデレーション エンドポイントを作成するには</span><span class="sxs-lookup"><span data-stu-id="99d6c-150">To create a federated endpoint in configuration</span></span>

1. <span data-ttu-id="99d6c-151">アプリケーション構成ファイル内の[\<binding >](../../../../docs/framework/configure-apps/file-schema/wcf/bindings.md)要素の子として、 [\<wsFederationHttpBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md)を作成します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-151">Create a [\<wsFederationHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md) as a child of the [\<bindings>](../../../../docs/framework/configure-apps/file-schema/wcf/bindings.md) element in the application configuration file.</span></span>

2. <span data-ttu-id="99d6c-152">[\<wsFederationHttpBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md)の子として[\<バインド >](../../configure-apps/file-schema/wcf/bindings.md)要素を作成し、`name` 属性を適切な値に設定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-152">Create a [\<binding>](../../configure-apps/file-schema/wcf/bindings.md) element as a child of [\<wsFederationHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md) and set the `name` attribute to an appropriate value.</span></span>

3. <span data-ttu-id="99d6c-153">[\<binding >](../../configure-apps/file-schema/wcf/bindings.md)要素の子として、`<security>` 要素を作成します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-153">Create a `<security>` element as a child of the [\<binding>](../../configure-apps/file-schema/wcf/bindings.md) element.</span></span>

4. <span data-ttu-id="99d6c-154">必要に応じて、`mode` 要素の `<security>` 属性値に `Message` または `TransportWithMessageCredential` を設定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-154">Set the `mode` attribute on the `<security>` element to a value of `Message` or `TransportWithMessageCredential`, as required.</span></span>

5. <span data-ttu-id="99d6c-155">`<message>` 要素の子要素として `<security>` 要素を作成します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-155">Create a `<message>` element as a child of the `<security>` element.</span></span>

6. <span data-ttu-id="99d6c-156">省略可能です。</span><span class="sxs-lookup"><span data-stu-id="99d6c-156">Optional.</span></span> <span data-ttu-id="99d6c-157">`algorithmSuite` 要素の `<message>` 属性に適切な値を設定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-157">Set the `algorithmSuite` attribute on the `<message>` element with an appropriate value.</span></span> <span data-ttu-id="99d6c-158">既定値は、 `Basic256`です。</span><span class="sxs-lookup"><span data-stu-id="99d6c-158">The default is `Basic256`.</span></span>

7. <span data-ttu-id="99d6c-159">省略可能です。</span><span class="sxs-lookup"><span data-stu-id="99d6c-159">Optional.</span></span> <span data-ttu-id="99d6c-160">非対称証明キーが必要ならば、`issuedKeyType` 要素の `<message>` 属性を `AsymmetricKey` に設定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-160">If an asymmetric proof key is required, set the `issuedKeyType` attribute of the `<message>` element to `AsymmetricKey`.</span></span> <span data-ttu-id="99d6c-161">既定値は、 `SymmetricKey`です。</span><span class="sxs-lookup"><span data-stu-id="99d6c-161">The default is `SymmetricKey`.</span></span>

8. <span data-ttu-id="99d6c-162">省略可能です。</span><span class="sxs-lookup"><span data-stu-id="99d6c-162">Optional.</span></span> <span data-ttu-id="99d6c-163">`issuedTokenType` 要素の `<message>` 属性を設定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-163">Set the `issuedTokenType` attribute on the `<message>` element.</span></span>

9. <span data-ttu-id="99d6c-164">クライアント側ではローカル発行者が指定されていなければ必須。サービス側では省略可能。</span><span class="sxs-lookup"><span data-stu-id="99d6c-164">Required on the client if no local issuer is specified; optional on the service.</span></span> <span data-ttu-id="99d6c-165">`<issuer>` 要素の子要素として `<message>` 要素を作成します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-165">Create an `<issuer>` element as a child of the `<message>` element.</span></span>

10. <span data-ttu-id="99d6c-166">`address` 要素に `<issuer>` 属性を設定し、セキュリティ トークン サービスがトークン要求を受け付けるアドレスを指定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-166">Set the `address` attribute to the `<issuer>` element and specify the address at which the security token service accepts token requests.</span></span>

11. <span data-ttu-id="99d6c-167">省略可能です。</span><span class="sxs-lookup"><span data-stu-id="99d6c-167">Optional.</span></span> <span data-ttu-id="99d6c-168">`<identity>` 子要素を追加し、セキュリティ トークン サービスの識別子を指定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-168">Add an `<identity>` child element and specify the identity of the security token service</span></span>

12. <span data-ttu-id="99d6c-169">詳細については、「[サービス id と認証](service-identity-and-authentication.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="99d6c-169">For more information, see [Service Identity and Authentication](service-identity-and-authentication.md).</span></span>

13. <span data-ttu-id="99d6c-170">クライアント側ではローカル発行者が指定されていなければ必須。サービス側では不要。</span><span class="sxs-lookup"><span data-stu-id="99d6c-170">Required on the client if no local issuer is specified; not used on the service.</span></span> <span data-ttu-id="99d6c-171">Security Token Service との通信に使用できるバインドセクションに、 [\<バインド >](../../configure-apps/file-schema/wcf/bindings.md)要素を作成します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-171">Create a [\<binding>](../../configure-apps/file-schema/wcf/bindings.md) element in the bindings section that can be used to communicate with the security token service.</span></span> <span data-ttu-id="99d6c-172">バインディングの作成の詳細については、「[方法: 構成でサービスバインディングを指定](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="99d6c-172">For more information about creating a binding, see [How to: Specify a Service Binding in Configuration](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md).</span></span>

14. <span data-ttu-id="99d6c-173">`binding` 要素の `bindingConfiguration` 属性および `<issuer>` 属性に設定して、前の手順で作成したバインディングを指定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-173">Specify the binding created in the previous step by setting the `binding` and `bindingConfiguration` attributes of the `<issuer>` element.</span></span>

15. <span data-ttu-id="99d6c-174">クライアント側では不要。サービス側では省略可能。</span><span class="sxs-lookup"><span data-stu-id="99d6c-174">Not used on the client; optional on the service.</span></span> <span data-ttu-id="99d6c-175">`message`> 要素の子として、`<issuerMetadata>` 要素を作成します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-175">Create an `<issuerMetadata>` element as a child of the <`message`> element.</span></span> <span data-ttu-id="99d6c-176">次に、`address` 要素の `<issuerMetadata>` 属性に、セキュリティ トークン サービスがメタデータを公開するアドレスを指定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-176">Then, in an `address` attribute on the `<issuerMetadata>` element, specify the address at which the security token service is to publish its metadata.</span></span> <span data-ttu-id="99d6c-177">オプションで、`<identity>` 子要素を追加し、セキュリティ トークン サービスの識別子を指定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-177">Optionally, add an `<identity>` child element and specify the identity of the security token service.</span></span>

16. <span data-ttu-id="99d6c-178">クライアント側、サービス側とも省略可能。</span><span class="sxs-lookup"><span data-stu-id="99d6c-178">Optional on both the client and the service.</span></span> <span data-ttu-id="99d6c-179">`<claimTypeRequirements>` 要素の子要素として `<message>` 要素を追加します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-179">Add a `<claimTypeRequirements>` element as a child of the `<message>` element.</span></span> <span data-ttu-id="99d6c-180">サービスが依存する必須および省略可能な要求を指定します。追加するには、> 要素を `<claimTypeRequirements>` 要素に追加し、`claimType` 属性を使用して要求の種類を指定[\<](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-claimtyperequirements.md)ます。</span><span class="sxs-lookup"><span data-stu-id="99d6c-180">Specify required and optional claims that the service relies on by adding [\<add>](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-claimtyperequirements.md) elements to the `<claimTypeRequirements>` element and specifying the claim type with the `claimType` attribute.</span></span> <span data-ttu-id="99d6c-181">さらに、`isOptional` 属性に、クレームが必須か省略可能かを設定します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-181">Specify whether a given claim is required or optional by setting the `isOptional` attribute.</span></span>

## <a name="example"></a><span data-ttu-id="99d6c-182">例</span><span class="sxs-lookup"><span data-stu-id="99d6c-182">Example</span></span>

<span data-ttu-id="99d6c-183">強制的に `WSFederationHttpBinding` を設定するコード例を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="99d6c-183">The following code sample shows code for setting up a `WSFederationHttpBinding` imperatively.</span></span>

[!code-csharp[c_FederationBinding#2](~/samples/snippets/csharp/VS_Snippets_CFX/c_federationbinding/cs/source.cs#2)]
[!code-vb[c_FederationBinding#2](~/samples/snippets/visualbasic/VS_Snippets_CFX/c_federationbinding/vb/source.vb#2)]

## <a name="see-also"></a><span data-ttu-id="99d6c-184">関連項目</span><span class="sxs-lookup"><span data-stu-id="99d6c-184">See also</span></span>

- [<span data-ttu-id="99d6c-185">フェデレーション</span><span class="sxs-lookup"><span data-stu-id="99d6c-185">Federation</span></span>](federation.md)
- [<span data-ttu-id="99d6c-186">フェデレーション サンプル</span><span class="sxs-lookup"><span data-stu-id="99d6c-186">Federation Sample</span></span>](../../../../docs/framework/wcf/samples/federation-sample.md)
- [<span data-ttu-id="99d6c-187">方法 : WSFederationHttpBinding のセキュリティで保護されたセッションを無効にする</span><span class="sxs-lookup"><span data-stu-id="99d6c-187">How to: Disable Secure Sessions on a WSFederationHttpBinding</span></span>](how-to-disable-secure-sessions-on-a-wsfederationhttpbinding.md)
