---
title: Windows Vista、Windows Server 2003、および Windows XP におけるキュー機能の相違点
ms.date: 03/30/2017
helpviewer_keywords:
- queues [WCF], differences in operating systems
ms.assetid: aa809d93-d0a3-4ae6-a726-d015cca37c04
ms.openlocfilehash: 77491981bdef7d02da6894cbbee93c779972d803
ms.sourcegitcommit: a4f9b754059f0210e29ae0578363a27b9ba84b64
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/05/2019
ms.locfileid: "74837429"
---
# <a name="differences-in-queuing-features-in-windows-vista-windows-server-2003-and-windows-xp"></a><span data-ttu-id="39c52-102">Windows Vista、Windows Server 2003、および Windows XP におけるキュー機能の相違点</span><span class="sxs-lookup"><span data-stu-id="39c52-102">Differences in Queuing Features in Windows Vista, Windows Server 2003, and Windows XP</span></span>
<span data-ttu-id="39c52-103">このトピックでは、Windows Vista、[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)]、および [!INCLUDE[wxp](../../../../includes/wxp-md.md)]間の Windows Communication Foundation (WCF) キュー機能の違いについて説明します。</span><span class="sxs-lookup"><span data-stu-id="39c52-103">This topic summarizes the differences in the Windows Communication Foundation (WCF) queues feature between Windows Vista, [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)], and [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span>  
  
## <a name="application-specific-dead-letter-queue"></a><span data-ttu-id="39c52-104">アプリケーションごとの配信不能キュー</span><span class="sxs-lookup"><span data-stu-id="39c52-104">Application-Specific Dead-Letter Queue</span></span>  
 <span data-ttu-id="39c52-105">キューに置かれたメッセージは、受信側のアプリケーションでタイムリーに読み取らなれないと、無期限にキューに残ることがあります。</span><span class="sxs-lookup"><span data-stu-id="39c52-105">Queued messages can remain in the queue indefinitely if the receiving application does not read them in a timely fashion.</span></span> <span data-ttu-id="39c52-106">時間依存のメッセージでは、このような動作は適切ではありません。</span><span class="sxs-lookup"><span data-stu-id="39c52-106">This behavior is not advisable if the messages are time-sensitive.</span></span> <span data-ttu-id="39c52-107">時間依存のメッセージとは、キューに置かれたバインディングで `TimeToLive` プロパティが設定されているメッセージです。</span><span class="sxs-lookup"><span data-stu-id="39c52-107">Time-sensitive messages have a `TimeToLive` property set in the queued binding.</span></span> <span data-ttu-id="39c52-108">このプロパティでは、メッセージの期限が切れるまでのキュー内での保持期間を指定します。</span><span class="sxs-lookup"><span data-stu-id="39c52-108">This property indicates how long the messages can be in the queue before they expire.</span></span> <span data-ttu-id="39c52-109">期限切れのメッセージは、配信不能キューと呼ばれる特別なキューに送信されます。</span><span class="sxs-lookup"><span data-stu-id="39c52-109">Expired messages are sent to a special queue called the dead-letter queue.</span></span> <span data-ttu-id="39c52-110">また、キューのクォータの超過、認証エラーの発生など、その他の理由でメッセージが配信不能キューに送信される場合もあります。</span><span class="sxs-lookup"><span data-stu-id="39c52-110">A message can also end up in a dead-letter queue for other reasons, such as exceeding a queue quota or experiencing an authentication failure.</span></span>  
  
 <span data-ttu-id="39c52-111">通常は、同じキュー マネージャーを共有する、キューに置かれたすべてのアプリケーションに対して、システム全体の配信不能キューが 1 つ存在します。</span><span class="sxs-lookup"><span data-stu-id="39c52-111">Typically, a single system-wide dead-letter queue exists for all queued applications that share a queue manager.</span></span> <span data-ttu-id="39c52-112">アプリケーションごとの配信不能キューを使用した場合は、個々のアプリケーションがそのアプリケーションごとの配信不能キューを指定できます。このため、キューに置かれた、同じキュー マネージャーを共有しているアプリケーション間の分離を改善できます。</span><span class="sxs-lookup"><span data-stu-id="39c52-112">A dead-letter queue for each application enables better isolation between queued applications that share a queue manager by allowing these applications to specify their own application-specific dead-letter queue.</span></span> <span data-ttu-id="39c52-113">配信不能キューを他のアプリケーションと共有しているアプリケーションは、キューをブラウズしてそのアプリケーション用のメッセージを見つける必要があります。</span><span class="sxs-lookup"><span data-stu-id="39c52-113">An application that shares a dead-letter queue with other applications has to browse the queue to find messages that are applicable to it.</span></span> <span data-ttu-id="39c52-114">アプリケーションごとの配信不能キューが使用されている場合、アプリケーション専用の配信不能キューにあるメッセージはすべて、そのアプリケーション用ということになります。</span><span class="sxs-lookup"><span data-stu-id="39c52-114">With an application-specific dead-letter queue, the application can be assured that all messages in its dead-letter queue are applicable to it.</span></span>  
  
 <span data-ttu-id="39c52-115">Windows Vista には、アプリケーション固有の配信不能キューが用意されています。</span><span class="sxs-lookup"><span data-stu-id="39c52-115">Windows Vista provides for application-specific dead-letter queues.</span></span> <span data-ttu-id="39c52-116">[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] と [!INCLUDE[wxp](../../../../includes/wxp-md.md)] では、アプリケーションごとの配信不能キューを使用できないので、アプリケーションは、システム全体の配信不能キューを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="39c52-116">Application-specific dead-letter queues are not available in [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] and [!INCLUDE[wxp](../../../../includes/wxp-md.md)], and applications must use the system-wide dead-letter queue.</span></span>  
  
## <a name="poison-message-handling"></a><span data-ttu-id="39c52-117">有害メッセージの処理</span><span class="sxs-lookup"><span data-stu-id="39c52-117">Poison-Message Handling</span></span>  
 <span data-ttu-id="39c52-118">有害メッセージとは、受信側アプリケーションへの配信試行の回数が最大値を超えたメッセージのことです。</span><span class="sxs-lookup"><span data-stu-id="39c52-118">A poison message is a message that has exceeded the maximum number of delivery attempts to the receiving application.</span></span> <span data-ttu-id="39c52-119">この状況が生じるのは、トランザクション キューからメッセージを読み取るアプリケーションが、エラーなどの原因でメッセージをすぐに処理できないような場合です。</span><span class="sxs-lookup"><span data-stu-id="39c52-119">This situation can arise when an application that reads a message from a transactional queue cannot process the message immediately because of errors.</span></span> <span data-ttu-id="39c52-120">アプリケーションは、キューに置かれたメッセージを受信したトランザクションを中止した場合、メッセージをキューに戻します。</span><span class="sxs-lookup"><span data-stu-id="39c52-120">If the application aborts the transaction in which the queued message was received, it returns the message to the queue.</span></span> <span data-ttu-id="39c52-121">その後、アプリケーションは、新しいトランザクションで再度メッセージを取得しようとします。</span><span class="sxs-lookup"><span data-stu-id="39c52-121">The application then tries to retrieve the message again in a new transaction.</span></span> <span data-ttu-id="39c52-122">エラーを引き起こす問題が解決しないと、受信側のアプリケーションは、同じメッセージの受信と中止を繰り返すループから出られなくなる可能性があります。その結果、配信試行回数が最大値を超過し、有害メッセージの状況が生じます。</span><span class="sxs-lookup"><span data-stu-id="39c52-122">If the problem that causes the error is not corrected, the receiving application can get stuck in a loop receiving and aborting the same message until it exceeds the maximum number of delivery attempts, and a poison message results.</span></span>  
  
 <span data-ttu-id="39c52-123">Windows Vista、[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)]、および有害扱いに関連する [!INCLUDE[wxp](../../../../includes/wxp-md.md)] のメッセージキュー (MSMQ) の主な相違点を次に示します。</span><span class="sxs-lookup"><span data-stu-id="39c52-123">The key differences between Message Queuing (MSMQ) on Windows Vista, [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)], and [!INCLUDE[wxp](../../../../includes/wxp-md.md)] that are relevant to poison handling include the following:</span></span>  
  
- <span data-ttu-id="39c52-124">Windows Vista の MSMQ はサブキューをサポートしていますが、[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] と [!INCLUDE[wxp](../../../../includes/wxp-md.md)] はサブキューをサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="39c52-124">MSMQ in Windows Vista supports subqueues, while [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] and [!INCLUDE[wxp](../../../../includes/wxp-md.md)] do not support subqueues.</span></span> <span data-ttu-id="39c52-125">サブキューは、有害メッセージ処理で使用されます。</span><span class="sxs-lookup"><span data-stu-id="39c52-125">Subqueues are used in poison-message handling.</span></span> <span data-ttu-id="39c52-126">再試行キューと有害キューは、有害メッセージ処理の設定に基づいて作成されるアプリケーション キューのサブキューです。</span><span class="sxs-lookup"><span data-stu-id="39c52-126">The retry queues and the poison queue are subqueues to the application queue that is created based on the poison-message handling settings.</span></span> <span data-ttu-id="39c52-127">作成する再試行サブキューの数は、`MaxRetryCycles` で指定します。</span><span class="sxs-lookup"><span data-stu-id="39c52-127">The `MaxRetryCycles` dictates how many retry subqueues to create.</span></span> <span data-ttu-id="39c52-128">したがって、[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] または [!INCLUDE[wxp](../../../../includes/wxp-md.md)] で実行している場合、`MaxRetryCycles` は無視されるため、`ReceiveErrorHandling.Move` は使用できません。</span><span class="sxs-lookup"><span data-stu-id="39c52-128">Therefore, when running on [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] or [!INCLUDE[wxp](../../../../includes/wxp-md.md)], `MaxRetryCycles` are ignored and `ReceiveErrorHandling.Move` is not allowed.</span></span>  
  
- <span data-ttu-id="39c52-129">Windows Vista の MSMQ は否定受信確認をサポートしていますが、[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] と [!INCLUDE[wxp](../../../../includes/wxp-md.md)] ではサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="39c52-129">MSMQ in Windows Vista supports negative acknowledgment, while [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] and [!INCLUDE[wxp](../../../../includes/wxp-md.md)] do not.</span></span> <span data-ttu-id="39c52-130">受信側キュー マネージャーから否定受信確認を受け取ると、送信側キュー マネージャーは拒否されたメッセージを配信不能キューに入れます。</span><span class="sxs-lookup"><span data-stu-id="39c52-130">A negative acknowledgment from the receiving queue manager causes the sending queue manager to place the rejected message in the dead-letter queue.</span></span> <span data-ttu-id="39c52-131">そのため、`ReceiveErrorHandling.Reject` は、[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] と [!INCLUDE[wxp](../../../../includes/wxp-md.md)] では使用できません。</span><span class="sxs-lookup"><span data-stu-id="39c52-131">As such, `ReceiveErrorHandling.Reject` is not allowed with [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] and [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span>  
  
- <span data-ttu-id="39c52-132">Windows Vista の MSMQ では、メッセージの配信が試行された回数を保持するメッセージプロパティをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="39c52-132">MSMQ in Windows Vista supports a message property that keeps count of the number of times message delivery is attempted.</span></span> <span data-ttu-id="39c52-133">この中止回数のプロパティは、[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] と [!INCLUDE[wxp](../../../../includes/wxp-md.md)] では使用できません。</span><span class="sxs-lookup"><span data-stu-id="39c52-133">This abort count property is not available on [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] and [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span> <span data-ttu-id="39c52-134">WCF では、abort count がメモリ内に保持されるため、同じメッセージが Web ファーム内の複数の WCF サービスによって読み取られる場合、このプロパティに正確な値が含まれていない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="39c52-134">WCF maintains the abort count in memory, so it is possible that this property may not contain an accurate value when the same message is read by more than one WCF service in a Web farm.</span></span>  
  
## <a name="remote-transactional-read"></a><span data-ttu-id="39c52-135">リモート トランザクション読み取り</span><span class="sxs-lookup"><span data-stu-id="39c52-135">Remote Transactional Read</span></span>  
 <span data-ttu-id="39c52-136">Windows Vista の MSMQ は、リモートトランザクション読み取りをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="39c52-136">MSMQ on Windows Vista supports remote transactional reads.</span></span> <span data-ttu-id="39c52-137">これによって、キューから読み取りを行うアプリケーションを、そのキューをホストしているコンピューターとは別のコンピューター上でホストすることが可能になります。</span><span class="sxs-lookup"><span data-stu-id="39c52-137">This allows an application that is reading from a queue to be hosted on a computer that is different from the computer on which the queue is hosted.</span></span> <span data-ttu-id="39c52-138">これにより、サービスのファーム全体で中央のキューから読み取りを行うことができるようになり、システムの全体のスループットが向上します。</span><span class="sxs-lookup"><span data-stu-id="39c52-138">This ensures the ability to have a farm of services reading from a central queue, which increases the overall throughput of the system.</span></span> <span data-ttu-id="39c52-139">また、メッセージの読み取り中および処理中にエラーが発生した場合、トランザクションはロールバックし、メッセージは後で処理できるようにキューに残るようにもなります。</span><span class="sxs-lookup"><span data-stu-id="39c52-139">It also ensures that if a failure occurs when reading and processing the message, the transaction rolls back and the message remains in the queue for later processing.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="39c52-140">参照</span><span class="sxs-lookup"><span data-stu-id="39c52-140">See also</span></span>

- [<span data-ttu-id="39c52-141">配信不能キューを使用したメッセージ転送エラー処理</span><span class="sxs-lookup"><span data-stu-id="39c52-141">Using Dead-Letter Queues to Handle Message Transfer Failures</span></span>](../../../../docs/framework/wcf/feature-details/using-dead-letter-queues-to-handle-message-transfer-failures.md)
- [<span data-ttu-id="39c52-142">有害メッセージ処理</span><span class="sxs-lookup"><span data-stu-id="39c52-142">Poison Message Handling</span></span>](../../../../docs/framework/wcf/feature-details/poison-message-handling.md)
