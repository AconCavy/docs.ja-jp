---
title: 信頼できるセッションの概要
ms.date: 03/30/2017
ms.assetid: a7fc4146-ee2c-444c-82d4-ef6faffccc2d
ms.openlocfilehash: 6dd90ef800daf236d77c419d48c0857ac2d78aa2
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "61962657"
---
# <a name="reliable-sessions-overview"></a>信頼できるセッションの概要

Windows Communication Foundation (WCF) の SOAP リライアブル メッセージには、SOAP エンドポイント間のエンド ツー エンドのメッセージ転送の信頼性が備わっています。 これにより、信頼性の低いネットワーク上でも、トランスポート エラーや SOAP メッセージ レベルのエラーに対処できます。 具体的には、SOAP またはトランスポート中継局を経由して送信されるメッセージに関して、1 回だけの配信や (オプションで) 順序保証の配信がセッション ベースで提供されます。 セッション ベースの配布は、メッセージの省略可能な順序とのセッションでメッセージをグループ化を提供します。

このトピックでは信頼できるセッションをする方法について説明、それらを使用してしてセキュリティで保護する方法。

## <a name="wcf-reliable-sessions"></a>WCF の信頼できるセッション

WCF の信頼できるセッションは、信頼性の高いメッセージング、WS-ReliableMessaging プロトコルで定義されている SOAP の実装です。

WCF SOAP リライアブル メッセージ数や、メッセージング エンドポイントを分離する中継ぎ局の種類に関係なく、2 つのエンドポイント間のエンド ツー エンドの信頼できるセッションを提供します。 これにより、SOAP (HTTP プロキシなど) を使用しないトランスポート手段が含まれます。 または中継ぎ局 SOAP (SOAP ベースのルーターやブリッジなど) を使用するエンドポイント間でフローにメッセージを必要とされます。 信頼できるセッション チャネルは、サポート*対話型*通信できるように、これらのチャネルで接続されているサービスが同時に実行したり、低待機時間、つまりの条件下でメッセージを処理比較的短い時間間隔。 この結合は、それらの間に提供される分離がないために、これらのコンポーネントは、進行状況をまとめて行うまたはひとまとまりでフェールオーバーを意味します。

信頼できるセッションでは次の 2 種類のエラーがマスクされます。

- SOAP メッセージ レベルのエラー (メッセージの喪失または重複、および送信順序と異なる順序で到着するメッセージを含む)

- トランスポート エラー

信頼できるセッションは、WS-ReliableMessaging プロトコルとメモリ内転送ウィンドウを実装することにより、トランスポート エラーが発生した場合に SOAP メッセージ レベルのエラーをマスクし、接続を再確立します。

信頼できるセッションは、TCP が IP パケットに提供する信頼性を SOAP メッセージに提供します。 TCP ソケット接続では、ノード間で IP パケットが 1 回のみ、正しい順序で転送されます。 信頼できるチャネルでも、これと同じタイプの信頼できる転送が提供されますが、次の点で TCP ソケットの信頼性とは異なります。

- 信頼性は、任意のサイズのバイト パケットに対してではなく、SOAP メッセージ レベルで提供されます。

- 信頼性は、TCP 経由で転送するためだけでなく、トランスポートに依存します。

- 信頼性は、特定のトランスポート セッション (たとえば、セッションの TCP 接続を提供します) に関連付けられていないし、トランスポート セッションを複数同時にまたは連続を使用してできます、信頼できるセッションの有効期間。

- 信頼できるセッションは、送信側と受信側の SOAP エンドポイント間の接続に必要なトランスポート接続の数に関係なく、両者の間で提供されます。 つまり、TCP の信頼性はトランスポート接続が終了する、エンド ツー エンドの信頼性を提供しますが、信頼できるセッションを終了します。

## <a name="reliable-sessions-and-bindings"></a>信頼できるセッションとバインド

前述のように、信頼できるセッションは、トランスポート中立です。 また、要求/応答または双方向など、多くのメッセージ交換パターンを信頼できるセッションを確立できます。 WCF の信頼できるセッションは、一連のバインドのプロパティとして公開されます。

使用するエンドポイントでは、信頼できるセッションを使用します。

- HTTP ベース トランスポートの標準バインディング

  - `WsHttpBinding` : 要求/応答または一方向のコントラクトを公開します。

  - ときに、信頼できるセッションを使用して、要求/応答または一方向のサービス コントラクト。

  - `WsDualHttpBinding` : 双方向、要求/応答、または一方向のコントラクトを公開します。

  - `WsFederationHttpBinding` : 要求/応答または一方向のコントラクトを公開します。

- TCP ベース トランスポートの標準バインディング

  - `NetTcpBinding` : 双方向、要求/応答、または一方向のコントラクトを公開します。

HTTPS などのカスタム バインドを作成して、他のバインディングで信頼できるセッションを使用 (問題の詳細については、次を参照してください。<a href="#reliable-sessions-and-security">信頼できるセッションとセキュリティ</a>) または名前付きパイプ バインドします。

基になるチャネルの種類の異なるで信頼できるセッションを積み重ねることができ、結果として得られる、信頼できるセッション チャネルの形状が変化します。 クライアントとサーバーの両方でサポートされている信頼できるセッション チャネルの種類に使用される基になるチャネルの種類によって異なります。 次の表では、基になるチャネルの種類ごとに、クライアントでサポートされるセッション チャネルの種類を示します。

| サポートされている信頼できるセッション チャネルの種類&#8224; | `IRequestChannel` | `IRequestSessionChannel` | `IDuplexChannel` | `IDuplexSessionChannel` |
| ----------------------------------------------- | :---------------: | :----------------------: | :--------------: | :---------------------: |
| `IOutputSessionChannel`                         | [はい]               | はい                      | はい              | はい                     |
| `IRequestSessionChannel`                        | はい               | [はい]                      | ×               | ×                      |
| `IDuplexSessionChannel`                         | ×                | ×                       | [はい]              | [はい]                     |

&#8224;サポートされているチャネルの型がジェネリックの使用できる値`TChannel`に渡されるパラメーター値、<xref:System.ServiceModel.Channels.ReliableSessionBindingElement.BuildChannelFactory%60%601%28System.ServiceModel.Channels.BindingContext%29>メソッド。

次の表では、基になるチャネルの種類ごとに、サーバーでサポートされるセッション チャネルの種類を示します。

| サポートされている信頼できるセッション チャネルの種類&#8225; | `IReplyChannel` | `IReplySessionChannel` | `IDuplexChannel` | `IDuplexSessionChannel` |
| ----------------------------------------------- | :-------------: | :--------------------: | :--------------: | :---------------------: |
| `IInputSessionChannel`                          | [はい]             | はい                    | はい              | はい                     |
| `IReplySessionChannel`                          | はい             | [はい]                    | ×               | ×                      |
| `IDuplexSessionChannel`                         | ×              | ×                     | [はい]              | [はい]                     |

&#8225;サポートされているチャネルの型がジェネリックの使用できる値`TChannel`に渡されるパラメーター値、<xref:System.ServiceModel.Channels.ReliableSessionBindingElement.BuildChannelListener%60%601%28System.ServiceModel.Channels.BindingContext%29>メソッド。

## <a name="reliable-sessions-and-security"></a>信頼できるセッションとセキュリティ

信頼できるセッションをセキュリティで保護するは、(サービスとクライアント) の通信相手が認証されると、セッションで交換されるメッセージが改ざんされないことを確認する必要があります。 さらに、それぞれ個別の信頼できるセッションの整合性を保証する重要なは。 信頼できるセッションが表され、セキュリティ セッション チャネルによって管理されるセキュリティ コンテキストにバインドすることによって保護されます。 セキュリティ チャネルによって、セキュリティ セッションが可能になります。 セッション確立中に交換されるセキュリティ トークンは、信頼できるセッションでメッセージをセキュリティで保護するために使用されます。

-S TCP 経由で信頼できるセッションがある場合は、信頼できるセッションに TCP セッションが関連付けられます。 そのため、トランスポート セキュリティにより、セキュリティが信頼できるセッションにも関連付けられていること。 この場合、接続の再確立は無効になります。

唯一の例外は、HTTPS の使用時です。 Secure Sockets Layer (SSL) セッションは、信頼できるセッションにバインドされていません。 セキュリティ コンテキスト (SSL セッション) を共有しているセッションが; 互いから保護されていないため、これにより、脅威これがか、アプリケーションによっては現実的な脅威ができない可能性があります。

## <a name="using-reliable-sessions"></a>信頼できるセッションを使用します。

WCF の信頼できるセッションを使用するには、信頼できるセッションをサポートするバインディングとエンドポイントを作成します。 WCF は信頼できるセッションを提供するシステム指定のバインディングのいずれかのでは、有効になっているか、これは、独自のカスタム バインディングを作成します。

信頼できるセッションが既定でサポートおよび有効化されているシステム定義のバインディングは、次のとおりです。

- <xref:System.ServiceModel.WSDualHttpBinding>

既定で 1 つを有効にしないオプションとして、信頼できるセッションをサポートするシステム指定のバインディングは、次のとおりです。

- <xref:System.ServiceModel.WSHttpBinding>

- <xref:System.ServiceModel.WSFederationHttpBinding>

- <xref:System.ServiceModel.NetTcpBinding>

カスタム バインドを作成する方法の例は、次を参照してください。[方法。HTTPS で信頼できるセッションをカスタム バインディングを作成する](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-reliable-session-binding-with-https.md)します。

信頼できるセッションをサポートする WCF バインドの詳細については、次を参照してください。 [System-Provided Bindings](../../../../docs/framework/wcf/system-provided-bindings.md)します。

## <a name="when-to-use-reliable-sessions"></a>信頼できるセッションを使用する場合

アプリケーションで信頼できるセッションを使用するタイミングを理解しておく必要があります。 WCF では、同時にアクティブで有効であるエンドポイント間の信頼できるセッションをサポートします。 アプリケーションでは、エンドポイントのいずれかが必要な場合は、時間の期間を使用できませんし、信頼性を実現するためにキューを使用します。

シナリオでは、2 つのエンドポイントを TCP 経由で接続されている必要がある場合、TCP が信頼性の高いメッセージ交換を提供するための十分なあります。 TCP が確実であるため、信頼できるセッションを使用する必要はありませんが、順序と 1 回だけで、パケットが到着します。

シナリオでは、次の特性のいずれかをする必要があります真剣に検討して、信頼できるセッションを使用します。

- SOAP ルーターなどの SOAP 中継ぎ局

- プロキシ中継ぎ局またはトランスポート ブリッジ

- 断続的な接続

- HTTP 経由でセッション

## <a name="see-also"></a>関連項目

- [サービスとクライアントを構成するためのバインディングの使用](../../../../docs/framework/wcf/using-bindings-to-configure-services-and-clients.md)
- [WS 信頼できるセッション](../../../../docs/framework/wcf/samples/ws-reliable-session.md)
