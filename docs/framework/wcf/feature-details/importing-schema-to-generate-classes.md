---
title: クラスを作成するためのスキーマのインポート
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF, schema import and export
- XsdDataContractImporter class
ms.assetid: b9170583-8c34-43bd-97bb-6c0c8dddeee0
ms.openlocfilehash: 7f7c13cda2dcaeec16ad1ee49ff3dddf369906e5
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/26/2020
ms.locfileid: "96280524"
---
# <a name="importing-schema-to-generate-classes"></a><span data-ttu-id="ed4a6-102">クラスを作成するためのスキーマのインポート</span><span class="sxs-lookup"><span data-stu-id="ed4a6-102">Importing Schema to Generate Classes</span></span>

<span data-ttu-id="ed4a6-103">Windows Communication Foundation (WCF) で使用できるスキーマからクラスを生成するには、クラスを使用し <xref:System.Runtime.Serialization.XsdDataContractImporter> ます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-103">To generate classes from schemas that are usable with Windows Communication Foundation (WCF), use the <xref:System.Runtime.Serialization.XsdDataContractImporter> class.</span></span> <span data-ttu-id="ed4a6-104">ここでは、生成時に指定できる各種のオプションについて解説します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-104">This topic describes the process and variations.</span></span>  
  
## <a name="the-import-process"></a><span data-ttu-id="ed4a6-105">インポート処理</span><span class="sxs-lookup"><span data-stu-id="ed4a6-105">The Import Process</span></span>

 <span data-ttu-id="ed4a6-106">スキーマのインポート処理は、<xref:System.Xml.Schema.XmlSchemaSet> を用意し、<xref:System.CodeDom.CodeCompileUnit> を生成することから始まります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-106">The schema import process starts with an <xref:System.Xml.Schema.XmlSchemaSet> and produces a <xref:System.CodeDom.CodeCompileUnit>.</span></span>  
  
 <span data-ttu-id="ed4a6-107">は、 `XmlSchemaSet` XML スキーマ定義言語 (XSD) スキーマドキュメントのセットを表す .NET Framework のスキーマオブジェクトモデル (SOM) の一部です。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-107">The `XmlSchemaSet` is a part of the .NET Framework’s Schema Object Model (SOM) that represents a set of XML Schema definition language (XSD) schema documents.</span></span> <span data-ttu-id="ed4a6-108">一連の XSD ドキュメントから `XmlSchemaSet` オブジェクトを生成する過程では、各ドキュメントを逆シリアル化して <xref:System.Xml.Schema.XmlSchema> オブジェクトにし (<xref:System.Xml.Serialization.XmlSerializer> を使用)、新規に作っておいた空の `XmlSchemaSet` に追加していきます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-108">To create an `XmlSchemaSet` object from a set of XSD documents, deserialize each document into an <xref:System.Xml.Schema.XmlSchema> object (using the <xref:System.Xml.Serialization.XmlSerializer>) and add these objects to a new `XmlSchemaSet`.</span></span>  
  
 <span data-ttu-id="ed4a6-109">は、 `CodeCompileUnit` 抽象的な方法で .NET Framework コードを表す .NET Framework の Code Document Object Model (CodeDOM) の一部です。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-109">The `CodeCompileUnit` is part of the .NET Framework’s Code Document Object Model (CodeDOM) that represents .NET Framework code in an abstract way.</span></span> <span data-ttu-id="ed4a6-110">実際のコードを `CodeCompileUnit` から生成するには、<xref:System.CodeDom.Compiler.CodeDomProvider> のサブクラスである、<xref:Microsoft.CSharp.CSharpCodeProvider> や <xref:Microsoft.VisualBasic.VBCodeProvider> を使います。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-110">To generate the actual code from a `CodeCompileUnit`, use a subclass of the <xref:System.CodeDom.Compiler.CodeDomProvider> class, such as the <xref:Microsoft.CSharp.CSharpCodeProvider> or <xref:Microsoft.VisualBasic.VBCodeProvider> class.</span></span>  
  
### <a name="to-import-a-schema"></a><span data-ttu-id="ed4a6-111">スキーマをインポートするには</span><span class="sxs-lookup"><span data-stu-id="ed4a6-111">To import a schema</span></span>  
  
1. <span data-ttu-id="ed4a6-112"><xref:System.Runtime.Serialization.XsdDataContractImporter> のインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-112">Create an instance of the <xref:System.Runtime.Serialization.XsdDataContractImporter>.</span></span>  
  
2. <span data-ttu-id="ed4a6-113">任意。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-113">Optional.</span></span> <span data-ttu-id="ed4a6-114">`CodeCompileUnit` をコンストラクターに渡します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-114">Pass a `CodeCompileUnit` in the constructor.</span></span> <span data-ttu-id="ed4a6-115">スキーマのインポート時に生成された型がこの `CodeCompileUnit` インスタンスに追加されるので、以降の処理は、`CodeCompileUnit` が空でない状態から始まります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-115">The types generated during schema import are added to this `CodeCompileUnit` instance instead of starting with a blank `CodeCompileUnit`.</span></span>  
  
3. <span data-ttu-id="ed4a6-116">任意。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-116">Optional.</span></span> <span data-ttu-id="ed4a6-117"><xref:System.Runtime.Serialization.XsdDataContractImporter.CanImport%2A> メソッドのいずれかを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-117">Call one of the <xref:System.Runtime.Serialization.XsdDataContractImporter.CanImport%2A> methods.</span></span> <span data-ttu-id="ed4a6-118">指定されたスキーマが有効なデータ コントラクト スキーマであって、インポートしても問題ないかどうかを判断するメソッドです。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-118">The method determines whether the given schema is a valid data contract schema and can be imported.</span></span> <span data-ttu-id="ed4a6-119">`CanImport` メソッドには、次の手順に出てくる `Import` と同様に、オーバーロードがあります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-119">The `CanImport` method has the same overloads as `Import` (the next step).</span></span>  
  
4. <span data-ttu-id="ed4a6-120">オーバーロードされた `Import` メソッドのいずれか、たとえば <xref:System.Runtime.Serialization.XsdDataContractImporter.Import%28System.Xml.Schema.XmlSchemaSet%29> を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-120">Call one of the overloaded `Import` methods, for example, the <xref:System.Runtime.Serialization.XsdDataContractImporter.Import%28System.Xml.Schema.XmlSchemaSet%29> method.</span></span>  
  
     <span data-ttu-id="ed4a6-121">これは、指定しなければならない引数が `XmlSchemaSet` だけという最も簡潔なオーバーロードであり、匿名型を含め、一連のスキーマに記述されている型をすべてインポートできます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-121">The simplest overload takes an `XmlSchemaSet` and imports all types, including anonymous types, found in that schema set.</span></span> <span data-ttu-id="ed4a6-122">他に、XSD 型、あるいはインポートする型のリストを (<xref:System.Xml.XmlQualifiedName>、または `XmlQualifiedName` オブジェクトのコレクションとして) 指定できるオーバーロードもあります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-122">Other overloads allow you to specify the XSD type or a list of types to import (in the form of an <xref:System.Xml.XmlQualifiedName> or a collection of `XmlQualifiedName` objects).</span></span> <span data-ttu-id="ed4a6-123">この場合は、指定した型だけがインポートされます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-123">In this case, only the specified types are imported.</span></span> <span data-ttu-id="ed4a6-124">また、引数として <xref:System.Xml.Schema.XmlSchemaElement> を受け取り、`XmlSchemaSet` のうち特定の要素を、対応する型 (匿名型を含む) と併せてインポートするオーバーロードもあります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-124">An overload takes an <xref:System.Xml.Schema.XmlSchemaElement> that imports a particular element out of the `XmlSchemaSet`, as well as its associated type (whether it is anonymous or not).</span></span> <span data-ttu-id="ed4a6-125">このメソッドの戻り値は `XmlQualifiedName` であり、この要素に対応して生成された型のデータ コントラクト名を表します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-125">This overload returns an `XmlQualifiedName`, which represents the data contract name of the type generated for this element.</span></span>  
  
     <span data-ttu-id="ed4a6-126">`Import` メソッドを何度も呼び出すと、同じ `CodeCompileUnit` に複数の項目が追加されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-126">Multiple calls of the `Import` method result in multiple items being added to the same `CodeCompileUnit`.</span></span> <span data-ttu-id="ed4a6-127">`CodeCompileUnit` に既に存在する型は生成されません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-127">A type is not generated into the `CodeCompileUnit` if it already exists there.</span></span> <span data-ttu-id="ed4a6-128">したがって、`Import` オブジェクトをいくつも使うのではなく、同じ `XsdDataContractImporter` の `XsdDataContractImporter` を必要な回数呼び出すようにしてください。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-128">Call `Import` multiple times on the same `XsdDataContractImporter` instead of using multiple `XsdDataContractImporter` objects.</span></span> <span data-ttu-id="ed4a6-129">同じ型が重複して生成されることがないので、この方法をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-129">This is the recommended way to avoid duplicate types being generated.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="ed4a6-130">インポート中に障害が発生した場合の `CodeCompileUnit` の状態は不定です。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-130">If there is a failure during import, the `CodeCompileUnit` will be in an unpredictable state.</span></span> <span data-ttu-id="ed4a6-131">このような `CodeCompileUnit` を使うと、セキュリティ上の脆弱性につながるおそれがあります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-131">Using a `CodeCompileUnit` resulting from a failed import could expose you to security vulnerabilities.</span></span>  
  
5. <span data-ttu-id="ed4a6-132">`CodeCompileUnit` プロパティを介して、 <xref:System.Runtime.Serialization.XsdDataContractImporter.CodeCompileUnit%2A> にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-132">Access the `CodeCompileUnit` through the <xref:System.Runtime.Serialization.XsdDataContractImporter.CodeCompileUnit%2A> property.</span></span>  
  
### <a name="import-options-customizing-the-generated-types"></a><span data-ttu-id="ed4a6-133">インポート オプション : 生成された型のカスタマイズ</span><span class="sxs-lookup"><span data-stu-id="ed4a6-133">Import Options: Customizing the Generated Types</span></span>  

 <span data-ttu-id="ed4a6-134"><xref:System.Runtime.Serialization.XsdDataContractImporter.Options%2A> の <xref:System.Runtime.Serialization.XsdDataContractImporter> プロパティとして <xref:System.Runtime.Serialization.ImportOptions> クラスのインスタンスを設定することにより、インポート処理の方法を制御できます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-134">You can set the <xref:System.Runtime.Serialization.XsdDataContractImporter.Options%2A> property of the <xref:System.Runtime.Serialization.XsdDataContractImporter> to an instance of the <xref:System.Runtime.Serialization.ImportOptions> class to control various aspects of the import process.</span></span> <span data-ttu-id="ed4a6-135">生成される型に直接影響するオプションが多数あります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-135">A number of options directly influence the types that are generated.</span></span>  
  
#### <a name="controlling-the-access-level-generateinternal-or-the-internal-switch"></a><span data-ttu-id="ed4a6-136">アクセス レベルの制御 (GenerateInternal または /internal スイッチ)</span><span class="sxs-lookup"><span data-stu-id="ed4a6-136">Controlling the Access Level (GenerateInternal or the /internal switch)</span></span>  

 <span data-ttu-id="ed4a6-137">これは、 [ServiceModel メタデータユーティリティツール (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md)の **/内部** スイッチに相当します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-137">This corresponds to the **/internal** switch on the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span>  
  
 <span data-ttu-id="ed4a6-138">通常、スキーマから生成されるのはパブリック型です。ここにプライベート フィールドや対応するパブリック データ メンバー プロパティが定義されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-138">Normally, public types are generated from schema, with private fields and matching public data member properties.</span></span> <span data-ttu-id="ed4a6-139">パブリック型ではなく内部型を生成したい場合は、<xref:System.Runtime.Serialization.ImportOptions.GenerateInternal%2A> プロパティを `true` としてください。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-139">To generate internal types instead, set the <xref:System.Runtime.Serialization.ImportOptions.GenerateInternal%2A> property to `true`.</span></span>  
  
 <span data-ttu-id="ed4a6-140">次の例は、<xref:System.Runtime.Serialization.ImportOptions.GenerateInternal%2A> プロパティが `true.` の場合に、スキーマがどのように内部型に変換されるかを表します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-140">The following example shows a schema transformed into an internal class when the <xref:System.Runtime.Serialization.ImportOptions.GenerateInternal%2A> property is set to `true.`</span></span>  
  
 [!code-csharp[c_SchemaImportExport#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/cs/source.cs#2)]
 [!code-vb[c_SchemaImportExport#2](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_schemaimportexport/vb/source.vb#2)]  
  
#### <a name="controlling-namespaces-namespaces-or-the-namespace-switch"></a><span data-ttu-id="ed4a6-141">名前空間の制御 (Namespaces または /namespace スイッチ)</span><span class="sxs-lookup"><span data-stu-id="ed4a6-141">Controlling Namespaces (Namespaces or the /namespace switch)</span></span>  

 <span data-ttu-id="ed4a6-142">これは、ツールの **/namespace** スイッチに相当し `Svcutil.exe` ます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-142">This corresponds to the **/namespace** switch on the `Svcutil.exe` tool.</span></span>  
  
 <span data-ttu-id="ed4a6-143">通常、スキーマから生成された型は .NET Framework 名前空間に生成されます。各 XSD 名前空間は、「 [データコントラクトスキーマリファレンス](data-contract-schema-reference.md)」で説明されているマッピングに従って、特定の .NET Framework 名前空間に対応します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-143">Normally, types generated from schema are generated into .NET Framework namespaces, with each XSD namespace corresponding to a particular .NET Framework namespace according to a mapping described in [Data Contract Schema Reference](data-contract-schema-reference.md).</span></span> <span data-ttu-id="ed4a6-144">この対応関係は、<xref:System.Runtime.Serialization.ImportOptions.Namespaces%2A> の <xref:System.Collections.Generic.Dictionary%602> プロパティでカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-144">You can customize this mapping by the <xref:System.Runtime.Serialization.ImportOptions.Namespaces%2A> property to a <xref:System.Collections.Generic.Dictionary%602>.</span></span> <span data-ttu-id="ed4a6-145">指定された XSD 名前空間がディクショナリで見つかった場合は、一致する .NET Framework 名前空間もディクショナリから取得されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-145">If a given XSD namespace is found in the dictionary, the matching .NET Framework namespace is also taken from your dictionary.</span></span>  
  
 <span data-ttu-id="ed4a6-146">たとえば、次のスキーマを考えます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-146">For example, consider the following schema.</span></span>  
  
 [!code-xml[c_SchemaImportExport#10](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/common/source.config#10)]  
  
 <span data-ttu-id="ed4a6-147">次の例では、プロパティを使用して `Namespaces` 、 `http://schemas.contoso.com/carSchema` 名前空間を "Contoso. 車" にマップしています。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-147">The following example uses the `Namespaces` property to map the `http://schemas.contoso.com/carSchema` namespace to "Contoso.Cars".</span></span>  
  
 [!code-csharp[c_SchemaImportExport#8](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/cs/source.cs#8)]
 [!code-vb[c_SchemaImportExport#8](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_schemaimportexport/vb/source.vb#8)]  
  
#### <a name="adding-the-serializableattribute-generateserializable-or-the-serializable-switch"></a><span data-ttu-id="ed4a6-148">SerializableAttribute の追加 (GenerateSerializable または /serializable スイッチ)</span><span class="sxs-lookup"><span data-stu-id="ed4a6-148">Adding the SerializableAttribute (GenerateSerializable or the /serializable switch)</span></span>  

 <span data-ttu-id="ed4a6-149">これは、ツールの **/シリアル化** 可能なスイッチに対応し `Svcutil.exe` ます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-149">This corresponds to the **/serializable** switch on the `Svcutil.exe` tool.</span></span>  
  
 <span data-ttu-id="ed4a6-150">場合によっては、スキーマから生成された型を .NET Framework ランタイムシリアル化エンジン (クラス、クラスなど) で使用できるようにすることが重要になり <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter?displayProperty=nameWithType> <xref:System.Runtime.Serialization.Formatters.Soap.SoapFormatter> ます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-150">Sometimes it is important for the types generated from the schema to be usable with .NET Framework runtime serialization engines (for example, the <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter?displayProperty=nameWithType> and the <xref:System.Runtime.Serialization.Formatters.Soap.SoapFormatter> classes).</span></span> <span data-ttu-id="ed4a6-151">これは、.NET Framework のリモート処理に型を使用する場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-151">This is useful when using types for .NET Framework remoting.</span></span> <span data-ttu-id="ed4a6-152">そのためには、生成された型に対して、通常の <xref:System.SerializableAttribute> 属性に加え、<xref:System.Runtime.Serialization.DataContractAttribute> 属性も適用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-152">To enable this, you must apply the <xref:System.SerializableAttribute> attribute to the generated types in addition to the regular <xref:System.Runtime.Serialization.DataContractAttribute> attribute.</span></span> <span data-ttu-id="ed4a6-153">`GenerateSerializable` オプションを `true` に設定すると、この属性が自動的に生成されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-153">The attribute is generated automatically if the `GenerateSerializable` import option is set to `true`.</span></span>  
  
 <span data-ttu-id="ed4a6-154">`Vehicle` オプションを `GenerateSerializable` に設定して `true` クラスを生成する例を示します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-154">The following example shows the `Vehicle` class generated with the `GenerateSerializable` import option set to `true`.</span></span>  
  
 [!code-csharp[c_SchemaImportExport#4](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/cs/source.cs#4)]
 [!code-vb[c_SchemaImportExport#4](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_schemaimportexport/vb/source.vb#4)]  
  
#### <a name="adding-data-binding-support-enabledatabinding-or-the-enabledatabinding-switch"></a><span data-ttu-id="ed4a6-155">データ バインディング機能の追加 (EnableDataBinding または /enableDataBinding スイッチ)</span><span class="sxs-lookup"><span data-stu-id="ed4a6-155">Adding Data Binding Support (EnableDataBinding or the /enableDataBinding switch)</span></span>  

 <span data-ttu-id="ed4a6-156">これは、Svcutil.exe ツールの **/enabledatabinding** スイッチに対応しています。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-156">This corresponds to the **/enableDataBinding** switch on the Svcutil.exe tool.</span></span>  
  
 <span data-ttu-id="ed4a6-157">スキーマから生成された型を GUI コンポーネントにバインドして、この型のインスタンスを更新したとき、自動的に UI にも反映されるようにする場合があります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-157">Sometimes, you may want to bind the types generated from the schema to graphical user interface components so that any update to instances of these types will automatically update the UI.</span></span> <span data-ttu-id="ed4a6-158">`XsdDataContractImporter` は、生成する型に <xref:System.ComponentModel.INotifyPropertyChanged> インターフェイスを実装して、プロパティが変更されるとイベントが発生するようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-158">The `XsdDataContractImporter` can generate types that implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface in such a way that any property change triggers an event.</span></span> <span data-ttu-id="ed4a6-159">このインターフェイスをサポートするクライアント UI プログラミング環境 (Windows Presentation Foundation (WPF) など) で使用する型を生成する場合は、プロパティをに設定して、 <xref:System.Runtime.Serialization.ImportOptions.EnableDataBinding%2A> `true` この機能を有効にします。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-159">If you are generating types for use with a client UI programming environment that supports this interface (such as Windows Presentation Foundation (WPF)), set the <xref:System.Runtime.Serialization.ImportOptions.EnableDataBinding%2A> property to `true` to enable this feature.</span></span>  
  
 <span data-ttu-id="ed4a6-160">`Vehicle` プロパティを <xref:System.Runtime.Serialization.ImportOptions.EnableDataBinding%2A> に設定して生成した `true` クラスの例を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-160">The following example shows the `Vehicle` class generated with the <xref:System.Runtime.Serialization.ImportOptions.EnableDataBinding%2A> set to `true`.</span></span>  
  
 [!code-csharp[C_SchemaImportExport#5](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/cs/source.cs#5)]
 [!code-vb[C_SchemaImportExport#5](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_schemaimportexport/vb/source.vb#5)]  
  
### <a name="import-options-choosing-collection-types"></a><span data-ttu-id="ed4a6-161">インポート オプション: コレクション型の選択</span><span class="sxs-lookup"><span data-stu-id="ed4a6-161">Import Options: Choosing Collection Types</span></span>  

 <span data-ttu-id="ed4a6-162">XML でアイテムのコレクションを表すパターンには、アイテムのリストと、アイテム間の関連付けの 2 種類があります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-162">Two special patterns in XML represent collections of items: lists of items and associations between one item and another.</span></span> <span data-ttu-id="ed4a6-163">文字列のリストの例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-163">The following is an example of a list of strings.</span></span>  
  
 [!code-xml[C_SchemaImportExport#11](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/common/source.config#11)]  
  
 <span data-ttu-id="ed4a6-164">文字列と整数 (`city name` と `population`) を関連付ける例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-164">The following is an example of an association between a string and an integer (`city name` and `population`).</span></span>  
  
 [!code-xml[C_SchemaImportExport#12](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/common/source.config#12)]  
  
> [!NOTE]
> <span data-ttu-id="ed4a6-165">関連付けもリストと見なすことができます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-165">Any association could also be considered a list.</span></span> <span data-ttu-id="ed4a6-166">たとえば、上記の関連付けは、文字列と整数の 2 つのフィールドから成る複雑な `city` オブジェクトのリストと考えることも可能です。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-166">For example, you can view the preceding association as a list of complex `city` objects that happen to have two fields (a string field and an integer field).</span></span> <span data-ttu-id="ed4a6-167">どちらの方法であっても、XSD スキーマで表現できます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-167">Both patterns have a representation in the XSD Schema.</span></span> <span data-ttu-id="ed4a6-168">リストとアソシエーションを区別する方法はありません。そのため、このようなパターンは、WCF に固有の注釈がスキーマ内に存在しない限り、常にリストとして扱われます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-168">There is no way to differentiate between a list and an association, so such patterns are always treated as lists unless a special annotation specific to WCF is present in the schema.</span></span> <span data-ttu-id="ed4a6-169">注釈がある場合は、関連付けを表すものとして扱われます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-169">The annotation indicates that a given pattern represents an association.</span></span> <span data-ttu-id="ed4a6-170">詳細については、「 [データコントラクトスキーマの参照](data-contract-schema-reference.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-170">For more information, see [Data Contract Schema Reference](data-contract-schema-reference.md).</span></span>  
  
 <span data-ttu-id="ed4a6-171">通常、リストは、コレクションの標準の名前付けパターンに従っているかどうかによって、ジェネリックリストまたは .NET Framework 配列から派生したコレクションデータコントラクトとしてインポートされます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-171">Normally, a list is imported as a collection data contract that derives from a Generic List or as a .NET Framework array, depending on whether or not the schema follows the standard naming pattern for collections.</span></span> <span data-ttu-id="ed4a6-172">詳細については、「 [データコントラクトのコレクション型](collection-types-in-data-contracts.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-172">This is described in more detail in [Collection Types in Data Contracts](collection-types-in-data-contracts.md).</span></span> <span data-ttu-id="ed4a6-173">関連付けは通常、<xref:System.Collections.Generic.Dictionary%602>、または辞書オブジェクトから派生したコレクション データ コントラクトとしてインポートされます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-173">Associations are normally imported as either a <xref:System.Collections.Generic.Dictionary%602> or a collection data contract that derives from the dictionary object.</span></span> <span data-ttu-id="ed4a6-174">たとえば、次のスキーマを考えます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-174">For example, consider the following schema.</span></span>  
  
 [!code-xml[c_SchemaImportExport#13](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/common/source.config#13)]  
  
 <span data-ttu-id="ed4a6-175">これをインポートすると次のようになります (読みやすいようプロパティの代わりにフィールドを記載)。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-175">This would be imported as follows (fields are shown instead of properties for readability).</span></span>  
  
 [!code-csharp[c_SchemaImportExport#6](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/cs/source.cs#6)]
 [!code-vb[c_SchemaImportExport#6](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_schemaimportexport/vb/source.vb#6)]  
  
 <span data-ttu-id="ed4a6-176">このようなスキーマ パターンに対し、生成されるコレクション型をカスタマイズすることも可能です。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-176">It is possible to customize the collection types that are generated for such schema patterns.</span></span> <span data-ttu-id="ed4a6-177">たとえば、<xref:System.ComponentModel.BindingList%601> クラスではなく <xref:System.Collections.Generic.List%601> クラスからコレクションを生成することにより、型をリスト ボックスにバインドし、コレクションの内容が変わると自動的にリスト ボックスにも反映されるようにすることを考えてみましょう。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-177">For example, you may want to generate collections deriving from the <xref:System.ComponentModel.BindingList%601> instead of the <xref:System.Collections.Generic.List%601> class in order to bind the type to a list box and have it be automatically updated when the contents of the collection change.</span></span> <span data-ttu-id="ed4a6-178">これは、<xref:System.Runtime.Serialization.ImportOptions.ReferencedCollectionTypes%2A> クラスの <xref:System.Runtime.Serialization.ImportOptions> プロパティとして、実際に使うコレクション型 (以下、"参照される" 型) のリストを設定すると実現できます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-178">To do this, set the <xref:System.Runtime.Serialization.ImportOptions.ReferencedCollectionTypes%2A> property of the <xref:System.Runtime.Serialization.ImportOptions> class to a list of collection types to be used (hereafter known as the referenced types).</span></span> <span data-ttu-id="ed4a6-179">コレクションのインポート時には、参照されるコレクション型のリストが順に調べられ、最も適したコレクションがあれば、それが使用されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-179">When importing any collection, this list of referenced collection types is scanned and the best-matching collection is used if one is found.</span></span> <span data-ttu-id="ed4a6-180">関連付けは <xref:System.Collections.IDictionary> インターフェイス (ジェネリックか否かにかかわらず) を実装した型にしか照合されませんが、リストはサポートされているすべてのコレクション型に照合されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-180">Associations are matched only against types that implement either the generic or the nongeneric <xref:System.Collections.IDictionary> interface, while lists are matched against any supported collection type.</span></span>  
  
 <span data-ttu-id="ed4a6-181">たとえば <xref:System.Runtime.Serialization.ImportOptions.ReferencedCollectionTypes%2A> プロパティに <xref:System.ComponentModel.BindingList%601> を設定すると、上記の例にある `people` 型は次のように生成されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-181">For example, if the <xref:System.Runtime.Serialization.ImportOptions.ReferencedCollectionTypes%2A> property is set to a <xref:System.ComponentModel.BindingList%601>, the `people` type in the preceding example is generated as follows.</span></span>  
  
 [!code-csharp[C_SchemaImportExport#7](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_schemaimportexport/cs/source.cs#7)]
 [!code-vb[C_SchemaImportExport#7](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_schemaimportexport/vb/source.vb#7)]  
  
 <span data-ttu-id="ed4a6-182">クローズ ジェネリック型 (型パラメーターすべてに具体的な型が指定されているジェネリック型) は、合致度が最も高いと見なされます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-182">A closed generic is considered the best match.</span></span> <span data-ttu-id="ed4a6-183">したがって、たとえば `BindingList(Of Integer)` と <xref:System.Collections.ArrayList> の 2 つの型を "参照される" 型のコレクションに渡した場合、スキーマ内に整数のリストがあると、すべて `BindingList(Of Integer)` としてインポートされます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-183">For example, if the types `BindingList(Of Integer)` and <xref:System.Collections.ArrayList> are passed to the collection of referenced types, any lists of integers found in schema are imported as a `BindingList(Of Integer)`.</span></span> <span data-ttu-id="ed4a6-184">一方、それ以外のリスト (`List(Of String)` など) は、`ArrayList` としてインポートされます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-184">Any other lists, for example, a `List(Of String)`, are imported as an `ArrayList`.</span></span>  
  
 <span data-ttu-id="ed4a6-185">ジェネリック `IDictionary` インターフェイスを実装する型を "参照される" 型のコレクションに追加した場合、型パラメーターは、完全にオープンであるか完全にクローズであるかのどちらかです。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-185">If a type that implements the generic `IDictionary` interface is added to the collection of referenced types, its type parameters must either be fully open or fully closed.</span></span>  
  
 <span data-ttu-id="ed4a6-186">複製は使用できません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-186">Duplicates are not allowed.</span></span> <span data-ttu-id="ed4a6-187">たとえば `List(Of Integer)` と `Collection(Of Integer)` の両方を "参照される" 型に追加することはできません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-187">For example, you cannot add both a `List(Of Integer)` and a `Collection(Of Integer)` to the referenced types.</span></span> <span data-ttu-id="ed4a6-188">仮に追加したとしても、整数のリストがスキーマ中に表れたとき、どちらを使うか決められないからです。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-188">That would make it impossible to determine which should be used when a list of integers is found in schema.</span></span> <span data-ttu-id="ed4a6-189">もっとも、このような重複が検出されるのは、それが問題になるような型がスキーマ中にある場合だけです。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-189">Duplicates will be detected only if there is a type in schema that exposes the duplicates problem.</span></span> <span data-ttu-id="ed4a6-190">インポートするスキーマ中に、たとえば整数のリストがないのであれば、`List(Of Integer)` と `Collection(Of Integer)` の両方が "参照される" 型のコレクションにあっても問題はなく、単に何にも使われなかったというだけのことです。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-190">For example, if the imported schema does not contain lists of integers, it is allowed to have both the `List(Of Integer)` and the `Collection(Of Integer)` in the referenced types collection, but neither will have any effect.</span></span>  
  
 <span data-ttu-id="ed4a6-191">参照されるコレクション型のしくみは、プリミティブ型のコレクションばかりでなく、複合型のコレクション (他のコレクションから成るコレクションを含む) にも同様に働きます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-191">The referenced collection types mechanism works equally well for collections of complex types (including collections of other collections), and not just for collections of primitives.</span></span>  
  
 <span data-ttu-id="ed4a6-192">プロパティは、 `ReferencedCollectionTypes` SvcUtil.exe ツールの **/collectionType** スイッチに対応します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-192">The `ReferencedCollectionTypes` property corresponds to the **/collectionType** switch on the SvcUtil.exe tool.</span></span> <span data-ttu-id="ed4a6-193">複数のコレクション型を参照するには、 **/collectionType** スイッチを複数回指定する必要があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-193">Note that to reference multiple collection types, the **/collectionType** switch must be specified multiple times.</span></span> <span data-ttu-id="ed4a6-194">型が MsCorLib.dll にない場合は、そのアセンブリも **/reference** スイッチを使用して参照する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-194">If the type is not in the MsCorLib.dll, its assembly must also be referenced using the **/reference** switch.</span></span>  
  
#### <a name="import-options-referencing-existing-types"></a><span data-ttu-id="ed4a6-195">インポート オプション : 既存の型の参照</span><span class="sxs-lookup"><span data-stu-id="ed4a6-195">Import Options: Referencing Existing Types</span></span>  

 <span data-ttu-id="ed4a6-196">場合によっては、スキーマの型が既存の .NET Framework 型に対応しており、これらの型を最初から生成する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-196">Occasionally, types in schema correspond to existing .NET Framework types, and there is no need to generate these types from scratch.</span></span> <span data-ttu-id="ed4a6-197">(以下の説明は、非コレクション型にのみ当てはまります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-197">(This section applies only to noncollection types.</span></span> <span data-ttu-id="ed4a6-198">コレクション型については、前のセクションを参照してください)。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-198">For collection types, see the preceding section.)</span></span>  
  
 <span data-ttu-id="ed4a6-199">たとえば、企業全体で共通に、"Person" というデータ コントラクト型を使っており、人を表す場合には常にこれを使いたいとします。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-199">For example, you may have a standard company-wide "Person" data contract type that you always want used when representing a person.</span></span> <span data-ttu-id="ed4a6-200">いくつかのサービスでこの型を利用し、そのスキーマがサービス メタデータに表示される場合は、このスキーマをインポートするときに既存の `Person` 型を再利用でき、サービスごとに新たに生成する必要がありません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-200">Whenever some service makes use of this type, and its schema appears in the service metadata, you may want to reuse the existing `Person` type when importing this schema instead of generating a new one for every service.</span></span>  
  
 <span data-ttu-id="ed4a6-201">これを行うには、再利用する .NET Framework の種類の一覧を、 <xref:System.Runtime.Serialization.ImportOptions.ReferencedTypes%2A> プロパティがクラスで返すコレクションに渡し <xref:System.Runtime.Serialization.ImportOptions> ます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-201">To do this, pass a list of .NET Framework types that you want to reuse into the collection the <xref:System.Runtime.Serialization.ImportOptions.ReferencedTypes%2A> property returns on the <xref:System.Runtime.Serialization.ImportOptions> class.</span></span> <span data-ttu-id="ed4a6-202">これらの型のいずれかが、スキーマ型の名前および名前空間と一致すれば、その構造が比較されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-202">If any of these types have a data contract name and namespace that matches the name and namespace of a schema type, a structural comparison is performed.</span></span> <span data-ttu-id="ed4a6-203">型に一致する名前と一致する構造体の両方があると判断された場合は、新しい型を生成する代わりに、既存の .NET Framework 型が再利用されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-203">If it is determined that the types have both matching names and matching structures, the existing .NET Framework type is reused instead of generating a new one.</span></span> <span data-ttu-id="ed4a6-204">名前だけが一致して構造が一致しない場合は、例外が発生します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-204">If only the name matches but not the structure, an exception is thrown.</span></span> <span data-ttu-id="ed4a6-205">型の参照時に、バージョンによる (オプションのデータ メンバーの追加などの) 差異は許容されません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-205">Note that there is no allowance for versioning when referencing types (for example, adding new optional data members).</span></span> <span data-ttu-id="ed4a6-206">構造は厳密に合致しなければなりません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-206">The structures must match exactly.</span></span>  
  
 <span data-ttu-id="ed4a6-207">"参照される" 型のコレクションに、データ コントラクト名と名前空間が同一である型を重複して追加しても、その名前と名前空間でスキーマ型をインポートしない限り問題ありません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-207">It is legal to add multiple types with the same data contract name and namespace to the referenced types collection, as long as no schema types are imported with that name and namespace.</span></span> <span data-ttu-id="ed4a6-208">したがって、実際にはスキーマに現れることのない型については重複を気にすることなく、アセンブリ内の型をすべてコレクションに追加してしまうことができます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-208">This allows you to easily add all the types in an assembly to the collection without worrying about duplicates for types that do not actually occur in schema.</span></span>  
  
 <span data-ttu-id="ed4a6-209">プロパティは、 `ReferencedTypes` Svcutil.exe ツールの特定のモードの操作における **/reference** スイッチに対応します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-209">The `ReferencedTypes` property corresponds to the **/reference** switch in certain modes of operation of the Svcutil.exe tool.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="ed4a6-210">**サービス参照の追加** ツールで Svcutil.exe または (Visual Studio では) を使用すると、MsCorLib.dll 内のすべての型が自動的に参照されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-210">When using the Svcutil.exe or (in Visual Studio) the **Add Service Reference** tools, all of the types in MsCorLib.dll are automatically referenced.</span></span>  
  
#### <a name="import-options-importing-non-datacontract-schema-as-ixmlserializable-types"></a><span data-ttu-id="ed4a6-211">インポート オプション : 非データ コントラクト スキーマを IXmlSerializable 型としてインポート</span><span class="sxs-lookup"><span data-stu-id="ed4a6-211">Import Options: Importing Non-DataContract Schema as IXmlSerializable types</span></span>  

 <span data-ttu-id="ed4a6-212"><xref:System.Runtime.Serialization.XsdDataContractImporter> は、どのようなスキーマでもインポートできるわけではありません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-212">The <xref:System.Runtime.Serialization.XsdDataContractImporter> supports a limited subset of the schema.</span></span> <span data-ttu-id="ed4a6-213">未対応のスキーマ構造 (たとえば XML 属性) をインポートしようとすると例外が発生します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-213">If unsupported schema constructs are present (for example, XML attributes), the import attempt fails with an exception.</span></span> <span data-ttu-id="ed4a6-214">ただし <xref:System.Runtime.Serialization.ImportOptions.ImportXmlType%2A> プロパティを `true` に設定すると、対応可能なスキーマの範囲が広がります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-214">However, setting the <xref:System.Runtime.Serialization.ImportOptions.ImportXmlType%2A> property to `true` extends the range of schema supported.</span></span> <span data-ttu-id="ed4a6-215">`true` に設定すると、<xref:System.Runtime.Serialization.XsdDataContractImporter> は、<xref:System.Xml.Serialization.IXmlSerializable> インターフェイスを実装した型を生成します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-215">When set to `true`, the <xref:System.Runtime.Serialization.XsdDataContractImporter> generates types that implement the <xref:System.Xml.Serialization.IXmlSerializable> interface.</span></span> <span data-ttu-id="ed4a6-216">そのため、これらの型の XML 表現に直接アクセスできるようになります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-216">This enables direct access to the XML representation of these types.</span></span>  
  
##### <a name="design-considerations"></a><span data-ttu-id="ed4a6-217">デザインに関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="ed4a6-217">Design Considerations</span></span>  
  
- <span data-ttu-id="ed4a6-218">弱く型指定された XML 表現を直接扱うのは困難です。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-218">It may be difficult to work with the weakly typed XML representation directly.</span></span> <span data-ttu-id="ed4a6-219">データ コントラクトと互換性がないスキーマを厳密に型指定された方法で操作するには、<xref:System.Xml.Serialization.XmlSerializer> などの別のシリアル化エンジンの使用を検討します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-219">Consider using an alternative serialization engine, such as the <xref:System.Xml.Serialization.XmlSerializer>, to work with schema not compatible with data contracts in a strongly typed way.</span></span> <span data-ttu-id="ed4a6-220">詳細については、「 [XmlSerializer クラスの使用](using-the-xmlserializer-class.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-220">For more information, see [Using the XmlSerializer Class](using-the-xmlserializer-class.md).</span></span>  
  
- <span data-ttu-id="ed4a6-221">スキーマ構造によっては、<xref:System.Runtime.Serialization.XsdDataContractImporter> プロパティを <xref:System.Runtime.Serialization.ImportOptions.ImportXmlType%2A> に設定しても、`true` でインポートできない場合があります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-221">Some schema constructs cannot be imported by the <xref:System.Runtime.Serialization.XsdDataContractImporter> even when the <xref:System.Runtime.Serialization.ImportOptions.ImportXmlType%2A> property is set to `true`.</span></span> <span data-ttu-id="ed4a6-222">このような場合も、<xref:System.Xml.Serialization.XmlSerializer> の使用を検討します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-222">Again, consider using the <xref:System.Xml.Serialization.XmlSerializer> for such cases.</span></span>  
  
- <span data-ttu-id="ed4a6-223">がである場合、 <xref:System.Runtime.Serialization.ImportOptions.ImportXmlType%2A> `true` または `false` 「 [データコントラクトスキーマの参照](data-contract-schema-reference.md)」で説明されている場合に、サポートされているスキーマ構造を正確に示します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-223">The exact schema constructs that are supported both when <xref:System.Runtime.Serialization.ImportOptions.ImportXmlType%2A> is `true` or `false` are described in [Data Contract Schema Reference](data-contract-schema-reference.md).</span></span>  
  
- <span data-ttu-id="ed4a6-224">生成された <xref:System.Xml.Serialization.IXmlSerializable> 型に対するスキーマには、いったんインポートしてからエクスポートした場合、忠実性が維持されません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-224">Schema for generated <xref:System.Xml.Serialization.IXmlSerializable> types do not retain fidelity when imported and exported.</span></span> <span data-ttu-id="ed4a6-225">つまり、生成された型を基にスキーマをエクスポートし、再びこれをクラスとしてインポートした場合、元どおりのスキーマにはなりません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-225">That is, exporting the schema from the generated types and importing as classes does not return the original schema.</span></span>  
  
 <span data-ttu-id="ed4a6-226"><xref:System.Runtime.Serialization.ImportOptions.ImportXmlType%2A> のオプションは、上記の <xref:System.ServiceModel.Description.ServiceContractGenerator.ReferencedTypes%2A> オプションと組み合わせて指定できます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-226">It is possible to combine the <xref:System.Runtime.Serialization.ImportOptions.ImportXmlType%2A> option with the <xref:System.ServiceModel.Description.ServiceContractGenerator.ReferencedTypes%2A> option previously described.</span></span> <span data-ttu-id="ed4a6-227"><xref:System.Xml.Serialization.IXmlSerializable> を実装する形で生成される型に関しては、<xref:System.ServiceModel.Description.ServiceContractGenerator.ReferencedTypes%2A> で型を指定する際、構造がチェックされません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-227">For types that have to be generated as <xref:System.Xml.Serialization.IXmlSerializable> implementations, the structural check is skipped when using the <xref:System.ServiceModel.Description.ServiceContractGenerator.ReferencedTypes%2A> feature.</span></span>  
  
 <span data-ttu-id="ed4a6-228">オプションは、 <xref:System.Runtime.Serialization.ImportOptions.ImportXmlType%2A> Svcutil.exe ツールの **/importxmltypes** スイッチに対応しています。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-228">The <xref:System.Runtime.Serialization.ImportOptions.ImportXmlType%2A> option corresponds to the **/importXmlTypes** switch on the Svcutil.exe tool.</span></span>  
  
##### <a name="working-with-generated-ixmlserializable-types"></a><span data-ttu-id="ed4a6-229">生成された IXmlSerializable 型の使い方</span><span class="sxs-lookup"><span data-stu-id="ed4a6-229">Working with Generated IXmlSerializable Types</span></span>  

 <span data-ttu-id="ed4a6-230">生成された `IXmlSerializable` 型には、<xref:System.Xml.XmlNode> オブジェクトの配列を返す "nodesField" というプライベート フィールドがあります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-230">The generated `IXmlSerializable` types contain a private field, named "nodesField," that returns an array of <xref:System.Xml.XmlNode> objects.</span></span> <span data-ttu-id="ed4a6-231">このような型のインスタンスを逆シリアル化すると、XML ドキュメント オブジェクト モデルに基づき、このフィールドを介して XML データに直接アクセスできるようになります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-231">When deserializing an instance of such a type, you can access the XML data directly through this field by using the XML Document Object Model.</span></span> <span data-ttu-id="ed4a6-232">この型のインスタンスをシリアル化する際、"nodesField" フィールドに XML データを設定しておくと、これもシリアル化の対象になります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-232">When serializing an instance of this type, you can set this field to the desired XML data and it will be serialized.</span></span>  
  
 <span data-ttu-id="ed4a6-233">以上の処理は `IXmlSerializable` インターフェイスで実装されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-233">This is accomplished through the `IXmlSerializable` implementation.</span></span> <span data-ttu-id="ed4a6-234">生成された `IXmlSerializable` 型では、<xref:System.Xml.Serialization.IXmlSerializable.ReadXml%2A> の実装により、<xref:System.Runtime.Serialization.XmlSerializableServices.ReadNodes%2A> クラスの <xref:System.Runtime.Serialization.XmlSerializableServices> メソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-234">In the generated `IXmlSerializable` type, the <xref:System.Xml.Serialization.IXmlSerializable.ReadXml%2A> implementation calls the <xref:System.Runtime.Serialization.XmlSerializableServices.ReadNodes%2A> method of the <xref:System.Runtime.Serialization.XmlSerializableServices> class.</span></span> <span data-ttu-id="ed4a6-235">これは <xref:System.Xml.XmlReader> を介して渡された XML を <xref:System.Xml.XmlNode> オブジェクトに変換するヘルパー メソッドです。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-235">The method is a helper method that converts XML provided through an <xref:System.Xml.XmlReader> to an array of <xref:System.Xml.XmlNode> objects.</span></span> <span data-ttu-id="ed4a6-236"><xref:System.Xml.Serialization.IXmlSerializable.WriteXml%2A> を実装したコードは逆に、`XmlNode` オブジェクトの配列を、一連の <xref:System.Xml.XmlWriter> の呼び出しに変換します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-236">The <xref:System.Xml.Serialization.IXmlSerializable.WriteXml%2A> implementation does the opposite and converts the array of `XmlNode` objects to a sequence of <xref:System.Xml.XmlWriter> calls.</span></span> <span data-ttu-id="ed4a6-237">それには <xref:System.Runtime.Serialization.XmlSerializableServices.WriteNodes%2A> メソッドを使います。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-237">This is accomplished using the <xref:System.Runtime.Serialization.XmlSerializableServices.WriteNodes%2A> method.</span></span>  
  
 <span data-ttu-id="ed4a6-238">スキーマのエクスポート処理は、生成された `IXmlSerializable` クラスに対して実行できます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-238">It is possible to run the schema export process on the generated `IXmlSerializable` classes.</span></span> <span data-ttu-id="ed4a6-239">ただし、先に述べたように、元どおりのスキーマは再現されません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-239">As previously stated, you will not get the original schema back.</span></span> <span data-ttu-id="ed4a6-240">代わりに、XSD 型のワイルドカードである "anyType" という標準 XSD 型が取得されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-240">Instead, you will get the "anyType" standard XSD type, which is a wildcard for any XSD type.</span></span>  
  
 <span data-ttu-id="ed4a6-241">これを実現するには、 <xref:System.Xml.Serialization.XmlSchemaProviderAttribute> 生成されたクラスに属性を適用 `IXmlSerializable` し、メソッドを呼び出して <xref:System.Runtime.Serialization.XmlSerializableServices.AddDefaultSchema%2A> "anyType" 型を生成するメソッドを指定します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-241">This is accomplished by applying the <xref:System.Xml.Serialization.XmlSchemaProviderAttribute> attribute to the generated `IXmlSerializable` classes and specifying a method that calls the <xref:System.Runtime.Serialization.XmlSerializableServices.AddDefaultSchema%2A> method to generate the "anyType" type.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="ed4a6-242"><xref:System.Runtime.Serialization.XmlSerializableServices> 型は、この機能を提供するためだけに用意されています。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-242">The <xref:System.Runtime.Serialization.XmlSerializableServices> type exists solely to support this particular feature.</span></span> <span data-ttu-id="ed4a6-243">他の目的で使用することはお勧めできません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-243">It is not recommended for use for any other purpose.</span></span>  
  
#### <a name="import-options-advanced-options"></a><span data-ttu-id="ed4a6-244">インポート オプション : 高度なオプション</span><span class="sxs-lookup"><span data-stu-id="ed4a6-244">Import Options: Advanced Options</span></span>  

 <span data-ttu-id="ed4a6-245">他にも、次のようなオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-245">The following are advanced import options:</span></span>  
  
- <span data-ttu-id="ed4a6-246"><xref:System.Runtime.Serialization.ImportOptions.CodeProvider%2A> プロパティ。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-246"><xref:System.Runtime.Serialization.ImportOptions.CodeProvider%2A> property.</span></span> <span data-ttu-id="ed4a6-247">生成されたクラスに組み込むコードを生成するために使用する、<xref:System.CodeDom.Compiler.CodeDomProvider> を指定します。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-247">Specify the <xref:System.CodeDom.Compiler.CodeDomProvider> to use to generate the code for the generated classes.</span></span> <span data-ttu-id="ed4a6-248">インポートの際は、<xref:System.CodeDom.Compiler.CodeDomProvider> でサポートされていない機能が回避されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-248">The import mechanism attempts to avoid features that the <xref:System.CodeDom.Compiler.CodeDomProvider> does not support.</span></span> <span data-ttu-id="ed4a6-249">が設定されて <xref:System.Runtime.Serialization.ImportOptions.CodeProvider%2A> いない場合は、.NET Framework 機能の完全なセットが制限なしで使用されます。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-249">If the <xref:System.Runtime.Serialization.ImportOptions.CodeProvider%2A> is not set, the full set of .NET Framework features is used with no restrictions.</span></span>  
  
- <span data-ttu-id="ed4a6-250"><xref:System.Runtime.Serialization.ImportOptions.DataContractSurrogate%2A> プロパティ。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-250"><xref:System.Runtime.Serialization.ImportOptions.DataContractSurrogate%2A> property.</span></span> <span data-ttu-id="ed4a6-251"><xref:System.Runtime.Serialization.IDataContractSurrogate> の実装を指定するために使います。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-251">An <xref:System.Runtime.Serialization.IDataContractSurrogate> implementation can be specified with this property.</span></span> <span data-ttu-id="ed4a6-252"><xref:System.Runtime.Serialization.IDataContractSurrogate> は、インポート処理をカスタマイズします。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-252">The <xref:System.Runtime.Serialization.IDataContractSurrogate> customizes the import process.</span></span> <span data-ttu-id="ed4a6-253">詳細については、「 [データコントラクトサロゲート](../extending/data-contract-surrogates.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-253">For more information, see [Data Contract Surrogates](../extending/data-contract-surrogates.md).</span></span> <span data-ttu-id="ed4a6-254">既定では、サロゲートは使用されません。</span><span class="sxs-lookup"><span data-stu-id="ed4a6-254">By default, no surrogate is used.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ed4a6-255">関連項目</span><span class="sxs-lookup"><span data-stu-id="ed4a6-255">See also</span></span>

- <xref:System.Runtime.Serialization.DataContractSerializer>
- <xref:System.Runtime.Serialization.XsdDataContractImporter>
- <xref:System.Runtime.Serialization.XsdDataContractExporter>
- <xref:System.Runtime.Serialization.ImportOptions>
- [<span data-ttu-id="ed4a6-256">データ コントラクト スキーマの参照</span><span class="sxs-lookup"><span data-stu-id="ed4a6-256">Data Contract Schema Reference</span></span>](data-contract-schema-reference.md)
- [<span data-ttu-id="ed4a6-257">データ コントラクト サロゲート</span><span class="sxs-lookup"><span data-stu-id="ed4a6-257">Data Contract Surrogates</span></span>](../extending/data-contract-surrogates.md)
- [<span data-ttu-id="ed4a6-258">スキーマのインポートとエクスポート</span><span class="sxs-lookup"><span data-stu-id="ed4a6-258">Schema Import and Export</span></span>](schema-import-and-export.md)
- [<span data-ttu-id="ed4a6-259">クラスからのスキーマのエクスポート</span><span class="sxs-lookup"><span data-stu-id="ed4a6-259">Exporting Schemas from Classes</span></span>](exporting-schemas-from-classes.md)
- [<span data-ttu-id="ed4a6-260">データ コントラクト スキーマの参照</span><span class="sxs-lookup"><span data-stu-id="ed4a6-260">Data Contract Schema Reference</span></span>](data-contract-schema-reference.md)
