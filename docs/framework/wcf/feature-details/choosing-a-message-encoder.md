---
title: メッセージ エンコーダーを選択する
ms.date: 03/30/2017
ms.assetid: 2204d82d-d962-4922-a79e-c9a231604f19
ms.openlocfilehash: fd5bc2270f2e4095ef6ad2b1d89af3560fb8d312
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/15/2020
ms.locfileid: "90559372"
---
# <a name="choose-a-message-encoder"></a><span data-ttu-id="9bfa0-102">メッセージエンコーダーを選択する</span><span class="sxs-lookup"><span data-stu-id="9bfa0-102">Choose a Message Encoder</span></span>

<span data-ttu-id="9bfa0-103">この記事では、Windows Communication Foundation (WCF) に含まれるメッセージエンコーダー (バイナリ、テキスト、メッセージ伝送最適化メカニズム (MTOM)) を選択するための基準について説明します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-103">This article discusses criteria for choosing among the message encoders that are included in Windows Communication Foundation (WCF): binary, text, and Message Transmission Optimization Mechanism (MTOM).</span></span>  
  
 <span data-ttu-id="9bfa0-104">WCF では、バインディングを使用して、エンドポイント間でネットワーク経由でデータを転送する方法を指定します。 *バインディング*はバインド *要素*のシーケンスで構成されます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-104">In WCF, you specify how to transfer data across a network between endpoints by means of a *binding*, which is made up of a sequence of *binding elements*.</span></span> <span data-ttu-id="9bfa0-105">メッセージ エンコーダーは、バインディング スタックにあるメッセージ エンコーディング バインド要素によって表されます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-105">A message encoder is represented by a message encoding binding element in the binding stack.</span></span> <span data-ttu-id="9bfa0-106">バインディングには、オプションのプロトコル バインド要素 (セキュリティ バインド要素や信頼できるメッセージング バインド要素など)、必須のメッセージ エンコーディング バインド要素、および必須のトランスポート バインド要素が含まれます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-106">A binding includes optional protocol binding elements, such as a security binding element or reliable messaging binding element, a required message encoding binding element, and a required transport binding element.</span></span>  
  
 <span data-ttu-id="9bfa0-107">メッセージ エンコーディング バインド要素は、オプションのプロトコル バインド要素の下、必須のトランスポート バインド要素の上に位置します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-107">The message encoding binding element sits below the optional protocol binding elements and above the required transport binding element.</span></span> <span data-ttu-id="9bfa0-108">送信側では、メッセージ エンコーダーにより出力 <xref:System.ServiceModel.Channels.Message> がシリアル化されてトランスポートに渡されます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-108">On the outgoing side, a message encoder serializes the outgoing <xref:System.ServiceModel.Channels.Message> and passes it to the transport.</span></span> <span data-ttu-id="9bfa0-109">受信側では、メッセージ エンコーダーがトランスポートからシリアル化形式の <xref:System.ServiceModel.Channels.Message> を受信し、上位のプロトコル層が存在する場合はその層に、存在しない場合はアプリケーションに渡します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-109">On the incoming side, a message encoder receives the serialized form of a <xref:System.ServiceModel.Channels.Message> from the transport and passes it to the higher protocol layer, if present, or to the application, if not.</span></span>  
  
 <span data-ttu-id="9bfa0-110">既存のクライアントまたはサーバーに接続するときには、相手側が予測している方法でメッセージをエンコードする必要があるため、特定のメッセージ エンコーディングを選択できない場合があります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-110">When connecting to a pre-existing client or server, you may not have a choice about using a particular message encoding since you need to encode your messages in a way that the other side is expecting.</span></span> <span data-ttu-id="9bfa0-111">ただし、WCF サービスを作成する場合は、それぞれ異なるメッセージエンコーディングを使用して、複数のエンドポイントを介してサービスを公開できます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-111">However, if you are writing a WCF service, you can expose your service through multiple endpoints, each using a different message encoding.</span></span> <span data-ttu-id="9bfa0-112">これにより、クライアントは最適なエンドポイントでのサービスとの対話に最も適したエンコーディングを選択でき、最適なエンコーディングを選択する際の柔軟性が得られます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-112">This allows clients to choose the best encoding for talking to your service over the endpoint that is best for them, as well as giving your clients the flexibility to choose the encoding that is best for them.</span></span> <span data-ttu-id="9bfa0-113">複数のエンドポイントを使用することにより、異なるメッセージ エンコーディングの利点を他のバインド要素と組み合わせることも可能になります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-113">Using multiple endpoints also allows you to combine the advantages of different message encodings with other binding elements.</span></span>  
  
## <a name="system-provided-encoders"></a><span data-ttu-id="9bfa0-114">システム指定のエンコーダー</span><span class="sxs-lookup"><span data-stu-id="9bfa0-114">System-Provided Encoders</span></span>  
 <span data-ttu-id="9bfa0-115">WCF には、次の3つのクラスによって表される3つのメッセージエンコーダーが含まれています。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-115">WCF includes three message encoders, which are represented by the following three classes:</span></span>  
  
- <span data-ttu-id="9bfa0-116"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement> は、書式なし XML エンコーディングと SOAP エンコーディングの両方をサポートするテキスト メッセージ エンコーダーです。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-116"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>, the text message encoder, supports both plain XML encoding and SOAP encoding.</span></span> <span data-ttu-id="9bfa0-117">テキスト メッセージ エンコーダーの書式なし XML エンコーディング モードは、テキスト ベースの SOAP エンコーディングと区別するために、"POX" (Plain Old XML) と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-117">The plain XML encoding mode of the text message encoder is called "plain old XML" (POX) to distinguish it from text-based SOAP encoding.</span></span> <span data-ttu-id="9bfa0-118">POX を有効にするには、<xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement.MessageVersion%2A> プロパティを <xref:System.ServiceModel.Channels.MessageVersion.None%2A> に設定します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-118">To enable POX, set the <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement.MessageVersion%2A> property to <xref:System.ServiceModel.Channels.MessageVersion.None%2A>.</span></span> <span data-ttu-id="9bfa0-119">非 WCF エンドポイントと相互運用するには、テキストメッセージエンコーダーを使用します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-119">Use the text message encoder to interoperate with non-WCF endpoints.</span></span>  
  
- <span data-ttu-id="9bfa0-120"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>バイナリメッセージエンコーダーは、コンパクトなバイナリ形式を使用し、WCF から WCF への通信に最適化されているため、相互運用できません。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-120"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>, the binary message encoder, uses a compact binary format and is optimized for WCF to WCF communication, and hence is not interoperable.</span></span> <span data-ttu-id="9bfa0-121">これは、WCF が提供するすべてのエンコーダーの最もパフォーマンスの高いエンコーダーでもあります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-121">This is also the most performant encoder of all the encoders WCF provides.</span></span>  
  
- <span data-ttu-id="9bfa0-122"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> は、MTOM エンコーディングを使用して、メッセージの文字エンコーディングとバージョン管理を指定するバインド要素です。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-122"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>, the binding element, specifies the character encoding and message versioning for messages using MTOM encoding.</span></span> <span data-ttu-id="9bfa0-123">MTOM は、WCF メッセージでバイナリ データを転送するための効率的なテクノロジです。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-123">MTOM is an efficient technology for transmitting binary data in WCF messages.</span></span> <span data-ttu-id="9bfa0-124">MTOM エンコーダーは、効率と相互運用性のバランスをとろうとします。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-124">The MTOM encoder attempts to create a balance between efficiency and interoperability.</span></span> <span data-ttu-id="9bfa0-125">MTOM エンコーディングは、ほとんどの XML をテキスト形式で転送しますが、大きいサイズのバイナリ データ ブロックはテキストに変換せずにそのまま転送することによって最適化します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-125">The MTOM encoding transmits most XML in textual form, but optimizes large blocks of binary data by transmitting them as-is, without conversion to text.</span></span> <span data-ttu-id="9bfa0-126">WCF に用意されているエンコーダーの効率性の点から、MTOM はテキスト (最も低速) とバイナリ (最速) の間にあります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-126">In terms of efficiency, among the encoders WCF provides, MTOM is in-between text (the slowest) and binary (the fastest).</span></span>  
  
## <a name="how-to-choose-a-message-encoder"></a><span data-ttu-id="9bfa0-127">メッセージ エンコーダーを選択する方法</span><span class="sxs-lookup"><span data-stu-id="9bfa0-127">How to Choose a Message Encoder</span></span>  
 <span data-ttu-id="9bfa0-128">メッセージ エンコーダーを選択するために使用される一般的な要因を、次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-128">The following table describes common factors used to choose a message encoder.</span></span> <span data-ttu-id="9bfa0-129">アプリケーションにとって重要な要因に優先順位を与えて、それらの要因に対して最適なメッセージ エンコーダーを選択します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-129">Prioritize the factors that are important for your application, and then choose the message encoders that work best with these factors.</span></span> <span data-ttu-id="9bfa0-130">この表には示されていないその他の要因と、アプリケーションで必要になることがあるカスタム メッセージ エンコーダーも考慮するようにしてください。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-130">Be sure to consider any additional factors not listed in this table and any custom message encoders that may be required in your application.</span></span>  
  
|<span data-ttu-id="9bfa0-131">要素</span><span class="sxs-lookup"><span data-stu-id="9bfa0-131">Factor</span></span>|<span data-ttu-id="9bfa0-132">説明</span><span class="sxs-lookup"><span data-stu-id="9bfa0-132">Description</span></span>|<span data-ttu-id="9bfa0-133">この要因をサポートするエンコーダー</span><span class="sxs-lookup"><span data-stu-id="9bfa0-133">Encoders that support this factor</span></span>|  
|------------|-----------------|---------------------------------------|  
|<span data-ttu-id="9bfa0-134">サポートされている文字セット</span><span class="sxs-lookup"><span data-stu-id="9bfa0-134">Supported Character Sets</span></span>|<span data-ttu-id="9bfa0-135"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement> および <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> は、UTF8 および UTF16 Unicode (*ビッグエンディアン* および *リトルエンディアン*) エンコーディングのみをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-135"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement> and <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> support only the UTF8 and UTF16 Unicode (*big-endian* and *little-endian*) encodings.</span></span> <span data-ttu-id="9bfa0-136">UTF7 や ASCII など、別のエンコーディングが要求される場合はカスタム エンコーディングを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-136">If other encodings are required, such as UTF7 or ASCII, a custom encoder must be used.</span></span> <span data-ttu-id="9bfa0-137">カスタムエンコーダーのサンプルについては、「 [カスタムメッセージエンコーダー](../samples/custom-message-encoder-custom-text-encoder.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-137">For a sample custom encoder, see [Custom Message Encoder](../samples/custom-message-encoder-custom-text-encoder.md).</span></span>|<span data-ttu-id="9bfa0-138">Text</span><span class="sxs-lookup"><span data-stu-id="9bfa0-138">Text</span></span>|  
|<span data-ttu-id="9bfa0-139">検査</span><span class="sxs-lookup"><span data-stu-id="9bfa0-139">Inspection</span></span>|<span data-ttu-id="9bfa0-140">検査は、転送中にメッセージを調べる機能です。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-140">Inspection is the ability to examine messages during transmission.</span></span> <span data-ttu-id="9bfa0-141">SOAP の使用に関係なく、テキスト エンコーディングでは、多くのアプリケーションで特別なツールを使用することなくメッセージの検査と分析が可能です。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-141">Text encodings, either with or without the use of SOAP, allow messages to be inspected and analyzed by many applications without the use of specialized tools.</span></span> <span data-ttu-id="9bfa0-142">メッセージレベルまたはトランスポートレベルで転送セキュリティを使用すると、メッセージを検査する機能に影響します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-142">The use of transfer security, at either the message or transport level, affects your ability to inspect messages.</span></span> <span data-ttu-id="9bfa0-143">機密性はメッセージが検査されないように保護し、整合性はメッセージが変更されないように保護します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-143">Confidentiality protects a message from being examined and integrity protects a message from being modified.</span></span>|<span data-ttu-id="9bfa0-144">Text</span><span class="sxs-lookup"><span data-stu-id="9bfa0-144">Text</span></span>|  
|<span data-ttu-id="9bfa0-145">[信頼性]</span><span class="sxs-lookup"><span data-stu-id="9bfa0-145">Reliability</span></span>|<span data-ttu-id="9bfa0-146">信頼性は、転送エラーに対するエンコーダーの復元能力です。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-146">Reliability is the resiliency of an encoder to transmission errors.</span></span> <span data-ttu-id="9bfa0-147">信頼性はメッセージ層、トランスポート層、またはアプリケーション層でも提供できます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-147">Reliability can also be provided at the message, transport, or application layer.</span></span> <span data-ttu-id="9bfa0-148">標準の WCF エンコーダーでは、他のレイヤーが信頼性を提供していると想定しています。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-148">All of the standard WCF encoders assume that another layer is providing reliability.</span></span> <span data-ttu-id="9bfa0-149">エンコーダーは、転送エラーから回復する機能をほとんど備えていません。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-149">The encoder has little ability to recover from a transmission error.</span></span>|<span data-ttu-id="9bfa0-150">なし</span><span class="sxs-lookup"><span data-stu-id="9bfa0-150">None</span></span>|  
|<span data-ttu-id="9bfa0-151">簡便性</span><span class="sxs-lookup"><span data-stu-id="9bfa0-151">Simplicity</span></span>|<span data-ttu-id="9bfa0-152">単純さは、エンコード仕様に対応するエンコーダーとデコーダーの作成の容易さを表します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-152">Simplicity represents the ease with which you can create encoders and decoders for an encoding specification.</span></span> <span data-ttu-id="9bfa0-153">テキスト エンコーディングは、単純さの面で特に優れており、POX テキスト エンコーディングは SOAP 処理のサポートが不要なため、さらに優れています。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-153">Text encodings are particularly advantageous for simplicity, and the POX text encoding has the additional advantage of not requiring support for processing SOAP.</span></span>|<span data-ttu-id="9bfa0-154">テキスト (POX)</span><span class="sxs-lookup"><span data-stu-id="9bfa0-154">Text (POX)</span></span>|  
|<span data-ttu-id="9bfa0-155">サイズ</span><span class="sxs-lookup"><span data-stu-id="9bfa0-155">Size</span></span>|<span data-ttu-id="9bfa0-156">エンコーディングによって、コンテンツに課せられるオーバーヘッドの量が決まります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-156">The encoding determines the amount of overhead imposed on content.</span></span> <span data-ttu-id="9bfa0-157">エンコードされたメッセージのサイズは、サービス操作の最大スループットに直接影響します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-157">The size of encoded messages is directly related to the maximum throughput of service operations.</span></span> <span data-ttu-id="9bfa0-158">バイナリ エンコーディングは、一般にテキスト エンコーディングよりサイズが小さくなります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-158">Binary encodings are generally more compact than text encodings.</span></span> <span data-ttu-id="9bfa0-159">メッセージのサイズが優先事項である場合は、エンコーディング中にメッセージ コンテンツを圧縮することも検討してください。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-159">When message size is at a premium, consider also compressing the message contents during encoding.</span></span> <span data-ttu-id="9bfa0-160">ただし、圧縮を行うとメッセージの送信者と受信者の両方で処理コストが大きくなります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-160">However, compression adds processing costs for both the message sender and receiver.</span></span>|<span data-ttu-id="9bfa0-161">Binary</span><span class="sxs-lookup"><span data-stu-id="9bfa0-161">Binary</span></span>|  
|<span data-ttu-id="9bfa0-162">ストリーミング</span><span class="sxs-lookup"><span data-stu-id="9bfa0-162">Streaming</span></span>|<span data-ttu-id="9bfa0-163">ストリーミングでは、アプリケーションはメッセージ全体が到着する前にメッセージの処理を開始できます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-163">Streaming allows applications to begin processing a message before the entire message has arrived.</span></span> <span data-ttu-id="9bfa0-164">ストリーミングを効果的に使用するには、受信するアプリケーションが重要なデータの到着を待つ必要をなくすために、メッセージの冒頭で重要なデータが利用可能になっている必要があります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-164">Effectively using streaming requires that the important data for a message be available at the beginning of the message so that the receiving application is not required to wait for it to arrive.</span></span> <span data-ttu-id="9bfa0-165">さらに、ストリーミングされた転送を使用するアプリケーションでは、メッセージ コンテンツに前方依存性がないように、メッセージ内のデータを順次編成していく必要があります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-165">Moreover, applications that use streamed transfer must organize data in the message incrementally so that the content does not have forward dependencies.</span></span> <span data-ttu-id="9bfa0-166">多くの場合、コンテンツのストリーミングと必要最小限のサイズで転送を行うこととの間で妥協を図る必要があります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-166">In many cases, you must compromise between streaming content and having the smallest possible transfer size for that content.</span></span>|<span data-ttu-id="9bfa0-167">なし</span><span class="sxs-lookup"><span data-stu-id="9bfa0-167">None</span></span>|  
|<span data-ttu-id="9bfa0-168">サードパーティ製ツールのサポート</span><span class="sxs-lookup"><span data-stu-id="9bfa0-168">Third-Party Tool Support</span></span>|<span data-ttu-id="9bfa0-169">エンコーディングのサポート領域には、開発と診断があります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-169">Support areas for an encoding include development and diagnosis.</span></span> <span data-ttu-id="9bfa0-170">サードパーティの開発者は、POX 形式でエンコードされたメッセージを処理するためのライブラリとツールキットに多大な投資をしています。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-170">Third-party developers have made a large investment in libraries and toolkits for handling messages encoded in the POX format.</span></span>|<span data-ttu-id="9bfa0-171">テキスト (POX)</span><span class="sxs-lookup"><span data-stu-id="9bfa0-171">Text (POX)</span></span>|  
|<span data-ttu-id="9bfa0-172">相互運用性</span><span class="sxs-lookup"><span data-stu-id="9bfa0-172">Interoperability</span></span>|<span data-ttu-id="9bfa0-173">この要因は、wcf エンコーダーが WCF 以外のサービスと相互運用する機能を指します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-173">This factor refers to the ability of a WCF encoder to interoperate with non-WCF services.</span></span>|<span data-ttu-id="9bfa0-174">Text</span><span class="sxs-lookup"><span data-stu-id="9bfa0-174">Text</span></span><br /><br /> <span data-ttu-id="9bfa0-175">MTOM (部分的)</span><span class="sxs-lookup"><span data-stu-id="9bfa0-175">MTOM (partial)</span></span>|  
  
<span data-ttu-id="9bfa0-176">メモ: バイナリ エンコーダーを使用している場合、XMLReader を作成するときに IgnoreWhitespace の設定を使用しても効果はありません。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-176">Note: When using the Binary Encoder, using the IgnoreWhitespace setting when creating a XMLReader will have no effect.</span></span>  <span data-ttu-id="9bfa0-177">たとえば、サービス操作内で次の操作を実行するとします。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-177">For example, if you do the following inside a service operation:</span></span>  

```csharp
public void OperationContract(XElement input)
{
    Console.WriteLine("{0}", input.Value);
    int counter = 0;
    var xreader = input.CreateReader();
    var reader = XmlReader.Create(xreader, new XmlReaderSettings() { IgnoreWhitespace = true });
    while (reader.Read())
    {
        counter++;
    }

    Console.WriteLine("Read {0} lines with reader", counter);
}
```  
  
<span data-ttu-id="9bfa0-178">IgnoreWhitespace の設定は無視されます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-178">The IgnoreWhitespace setting is ignored.</span></span>  
  
## <a name="compression-and-the-binary-encoder"></a><span data-ttu-id="9bfa0-179">圧縮およびバイナリ エンコーダー</span><span class="sxs-lookup"><span data-stu-id="9bfa0-179">Compression and the Binary Encoder</span></span>

<span data-ttu-id="9bfa0-180">WCF 4.5 以降の WCF バイナリ エンコーダーでは、圧縮がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-180">Beginning with WCF 4.5 the WCF binary encoder adds support for compression.</span></span> <span data-ttu-id="9bfa0-181">これにより、WCF クライアントから圧縮メッセージを送信するための gzip/deflate アルゴリズムを使用でき、さらに自己ホスト型 WCF サービスからの圧縮メッセージに応答することができます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-181">This enables you to use the gzip/deflate algorithm for sending compressed messages from a WCF client and also respond with compressed messages from a self-hosted WCF service.</span></span> <span data-ttu-id="9bfa0-182">この機能は、HTTP トランスポートおよび TCP トランスポートの両方で圧縮を有効にします。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-182">This feature enables compression on both the HTTP and TCP transports.</span></span> <span data-ttu-id="9bfa0-183">IIS のホスト サーバーを構成することによって、いつでも IIS でホストされる WCF サービスを有効にして圧縮された応答を送信できます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-183">An IIS hosted WCF service can always be enabled for sending compressed responses by configuring the IIS host server.</span></span> <span data-ttu-id="9bfa0-184">圧縮の種類は <xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement.CompressionFormat%2A?displayProperty=nameWithType> プロパティで構成されます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-184">The type of compression is configured with the <xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement.CompressionFormat%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="9bfa0-185">このプロパティは、いずれかの <xref:System.ServiceModel.Channels.CompressionFormat?displayProperty=nameWithType> 列挙値に設定されます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-185">This property is set to one of the <xref:System.ServiceModel.Channels.CompressionFormat?displayProperty=nameWithType> enum values:</span></span>

- <xref:System.ServiceModel.Channels.CompressionFormat.Deflate>
- <xref:System.ServiceModel.Channels.CompressionFormat.GZip>
- <xref:System.ServiceModel.Channels.CompressionFormat.None>
  
<span data-ttu-id="9bfa0-186">このプロパティは binaryMessageEncodingBindingElement でのみ公開されているため、この機能を使用するには、次のようなカスタムバインドを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-186">Since this property is only exposed on the binaryMessageEncodingBindingElement, you will need to create a custom binding like the following to use this feature:</span></span>

 ```xml
 <customBinding>
   <binding name="BinaryCompressionBinding">
     <binaryMessageEncoding compressionFormat ="GZip" />
     <httpTransport />
  </binding>
</customBinding>
 ```

<span data-ttu-id="9bfa0-187">クライアントとサービスはどちらも、圧縮されたメッセージの送受信に同意する必要があるため、クライアントとサービスの両方の binaryMessageEncoding 要素で compressionFormat プロパティを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-187">Both the client and the service need to agree to send and receive compressed messages and therefore the compressionFormat property must be configured on the binaryMessageEncoding element on both client and service.</span></span> <span data-ttu-id="9bfa0-188">プロトコル例外は、サービスまたはクライアントが圧縮用に構成されておらず、もう一方がである場合にスローされます。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-188">A ProtocolException is thrown if either the service or client is not configured for compression, but the other side is.</span></span> <span data-ttu-id="9bfa0-189">圧縮の有効化は慎重に検討する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-189">Enabling compression should be carefully considered.</span></span> <span data-ttu-id="9bfa0-190">圧縮は、ネットワーク帯域幅がボトルネックになっている場合に最も効果的です。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-190">Compression is mostly useful if network bandwidth is a bottleneck.</span></span> <span data-ttu-id="9bfa0-191">CPU がボトルネックである場合、圧縮によりスループットが低下します。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-191">In the case where the CPU is the bottleneck, compression will decrease throughput.</span></span> <span data-ttu-id="9bfa0-192">これがアプリケーションにとってメリットがあるかどうかを確認するために、適切なテストをシミュレートされた環境で行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="9bfa0-192">Appropriate testing must be done in a simulated environment to find out if this benefits the application</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9bfa0-193">関連項目</span><span class="sxs-lookup"><span data-stu-id="9bfa0-193">See also</span></span>

- [<span data-ttu-id="9bfa0-194">バインド</span><span class="sxs-lookup"><span data-stu-id="9bfa0-194">Bindings</span></span>](bindings.md)
