---
title: グラフィックス レンダリングの概要
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- graphics [WPF], rendering
- rendering graphics [WPF]
ms.assetid: 6dec9657-4d8c-4e46-8c54-40fb80008265
ms.openlocfilehash: 9d58aa973f7de6c073611e13f2889913ff26dd55
ms.sourcegitcommit: 267d092663aba36b6b2ea853034470aea493bfae
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/21/2020
ms.locfileid: "80111921"
---
# <a name="wpf-graphics-rendering-overview"></a><span data-ttu-id="a433f-102">WPF グラフィックス レンダリングの概要</span><span class="sxs-lookup"><span data-stu-id="a433f-102">WPF Graphics Rendering Overview</span></span>
<span data-ttu-id="a433f-103">ここでは、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のビジュアル層の概要について説明します。</span><span class="sxs-lookup"><span data-stu-id="a433f-103">This topic provides an overview of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual layer.</span></span> <span data-ttu-id="a433f-104">特に、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] モデルでのレンダリングをサポートする <xref:System.Windows.Media.Visual> クラスの役割に重点を置いて説明します。</span><span class="sxs-lookup"><span data-stu-id="a433f-104">It focuses on the role of the <xref:System.Windows.Media.Visual> class for rendering support in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] model.</span></span>  

<a name="role_of_visual_object"></a>
## <a name="role-of-the-visual-object"></a><span data-ttu-id="a433f-105">ビジュアル オブジェクトの役割</span><span class="sxs-lookup"><span data-stu-id="a433f-105">Role of the Visual Object</span></span>  
 <span data-ttu-id="a433f-106"><xref:System.Windows.Media.Visual> クラスは、すべての <xref:System.Windows.FrameworkElement> オブジェクトの派生元となる基本抽象クラスです。</span><span class="sxs-lookup"><span data-stu-id="a433f-106">The <xref:System.Windows.Media.Visual> class is the basic abstraction from which every <xref:System.Windows.FrameworkElement> object derives.</span></span> <span data-ttu-id="a433f-107">また、このクラスは、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] で新しいコントロールを作成するためのエントリ ポイントとしても機能し、多くの点で Win32 アプリケーション モデルのウィンドウ ハンドル (HWND) と考えることができます。</span><span class="sxs-lookup"><span data-stu-id="a433f-107">It also serves as the entry point for writing new controls in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], and in many ways can be thought of as the window handle (HWND) in the Win32 application model.</span></span>  
  
 <span data-ttu-id="a433f-108"><xref:System.Windows.Media.Visual> オブジェクトは、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] の中心的なオブジェクトであり、その第一の役割は描画をサポートすることです。</span><span class="sxs-lookup"><span data-stu-id="a433f-108">The <xref:System.Windows.Media.Visual> object is a core [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] object, whose primary role is to provide rendering support.</span></span> <span data-ttu-id="a433f-109"><xref:System.Windows.Controls.Button> や <xref:System.Windows.Controls.TextBox> などのユーザー インターフェイス コントロールは、<xref:System.Windows.Media.Visual> クラスから派生しており、レンダリング データを保持するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-109">User interface controls, such as <xref:System.Windows.Controls.Button> and <xref:System.Windows.Controls.TextBox>, derive from the <xref:System.Windows.Media.Visual> class, and use it for persisting their rendering data.</span></span> <span data-ttu-id="a433f-110"><xref:System.Windows.Media.Visual> オブジェクトは、以下をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="a433f-110">The <xref:System.Windows.Media.Visual> object provides support for:</span></span>  
  
- <span data-ttu-id="a433f-111">出力表示: ビジュアルの、シリアル化された永続的な描画内容をレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="a433f-111">Output display: Rendering the persisted, serialized drawing content of a visual.</span></span>  
  
- <span data-ttu-id="a433f-112">変換: ビジュアルで変換を実行します。</span><span class="sxs-lookup"><span data-stu-id="a433f-112">Transformations: Performing transformations on a visual.</span></span>  
  
- <span data-ttu-id="a433f-113">クリッピング: ビジュアルのクリッピング領域をサポートします。</span><span class="sxs-lookup"><span data-stu-id="a433f-113">Clipping: Providing clipping region support for a visual.</span></span>  
  
- <span data-ttu-id="a433f-114">ヒット テスト: 座標またはジオメトリがビジュアルの境界内に含まれているかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="a433f-114">Hit testing: Determining whether a coordinate or geometry is contained within the bounds of a visual.</span></span>  
  
- <span data-ttu-id="a433f-115">境界ボックスの計算: ビジュアルの四角形領域を決定します。</span><span class="sxs-lookup"><span data-stu-id="a433f-115">Bounding box calculations: Determining the bounding rectangle of a visual.</span></span>  
  
 <span data-ttu-id="a433f-116">ただし、<xref:System.Windows.Media.Visual> オブジェクトでは、次のような描画以外の機能はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="a433f-116">However, the <xref:System.Windows.Media.Visual> object does not include support for non-rendering features, such as:</span></span>  
  
- <span data-ttu-id="a433f-117">イベント処理</span><span class="sxs-lookup"><span data-stu-id="a433f-117">Event handling</span></span>  
  
- <span data-ttu-id="a433f-118">レイアウト</span><span class="sxs-lookup"><span data-stu-id="a433f-118">Layout</span></span>  
  
- <span data-ttu-id="a433f-119">スタイル</span><span class="sxs-lookup"><span data-stu-id="a433f-119">Styles</span></span>  
  
- <span data-ttu-id="a433f-120">データ バインディング</span><span class="sxs-lookup"><span data-stu-id="a433f-120">Data binding</span></span>  
  
- <span data-ttu-id="a433f-121">グローバリゼーション</span><span class="sxs-lookup"><span data-stu-id="a433f-121">Globalization</span></span>  
  
 <span data-ttu-id="a433f-122"><xref:System.Windows.Media.Visual> はパブリック抽象クラスとして公開され、子クラスはこのクラスから派生する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a433f-122"><xref:System.Windows.Media.Visual> is exposed as a public abstract class from which child classes must be derived.</span></span> <span data-ttu-id="a433f-123">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] で公開されるビジュアル オブジェクトの階層構造を次の図に示します。</span><span class="sxs-lookup"><span data-stu-id="a433f-123">The following illustration shows the hierarchy of the visual objects that are exposed in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
 ![Visual オブジェクトから派生したクラスのダイアグラム](./media/wpf-graphics-rendering-overview/classes-derived-visual-object.png)
  
### <a name="drawingvisual-class"></a><span data-ttu-id="a433f-125">DrawingVisual クラス</span><span class="sxs-lookup"><span data-stu-id="a433f-125">DrawingVisual Class</span></span>  
 <span data-ttu-id="a433f-126"><xref:System.Windows.Media.DrawingVisual> は、図形、イメージ、またはテキストのレンダリングに使用する軽量の描画クラスです。</span><span class="sxs-lookup"><span data-stu-id="a433f-126">The <xref:System.Windows.Media.DrawingVisual> is a lightweight drawing class that is used to render shapes, images, or text.</span></span> <span data-ttu-id="a433f-127">このクラスが軽量と見なされる理由は、レイアウトやイベントの処理を行わないため、実行時のパフォーマンスが向上するからです。</span><span class="sxs-lookup"><span data-stu-id="a433f-127">This class is considered lightweight because it does not provide layout or event handling, which improves its runtime performance.</span></span> <span data-ttu-id="a433f-128">そのため、背景やクリップ アートの描画に適しています。</span><span class="sxs-lookup"><span data-stu-id="a433f-128">For this reason, drawings are ideal for backgrounds and clip art.</span></span> <span data-ttu-id="a433f-129"><xref:System.Windows.Media.DrawingVisual> は、カスタム ビジュアル オブジェクトを作成するために使用できます。</span><span class="sxs-lookup"><span data-stu-id="a433f-129">The <xref:System.Windows.Media.DrawingVisual> can be used to create a custom visual object.</span></span> <span data-ttu-id="a433f-130">詳しくは、「[DrawingVisual オブジェクトの使用](using-drawingvisual-objects.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a433f-130">For more information, see [Using DrawingVisual Objects](using-drawingvisual-objects.md).</span></span>  
  
### <a name="viewport3dvisual-class"></a><span data-ttu-id="a433f-131">Viewport3DVisual クラス</span><span class="sxs-lookup"><span data-stu-id="a433f-131">Viewport3DVisual Class</span></span>  
 <span data-ttu-id="a433f-132"><xref:System.Windows.Media.Media3D.Viewport3DVisual> は、2D <xref:System.Windows.Media.Visual> と <xref:System.Windows.Media.Media3D.Visual3D> オブジェクト間のブリッジを提供します。</span><span class="sxs-lookup"><span data-stu-id="a433f-132">The <xref:System.Windows.Media.Media3D.Viewport3DVisual> provides a bridge between 2D <xref:System.Windows.Media.Visual> and <xref:System.Windows.Media.Media3D.Visual3D> objects.</span></span> <span data-ttu-id="a433f-133"><xref:System.Windows.Media.Media3D.Visual3D> クラスは、すべての 3D ビジュアル要素の基底クラスです。</span><span class="sxs-lookup"><span data-stu-id="a433f-133">The <xref:System.Windows.Media.Media3D.Visual3D> class is the base class for all 3D visual elements.</span></span> <span data-ttu-id="a433f-134"><xref:System.Windows.Media.Media3D.Viewport3DVisual> では、<xref:System.Windows.Media.Media3D.Viewport3DVisual.Camera%2A> 値と <xref:System.Windows.Media.Media3D.Viewport3DVisual.Viewport%2A> 値を定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a433f-134">The <xref:System.Windows.Media.Media3D.Viewport3DVisual> requires that you define a <xref:System.Windows.Media.Media3D.Viewport3DVisual.Camera%2A> value and a <xref:System.Windows.Media.Media3D.Viewport3DVisual.Viewport%2A> value.</span></span> <span data-ttu-id="a433f-135">カメラを使用するとシーンを表示できます。</span><span class="sxs-lookup"><span data-stu-id="a433f-135">The camera allows you to view the scene.</span></span> <span data-ttu-id="a433f-136">ビューポートは、投影が 2D サーフェイス上にマップされる場所を設定します。</span><span class="sxs-lookup"><span data-stu-id="a433f-136">The viewport establishes where the projection maps onto the 2D surface.</span></span> <span data-ttu-id="a433f-137">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] の 3D について詳しくは、「[3D グラフィックスの概要](3-d-graphics-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a433f-137">For more information on 3D in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [3D Graphics Overview](3-d-graphics-overview.md).</span></span>  
  
### <a name="containervisual-class"></a><span data-ttu-id="a433f-138">ContainerVisual クラス</span><span class="sxs-lookup"><span data-stu-id="a433f-138">ContainerVisual Class</span></span>  
 <span data-ttu-id="a433f-139"><xref:System.Windows.Media.ContainerVisual> クラスは、<xref:System.Windows.Media.Visual> オブジェクトのコレクションのコンテナーとして使用されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-139">The <xref:System.Windows.Media.ContainerVisual> class is used as a container for a collection of <xref:System.Windows.Media.Visual> objects.</span></span> <span data-ttu-id="a433f-140"><xref:System.Windows.Media.DrawingVisual> クラスは、<xref:System.Windows.Media.ContainerVisual> クラスから派生するため、ビジュアル オブジェクトのコレクションを格納できます。</span><span class="sxs-lookup"><span data-stu-id="a433f-140">The <xref:System.Windows.Media.DrawingVisual> class derives from the <xref:System.Windows.Media.ContainerVisual> class, allowing it to contain a collection of visual objects.</span></span>  
  
### <a name="drawing-content-in-visual-objects"></a><span data-ttu-id="a433f-141">ビジュアル オブジェクトの描画コンテンツ</span><span class="sxs-lookup"><span data-stu-id="a433f-141">Drawing Content in Visual Objects</span></span>  
 <span data-ttu-id="a433f-142"><xref:System.Windows.Media.Visual> オブジェクトは、レンダリング データを**ベクター グラフィックス命令リスト**として格納します。</span><span class="sxs-lookup"><span data-stu-id="a433f-142">A <xref:System.Windows.Media.Visual> object stores its render data as a **vector graphics instruction list**.</span></span> <span data-ttu-id="a433f-143">命令リスト内の各項目は、グラフィックス データと関連リソースの低レベル セットを、シリアル化された形式で表します。</span><span class="sxs-lookup"><span data-stu-id="a433f-143">Each item in the instruction list represents a low-level set of graphics data and associated resources in a serialized format.</span></span> <span data-ttu-id="a433f-144">描画コンテンツを格納できるレンダリング データには、次の 4 つの種類があります。</span><span class="sxs-lookup"><span data-stu-id="a433f-144">There are four different types of render data that can contain drawing content.</span></span>  
  
|<span data-ttu-id="a433f-145">描画コンテンツの種類</span><span class="sxs-lookup"><span data-stu-id="a433f-145">Drawing content type</span></span>|<span data-ttu-id="a433f-146">説明</span><span class="sxs-lookup"><span data-stu-id="a433f-146">Description</span></span>|  
|--------------------------|-----------------|  
|<span data-ttu-id="a433f-147">ベクター グラフィックス</span><span class="sxs-lookup"><span data-stu-id="a433f-147">Vector graphics</span></span>|<span data-ttu-id="a433f-148">ベクター グラフィックス データと、関連する <xref:System.Windows.Media.Brush> および <xref:System.Windows.Media.Pen> の情報を表します。</span><span class="sxs-lookup"><span data-stu-id="a433f-148">Represents vector graphics data, and any associated <xref:System.Windows.Media.Brush> and <xref:System.Windows.Media.Pen> information.</span></span>|  
|<span data-ttu-id="a433f-149">Image</span><span class="sxs-lookup"><span data-stu-id="a433f-149">Image</span></span>|<span data-ttu-id="a433f-150"><xref:System.Windows.Rect> で定義された領域内のイメージを表します。</span><span class="sxs-lookup"><span data-stu-id="a433f-150">Represents an image within a region defined by a <xref:System.Windows.Rect>.</span></span>|  
|<span data-ttu-id="a433f-151">グリフ</span><span class="sxs-lookup"><span data-stu-id="a433f-151">Glyph</span></span>|<span data-ttu-id="a433f-152">指定したフォント リソースからの一連のグリフである、<xref:System.Windows.Media.GlyphRun> をレンダリングする描画を表します。</span><span class="sxs-lookup"><span data-stu-id="a433f-152">Represents a drawing that renders a <xref:System.Windows.Media.GlyphRun>, which is a sequence of glyphs from a specified font resource.</span></span> <span data-ttu-id="a433f-153">テキストはこれによって表示されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-153">This is how text is represented.</span></span>|  
|<span data-ttu-id="a433f-154">ビデオ</span><span class="sxs-lookup"><span data-stu-id="a433f-154">Video</span></span>|<span data-ttu-id="a433f-155">ビデオをレンダリングする描画を表します。</span><span class="sxs-lookup"><span data-stu-id="a433f-155">Represents a drawing that renders video.</span></span>|  
  
 <span data-ttu-id="a433f-156"><xref:System.Windows.Media.DrawingContext> を使用すると、<xref:System.Windows.Media.Visual> にビジュアル コンテンツを読み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="a433f-156">The <xref:System.Windows.Media.DrawingContext> allows you to populate a <xref:System.Windows.Media.Visual> with visual content.</span></span> <span data-ttu-id="a433f-157"><xref:System.Windows.Media.DrawingContext> オブジェクトの描画コマンドを使用した場合、画面上にリアルタイムに描画が行われるのではなく、実際には、グラフィックス システムによって後で使用される、一連のレンダリング データが格納されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-157">When you use a <xref:System.Windows.Media.DrawingContext> object's draw commands, you are actually storing a set of render data that will later be used by the graphics system; you are not drawing to the screen in real-time.</span></span>  
  
 <span data-ttu-id="a433f-158">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] コントロール (<xref:System.Windows.Controls.Button> など) を作成すると、そのコントロールは、それ自身を描画するためのレンダリング データを暗黙的に生成します。</span><span class="sxs-lookup"><span data-stu-id="a433f-158">When you create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control, such as a <xref:System.Windows.Controls.Button>, the control implicitly generates render data for drawing itself.</span></span> <span data-ttu-id="a433f-159">たとえば、<xref:System.Windows.Controls.Button> の <xref:System.Windows.Controls.ContentControl.Content%2A> プロパティを設定すると、グリフのレンダリング表現がコントロールに格納されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-159">For example, setting the <xref:System.Windows.Controls.ContentControl.Content%2A> property of the <xref:System.Windows.Controls.Button> causes the control to store a rendering representation of a glyph.</span></span>  
  
 <span data-ttu-id="a433f-160"><xref:System.Windows.Media.Visual> のコンテンツは、<xref:System.Windows.Media.DrawingGroup> 内に含まれる 1 つ以上の <xref:System.Windows.Media.Drawing> オブジェクトとして表されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-160">A <xref:System.Windows.Media.Visual> describes its content as one or more <xref:System.Windows.Media.Drawing> objects contained within a <xref:System.Windows.Media.DrawingGroup>.</span></span> <span data-ttu-id="a433f-161">また <xref:System.Windows.Media.DrawingGroup> は、コンテンツに適用される不透明マスク、変換、ビットマップ効果などの操作も表します。</span><span class="sxs-lookup"><span data-stu-id="a433f-161">A <xref:System.Windows.Media.DrawingGroup> also describes opacity masks, transforms, bitmap effects, and other operations that are applied to its contents.</span></span> <span data-ttu-id="a433f-162">コンテンツをレンダリングする際、<xref:System.Windows.Media.DrawingGroup> 操作は、<xref:System.Windows.Media.DrawingGroup.OpacityMask%2A>、<xref:System.Windows.Media.DrawingGroup.Opacity%2A>、<xref:System.Windows.Media.DrawingGroup.BitmapEffect%2A>、<xref:System.Windows.Media.DrawingGroup.ClipGeometry%2A>、<xref:System.Windows.Media.DrawingGroup.GuidelineSet%2A>、<xref:System.Windows.Media.DrawingGroup.Transform%2A> の順に適用されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-162"><xref:System.Windows.Media.DrawingGroup> operations are applied in the following order when content is rendered: <xref:System.Windows.Media.DrawingGroup.OpacityMask%2A>, <xref:System.Windows.Media.DrawingGroup.Opacity%2A>, <xref:System.Windows.Media.DrawingGroup.BitmapEffect%2A>, <xref:System.Windows.Media.DrawingGroup.ClipGeometry%2A>, <xref:System.Windows.Media.DrawingGroup.GuidelineSet%2A>, and then <xref:System.Windows.Media.DrawingGroup.Transform%2A>.</span></span>  
  
 <span data-ttu-id="a433f-163">次の図は、レンダリング シーケンス中に <xref:System.Windows.Media.DrawingGroup> 操作が適用される順序を示したものです。</span><span class="sxs-lookup"><span data-stu-id="a433f-163">The following illustration shows the order in which <xref:System.Windows.Media.DrawingGroup> operations are applied during the rendering sequence.</span></span>  
  
 <span data-ttu-id="a433f-164">![DrawingGroup の操作の順序](./media/graphcismm-drawinggroup-order.png "graphcismm_drawinggroup_order")</span><span class="sxs-lookup"><span data-stu-id="a433f-164">![DrawingGroup order of operations](./media/graphcismm-drawinggroup-order.png "graphcismm_drawinggroup_order")</span></span>  
<span data-ttu-id="a433f-165">DrawingGroup 操作の順序</span><span class="sxs-lookup"><span data-stu-id="a433f-165">Order of DrawingGroup operations</span></span>  
  
 <span data-ttu-id="a433f-166">詳しくは、「[Drawing オブジェクトの概要](drawing-objects-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a433f-166">For more information, see [Drawing Objects Overview](drawing-objects-overview.md).</span></span>  
  
#### <a name="drawing-content-at-the-visual-layer"></a><span data-ttu-id="a433f-167">ビジュアル層での描画コンテンツ</span><span class="sxs-lookup"><span data-stu-id="a433f-167">Drawing Content at the Visual Layer</span></span>  
 <span data-ttu-id="a433f-168"><xref:System.Windows.Media.DrawingContext> を直接インスタンス化することはできません。ただし、描画コンテキストは、特定のメソッド (<xref:System.Windows.Media.DrawingGroup.Open%2A?displayProperty=nameWithType> や <xref:System.Windows.Media.DrawingVisual.RenderOpen%2A?displayProperty=nameWithType> など) から取得できます。</span><span class="sxs-lookup"><span data-stu-id="a433f-168">You never directly instantiate a <xref:System.Windows.Media.DrawingContext>; you can, however, acquire a drawing context from certain methods, such as <xref:System.Windows.Media.DrawingGroup.Open%2A?displayProperty=nameWithType> and <xref:System.Windows.Media.DrawingVisual.RenderOpen%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="a433f-169">次の例では、<xref:System.Windows.Media.DrawingVisual> から <xref:System.Windows.Media.DrawingContext> を取得し、それを四角形の描画に使用しています。</span><span class="sxs-lookup"><span data-stu-id="a433f-169">The following example retrieves a <xref:System.Windows.Media.DrawingContext> from a <xref:System.Windows.Media.DrawingVisual> and uses it to draw a rectangle.</span></span>  
  
 [!code-csharp[drawingvisualsample#101](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingVisualSample/CSharp/Window1.xaml.cs#101)]
 [!code-vb[drawingvisualsample#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DrawingVisualSample/visualbasic/window1.xaml.vb#101)]  
  
#### <a name="enumerating-drawing-content-at-the-visual-layer"></a><span data-ttu-id="a433f-170">ビジュアル層で描画コンテンツを列挙する</span><span class="sxs-lookup"><span data-stu-id="a433f-170">Enumerating Drawing Content at the Visual Layer</span></span>  
 <span data-ttu-id="a433f-171">他の用途に加えて、<xref:System.Windows.Media.Drawing> オブジェクトでは、<xref:System.Windows.Media.Visual> の内容を列挙するためのオブジェクト モデルも提供されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-171">In addition to their other uses, <xref:System.Windows.Media.Drawing> objects also provide an object model for enumerating the contents of a <xref:System.Windows.Media.Visual>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="a433f-172">ビジュアルのコンテンツを列挙する場合は、レンダリング データの基になる表現をベクター グラフィックス命令リストとして取得するのではなく、<xref:System.Windows.Media.Drawing> オブジェクトを取得することになります。</span><span class="sxs-lookup"><span data-stu-id="a433f-172">When you are enumerating the contents of the visual, you are retrieving <xref:System.Windows.Media.Drawing> objects, and not the underlying representation of the render data as a vector graphics instruction list.</span></span>  
  
 <span data-ttu-id="a433f-173">次の例では、<xref:System.Windows.Media.VisualTreeHelper.GetDrawing%2A> メソッドを使用して <xref:System.Windows.Media.Visual> の <xref:System.Windows.Media.DrawingGroup> 値を取得し、それを列挙します。</span><span class="sxs-lookup"><span data-stu-id="a433f-173">The following example uses the <xref:System.Windows.Media.VisualTreeHelper.GetDrawing%2A> method to retrieve the <xref:System.Windows.Media.DrawingGroup> value of a <xref:System.Windows.Media.Visual> and enumerate it.</span></span>  
  
 [!code-csharp[DrawingMiscSnippets_snip#GraphicsMMRetrieveDrawings](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingMiscSnippets_snip/CSharp/EnumerateDrawingsExample.xaml.cs#graphicsmmretrievedrawings)]  
  
<a name="how_visual_objects_are_used_to_build_controls"></a>
## <a name="how-visual-objects-are-used-to-build-controls"></a><span data-ttu-id="a433f-174">ビジュアル オブジェクトを使用してコントロールをビルドする方法</span><span class="sxs-lookup"><span data-stu-id="a433f-174">How Visual Objects are Used to Build Controls</span></span>  
 <span data-ttu-id="a433f-175">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のオブジェクトの多くは、他のビジュアル オブジェクトで構成されています。そのため、それらのオブジェクトには、子孫オブジェクトのさまざまな階層を格納することができます。</span><span class="sxs-lookup"><span data-stu-id="a433f-175">Many of the objects in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are composed of other visual objects, meaning they can contain varying hierarchies of descendant objects.</span></span> <span data-ttu-id="a433f-176">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のユーザー インターフェイス要素 (コントロールなど) の多くは、さまざまな種類のレンダリング要素を表す、複数のビジュアル オブジェクトで構成されています。</span><span class="sxs-lookup"><span data-stu-id="a433f-176">Many of the user interface elements in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], such as controls, are composed of multiple visual objects, representing different types of rendering elements.</span></span> <span data-ttu-id="a433f-177">たとえば、<xref:System.Windows.Controls.Button> コントロールは、<xref:Microsoft.Windows.Themes.ClassicBorderDecorator>、<xref:System.Windows.Controls.ContentPresenter>、<xref:System.Windows.Controls.TextBlock> など、他のオブジェクトを多数格納できます。</span><span class="sxs-lookup"><span data-stu-id="a433f-177">For example, the <xref:System.Windows.Controls.Button> control can contain a number of other objects, including <xref:Microsoft.Windows.Themes.ClassicBorderDecorator>, <xref:System.Windows.Controls.ContentPresenter>, and <xref:System.Windows.Controls.TextBlock>.</span></span>  
  
 <span data-ttu-id="a433f-178">次のコードは、マークアップで定義された <xref:System.Windows.Controls.Button> コントロールを示しています。</span><span class="sxs-lookup"><span data-stu-id="a433f-178">The following code shows a <xref:System.Windows.Controls.Button> control defined in markup.</span></span>  
  
 [!code-xaml[VisualsOverview#VisualsOverviewSnippet1](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml#visualsoverviewsnippet1)]  
  
 <span data-ttu-id="a433f-179">既定の <xref:System.Windows.Controls.Button> コントロールを構成するビジュアル オブジェクトを列挙した場合、ビジュアル オブジェクトの階層は次の図のようになります。</span><span class="sxs-lookup"><span data-stu-id="a433f-179">If you were to enumerate the visual objects that comprise the default <xref:System.Windows.Controls.Button> control, you would find the hierarchy of visual objects illustrated below:</span></span>  
  
 ![ビジュアル ツリー階層のダイアグラム](./media/wpf-graphics-rendering-overview/visual-object-diagram.gif)
  
 <span data-ttu-id="a433f-181"><xref:System.Windows.Controls.Button> コントロールには <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> 要素が含まれており、さらにそれには <xref:System.Windows.Controls.ContentPresenter> 要素が含まれています。</span><span class="sxs-lookup"><span data-stu-id="a433f-181">The <xref:System.Windows.Controls.Button> control contains a <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> element, which in turn, contains a <xref:System.Windows.Controls.ContentPresenter> element.</span></span> <span data-ttu-id="a433f-182"><xref:Microsoft.Windows.Themes.ClassicBorderDecorator> 要素は、<xref:System.Windows.Controls.Button> の境界線と背景を描画します。</span><span class="sxs-lookup"><span data-stu-id="a433f-182">The <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> element is responsible for drawing a border and a background for the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="a433f-183"><xref:System.Windows.Controls.ContentPresenter> 要素は、<xref:System.Windows.Controls.Button> の内容を表示します。</span><span class="sxs-lookup"><span data-stu-id="a433f-183">The <xref:System.Windows.Controls.ContentPresenter> element is responsible for displaying the contents of the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="a433f-184">この場合、テキストを表示しているため、<xref:System.Windows.Controls.ContentPresenter> 要素には <xref:System.Windows.Controls.TextBlock> 要素が格納されています。</span><span class="sxs-lookup"><span data-stu-id="a433f-184">In this case, since you are displaying text, the <xref:System.Windows.Controls.ContentPresenter> element contains a <xref:System.Windows.Controls.TextBlock> element.</span></span> <span data-ttu-id="a433f-185"><xref:System.Windows.Controls.Button> コントロールで <xref:System.Windows.Controls.ContentPresenter> が使用されるということは、そのコンテンツが、<xref:System.Windows.Controls.Image> やジオメトリ (たとえば <xref:System.Windows.Media.EllipseGeometry>) など、他の要素によって表現可能だということを意味します。</span><span class="sxs-lookup"><span data-stu-id="a433f-185">The fact that the <xref:System.Windows.Controls.Button> control uses a <xref:System.Windows.Controls.ContentPresenter> means that the content could be represented by other elements, such as an <xref:System.Windows.Controls.Image> or a geometry, such as an <xref:System.Windows.Media.EllipseGeometry>.</span></span>  
  
### <a name="control-templates"></a><span data-ttu-id="a433f-186">コントロール テンプレート</span><span class="sxs-lookup"><span data-stu-id="a433f-186">Control Templates</span></span>  
 <span data-ttu-id="a433f-187">コントロールをコントロールの階層に拡張する場合には、<xref:System.Windows.Controls.ControlTemplate> が重要になります。</span><span class="sxs-lookup"><span data-stu-id="a433f-187">The key to the expansion of a control into a hierarchy of controls is the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="a433f-188">コントロール テンプレートは、コントロールの既定のビジュアル階層を指定します。</span><span class="sxs-lookup"><span data-stu-id="a433f-188">A control template specifies the default visual hierarchy for a control.</span></span> <span data-ttu-id="a433f-189">コントロールを明示的に参照すると、コントロールのビジュアル階層が暗黙的に参照されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-189">When you explicitly reference a control, you implicitly reference its visual hierarchy.</span></span> <span data-ttu-id="a433f-190">コントロール テンプレートの既定値をオーバーライドして、コントロールの外観をカスタマイズすることもできます。</span><span class="sxs-lookup"><span data-stu-id="a433f-190">You can override the default values for a control template to create a customized visual appearance for a control.</span></span> <span data-ttu-id="a433f-191">たとえば、<xref:System.Windows.Controls.Button> コントロールの背景色の値を変更して、純色値の代わりに線形グラデーション値を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="a433f-191">For example, you could modify the background color value of the <xref:System.Windows.Controls.Button> control so that it uses a linear gradient color value instead of a solid color value.</span></span> <span data-ttu-id="a433f-192">詳しくは、「[ボタンのスタイルとテンプレート](../controls/button-styles-and-templates.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a433f-192">For more information, see [Button Styles and Templates](../controls/button-styles-and-templates.md).</span></span>  
  
 <span data-ttu-id="a433f-193"><xref:System.Windows.Controls.Button> コントロールなどのユーザー インターフェイス要素には、コントロールのすべてのレンダリング定義を表す、複数のベクター グラフィックス命令リストが含まれています。</span><span class="sxs-lookup"><span data-stu-id="a433f-193">A user interface element, such as a <xref:System.Windows.Controls.Button> control, contains several vector graphics instruction lists that describe the entire rendering definition of a control.</span></span> <span data-ttu-id="a433f-194">次のコードは、マークアップで定義された <xref:System.Windows.Controls.Button> コントロールを示しています。</span><span class="sxs-lookup"><span data-stu-id="a433f-194">The following code shows a <xref:System.Windows.Controls.Button> control defined in markup.</span></span>  
  
 [!code-xaml[VisualsOverview#VisualsOverviewSnippet2](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml#visualsoverviewsnippet2)]  
  
 <span data-ttu-id="a433f-195"><xref:System.Windows.Controls.Button> コントロールを構成するビジュアル オブジェクトとベクター グラフィックス命令リストを列挙した場合、オブジェクトの階層は次の図のようになります。</span><span class="sxs-lookup"><span data-stu-id="a433f-195">If you were to enumerate the visual objects and vector graphics instruction lists that comprise the <xref:System.Windows.Controls.Button> control, you would find the hierarchy of objects illustrated below:</span></span>  
  
 ![ビジュアル ツリーおよび描画データのダイアグラム](./media/wpf-graphics-rendering-overview/visual-tree-rendering-data.png)  
  
 <span data-ttu-id="a433f-197"><xref:System.Windows.Controls.Button> コントロールには <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> 要素が含まれており、さらにそれには <xref:System.Windows.Controls.ContentPresenter> 要素が含まれています。</span><span class="sxs-lookup"><span data-stu-id="a433f-197">The <xref:System.Windows.Controls.Button> control contains a <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> element, which in turn, contains a <xref:System.Windows.Controls.ContentPresenter> element.</span></span> <span data-ttu-id="a433f-198"><xref:Microsoft.Windows.Themes.ClassicBorderDecorator> 要素は、ボタンの境界線と背景を構成する個々のグラフィックス要素をすべて描画します。</span><span class="sxs-lookup"><span data-stu-id="a433f-198">The <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> element is responsible for drawing all the discrete graphic elements that make up the border and background of a button.</span></span> <span data-ttu-id="a433f-199"><xref:System.Windows.Controls.ContentPresenter> 要素は、<xref:System.Windows.Controls.Button> の内容を表示します。</span><span class="sxs-lookup"><span data-stu-id="a433f-199">The <xref:System.Windows.Controls.ContentPresenter> element is responsible for displaying the contents of the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="a433f-200">この場合、イメージを表示しているため、<xref:System.Windows.Controls.ContentPresenter> 要素には <xref:System.Windows.Controls.Image> 要素が格納されています。</span><span class="sxs-lookup"><span data-stu-id="a433f-200">In this case, since you are displaying an image, the <xref:System.Windows.Controls.ContentPresenter> element contains a <xref:System.Windows.Controls.Image> element.</span></span>  
  
 <span data-ttu-id="a433f-201">ビジュアル オブジェクトとベクター グラフィックス命令リストの階層については、次の点に注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a433f-201">There are a number of points to note about the hierarchy of visual objects and vector graphics instruction lists:</span></span>  
  
- <span data-ttu-id="a433f-202">階層内の順序は、描画情報のレンダリング順序を表します。</span><span class="sxs-lookup"><span data-stu-id="a433f-202">The ordering in the hierarchy represents the rendering order of the drawing information.</span></span> <span data-ttu-id="a433f-203">子要素は、ルート ビジュアル要素を起点として、左から右、上から下に走査されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-203">From the root visual element, child elements are traversed, left to right, top to bottom.</span></span> <span data-ttu-id="a433f-204">要素に子ビジュアル要素がある場合、子ビジュアル要素は要素の兄弟よりも先に走査されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-204">If an element has visual child elements, they are traversed before the element’s siblings.</span></span>  
  
- <span data-ttu-id="a433f-205">階層内の非リーフ要素 (<xref:System.Windows.Controls.ContentPresenter> など) は、子要素を格納するために使用されます。これらには、命令リストは格納されません。</span><span class="sxs-lookup"><span data-stu-id="a433f-205">Non-leaf node elements in the hierarchy, such as <xref:System.Windows.Controls.ContentPresenter>, are used to contain child elements—they do not contain instruction lists.</span></span>  
  
- <span data-ttu-id="a433f-206">ビジュアル要素にベクター グラフィックス命令リストとビジュアル子の両方が含まれている場合は、ビジュアル子オブジェクトが描画される前に、親ビジュアル要素の命令リストがレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="a433f-206">If a visual element contains both a vector graphics instruction list and visual children, the instruction list in the parent visual element is rendered before drawings in any of the visual child objects.</span></span>  
  
- <span data-ttu-id="a433f-207">ベクター グラフィックス命令リスト内の項目は、左から右の順にレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="a433f-207">The items in the vector graphics instruction list are rendered left to right.</span></span>  
  
<a name="visual_tree"></a>
## <a name="visual-tree"></a><span data-ttu-id="a433f-208">ビジュアル ツリー</span><span class="sxs-lookup"><span data-stu-id="a433f-208">Visual Tree</span></span>  
 <span data-ttu-id="a433f-209">ビジュアル ツリーには、アプリケーションのユーザー インターフェイスで使用されるすべてのビジュアル要素が含まれます。</span><span class="sxs-lookup"><span data-stu-id="a433f-209">The visual tree contains all visual elements used in an application's user interface.</span></span> <span data-ttu-id="a433f-210">ビジュアル要素には永続化された描画情報が含まれているので、ビジュアル ツリーは、ディスプレイ デバイスへの出力を構成するのに必要なレンダリング情報をすべて含んだ、シーン グラフであると考えることができます。</span><span class="sxs-lookup"><span data-stu-id="a433f-210">Since a visual element contains persisted drawing information, you can think of the visual tree as a scene graph, containing all the rendering information needed to compose the output to the display device.</span></span> <span data-ttu-id="a433f-211">このツリーは、コードかマークアップかを問わず、アプリケーションで直接作成されたすべてのビジュアル要素を累積したものです。</span><span class="sxs-lookup"><span data-stu-id="a433f-211">This tree is the accumulation of all visual elements created directly by the application, whether in code or in markup.</span></span> <span data-ttu-id="a433f-212">ビジュアル ツリーには、コントロールやデータ オブジェクトなど、要素のテンプレート拡張によって作成されたビジュアル要素もすべて含まれます。</span><span class="sxs-lookup"><span data-stu-id="a433f-212">The visual tree also contains all visual elements created by the template expansion of elements such as controls and data objects.</span></span>  
  
 <span data-ttu-id="a433f-213">次のコードは、マークアップで定義された <xref:System.Windows.Controls.StackPanel> 要素を示しています。</span><span class="sxs-lookup"><span data-stu-id="a433f-213">The following code shows a <xref:System.Windows.Controls.StackPanel> element defined in markup.</span></span>  
  
 [!code-xaml[VisualsOverview#VisualsOverviewSnippet3](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml#visualsoverviewsnippet3)]  
  
 <span data-ttu-id="a433f-214">マークアップ例の <xref:System.Windows.Controls.StackPanel> 要素を構成するビジュアル オブジェクトを列挙した場合、ビジュアル オブジェクトの階層は次の図のようになります。</span><span class="sxs-lookup"><span data-stu-id="a433f-214">If you were to enumerate the visual objects that comprise the <xref:System.Windows.Controls.StackPanel> element in the markup example, you would find the hierarchy of visual objects illustrated below:</span></span>  
  
 ![ビジュアル ツリー階層のダイアグラム](./media/wpf-graphics-rendering-overview/visual-tree-hierarchy.gif)  
  
### <a name="rendering-order"></a><span data-ttu-id="a433f-216">レンダリング順序</span><span class="sxs-lookup"><span data-stu-id="a433f-216">Rendering Order</span></span>  
 <span data-ttu-id="a433f-217">ビジュアル ツリーは、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のビジュアル オブジェクトと描画オブジェクトの表示順序を決定します。</span><span class="sxs-lookup"><span data-stu-id="a433f-217">The visual tree determines the rendering order of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual and drawing objects.</span></span> <span data-ttu-id="a433f-218">走査の順序は、ビジュアル ツリーの最上位ノードであるルート ビジュアルから始まります。</span><span class="sxs-lookup"><span data-stu-id="a433f-218">The order of traversal starts with the root visual, which is the top-most node in the visual tree.</span></span> <span data-ttu-id="a433f-219">次に、ルート ビジュアルの子が左から右に走査されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-219">The root visual’s children are then traversed, left to right.</span></span> <span data-ttu-id="a433f-220">ビジュアルの子が存在する場合、子はビジュアルの兄弟よりも先に走査されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-220">If a visual has children, its children are traversed before the visual’s siblings.</span></span> <span data-ttu-id="a433f-221">つまり、子ビジュアルの内容は、そのビジュアル自体の内容よりも前面に表示されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-221">This means that the content of a child visual is rendered in front of the visual's own content.</span></span>  
  
 ![ビジュアル ツリー描画順序のダイアグラム](./media/wpf-graphics-rendering-overview/visual-tree-rendering-order.gif)
  
### <a name="root-visual"></a><span data-ttu-id="a433f-223">ルート ビジュアル</span><span class="sxs-lookup"><span data-stu-id="a433f-223">Root Visual</span></span>  
 <span data-ttu-id="a433f-224">**ルート ビジュアル**は、ビジュアル ツリー階層内の最上位の要素です。</span><span class="sxs-lookup"><span data-stu-id="a433f-224">The **root visual** is the top-most element in a visual tree hierarchy.</span></span> <span data-ttu-id="a433f-225">ほとんどのアプリケーションでは、ルート ビジュアルの基底クラスは <xref:System.Windows.Window> または <xref:System.Windows.Navigation.NavigationWindow> のいずれかです。</span><span class="sxs-lookup"><span data-stu-id="a433f-225">In most applications, the base class of the root visual is either <xref:System.Windows.Window> or <xref:System.Windows.Navigation.NavigationWindow>.</span></span> <span data-ttu-id="a433f-226">ただし、ビジュアル オブジェクトを Win32 アプリケーションでホストする場合は、Win32 ウィンドウにホストする最上位のビジュアルがルート ビジュアルになります。</span><span class="sxs-lookup"><span data-stu-id="a433f-226">However, if you were hosting visual objects in a Win32 application, the root visual would be the top-most visual you were hosting in the Win32 window.</span></span> <span data-ttu-id="a433f-227">詳しくは、「[チュートリアル: Win32 アプリケーションでのビジュアル オブジェクトのホスト](tutorial-hosting-visual-objects-in-a-win32-application.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a433f-227">For more information, see [Tutorial: Hosting Visual Objects in a Win32 Application](tutorial-hosting-visual-objects-in-a-win32-application.md).</span></span>  
  
### <a name="relationship-to-the-logical-tree"></a><span data-ttu-id="a433f-228">論理ツリーとの関係</span><span class="sxs-lookup"><span data-stu-id="a433f-228">Relationship to the Logical Tree</span></span>  
 <span data-ttu-id="a433f-229">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] の論理ツリーは、実行時のアプリケーションの要素を表します。</span><span class="sxs-lookup"><span data-stu-id="a433f-229">The logical tree in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] represents the elements of an application at run time.</span></span> <span data-ttu-id="a433f-230">このツリーを直接操作することはありませんが、アプリケーションのこのビューは、プロパティの継承やイベントのルーティングを理解する上で役立ちます。</span><span class="sxs-lookup"><span data-stu-id="a433f-230">Although you do not manipulate this tree directly, this view of the application is useful for understanding property inheritance and event routing.</span></span> <span data-ttu-id="a433f-231">ビジュアル ツリーとは異なり、論理ツリーは、ビジュアル データ オブジェクト以外のオブジェクト (<xref:System.Windows.Documents.ListItem> など) を表すことができます。</span><span class="sxs-lookup"><span data-stu-id="a433f-231">Unlike the visual tree, the logical tree can represent non-visual data objects, such as <xref:System.Windows.Documents.ListItem>.</span></span> <span data-ttu-id="a433f-232">多くの場合、論理ツリーはアプリケーションのマークアップ定義にほぼ一致します。</span><span class="sxs-lookup"><span data-stu-id="a433f-232">In many cases, the logical tree maps very closely to an application's markup definitions.</span></span> <span data-ttu-id="a433f-233">次のコードは、マークアップで定義された <xref:System.Windows.Controls.DockPanel> 要素を示しています。</span><span class="sxs-lookup"><span data-stu-id="a433f-233">The following code shows a <xref:System.Windows.Controls.DockPanel> element defined in markup.</span></span>  
  
 [!code-xaml[VisualsOverview#VisualsOverviewSnippet5](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml#visualsoverviewsnippet5)]  
  
 <span data-ttu-id="a433f-234">マークアップ例の <xref:System.Windows.Controls.DockPanel> 要素を構成する論理オブジェクトを列挙した場合、論理オブジェクトの階層は次の図のようになります。</span><span class="sxs-lookup"><span data-stu-id="a433f-234">If you were to enumerate the logical objects that comprise the <xref:System.Windows.Controls.DockPanel> element in the markup example, you would find the hierarchy of logical objects illustrated below:</span></span>  
  
 <span data-ttu-id="a433f-235">![ツリー ダイアグラム](./media/tree1-wcp.gif "Tree1_wcp")</span><span class="sxs-lookup"><span data-stu-id="a433f-235">![Tree diagram](./media/tree1-wcp.gif "Tree1_wcp")</span></span>  
<span data-ttu-id="a433f-236">論理ツリーのダイアグラム</span><span class="sxs-lookup"><span data-stu-id="a433f-236">Diagram of logical tree</span></span>  
  
 <span data-ttu-id="a433f-237">ビジュアル ツリーと論理ツリーはどちらも、現在のアプリケーション要素セットと同期し、要素の追加、削除、または変更をすべて反映します。</span><span class="sxs-lookup"><span data-stu-id="a433f-237">Both the visual tree and logical tree are synchronized with the current set of application elements, reflecting any addition, deletion, or modification of elements.</span></span> <span data-ttu-id="a433f-238">ただし、これらのツリーが表すアプリケーションのビューはそれぞれ異なるものです。</span><span class="sxs-lookup"><span data-stu-id="a433f-238">However, the trees present different views of the application.</span></span> <span data-ttu-id="a433f-239">ビジュアル ツリーとは異なり、論理ツリーでは、コントロールの <xref:System.Windows.Controls.ContentPresenter> 要素は展開されません。</span><span class="sxs-lookup"><span data-stu-id="a433f-239">Unlike the visual tree, the logical tree does not expand a control's <xref:System.Windows.Controls.ContentPresenter> element.</span></span> <span data-ttu-id="a433f-240">つまり、同じオブジェクト セットについて見ても、論理ツリーとビジュアルツリーの間に 1 対 1 の対応関係はありません。</span><span class="sxs-lookup"><span data-stu-id="a433f-240">This means there is not a direct one-to-one correspondence between a logical tree and a visual tree for the same set of objects.</span></span> <span data-ttu-id="a433f-241">実際、同じ要素をパラメーターに使用して、**LogicalTreeHelper** オブジェクトの <xref:System.Windows.LogicalTreeHelper.GetChildren%2A> メソッドと **VisualTreeHelper** オブジェクトの <xref:System.Windows.Media.VisualTreeHelper.GetChild%2A> メソッドを呼び出すと、異なる結果が返されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-241">In fact, invoking the **LogicalTreeHelper** object's <xref:System.Windows.LogicalTreeHelper.GetChildren%2A> method and the **VisualTreeHelper** object's <xref:System.Windows.Media.VisualTreeHelper.GetChild%2A> method using the same element as a parameter yields differing results.</span></span>  
  
 <span data-ttu-id="a433f-242">論理ツリーについて詳しくは、「[WPF のツリー](../advanced/trees-in-wpf.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a433f-242">For more information on the logical tree, see [Trees in WPF](../advanced/trees-in-wpf.md).</span></span>  
  
### <a name="viewing-the-visual-tree-with-xamlpad"></a><span data-ttu-id="a433f-243">XamlPad を使用したビジュアル ツリーの表示</span><span class="sxs-lookup"><span data-stu-id="a433f-243">Viewing the Visual Tree with XamlPad</span></span>  
 <span data-ttu-id="a433f-244">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] ツールである XamlPad は、現在定義されている XAML コンテンツに対応するビジュアル ツリーを表示、探索するために使用できます。</span><span class="sxs-lookup"><span data-stu-id="a433f-244">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tool, XamlPad, provides an option for viewing and exploring the visual tree that corresponds to the currently defined XAML content.</span></span> <span data-ttu-id="a433f-245">ビジュアル ツリーを表示するには、メニュー バーの **[Show Visual Tree]** (ビジュアル ツリーを表示) ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="a433f-245">Click the **Show Visual Tree** button on the menu bar to display the visual tree.</span></span> <span data-ttu-id="a433f-246">次の図は、XamlPad の **[Visual Tree Explorer]\(ビジュアル ツリー エクスプローラー\)** パネルに表示されたビジュアル ツリー ノードで、XAML コンテンツを展開した様子を示したものです。</span><span class="sxs-lookup"><span data-stu-id="a433f-246">The following illustrates the expansion of XAML content into visual tree nodes in the **Visual Tree Explorer** panel of XamlPad:</span></span>  
  
 ![XamlPad のビジュアル ツリー エクスプローラー パネル](./media/wpf-graphics-rendering-overview/visual-tree-explorer.png)  

 <span data-ttu-id="a433f-248"><xref:System.Windows.Controls.Label>、<xref:System.Windows.Controls.TextBox>、および <xref:System.Windows.Controls.Button> の各コントロールによって、XamlPad の **[Visual Tree Explorer]\(ビジュアル ツリー エクスプローラー\)** パネルに、個別のビジュアル オブジェクト階層がどのように表示されるかに注目してください。</span><span class="sxs-lookup"><span data-stu-id="a433f-248">Notice how the <xref:System.Windows.Controls.Label>, <xref:System.Windows.Controls.TextBox>, and <xref:System.Windows.Controls.Button> controls each display a separate visual object hierarchy in the **Visual Tree Explorer** panel of XamlPad.</span></span> <span data-ttu-id="a433f-249">これは、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] コントロールに、そのコントロールのビジュアル ツリーを含む <xref:System.Windows.Controls.ControlTemplate> があるためです。</span><span class="sxs-lookup"><span data-stu-id="a433f-249">This is because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls have a <xref:System.Windows.Controls.ControlTemplate> that contains the visual tree of that control.</span></span> <span data-ttu-id="a433f-250">コントロールを明示的に参照すると、コントロールのビジュアル階層が暗黙的に参照されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-250">When you explicitly reference a control, you implicitly reference its visual hierarchy.</span></span>  
  
### <a name="profiling-visual-performance"></a><span data-ttu-id="a433f-251">ビジュアル パフォーマンスのプロファイリング</span><span class="sxs-lookup"><span data-stu-id="a433f-251">Profiling Visual Performance</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="a433f-252">にはパフォーマンス プロファイリング ツールのセットがあります。アプリケーションの実行時動作を分析したり、適用できるパフォーマンス最適化の種類を決定したりできます。</span><span class="sxs-lookup"><span data-stu-id="a433f-252">provides a suite of performance profiling tools that allow you to analyze the run-time behavior of your application and determine the types of performance optimizations you can apply.</span></span> <span data-ttu-id="a433f-253">Visual Profiler ツールでは、パフォーマンス データをアプリケーションのビジュアル ツリーに直接マップすることにより、それらのデータを多彩なグラフィカル ビューで表示できます。</span><span class="sxs-lookup"><span data-stu-id="a433f-253">The Visual Profiler tool provides a rich, graphical view of performance data by mapping directly to the application's visual tree.</span></span> <span data-ttu-id="a433f-254">このスクリーンショットでは、Visual Profiler の **[CPU 使用率]** セクションに、オブジェクトの [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] サービスの使用率が詳しく表示されています (レンダリングやレイアウトなど)。</span><span class="sxs-lookup"><span data-stu-id="a433f-254">In this screenshot, the **CPU Usage** section of the Visual Profiler gives you a precise breakdown of an object's use of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] services, such as rendering and layout.</span></span>  
  
 <span data-ttu-id="a433f-255">![Visual Profiler の表示出力](./media/wpfperf-visualprofiler-04.png "WPFPerf_VisualProfiler_04")</span><span class="sxs-lookup"><span data-stu-id="a433f-255">![Visual Profiler display output](./media/wpfperf-visualprofiler-04.png "WPFPerf_VisualProfiler_04")</span></span>  
<span data-ttu-id="a433f-256">Visual Profiler 表示出力</span><span class="sxs-lookup"><span data-stu-id="a433f-256">Visual Profiler display output</span></span>  
  
<a name="visual_rendering_behavior"></a>
## <a name="visual-rendering-behavior"></a><span data-ttu-id="a433f-257">ビジュアル レンダリング動作</span><span class="sxs-lookup"><span data-stu-id="a433f-257">Visual Rendering Behavior</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="a433f-258">では、ビジュアル オブジェクトのレンダリング動作に影響を及ぼす機能が導入されています。保持モード グラフィックス、ベクター グラフィックス、およびデバイス非依存グラフィックスです。</span><span class="sxs-lookup"><span data-stu-id="a433f-258">introduces several features that affect the rendering behavior of visual objects: retained mode graphics, vector graphics, and device independent graphics.</span></span>  
  
### <a name="retained-mode-graphics"></a><span data-ttu-id="a433f-259">保持モード グラフィックス</span><span class="sxs-lookup"><span data-stu-id="a433f-259">Retained Mode Graphics</span></span>  
 <span data-ttu-id="a433f-260">ビジュアル オブジェクトの役割を理解するためには、**イミディエイト モード**のグラフィックス システムと**保持モード**のグラフィックス システムの違いについて理解することが重要です。</span><span class="sxs-lookup"><span data-stu-id="a433f-260">One of the keys to understanding the role of the Visual object is to understand the difference between **immediate mode** and **retained mode** graphics systems.</span></span> <span data-ttu-id="a433f-261">GDI または GDI+ に基づく標準的な Win32 アプリケーションでは、イミディエイト モードのグラフィックス システムが使用されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-261">A standard Win32 application based on GDI or GDI+ uses an immediate mode graphics system.</span></span> <span data-ttu-id="a433f-262">これは、ウィンドウのサイズ変更やオブジェクトの外観変更などといったアクションによって無効化されたクライアント領域の部分を、アプリケーションが再描画するということを意味します。</span><span class="sxs-lookup"><span data-stu-id="a433f-262">This means that the application is responsible for repainting the portion of the client area that is invalidated, due to an action such as a window being resized, or an object changing its visual appearance.</span></span>  
  
 ![Win32 レンダリング シーケンスのダイアグラム](./media/wpf-graphics-rendering-overview/win32-rendering-squence.png)  
  
 <span data-ttu-id="a433f-264">これに対し、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] では、保持モード システムが使用されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-264">In contrast, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses a retained mode system.</span></span> <span data-ttu-id="a433f-265">これは、外観を持つアプリケーション オブジェクト側で、シリアル化された一連の描画データが定義されるということを意味します。</span><span class="sxs-lookup"><span data-stu-id="a433f-265">This means application objects that have a visual appearance define a set of serialized drawing data.</span></span> <span data-ttu-id="a433f-266">描画データが定義された後は、アプリケーション オブジェクトをレンダリングするためのすべての再描画要求に、システム側が対応します。</span><span class="sxs-lookup"><span data-stu-id="a433f-266">Once the drawing data is defined, the system is responsible thereafter for responding to all repaint requests for rendering the application objects.</span></span> <span data-ttu-id="a433f-267">実行時であっても、アプリケーション オブジェクトを変更したり作成した場合の描画要求への対応は、システムに任せることができます。</span><span class="sxs-lookup"><span data-stu-id="a433f-267">Even at run time, you can modify or create application objects, and still rely on the system for responding to paint requests.</span></span> <span data-ttu-id="a433f-268">保持モードのグラフィックス システムでは、描画情報が常にシリアル化された状態でアプリケーションに保持されますが、レンダリングはシステムによって実行されます。これが、保持モードのグラフィックス システムの長所です。</span><span class="sxs-lookup"><span data-stu-id="a433f-268">The power in a retained mode graphics system is that drawing information is always persisted in a serialized state by the application, but rendering responsibility left to the system.</span></span> <span data-ttu-id="a433f-269">次の図は、アプリケーションでの描画要求が [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] によって処理される様子を示したものです。</span><span class="sxs-lookup"><span data-stu-id="a433f-269">The following diagram shows how the application relies on [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] for responding to paint requests.</span></span>  
  
 ![WPF レンダリング シーケンスのダイアグラム](./media/wpf-graphics-rendering-overview/wpf-rendering-sequence.png)  

#### <a name="intelligent-redrawing"></a><span data-ttu-id="a433f-271">インテリジェントな再描画</span><span class="sxs-lookup"><span data-stu-id="a433f-271">Intelligent Redrawing</span></span>  
 <span data-ttu-id="a433f-272">保持モード グラフィックスを使用することの最も大きな利点の 1 つは、アプリケーション内のどの項目を再描画するのかを、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] が効率的に最適化できることです。</span><span class="sxs-lookup"><span data-stu-id="a433f-272">One of the biggest benefits in using retained mode graphics is that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can efficiently optimize what needs to be redrawn in the application.</span></span> <span data-ttu-id="a433f-273">さまざまな不透明度が適用された複雑なシーンがある場合でも、通常、再描画を最適化するために特殊な目的のコードを記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="a433f-273">Even if you have a complex scene with varying levels of opacity, you generally do not need to write special-purpose code to optimize redrawing.</span></span> <span data-ttu-id="a433f-274">これに対し、Win32 プログラミングでは、更新領域内の再描画量を最小化してアプリケーションを最適化するために、多大な労力が費やされることもあります。</span><span class="sxs-lookup"><span data-stu-id="a433f-274">Compare this with Win32 programming in which you can spend a great deal of effort in optimizing your application by minimizing the amount of redrawing in the update region.</span></span> <span data-ttu-id="a433f-275">Win32 アプリケーションで再描画を最適化するための複雑な作業の例については、「[Redrawing in the Update Region](/windows/desktop/gdi/redrawing-in-the-update-region)」(更新領域での再描画) をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a433f-275">See [Redrawing in the Update Region](/windows/desktop/gdi/redrawing-in-the-update-region) for an example of the type of complexity involved in optimizing redrawing in Win32 applications.</span></span>  
  
### <a name="vector-graphics"></a><span data-ttu-id="a433f-276">ベクター グラフィックス</span><span class="sxs-lookup"><span data-stu-id="a433f-276">Vector Graphics</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="a433f-277">では、がレンダリング データ形式として**ベクタ グラフィックス**が使用されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-277">uses **vector graphics** as its rendering data format.</span></span> <span data-ttu-id="a433f-278">スケーラブル ベクター グラフィックス (SVG)、Windows メタファイル (.wmf)、TrueType フォントなどのベクター グラフィックスは、レンダリング データを格納し、それを命令リストとして伝達します。命令リストには、グラフィックス プリミティブを使用してイメージを再作成するための方法が記述されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-278">Vector graphics—which include Scalable Vector Graphics (SVG), Windows metafiles (.wmf), and TrueType fonts—store rendering data and transmit it as a list of instructions that describe how to recreate an image using graphics primitives.</span></span> <span data-ttu-id="a433f-279">たとえば、TrueType フォントは、ピクセル配列ではなく、直線、曲線、およびコマンドのセットで表されるアウトライン フォントです。</span><span class="sxs-lookup"><span data-stu-id="a433f-279">For example, TrueType fonts are outline fonts that describe a set of lines, curves, and commands, rather than an array of pixels.</span></span> <span data-ttu-id="a433f-280">ベクター グラフィックスの主な利点の 1 つは、任意のサイズや解像度に拡大縮小できることです。</span><span class="sxs-lookup"><span data-stu-id="a433f-280">One of the key benefits of vector graphics is the ability to scale to any size and resolution.</span></span>  
  
 <span data-ttu-id="a433f-281">ビットマップ グラフィックスは、ベクター グラフィックスとは異なり、特定の解像度で事前にレンダリングされた、ピクセル単位のイメージ表現としてレンダリング データを格納します。</span><span class="sxs-lookup"><span data-stu-id="a433f-281">Unlike vector graphics, bitmap graphics store rendering data as a pixel-by-pixel representation of an image, pre-rendered for a specific resolution.</span></span> <span data-ttu-id="a433f-282">ビットマップ グラフィックス形式とベクター グラフィックス形式の主な違いの 1 つは、元のソース イメージへの忠実性です。</span><span class="sxs-lookup"><span data-stu-id="a433f-282">One of the key differences between bitmap and vector graphic formats is fidelity to the original source image.</span></span> <span data-ttu-id="a433f-283">たとえば、ソース イメージのサイズを変更した場合、ビットマップ グラフィックス システムではイメージが伸縮されますが、ベクタ グラフィックス システムでは、イメージが拡大縮小されるため、イメージの忠実性が維持されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-283">For example, when the size of a source image is modified, bitmap graphics systems stretch the image, whereas vector graphics systems scale the image, preserving the image fidelity.</span></span>  
  
 <span data-ttu-id="a433f-284">次の図は、ソース イメージが 300% に拡大された場合の例です。</span><span class="sxs-lookup"><span data-stu-id="a433f-284">The following illustration shows a source image that has been resized by 300%.</span></span> <span data-ttu-id="a433f-285">ソース イメージをビットマップ グラフィックス イメージとして拡大したイメージには、ゆがみが生じています。ベクター グラフィックス イメージとして拡大縮小した場合、こうしたゆがみは生じません。</span><span class="sxs-lookup"><span data-stu-id="a433f-285">Notice the distortions that appear when the source image is stretched as a bitmap graphics image rather than scaled as a vector graphics image.</span></span>  
  
 ![ラスター グラフィックスとベクター グラフィックスの違い](./media/wpf-graphics-rendering-overview/raster-vector-differences.png)  
  
 <span data-ttu-id="a433f-287">次のマークアップは、定義された 2 つの <xref:System.Windows.Shapes.Path> 要素を示しています。</span><span class="sxs-lookup"><span data-stu-id="a433f-287">The following markup shows two <xref:System.Windows.Shapes.Path> elements defined.</span></span> <span data-ttu-id="a433f-288">2 つ目の要素では、<xref:System.Windows.Media.ScaleTransform> を使用して、最初の要素の描画命令を 300% に拡大しています。</span><span class="sxs-lookup"><span data-stu-id="a433f-288">The second element uses a <xref:System.Windows.Media.ScaleTransform> to resize the drawing instructions of the first element by 300%.</span></span> <span data-ttu-id="a433f-289">なお、<xref:System.Windows.Shapes.Path> 要素の描画命令は変更されていません。</span><span class="sxs-lookup"><span data-stu-id="a433f-289">Notice that the drawing instructions in the <xref:System.Windows.Shapes.Path> elements remain unchanged.</span></span>  
  
 [!code-xaml[VectorGraphicsSnippets#VectorGraphicsSnippet1](~/samples/snippets/csharp/VS_Snippets_Wpf/VectorGraphicsSnippets/CS/PageOne.xaml#vectorgraphicssnippet1)]  
  
### <a name="about-resolution-and-device-independent-graphics"></a><span data-ttu-id="a433f-290">解像度とデバイス非依存グラフィックスについて</span><span class="sxs-lookup"><span data-stu-id="a433f-290">About Resolution and Device-Independent Graphics</span></span>  
 <span data-ttu-id="a433f-291">画面上のテキストやグラフィックスのサイズを決定するシステム要素は、2 つあります。解像度と DPI です。</span><span class="sxs-lookup"><span data-stu-id="a433f-291">There are two system factors that determine the size of text and graphics on your screen: resolution and DPI.</span></span> <span data-ttu-id="a433f-292">解像度は、画面に表示されるピクセルの数を表します。</span><span class="sxs-lookup"><span data-stu-id="a433f-292">Resolution describes the number of pixels that appear on the screen.</span></span> <span data-ttu-id="a433f-293">解像度が高くなると、ピクセルが小さくなり、グラフィックスとテキストがより滑らかに表示されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-293">As the resolution gets higher, pixels get smaller, causing graphics and text to appear smaller.</span></span> <span data-ttu-id="a433f-294">モニターの解像度が 1024 x 768 に設定されている場合、解像度を 1600 x 1200 に変更すると、表示されるグラフィックスがより小さくなります。</span><span class="sxs-lookup"><span data-stu-id="a433f-294">A graphic displayed on a monitor set to 1024 x 768 will appear much smaller when the resolution is changed to 1600 x 1200.</span></span>  
  
 <span data-ttu-id="a433f-295">もう 1 つのシステム設定である DPI は、画面上の 1 インチのサイズをピクセル単位で表したものです。</span><span class="sxs-lookup"><span data-stu-id="a433f-295">The other system setting, DPI, describes the size of a screen inch in pixels.</span></span> <span data-ttu-id="a433f-296">ほとんどの Windows システムは 96 DPI であり、これは、画面上の 1 インチが 96 ピクセルであることを意味します。</span><span class="sxs-lookup"><span data-stu-id="a433f-296">Most Windows systems have a DPI of 96, which means a screen inch is 96 pixels.</span></span> <span data-ttu-id="a433f-297">DPI の設定を上げると、画面上の 1 インチが長くなり、設定を下げると、画面上の 1 インチが短くなります。</span><span class="sxs-lookup"><span data-stu-id="a433f-297">Increasing the DPI setting makes the screen inch larger; decreasing the DPI makes the screen inch smaller.</span></span> <span data-ttu-id="a433f-298">そのため、ほとんどのシステムでは、画面上の 1 インチと実際の 1 インチが同じサイズにはなりません。</span><span class="sxs-lookup"><span data-stu-id="a433f-298">This means that a screen inch isn't the same size as a real-world inch; on most systems, it's probably not.</span></span> <span data-ttu-id="a433f-299">DPI を大きくすると、画面上の 1 インチのサイズが大きくなるため、DPI 対応のグラフィックスとテキストは大きくなります。</span><span class="sxs-lookup"><span data-stu-id="a433f-299">As you increase the DPI, DPI-aware graphics and text become larger because you've increased the size of the screen inch.</span></span> <span data-ttu-id="a433f-300">DPI を大きくすると、特に高解像度の場合にはテキストが読みやすくなります。</span><span class="sxs-lookup"><span data-stu-id="a433f-300">Increasing the DPI can make text easier to read, especially at high resolutions.</span></span>  
  
 <span data-ttu-id="a433f-301">ただし、すべてのアプリケーションが DPI に対応しているわけではありません。一部のアプリケーションでは、主要な測定単位としてハードウェア ピクセルが使用されているため、システム DPI を変更しても影響がありません。</span><span class="sxs-lookup"><span data-stu-id="a433f-301">Not all applications are DPI-aware: some use hardware pixels as the primary unit of measurement; changing the system DPI has no effect on these applications.</span></span> <span data-ttu-id="a433f-302">また、フォント サイズに DPI 対応の単位を使用している場合でも、それ以外の項目にはすべてピクセルを使用するアプリケーションが数多く存在します。</span><span class="sxs-lookup"><span data-stu-id="a433f-302">Many other applications use DPI-aware units to describe font sizes, but use pixels to describe everything else.</span></span> <span data-ttu-id="a433f-303">これらのアプリケーションで DPI を過度に小さくしたり、大きくしたりした場合、アプリケーションのテキストはシステムの DPI 設定に従って拡大縮小されますが、アプリケーションの UI は拡大縮小されないため、レイアウトの問題が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a433f-303">Making the DPI too small or too large can cause layout problems for these applications, because the applications' text scales with the system's DPI setting, but the applications' UI does not.</span></span> <span data-ttu-id="a433f-304">この問題は、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] を使用して開発されたアプリケーションでは発生しません。</span><span class="sxs-lookup"><span data-stu-id="a433f-304">This problem has been eliminated for applications developed using [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="a433f-305">では、ハードウェア ピクセルの代わりに、デバイス非依存のピクセルを主要測定単位として用いた、自動拡大縮小機能がサポートされています。つまり、アプリケーション開発者が手を加えなくても、グラフィックスとテキストが適切に拡大縮小されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-305">supports automatic scaling by using the device independent pixel as its primary unit of measurement, instead of hardware pixels; graphics and text scale properly without any extra work from the application developer.</span></span> <span data-ttu-id="a433f-306">次の図は、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のテキストとグラフィックスが、さまざまな DPI でどのように表示されるかを示したものです。</span><span class="sxs-lookup"><span data-stu-id="a433f-306">The following illustration shows an example of how [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] text and graphics are appear at different DPI settings.</span></span>  
  
 <span data-ttu-id="a433f-307">![異なる DPI 設定のグラフィックとテキスト](./media/graphicsmm-dpi-setting-examples.png "graphicsmm_dpi_setting_examples")</span><span class="sxs-lookup"><span data-stu-id="a433f-307">![Graphics and text at different DPI settings](./media/graphicsmm-dpi-setting-examples.png "graphicsmm_dpi_setting_examples")</span></span>  
<span data-ttu-id="a433f-308">異なる DPI 設定のグラフィックスとテキスト</span><span class="sxs-lookup"><span data-stu-id="a433f-308">Graphics and text at different DPI settings</span></span>  
  
<a name="visualtreehelper_class"></a>
## <a name="visualtreehelper-class"></a><span data-ttu-id="a433f-309">VisualTreeHelper クラス</span><span class="sxs-lookup"><span data-stu-id="a433f-309">VisualTreeHelper Class</span></span>  
 <span data-ttu-id="a433f-310"><xref:System.Windows.Media.VisualTreeHelper> クラスは、ビジュアル オブジェクト レベルでのプログラミング用に低レベルの機能を提供する、静的なヘルパー クラスです。これは、高性能のカスタム コントロールの開発など、非常に限定されたシナリオで役立ちます。</span><span class="sxs-lookup"><span data-stu-id="a433f-310">The <xref:System.Windows.Media.VisualTreeHelper> class is a static helper class that provides low-level functionality for programming at the visual object level, which is useful in very specific scenarios, such as developing high-performance custom controls.</span></span> <span data-ttu-id="a433f-311">多くの場合は、より高レベルの [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] フレームワーク オブジェクト (<xref:System.Windows.Controls.Canvas> や <xref:System.Windows.Controls.TextBlock> など) を使用したほうが、柔軟性と使いやすさが向上します。</span><span class="sxs-lookup"><span data-stu-id="a433f-311">In most case, the higher-level [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] framework objects, such as <xref:System.Windows.Controls.Canvas> and <xref:System.Windows.Controls.TextBlock>, offer greater flexibility and ease of use.</span></span>  
  
### <a name="hit-testing"></a><span data-ttu-id="a433f-312">ヒット テスト</span><span class="sxs-lookup"><span data-stu-id="a433f-312">Hit Testing</span></span>  
 <span data-ttu-id="a433f-313"><xref:System.Windows.Media.VisualTreeHelper> クラスでは、ビジュアル オブジェクトに対するヒット テストのためのメソッドが提供されています。これらは、既定のヒット テスト サポートが要件を満たさない場合に使用できます。</span><span class="sxs-lookup"><span data-stu-id="a433f-313">The <xref:System.Windows.Media.VisualTreeHelper> class provides methods for hit testing on visual objects when the default hit test support does not meet your needs.</span></span> <span data-ttu-id="a433f-314"><xref:System.Windows.Media.VisualTreeHelper> クラスの <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> メソッドを使用すると、ジオメトリやポイントの座標値が特定のオブジェクト (コントロールやグラフィック要素など) の境界内にあるかどうかを確認できます。</span><span class="sxs-lookup"><span data-stu-id="a433f-314">You can use the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> methods in the <xref:System.Windows.Media.VisualTreeHelper> class to determine whether a geometry or point coordinate value is within the boundary of a given object, such as a control or graphic element.</span></span> <span data-ttu-id="a433f-315">たとえば、ヒット テストを使用して、オブジェクトの四角形領域内でのマウス クリックが円のジオメトリ内にあるかどうかを確認することもできます。また、ヒット テストの既定の実装をオーバーライドして、独自のカスタム ヒット テスト計算を実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="a433f-315">For example, you could use hit testing to determine whether a mouse click within the bounding rectangle of an object falls within the geometry of a circle You can also choose to override the default implementation of hit testing to perform your own custom hit test calculations.</span></span>  
  
 <span data-ttu-id="a433f-316">ヒット テストについて詳しくは、「[ビジュアル層でのヒット テスト](hit-testing-in-the-visual-layer.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a433f-316">For more information on hit testing, see [Hit Testing in the Visual Layer](hit-testing-in-the-visual-layer.md).</span></span>  
  
### <a name="enumerating-the-visual-tree"></a><span data-ttu-id="a433f-317">ビジュアル ツリーを列挙する</span><span class="sxs-lookup"><span data-stu-id="a433f-317">Enumerating the Visual Tree</span></span>  
 <span data-ttu-id="a433f-318"><xref:System.Windows.Media.VisualTreeHelper> クラスでは、ビジュアル ツリーのメンバーを列挙するための機能が提供されています。</span><span class="sxs-lookup"><span data-stu-id="a433f-318">The <xref:System.Windows.Media.VisualTreeHelper> class provides functionality for enumerating the members of a visual tree.</span></span> <span data-ttu-id="a433f-319">親を取得するには、<xref:System.Windows.Media.VisualTreeHelper.GetParent%2A> メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="a433f-319">To retrieve a parent, call the <xref:System.Windows.Media.VisualTreeHelper.GetParent%2A> method.</span></span> <span data-ttu-id="a433f-320">ビジュアル オブジェクトの子 (直接の子孫) を取得するには、<xref:System.Windows.Media.VisualTreeHelper.GetChild%2A> メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="a433f-320">To retrieve a child, or direct descendant, of a visual object, call the <xref:System.Windows.Media.VisualTreeHelper.GetChild%2A> method.</span></span> <span data-ttu-id="a433f-321">このメソッドは、指定したインデックス位置にある親の子 <xref:System.Windows.Media.Visual> を返します。</span><span class="sxs-lookup"><span data-stu-id="a433f-321">This method returns a child <xref:System.Windows.Media.Visual> of the parent at the specified index.</span></span>  
  
 <span data-ttu-id="a433f-322">次の例に示すのは、ビジュアル オブジェクトのすべての子孫を列挙する方法です。これは、ビジュアル オブジェクト階層のすべての描画情報をシリアル化する必要がある場合に使用できる手法です。</span><span class="sxs-lookup"><span data-stu-id="a433f-322">The following example shows how to enumerate all the descendants of a visual object, which is a technique you might want to use if you were interested in serializing all the rendering information of a visual object hierarchy.</span></span>  
  
 [!code-csharp[VisualsOverview#101](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml.cs#101)]
 [!code-vb[VisualsOverview#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsOverview/visualbasic/window1.xaml.vb#101)]  
  
 <span data-ttu-id="a433f-323">ほとんどの場合、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] アプリケーションの要素を表すのには、論理ツリーの方が役立ちます。</span><span class="sxs-lookup"><span data-stu-id="a433f-323">In most cases, the logical tree is a more useful representation of the elements in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application.</span></span> <span data-ttu-id="a433f-324">論理ツリーを直接変更することはありませんが、アプリケーションのこのビューは、プロパティの継承やイベントのルーティングを理解する上で役立ちます。</span><span class="sxs-lookup"><span data-stu-id="a433f-324">Although you do not modify the logical tree directly, this view of the application is useful for understanding property inheritance and event routing.</span></span> <span data-ttu-id="a433f-325">ビジュアル ツリーとは異なり、論理ツリーは、ビジュアル データ オブジェクト以外のオブジェクト (<xref:System.Windows.Documents.ListItem> など) を表すことができます。</span><span class="sxs-lookup"><span data-stu-id="a433f-325">Unlike the visual tree, the logical tree can represent non-visual data objects, such as <xref:System.Windows.Documents.ListItem>.</span></span> <span data-ttu-id="a433f-326">論理ツリーについて詳しくは、「[WPF のツリー](../advanced/trees-in-wpf.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a433f-326">For more information on the logical tree, see [Trees in WPF](../advanced/trees-in-wpf.md).</span></span>  
  
 <span data-ttu-id="a433f-327"><xref:System.Windows.Media.VisualTreeHelper> クラスでは、ビジュアル オブジェクトの四角形領域を返すメソッドが提供されています。</span><span class="sxs-lookup"><span data-stu-id="a433f-327">The <xref:System.Windows.Media.VisualTreeHelper> class provides methods for returning the bounding rectangle of visual objects.</span></span> <span data-ttu-id="a433f-328"><xref:System.Windows.Media.VisualTreeHelper.GetContentBounds%2A> を呼び出すと、ビジュアル オブジェクトの四角形領域が返されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-328">You can return the bounding rectangle of a visual object by calling <xref:System.Windows.Media.VisualTreeHelper.GetContentBounds%2A>.</span></span> <span data-ttu-id="a433f-329"><xref:System.Windows.Media.VisualTreeHelper.GetDescendantBounds%2A> を呼び出すと、ビジュアル オブジェクトのすべての子孫 (ビジュアル オブジェクト自体も含む) の四角形領域が返されます。</span><span class="sxs-lookup"><span data-stu-id="a433f-329">You can return the bounding rectangle of all the descendants of a visual object, including the visual object itself, by calling <xref:System.Windows.Media.VisualTreeHelper.GetDescendantBounds%2A>.</span></span> <span data-ttu-id="a433f-330">次のコードは、ビジュアル オブジェクトとそのすべての子孫の四角形領域を計算する方法を示したものです。</span><span class="sxs-lookup"><span data-stu-id="a433f-330">The following code shows how you would calculate the bounding rectangle of a visual object and all its descendants.</span></span>  
  
 [!code-csharp[VisualsOverview#102](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml.cs#102)]
 [!code-vb[VisualsOverview#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsOverview/visualbasic/window1.xaml.vb#102)]  
  
## <a name="see-also"></a><span data-ttu-id="a433f-331">関連項目</span><span class="sxs-lookup"><span data-stu-id="a433f-331">See also</span></span>

- <xref:System.Windows.Media.Visual>
- <xref:System.Windows.Media.VisualTreeHelper>
- <xref:System.Windows.Media.DrawingVisual>
- [<span data-ttu-id="a433f-332">2D グラフィックスとイメージング</span><span class="sxs-lookup"><span data-stu-id="a433f-332">2D Graphics and Imaging</span></span>](../advanced/optimizing-performance-2d-graphics-and-imaging.md)
- [<span data-ttu-id="a433f-333">ビジュアル層でのヒット テスト</span><span class="sxs-lookup"><span data-stu-id="a433f-333">Hit Testing in the Visual Layer</span></span>](hit-testing-in-the-visual-layer.md)
- [<span data-ttu-id="a433f-334">DrawingVisual オブジェクトの使用</span><span class="sxs-lookup"><span data-stu-id="a433f-334">Using DrawingVisual Objects</span></span>](using-drawingvisual-objects.md)
- [<span data-ttu-id="a433f-335">チュートリアル: Win32 アプリケーションでのビジュアル オブジェクトのホスト</span><span class="sxs-lookup"><span data-stu-id="a433f-335">Tutorial: Hosting Visual Objects in a Win32 Application</span></span>](tutorial-hosting-visual-objects-in-a-win32-application.md)
- [<span data-ttu-id="a433f-336">WPF アプリケーションのパフォーマンスの最適化</span><span class="sxs-lookup"><span data-stu-id="a433f-336">Optimizing WPF Application Performance</span></span>](../advanced/optimizing-wpf-application-performance.md)
