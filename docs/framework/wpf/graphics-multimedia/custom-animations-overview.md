---
title: カスタム アニメーションの概要
ms.date: 03/30/2017
helpviewer_keywords:
- custom classes [WPF], animation
- key frames [WPF], custom
- custom key frames [WPF]
- animation [WPF], custom classes
- custom animation classes [WPF]
ms.assetid: 9be69d50-3384-4938-886f-08ce00e4a7a6
ms.openlocfilehash: c5f315992e8ae37bc79602e6986d90e7af591fb2
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/12/2020
ms.locfileid: "79186550"
---
# <a name="custom-animations-overview"></a><span data-ttu-id="aeb87-102">カスタム アニメーションの概要</span><span class="sxs-lookup"><span data-stu-id="aeb87-102">Custom Animations Overview</span></span>
<span data-ttu-id="aeb87-103">このトピックでは、カスタム キー フレームやアニメーション クラスを作成して、またはフレームごとのコールバックを使ってバイパスすることにより、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のアニメーション システムを拡張する方法と、それが必要な状況について説明します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-103">This topic describes how and when to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system by creating custom key frames, animation classes, or by using per-frame callback to bypass it.</span></span>  
  
<a name="prerequisites"></a>
## <a name="prerequisites"></a><span data-ttu-id="aeb87-104">必須コンポーネント</span><span class="sxs-lookup"><span data-stu-id="aeb87-104">Prerequisites</span></span>  
 <span data-ttu-id="aeb87-105">このトピックを理解するには、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] によって提供されるさまざまな種類のアニメーションに精通している必要があります。</span><span class="sxs-lookup"><span data-stu-id="aeb87-105">To understand this topic, you should be familiar with the different types of animations provided by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span> <span data-ttu-id="aeb87-106">詳しくは、「From/To/By アニメーションの概要」、「[キー フレーム アニメーションの概要](key-frame-animations-overview.md)」、および「[パス アニメーションの概要](path-animations-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-106">For more information, see the From/To/By Animations Overview, the [Key-Frame Animations Overview](key-frame-animations-overview.md), and the [Path Animations Overview](path-animations-overview.md).</span></span>  
  
 <span data-ttu-id="aeb87-107">アニメーション クラスは<xref:System.Windows.Freezable>クラスから継承されるため、<xref:System.Windows.Freezable>オブジェクトとから継承する方法について理解しておく必要があります<xref:System.Windows.Freezable>。</span><span class="sxs-lookup"><span data-stu-id="aeb87-107">Because the animation classes inherit from the <xref:System.Windows.Freezable> class, you should be familiar with <xref:System.Windows.Freezable> objects and how to inherit from <xref:System.Windows.Freezable>.</span></span> <span data-ttu-id="aeb87-108">詳しくは、「[Freezable オブジェクトの概要](../advanced/freezable-objects-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-108">For more information, see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md).</span></span>  
  
<a name="extendingtheanimationsystem"></a>
## <a name="extending-the-animation-system"></a><span data-ttu-id="aeb87-109">アニメーション システムの拡張</span><span class="sxs-lookup"><span data-stu-id="aeb87-109">Extending the Animation System</span></span>  
 <span data-ttu-id="aeb87-110">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のアニメーション システムには、使う組み込み機能のレベルに応じて、さまざまな拡張方法があります。</span><span class="sxs-lookup"><span data-stu-id="aeb87-110">There are a number of ways to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system, depending on the level of built-in functionality you want to use.</span></span>  <span data-ttu-id="aeb87-111">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のアニメーション エンジンには、次の 3 つの主な機能拡張ポイントがあります。</span><span class="sxs-lookup"><span data-stu-id="aeb87-111">There are three primary extensibility points in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine:</span></span>  
  
- <span data-ttu-id="aeb87-112">などの<xref:System.Windows.Media.Animation.DoubleKeyFrame> \* \<Type>\* KeyFrame クラスの 1 つを継承して、カスタム のキー フレーム オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-112">Create a custom key frame object by inheriting from one of the *\<Type>* KeyFrame classes, such as <xref:System.Windows.Media.Animation.DoubleKeyFrame>.</span></span> <span data-ttu-id="aeb87-113">この方法では、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] アニメーション エンジンの組み込み機能のほとんどを使います。</span><span class="sxs-lookup"><span data-stu-id="aeb87-113">This approach uses most of the built-in functionality of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine.</span></span>  
  
- <span data-ttu-id="aeb87-114">\* \<AnimationBase\*クラスの 1 つ<xref:System.Windows.Media.Animation.AnimationTimeline>または 1 つを継承して独自のアニメーション クラスを作成>。</span><span class="sxs-lookup"><span data-stu-id="aeb87-114">Create your own animation class by inheriting from <xref:System.Windows.Media.Animation.AnimationTimeline> or one of the *\<Type>* AnimationBase classes.</span></span>  
  
- <span data-ttu-id="aeb87-115">フレームごとのコールバックを使って、フレームごとにアニメーションを生成します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-115">Use per-frame callback to generate animations on a per-frame basis.</span></span> <span data-ttu-id="aeb87-116">この方法は、アニメーションおよびタイミング システムを完全にバイパスします。</span><span class="sxs-lookup"><span data-stu-id="aeb87-116">This approach completely bypasses the animation and timing system.</span></span>  
  
 <span data-ttu-id="aeb87-117">次の表では、いくつかのアニメーション システム拡張シナリオについて説明します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-117">The following table describes some the scenarios for extending the animation system.</span></span>  
  
|<span data-ttu-id="aeb87-118">目的...</span><span class="sxs-lookup"><span data-stu-id="aeb87-118">When you want to...</span></span>|<span data-ttu-id="aeb87-119">使う方法</span><span class="sxs-lookup"><span data-stu-id="aeb87-119">Use this approach</span></span>|  
|-------------------------|-----------------------|  
|<span data-ttu-id="aeb87-120">対応する*\<* 型を持つ型の値間の補間をカスタマイズするキー フレームを使用してアニメーション></span><span class="sxs-lookup"><span data-stu-id="aeb87-120">Customize the interpolation between values of a type that has a corresponding *\<Type>* AnimationUsingKeyFrames</span></span>|<span data-ttu-id="aeb87-121">カスタム キー フレームを作成します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-121">Create a custom key frame.</span></span> <span data-ttu-id="aeb87-122">詳しくは、「[カスタム キー フレームを作成する](#createacustomkeyframe)」セクションをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-122">For more information, see the [Create a Custom Key Frame](#createacustomkeyframe) section.</span></span>|  
|<span data-ttu-id="aeb87-123">対応する*\<タイプ>* アニメーションを持つ型の値間の補間だけでなく、カスタマイズします。</span><span class="sxs-lookup"><span data-stu-id="aeb87-123">Customize more than just the interpolation between values of a type that has a corresponding *\<Type>* Animation.</span></span>|<span data-ttu-id="aeb87-124">アニメーション化する型に対応する*\<Type>* AnimationBase クラスから継承するカスタム アニメーション クラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-124">Create a custom animation class that inherits from the *\<Type>* AnimationBase class that corresponds to the type you want to animate.</span></span> <span data-ttu-id="aeb87-125">詳しくは、「[カスタム アニメーション クラスを作成する](#createacustomanimationtype)」セクションをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-125">For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section.</span></span>|  
|<span data-ttu-id="aeb87-126">対応する [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] アニメーションがない型をアニメーション化する</span><span class="sxs-lookup"><span data-stu-id="aeb87-126">Animate a type that has no corresponding [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation</span></span>|<span data-ttu-id="aeb87-127">を<xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>使用するか、 から<xref:System.Windows.Media.Animation.AnimationTimeline>継承するクラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-127">Use an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> or create a class that inherits from <xref:System.Windows.Media.Animation.AnimationTimeline>.</span></span> <span data-ttu-id="aeb87-128">詳しくは、「[カスタム アニメーション クラスを作成する](#createacustomanimationtype)」セクションをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-128">For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section.</span></span>|  
|<span data-ttu-id="aeb87-129">フレームごとに計算され、最後のオブジェクト相互作用セットに基づく値のある、複数のオブジェクトをアニメーション化する</span><span class="sxs-lookup"><span data-stu-id="aeb87-129">Animate multiple objects with values that are computed each frame and are based on the last set of object interactions</span></span>|<span data-ttu-id="aeb87-130">フレームごとのコールバックを使います。</span><span class="sxs-lookup"><span data-stu-id="aeb87-130">Use per-frame callback.</span></span> <span data-ttu-id="aeb87-131">詳しくは、「[フレームごとのコールバックを使用する](#useperframecallback)」セクションをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-131">For more information, see the [Create a Use Per-Frame Callback](#useperframecallback) section.</span></span>|  
  
<a name="createacustomkeyframe"></a>
## <a name="create-a-custom-key-frame"></a><span data-ttu-id="aeb87-132">カスタム キー フレームを作成する</span><span class="sxs-lookup"><span data-stu-id="aeb87-132">Create a Custom Key Frame</span></span>  
 <span data-ttu-id="aeb87-133">カスタム キー フレーム クラスの作成は、アニメーション システムを拡張する最も簡単な方法です。</span><span class="sxs-lookup"><span data-stu-id="aeb87-133">Creating a custom key frame class is the simplest way to extend the animation system.</span></span> <span data-ttu-id="aeb87-134">キー フレーム アニメーションに対して異なる補間方法が必要なときは、このアプローチを使います。</span><span class="sxs-lookup"><span data-stu-id="aeb87-134">Use this approach when you want to a different interpolation method for a key-frame animation.</span></span>  <span data-ttu-id="aeb87-135">「[キー フレーム アニメーションの概要](key-frame-animations-overview.md)」で説明されているように、キー フレーム アニメーションはキー フレーム オブジェクトを使って出力値を生成します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-135">As described in the [Key-Frame Animations Overview](key-frame-animations-overview.md), a key-frame animation uses key frame objects to generate its output values.</span></span> <span data-ttu-id="aeb87-136">各キー フレーム オブジェクトは 3 つの機能を実行します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-136">Each key frame object performs three functions:</span></span>  
  
- <span data-ttu-id="aeb87-137">プロパティを使用してターゲット値<xref:System.Windows.Media.Animation.IKeyFrame.Value%2A>を指定します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-137">Specifies a target value using its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property.</span></span>  
  
- <span data-ttu-id="aeb87-138">プロパティを使用して、その値に到達する時刻を<xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A>指定します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-138">Specifies the time at which that value should be reached using its <xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A> property.</span></span>  
  
- <span data-ttu-id="aeb87-139">InterpolateValueCore メソッドを実装することで、前のキー フレームの値とそれ自体の値の間を補間します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-139">Interpolates between the value of the previous key frame and its own value by implementing the InterpolateValueCore method.</span></span>  
  
 <span data-ttu-id="aeb87-140">**実装の説明**</span><span class="sxs-lookup"><span data-stu-id="aeb87-140">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="aeb87-141">*\<型>* キー フレーム抽象クラスから派生し、メソッドを実装します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-141">Derive from the *\<Type>* KeyFrame abstract class and implement the InterpolateValueCore method.</span></span> <span data-ttu-id="aeb87-142">InterpolateValueCore メソッドは、キー フレームの現在の値を返します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-142">The InterpolateValueCore method returns the current value of the key frame.</span></span> <span data-ttu-id="aeb87-143">2 つのパラメーターとして、前のキー フレームの値と、0 から 1 の範囲の進行状況の値を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="aeb87-143">It takes two parameters: the value of the previous key frame and a progress value that ranges from 0 to 1.</span></span> <span data-ttu-id="aeb87-144">進行状況が 0 の場合は、キー フレームが開始したばかりであることを示し、値 1 はキー フレームが完了したばかりで、<xref:System.Windows.Media.Animation.IKeyFrame.Value%2A>そのプロパティで指定された値を返す必要があることを示します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-144">A progress of 0 indicates the key frame has just started, and a value of 1 indicates that the key frame has just completed and should return the value specified by its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property.</span></span>  
  
 <span data-ttu-id="aeb87-145">Type>KeyFrame クラスは<xref:System.Windows.Freezable>クラスから継承するため、クラスの<xref:System.Windows.Freezable.CreateInstanceCore%2A>新しいインスタンスを返すためにコアもオーバーライドする必要があります。 \* \< \*</span><span class="sxs-lookup"><span data-stu-id="aeb87-145">Because the *\<Type>* KeyFrame classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class.</span></span> <span data-ttu-id="aeb87-146">クラスが依存関係プロパティを使ってデータを保存しない場合、または作成の後で追加の初期化が必要な場合は、他のメソッドのオーバーライドが必要な場合があります。詳しくは、「[Freezable オブジェクトの概要](../advanced/freezable-objects-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-146">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="aeb87-147">カスタム*\<タイプ>* キーフレーム アニメーションを作成したら、その*種類の\<* アニメーションを使用してキー フレーム>種類で使用できます。</span><span class="sxs-lookup"><span data-stu-id="aeb87-147">After you've created your custom *\<Type>* KeyFrame animation, you can use it with the *\<Type>* AnimationUsingKeyFrames for that type.</span></span>  
  
<a name="createacustomanimationtype"></a>
## <a name="create-a-custom-animation-class"></a><span data-ttu-id="aeb87-148">カスタム アニメーション クラスを作成する</span><span class="sxs-lookup"><span data-stu-id="aeb87-148">Create a Custom Animation Class</span></span>  
 <span data-ttu-id="aeb87-149">独自のアニメーション型を作成すると、オブジェクトをアニメーション化する方法をいっそう細かく制御できます。</span><span class="sxs-lookup"><span data-stu-id="aeb87-149">Creating your own animation type gives you more control over how an object in animated.</span></span> <span data-ttu-id="aeb87-150">独自のアニメーション タイプを作成するには、<xref:System.Windows.Media.Animation.AnimationTimeline>クラスまたは*\<Type>* AnimationBase クラスから派生させる方法の 2 つがあります。</span><span class="sxs-lookup"><span data-stu-id="aeb87-150">There are two recommended ways to create your own animation type: you can derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class or the *\<Type>* AnimationBase class.</span></span> <span data-ttu-id="aeb87-151">アニメーション>*\<型*または*\<型>* から派生するキーフレーム クラスを使用して推奨されません。</span><span class="sxs-lookup"><span data-stu-id="aeb87-151">Deriving from the *\<Type>* Animation or *\<Type>* AnimationUsingKeyFrames classes is not recommended.</span></span>  
  
### <a name="derive-from-typeanimationbase"></a><span data-ttu-id="aeb87-152">\<Type>AnimationBase から派生する</span><span class="sxs-lookup"><span data-stu-id="aeb87-152">Derive from \<Type>AnimationBase</span></span>  
 <span data-ttu-id="aeb87-153">Type>AnimationBase クラスから派生する方法は、新しいアニメーション タイプを作成する最も簡単な方法です。 \* \< \*</span><span class="sxs-lookup"><span data-stu-id="aeb87-153">Deriving from a *\<Type>* AnimationBase class is the simplest way to create a new animation type.</span></span> <span data-ttu-id="aeb87-154">この方法は、対応する*\<Type>* AnimationBase クラスが既に存在するタイプの新しいアニメーションを作成する場合に使用します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-154">Use this approach when you want to create a new animation for type that already has a corresponding *\<Type>* AnimationBase class.</span></span>  
  
 <span data-ttu-id="aeb87-155">**実装の説明**</span><span class="sxs-lookup"><span data-stu-id="aeb87-155">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="aeb87-156">型>アニメーション クラスから派生し、メソッドを実装します。 \* \< \*</span><span class="sxs-lookup"><span data-stu-id="aeb87-156">Derive from a *\<Type>* Animation class and implement the GetCurrentValueCore method.</span></span> <span data-ttu-id="aeb87-157">GetCurrentValueCore メソッドは、アニメーションの現在の値を返します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-157">The GetCurrentValueCore method returns the current value of the animation.</span></span> <span data-ttu-id="aeb87-158">このパラメーターには、推奨開始値、推奨終了値、および<xref:System.Windows.Media.Animation.AnimationClock>アニメーションの進行状況を決定するために使用する の 3 つのパラメーターが必要です。</span><span class="sxs-lookup"><span data-stu-id="aeb87-158">It takes three parameters: a suggested starting value, a suggested ending value, and an <xref:System.Windows.Media.Animation.AnimationClock>, which you use to determine the progress of the animation.</span></span>  
  
 <span data-ttu-id="aeb87-159">Type>AnimationBase クラスは<xref:System.Windows.Freezable>クラスから継承するため、クラスの<xref:System.Windows.Freezable.CreateInstanceCore%2A>新しいインスタンスを返すためにコアもオーバーライドする必要があります。 \* \< \*</span><span class="sxs-lookup"><span data-stu-id="aeb87-159">Because the *\<Type>* AnimationBase classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class.</span></span> <span data-ttu-id="aeb87-160">クラスが依存関係プロパティを使ってデータを保存しない場合、または作成の後で追加の初期化が必要な場合は、他のメソッドのオーバーライドが必要な場合があります。詳しくは、「[Freezable オブジェクトの概要](../advanced/freezable-objects-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-160">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="aeb87-161">詳細については、アニメーション化する*\<型の型>* AnimationBase クラスの GetCurrentValueCore メソッドのドキュメントを参照してください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-161">For more information, see the GetCurrentValueCore method documentation for the *\<Type>* AnimationBase class for the type that you want to animate.</span></span> <span data-ttu-id="aeb87-162">例については、「[Custom Animation Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)」(カスタム アニメーションのサンプル) をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-162">For an example, see the [Custom Animation Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)</span></span>  
  
 <span data-ttu-id="aeb87-163">**代替アプローチ**</span><span class="sxs-lookup"><span data-stu-id="aeb87-163">**Alternative Approaches**</span></span>  
  
 <span data-ttu-id="aeb87-164">アニメーション値の補間方法を変更するだけの場合は*\<、Type>* KeyFrame クラスのいずれかから派生することを検討してください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-164">If you simply want to change how animation values are interpolated, considering deriving from one of the *\<Type>* KeyFrame classes.</span></span> <span data-ttu-id="aeb87-165">作成するキー フレームは、対応する*\<型>* アニメーション使用キーフレームで[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]使用できます。</span><span class="sxs-lookup"><span data-stu-id="aeb87-165">The key frame you create can be used with the corresponding *\<Type>* AnimationUsingKeyFrames provided by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
### <a name="derive-from-animationtimeline"></a><span data-ttu-id="aeb87-166">AnimationTimeline から派生する</span><span class="sxs-lookup"><span data-stu-id="aeb87-166">Derive from AnimationTimeline</span></span>  
 <span data-ttu-id="aeb87-167">一致する<xref:System.Windows.Media.Animation.AnimationTimeline>[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]アニメーションがない型のアニメーションを作成する場合、または厳密に型指定されていないアニメーションを作成する場合は、クラスから派生します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-167">Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class when you want to create an animation for a type that doesn't already have a matching [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation, or you want to create an animation that is not strongly typed.</span></span>  
  
 <span data-ttu-id="aeb87-168">**実装の説明**</span><span class="sxs-lookup"><span data-stu-id="aeb87-168">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="aeb87-169">クラスから派生<xref:System.Windows.Media.Animation.AnimationTimeline>し、次のメンバーをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="aeb87-169">Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class and override the following members:</span></span>  
  
- <span data-ttu-id="aeb87-170"><xref:System.Windows.Freezable.CreateInstanceCore%2A>– 新しいクラスが具象型の場合<xref:System.Windows.Freezable.CreateInstanceCore%2A>、クラスの新しいインスタンスを返すためにオーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="aeb87-170"><xref:System.Windows.Freezable.CreateInstanceCore%2A> – If your new class is concrete, you must override <xref:System.Windows.Freezable.CreateInstanceCore%2A> to return a new instance of your class.</span></span>  
  
- <span data-ttu-id="aeb87-171"><xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A>– アニメーションの現在の値を返す場合は、このメソッドをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="aeb87-171"><xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> – Override this method to return the current value of your animation.</span></span> <span data-ttu-id="aeb87-172">このパラメータには、デフォルトの起点値、デフォルトの終点値、および<xref:System.Windows.Media.Animation.AnimationClock>.</span><span class="sxs-lookup"><span data-stu-id="aeb87-172">It takes three parameters: a default origin value, a default destination value, and an <xref:System.Windows.Media.Animation.AnimationClock>.</span></span> <span data-ttu-id="aeb87-173">アニメーションの<xref:System.Windows.Media.Animation.AnimationClock>現在の時間または進行状況を取得するには、 を使用します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-173">Use the <xref:System.Windows.Media.Animation.AnimationClock> to obtain the current time or progress for the animation.</span></span> <span data-ttu-id="aeb87-174">既定の開始値と終了値を使うかどうかを選択できます。</span><span class="sxs-lookup"><span data-stu-id="aeb87-174">You can choose whether to use the default origin and destination values.</span></span>  
  
- <span data-ttu-id="aeb87-175"><xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A>–<xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A>このプロパティをオーバーライドして、メソッドで指定された既定の宛先値をアニメーションで使用するかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-175"><xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> – Override this property to indicate whether your animation uses the default destination value specified by the <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> method.</span></span>  
  
- <span data-ttu-id="aeb87-176"><xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A>– アニメーションが生成する出力<xref:System.Type>を示すには、このプロパティをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="aeb87-176"><xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> – Override this property to indicate the <xref:System.Type> of output your animation produces.</span></span>  
  
 <span data-ttu-id="aeb87-177">クラスが依存関係プロパティを使ってデータを保存しない場合、または作成の後で追加の初期化が必要な場合は、他のメソッドのオーバーライドが必要な場合があります。詳しくは、「[Freezable オブジェクトの概要](../advanced/freezable-objects-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-177">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="aeb87-178">推奨される ([!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] アニメーションによって使われる) パラダイムは、2 つの継承レベルを使うことです。</span><span class="sxs-lookup"><span data-stu-id="aeb87-178">The recommended paradigm (used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animations) is to use two inheritance levels:</span></span>  
  
1. <span data-ttu-id="aeb87-179">から<xref:System.Windows.Media.Animation.AnimationTimeline>派生した抽象*\<型>* AnimationBase クラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-179">Create an abstract *\<Type>* AnimationBase class that derives from <xref:System.Windows.Media.Animation.AnimationTimeline>.</span></span> <span data-ttu-id="aeb87-180">このクラスはメソッドを<xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A>オーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="aeb87-180">This class should override the <xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> method.</span></span> <span data-ttu-id="aeb87-181">また、新しい抽象メソッド GetCurrentValueCore を導入し、<xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A>既定の発生元の値と既定の送信先の値パラメーターの型を検証するようにオーバーライドしてから、GetCurrentValueCore を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-181">It should also introduce a new abstract method, GetCurrentValueCore, and override <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> so that it validates the types of the default origin value and default destination value parameters, then calls GetCurrentValueCore.</span></span>  
  
2. <span data-ttu-id="aeb87-182">新しい<xref:System.Windows.Freezable.CreateInstanceCore%2A><xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A>*\<Type>* AnimationBase クラスから継承する別のクラスを作成し、メソッド、導入した GetCurrentValueCore メソッド、およびプロパティをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="aeb87-182">Create another class that inherits from your new *\<Type>* AnimationBase class and overrides the <xref:System.Windows.Freezable.CreateInstanceCore%2A> method, the GetCurrentValueCore method that you introduced, and the <xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> property.</span></span>  
  
 <span data-ttu-id="aeb87-183">**代替アプローチ**</span><span class="sxs-lookup"><span data-stu-id="aeb87-183">**Alternative Approaches**</span></span>  
  
 <span data-ttu-id="aeb87-184">対応する From/To/By アニメーションまたはキー フレーム アニメーションがない型をアニメーション化する場合は、 を<xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>使用することを検討してください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-184">If you want to animate a type that has no corresponding From/To/By animation or key-frame animation, consider using an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>.</span></span> <span data-ttu-id="aeb87-185">型が弱いため、任意の<xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>種類の値をアニメーション化できます。</span><span class="sxs-lookup"><span data-stu-id="aeb87-185">Because it is weakly typed, an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> can animate any type of value.</span></span> <span data-ttu-id="aeb87-186">この方法の欠点は、離散<xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>補間のみをサポートしていることです。</span><span class="sxs-lookup"><span data-stu-id="aeb87-186">The drawback to this approach is that <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> only supports discrete interpolation.</span></span>  
  
<a name="useperframecallback"></a>
## <a name="use-per-frame-callback"></a><span data-ttu-id="aeb87-187">フレームごとのコールバックを使用する</span><span class="sxs-lookup"><span data-stu-id="aeb87-187">Use Per-Frame Callback</span></span>  
 <span data-ttu-id="aeb87-188">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] アニメーション システムを完全にバイパスする必要があるときは、この方法を使います。</span><span class="sxs-lookup"><span data-stu-id="aeb87-188">Use this approach when you need to completely bypass the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system.</span></span> <span data-ttu-id="aeb87-189">この方法の 1 つのシナリオは、各アニメーション ステップでオブジェクトの最後の一連のやり取りに基づいてアニメーション化されるオブジェクトの新しい向きまたは位置を再計算する必要がある物理アニメーションです。</span><span class="sxs-lookup"><span data-stu-id="aeb87-189">One scenario for this approach is physics animations, where at each animation step a new direction or position of animated objects needs to be recomputed based on the  last set of object interactions.</span></span>  
  
 <span data-ttu-id="aeb87-190">**実装の説明**</span><span class="sxs-lookup"><span data-stu-id="aeb87-190">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="aeb87-191">この概要で説明されている他の方法とは異なり、フレームごとのコールバックを使うために、カスタム アニメーション クラスまたはカスタム キー フレーム クラスを作成する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="aeb87-191">Unlike the other approaches described in this overview, to use per-frame callback you don't need to create a custom animation or key frame class.</span></span>  
  
 <span data-ttu-id="aeb87-192">代わりに、アニメーション化する<xref:System.Windows.Media.CompositionTarget.Rendering>オブジェクトを含むオブジェクトのイベントに登録します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-192">Instead, you register for the <xref:System.Windows.Media.CompositionTarget.Rendering> event of the object that contains the objects you want to animate.</span></span> <span data-ttu-id="aeb87-193">このイベント ハンドラー メソッドは、フレームごとに 1 回呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="aeb87-193">This event handler method gets called once per frame.</span></span> <span data-ttu-id="aeb87-194">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] がビジュアル ツリーの永続化されたレンダリング データを構成ツリーにマーシャリングするたびに、イベント ハンドラー メソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="aeb87-194">Each time that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] marshals the persisted rendering data in the visual tree across to the composition tree, your event handler method is called.</span></span>  
  
 <span data-ttu-id="aeb87-195">イベント ハンドラーでは、アニメーション効果に必要なあらゆる計算を実行し、これらの値を使用してアニメーション化するオブジェクトのプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-195">In your event handler, perform your whatever calculations necessary for your animation effect and set the properties of the objects you want to animate with these values.</span></span>  
  
 <span data-ttu-id="aeb87-196">現在のフレームのプレゼンテーション時間を取得するには、この<xref:System.EventArgs>イベントに関連付けられた をとして<xref:System.Windows.Media.RenderingEventArgs>キャストして、現在<xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A>のフレームのレンダリング時間を取得するために使用できるプロパティを提供します。</span><span class="sxs-lookup"><span data-stu-id="aeb87-196">To obtain the presentation time of the current frame, the <xref:System.EventArgs> associated with this event can be cast as <xref:System.Windows.Media.RenderingEventArgs>, which provide a <xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A> property that you can use to obtain the current frame's rendering time.</span></span>  
  
 <span data-ttu-id="aeb87-197">詳しくは、<xref:System.Windows.Media.CompositionTarget.Rendering> のページをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="aeb87-197">For more information, see the <xref:System.Windows.Media.CompositionTarget.Rendering> page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="aeb87-198">関連項目</span><span class="sxs-lookup"><span data-stu-id="aeb87-198">See also</span></span>

- <xref:System.Windows.Media.Animation.AnimationTimeline>
- <xref:System.Windows.Media.Animation.IKeyFrame>
- [<span data-ttu-id="aeb87-199">プロパティ アニメーションの手法の概要</span><span class="sxs-lookup"><span data-stu-id="aeb87-199">Property Animation Techniques Overview</span></span>](property-animation-techniques-overview.md)
- [<span data-ttu-id="aeb87-200">Freezable オブジェクトの概要</span><span class="sxs-lookup"><span data-stu-id="aeb87-200">Freezable Objects Overview</span></span>](../advanced/freezable-objects-overview.md)
- [<span data-ttu-id="aeb87-201">キー フレーム アニメーションの概要</span><span class="sxs-lookup"><span data-stu-id="aeb87-201">Key-Frame Animations Overview</span></span>](key-frame-animations-overview.md)
- [<span data-ttu-id="aeb87-202">パス アニメーションの概要</span><span class="sxs-lookup"><span data-stu-id="aeb87-202">Path Animations Overview</span></span>](path-animations-overview.md)
- [<span data-ttu-id="aeb87-203">アニメーションの概要</span><span class="sxs-lookup"><span data-stu-id="aeb87-203">Animation Overview</span></span>](animation-overview.md)
- [<span data-ttu-id="aeb87-204">アニメーションとタイミング システムの概要</span><span class="sxs-lookup"><span data-stu-id="aeb87-204">Animation and Timing System Overview</span></span>](animation-and-timing-system-overview.md)
- [<span data-ttu-id="aeb87-205">カスタム アニメーションのサンプル</span><span class="sxs-lookup"><span data-stu-id="aeb87-205">Custom Animation Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)
