---
title: カスタム アニメーションの概要
ms.date: 03/30/2017
helpviewer_keywords:
- custom classes [WPF], animation
- key frames [WPF], custom
- custom key frames [WPF]
- animation [WPF], custom classes
- custom animation classes [WPF]
ms.assetid: 9be69d50-3384-4938-886f-08ce00e4a7a6
ms.openlocfilehash: c5f315992e8ae37bc79602e6986d90e7af591fb2
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/12/2020
ms.locfileid: "79186550"
---
# <a name="custom-animations-overview"></a><span data-ttu-id="e7a7b-102">カスタム アニメーションの概要</span><span class="sxs-lookup"><span data-stu-id="e7a7b-102">Custom Animations Overview</span></span>
<span data-ttu-id="e7a7b-103">このトピックでは、カスタム キー フレームやアニメーション クラスを作成して、またはフレームごとのコールバックを使ってバイパスすることにより、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のアニメーション システムを拡張する方法と、それが必要な状況について説明します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-103">This topic describes how and when to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system by creating custom key frames, animation classes, or by using per-frame callback to bypass it.</span></span>  
  
<a name="prerequisites"></a>
## <a name="prerequisites"></a><span data-ttu-id="e7a7b-104">必須コンポーネント</span><span class="sxs-lookup"><span data-stu-id="e7a7b-104">Prerequisites</span></span>  
 <span data-ttu-id="e7a7b-105">このトピックを理解するには、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] によって提供されるさまざまな種類のアニメーションに精通している必要があります。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-105">To understand this topic, you should be familiar with the different types of animations provided by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span> <span data-ttu-id="e7a7b-106">詳しくは、「From/To/By アニメーションの概要」、「[キー フレーム アニメーションの概要](key-frame-animations-overview.md)」、および「[パス アニメーションの概要](path-animations-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-106">For more information, see the From/To/By Animations Overview, the [Key-Frame Animations Overview](key-frame-animations-overview.md), and the [Path Animations Overview](path-animations-overview.md).</span></span>  
  
 <span data-ttu-id="e7a7b-107">アニメーションのクラスは <xref:System.Windows.Freezable> クラスを継承するため、<xref:System.Windows.Freezable> オブジェクトと、<xref:System.Windows.Freezable> からの継承方法について、理解している必要があります。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-107">Because the animation classes inherit from the <xref:System.Windows.Freezable> class, you should be familiar with <xref:System.Windows.Freezable> objects and how to inherit from <xref:System.Windows.Freezable>.</span></span> <span data-ttu-id="e7a7b-108">詳しくは、「[Freezable オブジェクトの概要](../advanced/freezable-objects-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-108">For more information, see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md).</span></span>  
  
<a name="extendingtheanimationsystem"></a>
## <a name="extending-the-animation-system"></a><span data-ttu-id="e7a7b-109">アニメーション システムの拡張</span><span class="sxs-lookup"><span data-stu-id="e7a7b-109">Extending the Animation System</span></span>  
 <span data-ttu-id="e7a7b-110">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のアニメーション システムには、使う組み込み機能のレベルに応じて、さまざまな拡張方法があります。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-110">There are a number of ways to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system, depending on the level of built-in functionality you want to use.</span></span>  <span data-ttu-id="e7a7b-111">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のアニメーション エンジンには、次の 3 つの主な機能拡張ポイントがあります。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-111">There are three primary extensibility points in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine:</span></span>  
  
- <span data-ttu-id="e7a7b-112">*\<Type>* KeyFrame クラス (<xref:System.Windows.Media.Animation.DoubleKeyFrame> など) の 1 つから継承することにより、カスタム キー フレーム オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-112">Create a custom key frame object by inheriting from one of the *\<Type>* KeyFrame classes, such as <xref:System.Windows.Media.Animation.DoubleKeyFrame>.</span></span> <span data-ttu-id="e7a7b-113">この方法では、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] アニメーション エンジンの組み込み機能のほとんどを使います。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-113">This approach uses most of the built-in functionality of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine.</span></span>  
  
- <span data-ttu-id="e7a7b-114"><xref:System.Windows.Media.Animation.AnimationTimeline> または *\<Type>* AnimationBase クラスの 1 つから継承することにより、独自のアニメーション クラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-114">Create your own animation class by inheriting from <xref:System.Windows.Media.Animation.AnimationTimeline> or one of the *\<Type>* AnimationBase classes.</span></span>  
  
- <span data-ttu-id="e7a7b-115">フレームごとのコールバックを使って、フレームごとにアニメーションを生成します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-115">Use per-frame callback to generate animations on a per-frame basis.</span></span> <span data-ttu-id="e7a7b-116">この方法は、アニメーションおよびタイミング システムを完全にバイパスします。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-116">This approach completely bypasses the animation and timing system.</span></span>  
  
 <span data-ttu-id="e7a7b-117">次の表では、いくつかのアニメーション システム拡張シナリオについて説明します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-117">The following table describes some the scenarios for extending the animation system.</span></span>  
  
|<span data-ttu-id="e7a7b-118">目的...</span><span class="sxs-lookup"><span data-stu-id="e7a7b-118">When you want to...</span></span>|<span data-ttu-id="e7a7b-119">使う方法</span><span class="sxs-lookup"><span data-stu-id="e7a7b-119">Use this approach</span></span>|  
|-------------------------|-----------------------|  
|<span data-ttu-id="e7a7b-120">対応する *\<Type>* AnimationUsingKeyFrames がある型の値の間の補間をカスタマイズする</span><span class="sxs-lookup"><span data-stu-id="e7a7b-120">Customize the interpolation between values of a type that has a corresponding *\<Type>* AnimationUsingKeyFrames</span></span>|<span data-ttu-id="e7a7b-121">カスタム キー フレームを作成します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-121">Create a custom key frame.</span></span> <span data-ttu-id="e7a7b-122">詳しくは、「[カスタム キー フレームを作成する](#createacustomkeyframe)」セクションをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-122">For more information, see the [Create a Custom Key Frame](#createacustomkeyframe) section.</span></span>|  
|<span data-ttu-id="e7a7b-123">対応する *\<Type>* Animation がある型の値の間の補間以外の部分もカスタマイズする</span><span class="sxs-lookup"><span data-stu-id="e7a7b-123">Customize more than just the interpolation between values of a type that has a corresponding *\<Type>* Animation.</span></span>|<span data-ttu-id="e7a7b-124">アニメーション化する型に対応する *\<Type>* AnimationBase クラスを継承するカスタム アニメーション クラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-124">Create a custom animation class that inherits from the *\<Type>* AnimationBase class that corresponds to the type you want to animate.</span></span> <span data-ttu-id="e7a7b-125">詳しくは、「[カスタム アニメーション クラスを作成する](#createacustomanimationtype)」セクションをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-125">For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section.</span></span>|  
|<span data-ttu-id="e7a7b-126">対応する [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] アニメーションがない型をアニメーション化する</span><span class="sxs-lookup"><span data-stu-id="e7a7b-126">Animate a type that has no corresponding [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation</span></span>|<span data-ttu-id="e7a7b-127"><xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> を使用するか、または <xref:System.Windows.Media.Animation.AnimationTimeline> を継承するクラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-127">Use an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> or create a class that inherits from <xref:System.Windows.Media.Animation.AnimationTimeline>.</span></span> <span data-ttu-id="e7a7b-128">詳しくは、「[カスタム アニメーション クラスを作成する](#createacustomanimationtype)」セクションをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-128">For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section.</span></span>|  
|<span data-ttu-id="e7a7b-129">フレームごとに計算され、最後のオブジェクト相互作用セットに基づく値のある、複数のオブジェクトをアニメーション化する</span><span class="sxs-lookup"><span data-stu-id="e7a7b-129">Animate multiple objects with values that are computed each frame and are based on the last set of object interactions</span></span>|<span data-ttu-id="e7a7b-130">フレームごとのコールバックを使います。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-130">Use per-frame callback.</span></span> <span data-ttu-id="e7a7b-131">詳しくは、「[フレームごとのコールバックを使用する](#useperframecallback)」セクションをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-131">For more information, see the [Create a Use Per-Frame Callback](#useperframecallback) section.</span></span>|  
  
<a name="createacustomkeyframe"></a>
## <a name="create-a-custom-key-frame"></a><span data-ttu-id="e7a7b-132">カスタム キー フレームを作成する</span><span class="sxs-lookup"><span data-stu-id="e7a7b-132">Create a Custom Key Frame</span></span>  
 <span data-ttu-id="e7a7b-133">カスタム キー フレーム クラスの作成は、アニメーション システムを拡張する最も簡単な方法です。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-133">Creating a custom key frame class is the simplest way to extend the animation system.</span></span> <span data-ttu-id="e7a7b-134">キー フレーム アニメーションに対して異なる補間方法が必要なときは、このアプローチを使います。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-134">Use this approach when you want to a different interpolation method for a key-frame animation.</span></span>  <span data-ttu-id="e7a7b-135">「[キー フレーム アニメーションの概要](key-frame-animations-overview.md)」で説明されているように、キー フレーム アニメーションはキー フレーム オブジェクトを使って出力値を生成します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-135">As described in the [Key-Frame Animations Overview](key-frame-animations-overview.md), a key-frame animation uses key frame objects to generate its output values.</span></span> <span data-ttu-id="e7a7b-136">各キー フレーム オブジェクトは 3 つの機能を実行します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-136">Each key frame object performs three functions:</span></span>  
  
- <span data-ttu-id="e7a7b-137"><xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> プロパティを使用してターゲット値を指定します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-137">Specifies a target value using its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property.</span></span>  
  
- <span data-ttu-id="e7a7b-138"><xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A> プロパティを使用して、その値に到達する必要がある時間を指定します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-138">Specifies the time at which that value should be reached using its <xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A> property.</span></span>  
  
- <span data-ttu-id="e7a7b-139">InterpolateValueCore メソッドを実装することで、前のキー フレームの値とそれ自体の値の間を補間します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-139">Interpolates between the value of the previous key frame and its own value by implementing the InterpolateValueCore method.</span></span>  
  
 <span data-ttu-id="e7a7b-140">**実装の説明**</span><span class="sxs-lookup"><span data-stu-id="e7a7b-140">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="e7a7b-141">*\<Type>* KeyFrame 抽象クラスから派生して、InterpolateValueCore メソッドを実装します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-141">Derive from the *\<Type>* KeyFrame abstract class and implement the InterpolateValueCore method.</span></span> <span data-ttu-id="e7a7b-142">InterpolateValueCore メソッドは、キー フレームの現在の値を返します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-142">The InterpolateValueCore method returns the current value of the key frame.</span></span> <span data-ttu-id="e7a7b-143">2 つのパラメーターとして、前のキー フレームの値と、0 から 1 の範囲の進行状況の値を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-143">It takes two parameters: the value of the previous key frame and a progress value that ranges from 0 to 1.</span></span> <span data-ttu-id="e7a7b-144">進行状況 0 はキー フレームが開始したばかりであることを示し、値 1 はキー フレームが完了したばかりで、<xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> プロパティによって指定されている値を返す必要があることを示します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-144">A progress of 0 indicates the key frame has just started, and a value of 1 indicates that the key frame has just completed and should return the value specified by its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property.</span></span>  
  
 <span data-ttu-id="e7a7b-145">*\<Type>* KeyFrame クラスは <xref:System.Windows.Freezable> クラスを継承するため、独自クラスの新しいインスタンスを返すように、<xref:System.Windows.Freezable.CreateInstanceCore%2A> コアもオーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-145">Because the *\<Type>* KeyFrame classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class.</span></span> <span data-ttu-id="e7a7b-146">クラスが依存関係プロパティを使ってデータを保存しない場合、または作成の後で追加の初期化が必要な場合は、他のメソッドのオーバーライドが必要な場合があります。詳しくは、「[Freezable オブジェクトの概要](../advanced/freezable-objects-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-146">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="e7a7b-147">カスタム *\<Type>* KeyFrame アニメーションを作成した後は、その型の *\<Type>* AnimationUsingKeyFrames でそれを使うことができます。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-147">After you've created your custom *\<Type>* KeyFrame animation, you can use it with the *\<Type>* AnimationUsingKeyFrames for that type.</span></span>  
  
<a name="createacustomanimationtype"></a>
## <a name="create-a-custom-animation-class"></a><span data-ttu-id="e7a7b-148">カスタム アニメーション クラスを作成する</span><span class="sxs-lookup"><span data-stu-id="e7a7b-148">Create a Custom Animation Class</span></span>  
 <span data-ttu-id="e7a7b-149">独自のアニメーション型を作成すると、オブジェクトをアニメーション化する方法をいっそう細かく制御できます。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-149">Creating your own animation type gives you more control over how an object in animated.</span></span> <span data-ttu-id="e7a7b-150">独自のアニメーション型を作成するには、2 つの推奨される方法があります。<xref:System.Windows.Media.Animation.AnimationTimeline> クラスから派生する方法と、 *\<Type>* AnimationBase クラスから派生する方法です。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-150">There are two recommended ways to create your own animation type: you can derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class or the *\<Type>* AnimationBase class.</span></span> <span data-ttu-id="e7a7b-151">*\<Type>* Animation クラスまたは *\<Type>* AnimationUsingKeyFrames クラスからの派生は推奨されません。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-151">Deriving from the *\<Type>* Animation or *\<Type>* AnimationUsingKeyFrames classes is not recommended.</span></span>  
  
### <a name="derive-from-typeanimationbase"></a><span data-ttu-id="e7a7b-152">\<Type>AnimationBase から派生する</span><span class="sxs-lookup"><span data-stu-id="e7a7b-152">Derive from \<Type>AnimationBase</span></span>  
 <span data-ttu-id="e7a7b-153">*\<Type>* AnimationBase クラスからの派生は、新しいアニメーション型を作成する最も簡単な方法です。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-153">Deriving from a *\<Type>* AnimationBase class is the simplest way to create a new animation type.</span></span> <span data-ttu-id="e7a7b-154">対応する *\<Type>* AnimationBase クラスが既にある型の新しいアニメーションを作成する場合は、この方法を使います。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-154">Use this approach when you want to create a new animation for type that already has a corresponding *\<Type>* AnimationBase class.</span></span>  
  
 <span data-ttu-id="e7a7b-155">**実装の説明**</span><span class="sxs-lookup"><span data-stu-id="e7a7b-155">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="e7a7b-156">*\<Type>* Animation から派生して、GetCurrentValueCore メソッドを実装します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-156">Derive from a *\<Type>* Animation class and implement the GetCurrentValueCore method.</span></span> <span data-ttu-id="e7a7b-157">GetCurrentValueCore メソッドは、アニメーションの現在の値を返します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-157">The GetCurrentValueCore method returns the current value of the animation.</span></span> <span data-ttu-id="e7a7b-158">これは、3 つのパラメーターとして、推奨される開始値、推奨される終了値、およびアニメーションの進行状況を特定するために使用する <xref:System.Windows.Media.Animation.AnimationClock> を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-158">It takes three parameters: a suggested starting value, a suggested ending value, and an <xref:System.Windows.Media.Animation.AnimationClock>, which you use to determine the progress of the animation.</span></span>  
  
 <span data-ttu-id="e7a7b-159">*\<Type>* AnimationBase クラスは <xref:System.Windows.Freezable> クラスを継承するため、独自クラスの新しいインスタンスを返すように、<xref:System.Windows.Freezable.CreateInstanceCore%2A> コアもオーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-159">Because the *\<Type>* AnimationBase classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class.</span></span> <span data-ttu-id="e7a7b-160">クラスが依存関係プロパティを使ってデータを保存しない場合、または作成の後で追加の初期化が必要な場合は、他のメソッドのオーバーライドが必要な場合があります。詳しくは、「[Freezable オブジェクトの概要](../advanced/freezable-objects-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-160">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="e7a7b-161">詳しくは、アニメーション化する型の *\<Type>* AnimationBase クラスの GetCurrentValueCore メソッドのドキュメントをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-161">For more information, see the GetCurrentValueCore method documentation for the *\<Type>* AnimationBase class for the type that you want to animate.</span></span> <span data-ttu-id="e7a7b-162">例については、「[Custom Animation Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)」(カスタム アニメーションのサンプル) をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-162">For an example, see the [Custom Animation Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)</span></span>  
  
 <span data-ttu-id="e7a7b-163">**別の方法**</span><span class="sxs-lookup"><span data-stu-id="e7a7b-163">**Alternative Approaches**</span></span>  
  
 <span data-ttu-id="e7a7b-164">アニメーション値を補間する方法を変更したいだけの場合は、いずれかの *\<Type>* KeyFrame クラスからの派生を検討します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-164">If you simply want to change how animation values are interpolated, considering deriving from one of the *\<Type>* KeyFrame classes.</span></span> <span data-ttu-id="e7a7b-165">作成したキー フレームを、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] によって提供される対応する *\<Type>* AnimationUsingKeyFrames で使うことができます。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-165">The key frame you create can be used with the corresponding *\<Type>* AnimationUsingKeyFrames provided by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
### <a name="derive-from-animationtimeline"></a><span data-ttu-id="e7a7b-166">AnimationTimeline から派生する</span><span class="sxs-lookup"><span data-stu-id="e7a7b-166">Derive from AnimationTimeline</span></span>  
 <span data-ttu-id="e7a7b-167">一致する [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] アニメーションがまだ存在しない型のアニメーションを作成する場合、または厳密に型指定されていないアニメーションを作成したい場合は、<xref:System.Windows.Media.Animation.AnimationTimeline> クラスから派生します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-167">Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class when you want to create an animation for a type that doesn't already have a matching [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation, or you want to create an animation that is not strongly typed.</span></span>  
  
 <span data-ttu-id="e7a7b-168">**実装の説明**</span><span class="sxs-lookup"><span data-stu-id="e7a7b-168">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="e7a7b-169"><xref:System.Windows.Media.Animation.AnimationTimeline> クラスから派生して、次のメンバーをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-169">Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class and override the following members:</span></span>  
  
- <span data-ttu-id="e7a7b-170"><xref:System.Windows.Freezable.CreateInstanceCore%2A> – 新しいクラスが具象の場合、クラスの新しいインスタンスを返すように <xref:System.Windows.Freezable.CreateInstanceCore%2A> をオーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-170"><xref:System.Windows.Freezable.CreateInstanceCore%2A> – If your new class is concrete, you must override <xref:System.Windows.Freezable.CreateInstanceCore%2A> to return a new instance of your class.</span></span>  
  
- <span data-ttu-id="e7a7b-171"><xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> – アニメーションの現在の値を返すように、このメソッドをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-171"><xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> – Override this method to return the current value of your animation.</span></span> <span data-ttu-id="e7a7b-172">既定の開始値、既定の終了値、<xref:System.Windows.Media.Animation.AnimationClock> の、3 つのパラメーターを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-172">It takes three parameters: a default origin value, a default destination value, and an <xref:System.Windows.Media.Animation.AnimationClock>.</span></span> <span data-ttu-id="e7a7b-173">アニメーションの現在の時間または進行状況を取得するには、<xref:System.Windows.Media.Animation.AnimationClock> を使用します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-173">Use the <xref:System.Windows.Media.Animation.AnimationClock> to obtain the current time or progress for the animation.</span></span> <span data-ttu-id="e7a7b-174">既定の開始値と終了値を使うかどうかを選択できます。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-174">You can choose whether to use the default origin and destination values.</span></span>  
  
- <span data-ttu-id="e7a7b-175"><xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> – <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> メソッドによって指定された既定の終了値をアニメーションで使用するかどうかを示すために、このプロパティをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-175"><xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> – Override this property to indicate whether your animation uses the default destination value specified by the <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> method.</span></span>  
  
- <span data-ttu-id="e7a7b-176"><xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> – アニメーションが生成する出力の <xref:System.Type> を示すように、このプロパティをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-176"><xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> – Override this property to indicate the <xref:System.Type> of output your animation produces.</span></span>  
  
 <span data-ttu-id="e7a7b-177">クラスが依存関係プロパティを使ってデータを保存しない場合、または作成の後で追加の初期化が必要な場合は、他のメソッドのオーバーライドが必要な場合があります。詳しくは、「[Freezable オブジェクトの概要](../advanced/freezable-objects-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-177">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="e7a7b-178">推奨される ([!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] アニメーションによって使われる) パラダイムは、2 つの継承レベルを使うことです。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-178">The recommended paradigm (used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animations) is to use two inheritance levels:</span></span>  
  
1. <span data-ttu-id="e7a7b-179"><xref:System.Windows.Media.Animation.AnimationTimeline> から派生する抽象 *\<Type>* AnimationBase クラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-179">Create an abstract *\<Type>* AnimationBase class that derives from <xref:System.Windows.Media.Animation.AnimationTimeline>.</span></span> <span data-ttu-id="e7a7b-180">このクラスでは、<xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> メソッドをオーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-180">This class should override the <xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> method.</span></span> <span data-ttu-id="e7a7b-181">また、新しい抽象メソッド GetCurrentValueCore を導入し、既定の開始値と終了値パラメーターの型を検証してから GetCurrentValueCore を呼び出すように <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> をオーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-181">It should also introduce a new abstract method, GetCurrentValueCore, and override <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> so that it validates the types of the default origin value and default destination value parameters, then calls GetCurrentValueCore.</span></span>  
  
2. <span data-ttu-id="e7a7b-182">新しい *\<Type>* AnimationBase クラスから継承し、<xref:System.Windows.Freezable.CreateInstanceCore%2A> メソッド、導入した GetCurrentValueCore メソッド、<xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> プロパティをオーバーライドする、別のクラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-182">Create another class that inherits from your new *\<Type>* AnimationBase class and overrides the <xref:System.Windows.Freezable.CreateInstanceCore%2A> method, the GetCurrentValueCore method that you introduced, and the <xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> property.</span></span>  
  
 <span data-ttu-id="e7a7b-183">**別の方法**</span><span class="sxs-lookup"><span data-stu-id="e7a7b-183">**Alternative Approaches**</span></span>  
  
 <span data-ttu-id="e7a7b-184">対応する From/To/By アニメーションまたはキー フレーム アニメーションがない型をアニメーション化する場合は、<xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> の使用を検討します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-184">If you want to animate a type that has no corresponding From/To/By animation or key-frame animation, consider using an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>.</span></span> <span data-ttu-id="e7a7b-185"><xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>は弱く型指定されているため、任意の型の値をアニメーション化できます。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-185">Because it is weakly typed, an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> can animate any type of value.</span></span> <span data-ttu-id="e7a7b-186">この方法の欠点は、<xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> が離散補間のみをサポートすることです。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-186">The drawback to this approach is that <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> only supports discrete interpolation.</span></span>  
  
<a name="useperframecallback"></a>
## <a name="use-per-frame-callback"></a><span data-ttu-id="e7a7b-187">フレームごとのコールバックを使用する</span><span class="sxs-lookup"><span data-stu-id="e7a7b-187">Use Per-Frame Callback</span></span>  
 <span data-ttu-id="e7a7b-188">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] アニメーション システムを完全にバイパスする必要があるときは、この方法を使います。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-188">Use this approach when you need to completely bypass the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system.</span></span> <span data-ttu-id="e7a7b-189">この方法の 1 つのシナリオは、各アニメーション ステップでオブジェクトの最後の一連のやり取りに基づいてアニメーション化されるオブジェクトの新しい向きまたは位置を再計算する必要がある物理アニメーションです。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-189">One scenario for this approach is physics animations, where at each animation step a new direction or position of animated objects needs to be recomputed based on the  last set of object interactions.</span></span>  
  
 <span data-ttu-id="e7a7b-190">**実装の説明**</span><span class="sxs-lookup"><span data-stu-id="e7a7b-190">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="e7a7b-191">この概要で説明されている他の方法とは異なり、フレームごとのコールバックを使うために、カスタム アニメーション クラスまたはカスタム キー フレーム クラスを作成する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-191">Unlike the other approaches described in this overview, to use per-frame callback you don't need to create a custom animation or key frame class.</span></span>  
  
 <span data-ttu-id="e7a7b-192">代わりに、アニメーション化するオブジェクトを格納しているオブジェクトの <xref:System.Windows.Media.CompositionTarget.Rendering> イベントに登録します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-192">Instead, you register for the <xref:System.Windows.Media.CompositionTarget.Rendering> event of the object that contains the objects you want to animate.</span></span> <span data-ttu-id="e7a7b-193">このイベント ハンドラー メソッドは、フレームごとに 1 回呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-193">This event handler method gets called once per frame.</span></span> <span data-ttu-id="e7a7b-194">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] がビジュアル ツリーの永続化されたレンダリング データを構成ツリーにマーシャリングするたびに、イベント ハンドラー メソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-194">Each time that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] marshals the persisted rendering data in the visual tree across to the composition tree, your event handler method is called.</span></span>  
  
 <span data-ttu-id="e7a7b-195">イベント ハンドラーでは、アニメーション効果に必要なあらゆる計算を実行し、これらの値を使用してアニメーション化するオブジェクトのプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-195">In your event handler, perform your whatever calculations necessary for your animation effect and set the properties of the objects you want to animate with these values.</span></span>  
  
 <span data-ttu-id="e7a7b-196">現在のフレームの表現時間を取得するために、このイベントに関連付けられている <xref:System.EventArgs> を、<xref:System.Windows.Media.RenderingEventArgs> としてキャストできます。これにより、現在のフレームのレンダリング時間を取得するために使用できる <xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A> プロパティが提供されます。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-196">To obtain the presentation time of the current frame, the <xref:System.EventArgs> associated with this event can be cast as <xref:System.Windows.Media.RenderingEventArgs>, which provide a <xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A> property that you can use to obtain the current frame's rendering time.</span></span>  
  
 <span data-ttu-id="e7a7b-197">詳細については、「<xref:System.Windows.Media.CompositionTarget.Rendering>」ページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="e7a7b-197">For more information, see the <xref:System.Windows.Media.CompositionTarget.Rendering> page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e7a7b-198">関連項目</span><span class="sxs-lookup"><span data-stu-id="e7a7b-198">See also</span></span>

- <xref:System.Windows.Media.Animation.AnimationTimeline>
- <xref:System.Windows.Media.Animation.IKeyFrame>
- [<span data-ttu-id="e7a7b-199">プロパティ アニメーションの手法の概要</span><span class="sxs-lookup"><span data-stu-id="e7a7b-199">Property Animation Techniques Overview</span></span>](property-animation-techniques-overview.md)
- [<span data-ttu-id="e7a7b-200">Freezable オブジェクトの概要</span><span class="sxs-lookup"><span data-stu-id="e7a7b-200">Freezable Objects Overview</span></span>](../advanced/freezable-objects-overview.md)
- [<span data-ttu-id="e7a7b-201">キー フレーム アニメーションの概要</span><span class="sxs-lookup"><span data-stu-id="e7a7b-201">Key-Frame Animations Overview</span></span>](key-frame-animations-overview.md)
- [<span data-ttu-id="e7a7b-202">パス アニメーションの概要</span><span class="sxs-lookup"><span data-stu-id="e7a7b-202">Path Animations Overview</span></span>](path-animations-overview.md)
- [<span data-ttu-id="e7a7b-203">アニメーションの概要</span><span class="sxs-lookup"><span data-stu-id="e7a7b-203">Animation Overview</span></span>](animation-overview.md)
- [<span data-ttu-id="e7a7b-204">アニメーションとタイミング システムの概要</span><span class="sxs-lookup"><span data-stu-id="e7a7b-204">Animation and Timing System Overview</span></span>](animation-and-timing-system-overview.md)
- [<span data-ttu-id="e7a7b-205">カスタム アニメーションのサンプル</span><span class="sxs-lookup"><span data-stu-id="e7a7b-205">Custom Animation Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)
