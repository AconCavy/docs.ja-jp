---
title: コマンド実行の概要
description: Windows Presentation Foundation の入力メカニズムである、コマンド実行について学習します。これにより、デバイス入力よりいっそうセマンティックなレベルでの入力処理が提供されます。
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- interfaces [WPF], ICommandSource
- command library [WPF]
- commands [WPF], definition of
- CommandBindings [WPF]
- ICommandSource interfaces [WPF]
- commanding [WPF]
- CommandManager [WPF]
ms.assetid: bc208dfe-367d-426a-99de-52b7e7511e81
ms.openlocfilehash: 4f7d12fbf0de9b1546f15061ab7eb1318378bbbb
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/24/2020
ms.locfileid: "87168128"
---
# <a name="commanding-overview"></a><span data-ttu-id="508dc-103">コマンド実行の概要</span><span class="sxs-lookup"><span data-stu-id="508dc-103">Commanding Overview</span></span>
<a name="introduction"></a> <span data-ttu-id="508dc-104">コマンド実行は [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] の入力メカニズムであり、デバイス入力よりいっそうセマンティックなレベルでの入力処理を提供します。</span><span class="sxs-lookup"><span data-stu-id="508dc-104">Commanding is an input mechanism in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] which provides input handling at a more semantic level than device input.</span></span> <span data-ttu-id="508dc-105">コマンドの例は、多くのアプリケーションで見られる**コピー**、**切り取り**、**貼り付け**などの操作です。</span><span class="sxs-lookup"><span data-stu-id="508dc-105">Examples of commands are the **Copy**, **Cut**, and **Paste** operations found on many applications.</span></span>  
  
 <span data-ttu-id="508dc-106">この概要では、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] でのコマンドとはどういうものか、コマンド実行モデルに含まれるクラス、アプリケーションでコマンドを作成して使用する方法を定義します。</span><span class="sxs-lookup"><span data-stu-id="508dc-106">This overview defines what commands are in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], which classes are part of the commanding model, and how to use and create commands in your applications.</span></span>  
  
 <span data-ttu-id="508dc-107">このトピックは、次のセクションで構成されています。</span><span class="sxs-lookup"><span data-stu-id="508dc-107">This topic contains the following sections:</span></span>  
  
- [<span data-ttu-id="508dc-108">コマンドとは</span><span class="sxs-lookup"><span data-stu-id="508dc-108">What Are Commands?</span></span>](#commands_at_10000_feet)  
  
- [<span data-ttu-id="508dc-109">WPF での簡単なコマンドの例</span><span class="sxs-lookup"><span data-stu-id="508dc-109">Simple Command Example in WPF</span></span>](#simple_command)  
  
- [<span data-ttu-id="508dc-110">WPF のコマンド実行における 4 つの主要な概念</span><span class="sxs-lookup"><span data-stu-id="508dc-110">Four Main Concepts in WPF Commanding</span></span>](#Four_main_Concepts)  
  
- [<span data-ttu-id="508dc-111">コマンド ライブラリ</span><span class="sxs-lookup"><span data-stu-id="508dc-111">Command Library</span></span>](#Command_Library)  
  
- [<span data-ttu-id="508dc-112">カスタム コマンドの作成</span><span class="sxs-lookup"><span data-stu-id="508dc-112">Creating Custom Commands</span></span>](#creating_commands)  
  
<a name="commands_at_10000_feet"></a>
## <a name="what-are-commands"></a><span data-ttu-id="508dc-113">コマンドとは</span><span class="sxs-lookup"><span data-stu-id="508dc-113">What Are Commands?</span></span>  
 <span data-ttu-id="508dc-114">コマンドには、いくつかの目的があります。</span><span class="sxs-lookup"><span data-stu-id="508dc-114">Commands have several purposes.</span></span> <span data-ttu-id="508dc-115">第 1 の目的は、コマンドを呼び出すセマンティクスとオブジェクトを、コマンドを実行するロジックから分離することです。</span><span class="sxs-lookup"><span data-stu-id="508dc-115">The first purpose is to separate the semantics and the object that invokes a command from the logic that executes the command.</span></span> <span data-ttu-id="508dc-116">これにより、複数の異なるソースから同じコマンド ロジックを呼び出すことができ、異なるターゲットに合わせてコマンド ロジックをカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="508dc-116">This allows for multiple and disparate sources to invoke the same command logic, and it allows the command logic to be customized for different targets.</span></span> <span data-ttu-id="508dc-117">たとえば、多くのアプリケーションで使われる編集操作である**コピー**、**切り取り**、**貼り付け**は、コマンドを使って実装されていれば、異なるユーザー アクションを使って呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="508dc-117">For example, the editing operations **Copy**, **Cut**, and **Paste**, which are found in many applications, can be invoked by using different user actions if they are implemented by using commands.</span></span> <span data-ttu-id="508dc-118">ユーザーは、ボタンをクリックして、メニューの項目を選択して、または Ctrl + X などのキーの組み合わせを使って、選んだオブジェクトやテキストを切り取ることができます。</span><span class="sxs-lookup"><span data-stu-id="508dc-118">An application might allow a user to cut selected objects or text by either clicking a button, choosing an item in a menu, or using a key combination, such as CTRL+X.</span></span> <span data-ttu-id="508dc-119">コマンドを使うことにより、各種のユーザー アクションを同じロジックにバインドできます。</span><span class="sxs-lookup"><span data-stu-id="508dc-119">By using commands, you can bind each type of user action to the same logic.</span></span>  
  
 <span data-ttu-id="508dc-120">コマンドのもう 1 つの目的は、アクションを実行できるかどうかを示すことです。</span><span class="sxs-lookup"><span data-stu-id="508dc-120">Another purpose of commands is to indicate whether an action is available.</span></span> <span data-ttu-id="508dc-121">再びオブジェクトやテキストの切り取りを例にすると、アクションは何かを選択したときにのみ意味があります。</span><span class="sxs-lookup"><span data-stu-id="508dc-121">To continue the example of cutting an object or text, the action only makes sense when something is selected.</span></span> <span data-ttu-id="508dc-122">何も選ばないでオブジェクトまたはテキストを切り取ろうとすると、何も起こりません。</span><span class="sxs-lookup"><span data-stu-id="508dc-122">If a user tries to cut an object or text without having anything selected, nothing would happen.</span></span> <span data-ttu-id="508dc-123">ユーザーにこのことを示すため、多くのアプリケーションでは、ボタンやメニュー項目を無効にして、アクションを実行できるかどうかをユーザーが認識できるようにしています。</span><span class="sxs-lookup"><span data-stu-id="508dc-123">To indicate this to the user, many applications disable buttons and menu items so that the user knows whether it is possible to perform an action.</span></span> <span data-ttu-id="508dc-124">コマンドでは、<xref:System.Windows.Input.ICommand.CanExecute%2A> メソッドを実装することで、アクションが実行可能かどうかを示すことができます。</span><span class="sxs-lookup"><span data-stu-id="508dc-124">A command can indicate whether an action is possible by implementing the <xref:System.Windows.Input.ICommand.CanExecute%2A> method.</span></span> <span data-ttu-id="508dc-125">ボタンは、<xref:System.Windows.Input.ICommand.CanExecuteChanged> イベントをサブスクライブでき、<xref:System.Windows.Input.ICommand.CanExecute%2A> で `false` が返された場合は無効に、<xref:System.Windows.Input.ICommand.CanExecute%2A> で `true` が返された場合は有効にできます。</span><span class="sxs-lookup"><span data-stu-id="508dc-125">A button can subscribe to the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event and be disabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `false` or be enabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `true`.</span></span>  
  
 <span data-ttu-id="508dc-126">コマンドのセマンティクスはアプリケーションおよびクラス全体で統一できますが、アクションのロジックは対象となる特定のオブジェクトに固有です。</span><span class="sxs-lookup"><span data-stu-id="508dc-126">The semantics of a command can be consistent across applications and classes, but the logic of the action is specific to the particular object acted upon.</span></span> <span data-ttu-id="508dc-127">キーの組み合わせ Ctrl + X キーはテキスト クラス、イメージ クラス、Web ブラウザーの**切り取り**コマンドを呼び出しますが、**切り取り**操作を実行する実際のロジックは、切り取りを実行するアプリケーションによって定義されています。</span><span class="sxs-lookup"><span data-stu-id="508dc-127">The key combination CTRL+X invokes the **Cut** command in text classes, image classes, and Web browsers, but the actual logic for performing the **Cut** operation is defined by the application that performs the cut.</span></span> <span data-ttu-id="508dc-128"><xref:System.Windows.Input.RoutedCommand> では、クライアントでロジックを実装できます。</span><span class="sxs-lookup"><span data-stu-id="508dc-128">A <xref:System.Windows.Input.RoutedCommand> enables clients to implement the logic.</span></span> <span data-ttu-id="508dc-129">テキスト オブジェクトは選択されたテキストを切り取ってクリップボードに移動できるのに対し、イメージ オブジェクトは選択されたイメージを切り取ることができます。</span><span class="sxs-lookup"><span data-stu-id="508dc-129">A text object may cut the selected text into the clipboard, while an image object may cut the selected image.</span></span> <span data-ttu-id="508dc-130">アプリケーションは、<xref:System.Windows.Input.CommandManager.Executed> イベントを処理するときに、コマンドのターゲットにアクセスし、ターゲットの種類に応じた適切なアクションを実行できます。</span><span class="sxs-lookup"><span data-stu-id="508dc-130">When an application handles the <xref:System.Windows.Input.CommandManager.Executed> event, it has access to the target of the command and can take appropriate action depending on the target's type.</span></span>  
  
<a name="simple_command"></a>
## <a name="simple-command-example-in-wpf"></a><span data-ttu-id="508dc-131">WPF での簡単なコマンドの例</span><span class="sxs-lookup"><span data-stu-id="508dc-131">Simple Command Example in WPF</span></span>  
 <span data-ttu-id="508dc-132">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] でコマンドを使う最も簡単な方法は、いずれかのコマンド ライブラリ クラスの定義済みの <xref:System.Windows.Input.RoutedCommand> を使用するか、コマンドの処理をネイティブにサポートするコントロールを使用するか、コマンドの呼び出しをネイティブにサポートするコントロールを使用することです。</span><span class="sxs-lookup"><span data-stu-id="508dc-132">The simplest way to use a command in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is to use a predefined <xref:System.Windows.Input.RoutedCommand> from one of the command library classes; use a control that has native support for handling the command; and use a control that has native support for invoking a command.</span></span>  <span data-ttu-id="508dc-133"><xref:System.Windows.Input.ApplicationCommands.Paste%2A> コマンドは、<xref:System.Windows.Input.ApplicationCommands> クラスで定義済みのコマンドのいずれかです。</span><span class="sxs-lookup"><span data-stu-id="508dc-133">The <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is one of the predefined commands in the <xref:System.Windows.Input.ApplicationCommands> class.</span></span>  <span data-ttu-id="508dc-134"><xref:System.Windows.Controls.TextBox> コントロールには、<xref:System.Windows.Input.ApplicationCommands.Paste%2A> コマンドを処理するためのロジックが組み込まれています。</span><span class="sxs-lookup"><span data-stu-id="508dc-134">The <xref:System.Windows.Controls.TextBox> control has built in logic for handling the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command.</span></span>  <span data-ttu-id="508dc-135"><xref:System.Windows.Controls.MenuItem> クラスはコマンドの呼び出しをネイティブにサポートします。</span><span class="sxs-lookup"><span data-stu-id="508dc-135">And the <xref:System.Windows.Controls.MenuItem> class has native support for invoking commands.</span></span>  
  
 <span data-ttu-id="508dc-136">次に示すのは、<xref:System.Windows.Controls.TextBox> にキーボード フォーカスがある場合に、クリックされたときに <xref:System.Windows.Controls.TextBox> で <xref:System.Windows.Input.ApplicationCommands.Paste%2A> コマンドを呼び出すように <xref:System.Windows.Controls.MenuItem> を設定する方法の例です。</span><span class="sxs-lookup"><span data-stu-id="508dc-136">The following example shows how to set up a <xref:System.Windows.Controls.MenuItem> so that when it is clicked it will invoke the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command on a <xref:System.Windows.Controls.TextBox>, assuming the <xref:System.Windows.Controls.TextBox> has keyboard focus.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewSimpleCommand](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewsimplecommand)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Four_main_Concepts"></a>
## <a name="four-main-concepts-in-wpf-commanding"></a><span data-ttu-id="508dc-137">WPF のコマンド実行における 4 つの主要な概念</span><span class="sxs-lookup"><span data-stu-id="508dc-137">Four Main Concepts in WPF Commanding</span></span>  
 <span data-ttu-id="508dc-138">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のルーティング コマンド モデルは、コマンド、コマンド ソース、コマンド ターゲット、コマンド バインディングという 4 つの主要な概念に分けることができます。</span><span class="sxs-lookup"><span data-stu-id="508dc-138">The routed command model in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can be broken up into four main concepts: the command, the command source, the command target, and the command binding:</span></span>  
  
- <span data-ttu-id="508dc-139">"*コマンド*" は、実行するアクションです。</span><span class="sxs-lookup"><span data-stu-id="508dc-139">The *command* is the action to be executed.</span></span>  
  
- <span data-ttu-id="508dc-140">"*コマンド ソース*" は、コマンドを呼び出すオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="508dc-140">The *command source* is the object which invokes the command.</span></span>  
  
- <span data-ttu-id="508dc-141">"*コマンド ターゲット*" は、コマンドが実行されているオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="508dc-141">The *command target* is the object that the command is being executed on.</span></span>  
  
- <span data-ttu-id="508dc-142">"*コマンド バインディング*" は、コマンド ロジックをコマンドにマップするオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="508dc-142">The *command binding* is the object which maps the command logic to the command.</span></span>  
  
 <span data-ttu-id="508dc-143">前の例では、<xref:System.Windows.Input.ApplicationCommands.Paste%2A> コマンドがコマンド、<xref:System.Windows.Controls.MenuItem> がコマンド ソース、<xref:System.Windows.Controls.TextBox> がコマンド ターゲットで、コマンド バインドは <xref:System.Windows.Controls.TextBox> コントロールによって提供されます。</span><span class="sxs-lookup"><span data-stu-id="508dc-143">In the previous example, the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is the command, the <xref:System.Windows.Controls.MenuItem> is the command source, the <xref:System.Windows.Controls.TextBox> is the command target, and the command binding is supplied by the <xref:System.Windows.Controls.TextBox> control.</span></span>  <span data-ttu-id="508dc-144">注意しなければならないのは、<xref:System.Windows.Input.CommandBinding> はコマンド ターゲット クラスであるコントロールによって常に提供されるわけではないということです。</span><span class="sxs-lookup"><span data-stu-id="508dc-144">It is worth noting that it is not always the case that the <xref:System.Windows.Input.CommandBinding> is supplied by the control that is the command target class.</span></span>  <span data-ttu-id="508dc-145">多くの場合は、アプリケーション開発者が <xref:System.Windows.Input.CommandBinding> を作成する必要があるか、または <xref:System.Windows.Input.CommandBinding> はコマンド ターゲットの先祖に関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="508dc-145">Quite often the <xref:System.Windows.Input.CommandBinding> must be created by the application developer, or the <xref:System.Windows.Input.CommandBinding> might be attached to an ancestor of the command target.</span></span>  
  
<a name="Commands"></a>
### <a name="commands"></a><span data-ttu-id="508dc-146">コマンド</span><span class="sxs-lookup"><span data-stu-id="508dc-146">Commands</span></span>  
 <span data-ttu-id="508dc-147">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のコマンドは、<xref:System.Windows.Input.ICommand> インターフェイスを実装することで作成されます。</span><span class="sxs-lookup"><span data-stu-id="508dc-147">Commands in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are created by implementing the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="508dc-148"><xref:System.Windows.Input.ICommand> では、2 つのメソッド (<xref:System.Windows.Input.ICommand.Execute%2A> と <xref:System.Windows.Input.ICommand.CanExecute%2A>)、およびイベント (<xref:System.Windows.Input.ICommand.CanExecuteChanged>) を公開します。</span><span class="sxs-lookup"><span data-stu-id="508dc-148"><xref:System.Windows.Input.ICommand> exposes two methods, <xref:System.Windows.Input.ICommand.Execute%2A>, and <xref:System.Windows.Input.ICommand.CanExecute%2A>, and an event, <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span></span> <span data-ttu-id="508dc-149"><xref:System.Windows.Input.ICommand.Execute%2A> では、コマンドに関連付けられているアクションを実行します。</span><span class="sxs-lookup"><span data-stu-id="508dc-149"><xref:System.Windows.Input.ICommand.Execute%2A> performs the actions that are associated with the command.</span></span> <span data-ttu-id="508dc-150"><xref:System.Windows.Input.ICommand.CanExecute%2A> では、現在のコマンド ターゲットでコマンドを実行できるかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="508dc-150"><xref:System.Windows.Input.ICommand.CanExecute%2A> determines whether the command can execute on the current command target.</span></span> <span data-ttu-id="508dc-151">コマンド実行操作を集中管理するコマンド マネージャーが、既に発生しているがコマンド バインドによってまだ実行されていないコマンドを無効にする可能性のある変更をコマンド ソースで検出した場合、<xref:System.Windows.Input.ICommand.CanExecuteChanged> が発生します。</span><span class="sxs-lookup"><span data-stu-id="508dc-151"><xref:System.Windows.Input.ICommand.CanExecuteChanged> is raised if the command manager that centralizes the commanding operations detects a change in the command source that might invalidate a command that has been raised but not yet executed by the command binding.</span></span>  <span data-ttu-id="508dc-152"><xref:System.Windows.Input.ICommand> での [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] の実装は <xref:System.Windows.Input.RoutedCommand> クラスであり、この概要の焦点になります。</span><span class="sxs-lookup"><span data-stu-id="508dc-152">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of <xref:System.Windows.Input.ICommand> is the <xref:System.Windows.Input.RoutedCommand> class and is the focus of this overview.</span></span>  
  
 <span data-ttu-id="508dc-153">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] での主な入力ソースは、マウス、キーボード、インク、およびルーティング コマンドです。</span><span class="sxs-lookup"><span data-stu-id="508dc-153">The main sources of input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the mouse, the keyboard, ink, and routed commands.</span></span>  <span data-ttu-id="508dc-154">デバイス指向性の高い入力では、<xref:System.Windows.RoutedEvent> を使って、入力イベントが発生したことをアプリケーション ページのオブジェクトに通知します。</span><span class="sxs-lookup"><span data-stu-id="508dc-154">The more device-oriented inputs use a <xref:System.Windows.RoutedEvent> to notify objects in an application page that an input event has occurred.</span></span>  <span data-ttu-id="508dc-155"><xref:System.Windows.Input.RoutedCommand> も同様です。</span><span class="sxs-lookup"><span data-stu-id="508dc-155">A <xref:System.Windows.Input.RoutedCommand> is no different.</span></span>  <span data-ttu-id="508dc-156"><xref:System.Windows.Input.RoutedCommand> の <xref:System.Windows.Input.RoutedCommand.Execute%2A> メソッドと <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> メソッドにはコマンドのアプリケーション ロジックは含まれませんが、これらのメソッドが発生させたルーティング イベントは、<xref:System.Windows.Input.CommandBinding> を含むオブジェクトに遭遇するまで、要素ツリー内をトンネリングおよびバブリングします。</span><span class="sxs-lookup"><span data-stu-id="508dc-156">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> and <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> methods of a <xref:System.Windows.Input.RoutedCommand> do not contain the application logic for the command, but rather they raise routed events that tunnel and bubble through the element tree until they encounter an object with a <xref:System.Windows.Input.CommandBinding>.</span></span>  <span data-ttu-id="508dc-157"><xref:System.Windows.Input.CommandBinding> にはこれらのイベント用のハンドラーが含まれ、そのハンドラーがコマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="508dc-157">The <xref:System.Windows.Input.CommandBinding> contains the handlers for these events and it is the handlers that perform the command.</span></span>  <span data-ttu-id="508dc-158">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] でのルーティング イベントについて詳しくは、「[ルーティング イベントの概要](routed-events-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="508dc-158">For more information on event routing in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="508dc-159"><xref:System.Windows.Input.RoutedCommand> の <xref:System.Windows.Input.RoutedCommand.Execute%2A> メソッドは、コマンド ターゲットで <xref:System.Windows.Input.CommandManager.PreviewExecuted> イベントと <xref:System.Windows.Input.CommandManager.Executed> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="508dc-159">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.PreviewExecuted> and the <xref:System.Windows.Input.CommandManager.Executed> events on the command target.</span></span>  <span data-ttu-id="508dc-160"><xref:System.Windows.Input.RoutedCommand> の <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> メソッドは、コマンド ターゲットで <xref:System.Windows.Input.CommandManager.CanExecute> イベントと <xref:System.Windows.Input.CommandManager.PreviewCanExecute> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="508dc-160">The <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.CanExecute> and <xref:System.Windows.Input.CommandManager.PreviewCanExecute> events on the command target.</span></span>  <span data-ttu-id="508dc-161">これらのイベントは、その特定のコマンドの <xref:System.Windows.Input.CommandBinding> を持つオブジェクトに遭遇するまで、要素ツリー内をトンネリングおよびバブリングします。</span><span class="sxs-lookup"><span data-stu-id="508dc-161">These events tunnel and bubble through the element tree until they encounter an object which has a <xref:System.Windows.Input.CommandBinding> for that particular command.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="508dc-162">では、<xref:System.Windows.Input.MediaCommands>、<xref:System.Windows.Input.ApplicationCommands>、<xref:System.Windows.Input.NavigationCommands>、<xref:System.Windows.Input.ComponentCommands>、<xref:System.Windows.Documents.EditingCommands> などの複数のクラスにわたる共通のルーティング コマンドのセットが提供されます。</span><span class="sxs-lookup"><span data-stu-id="508dc-162">supplies a set of common routed commands spread across several classes: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands>, and <xref:System.Windows.Documents.EditingCommands>.</span></span>  <span data-ttu-id="508dc-163">これらのクラスは <xref:System.Windows.Input.RoutedCommand> オブジェクトのみで構成され、コマンドの実装ロジックは含みません。</span><span class="sxs-lookup"><span data-stu-id="508dc-163">These classes consist only of the <xref:System.Windows.Input.RoutedCommand> objects and not the implementation logic of the command.</span></span>  <span data-ttu-id="508dc-164">実装ロジックは、コマンドが実行されるオブジェクトに存在します。</span><span class="sxs-lookup"><span data-stu-id="508dc-164">The implementation logic is the responsibility of the object on which the command is being executed on.</span></span>  
  
<a name="Command_Sources"></a>
### <a name="command-sources"></a><span data-ttu-id="508dc-165">コマンド ソース</span><span class="sxs-lookup"><span data-stu-id="508dc-165">Command Sources</span></span>  
 <span data-ttu-id="508dc-166">コマンド ソースは、コマンドを呼び出すオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="508dc-166">A command source is the object which invokes the command.</span></span>  <span data-ttu-id="508dc-167">コマンド ソースの例は、<xref:System.Windows.Controls.MenuItem>、<xref:System.Windows.Controls.Button>、<xref:System.Windows.Input.KeyGesture> などです。</span><span class="sxs-lookup"><span data-stu-id="508dc-167">Examples of command sources are <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button>, and <xref:System.Windows.Input.KeyGesture>.</span></span>  
  
 <span data-ttu-id="508dc-168">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のコマンド ソースでは、通常、<xref:System.Windows.Input.ICommandSource> インターフェイスを実装します。</span><span class="sxs-lookup"><span data-stu-id="508dc-168">Command sources in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] generally implement the <xref:System.Windows.Input.ICommandSource> interface.</span></span>  
  
 <span data-ttu-id="508dc-169"><xref:System.Windows.Input.ICommandSource> では、<xref:System.Windows.Input.ICommandSource.Command%2A>、<xref:System.Windows.Input.ICommandSource.CommandTarget%2A>、<xref:System.Windows.Input.ICommandSource.CommandParameter%2A> という 3 つのプロパティを公開します。</span><span class="sxs-lookup"><span data-stu-id="508dc-169"><xref:System.Windows.Input.ICommandSource> exposes three properties: <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, and <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:</span></span>  
  
- <span data-ttu-id="508dc-170"><xref:System.Windows.Input.ICommandSource.Command%2A> は、コマンド ソースが呼び出されたときに実行されるコマンドです。</span><span class="sxs-lookup"><span data-stu-id="508dc-170"><xref:System.Windows.Input.ICommandSource.Command%2A> is the command to execute when the command source is invoked.</span></span>  
  
- <span data-ttu-id="508dc-171"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A> は、コマンドを実行するオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="508dc-171"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is the object on which to execute the command.</span></span>  <span data-ttu-id="508dc-172">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] では、<xref:System.Windows.Input.ICommandSource> の <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> プロパティは、<xref:System.Windows.Input.ICommand> が <xref:System.Windows.Input.RoutedCommand> である場合にのみ適用可能であることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="508dc-172">It is worth noting that in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="508dc-173"><xref:System.Windows.Input.ICommandSource> で <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> が設定されていて、対応するコマンドが <xref:System.Windows.Input.RoutedCommand> ではない場合、コマンド ターゲットは無視されます。</span><span class="sxs-lookup"><span data-stu-id="508dc-173">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span> <span data-ttu-id="508dc-174"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A> が設定されていない場合は、キーボード フォーカスを持つ要素がコマンド ターゲットになります。</span><span class="sxs-lookup"><span data-stu-id="508dc-174">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is not set, the element with keyboard focus will be the command target.</span></span>  
  
- <span data-ttu-id="508dc-175"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A> は、コマンドを実装しているハンドラーに情報を渡すために使われるユーザー定義データ型です。</span><span class="sxs-lookup"><span data-stu-id="508dc-175"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A> is a user-defined data type used to pass information to the handlers implementing the command.</span></span>  
  
 <span data-ttu-id="508dc-176"><xref:System.Windows.Input.ICommandSource> を実装する [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] クラスは、<xref:System.Windows.Controls.Primitives.ButtonBase>、<xref:System.Windows.Controls.MenuItem>、<xref:System.Windows.Documents.Hyperlink>、<xref:System.Windows.Input.InputBinding> です。</span><span class="sxs-lookup"><span data-stu-id="508dc-176">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes that implement <xref:System.Windows.Input.ICommandSource> are <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink>, and <xref:System.Windows.Input.InputBinding>.</span></span>  <span data-ttu-id="508dc-177"><xref:System.Windows.Controls.Primitives.ButtonBase>、<xref:System.Windows.Controls.MenuItem>、<xref:System.Windows.Documents.Hyperlink> は、クリックされたときにコマンドを呼び出します。<xref:System.Windows.Input.InputBinding> は、関連付けられている <xref:System.Windows.Input.InputGesture> が実行されたときにコマンドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="508dc-177"><xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, and <xref:System.Windows.Documents.Hyperlink> invoke a command when they are clicked, and an <xref:System.Windows.Input.InputBinding> invokes a command when the <xref:System.Windows.Input.InputGesture> associated with it is performed.</span></span>  
  
 <span data-ttu-id="508dc-178">次の例では、<xref:System.Windows.Input.ApplicationCommands.Properties%2A> コマンドのコマンド ソースとして、<xref:System.Windows.Controls.ContextMenu> で <xref:System.Windows.Controls.MenuItem> を使用する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="508dc-178">The following example shows how to use a <xref:System.Windows.Controls.MenuItem> in a <xref:System.Windows.Controls.ContextMenu> as a command source for the <xref:System.Windows.Input.ApplicationCommands.Properties%2A> command.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewCmdSourceXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewcmdsourcexaml)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCmdSource](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcmdsource)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCmdSource](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcmdsource)]  
  
 <span data-ttu-id="508dc-179">通常、コマンド ソースは <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> イベントをリッスンします。</span><span class="sxs-lookup"><span data-stu-id="508dc-179">Typically, a command source will listen to the <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> event.</span></span>  <span data-ttu-id="508dc-180">このイベントは、現在のコマンド ターゲットでのコマンド実行機能が変化した可能性があることを、コマンド ソースに通知します。</span><span class="sxs-lookup"><span data-stu-id="508dc-180">This event informs the command source that the ability of the command to execute on the current command target may have changed.</span></span>  <span data-ttu-id="508dc-181">コマンド ソースは、<xref:System.Windows.Input.RoutedCommand> の現在の状態を、<xref:System.Windows.Input.RoutedCommand.CanExecute%2A> メソッドを使って照会できます。</span><span class="sxs-lookup"><span data-stu-id="508dc-181">The command source can query the current status of the <xref:System.Windows.Input.RoutedCommand> by using the <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method.</span></span>  <span data-ttu-id="508dc-182">コマンドを実行できない場合、コマンド ソースはそれ自体を無効にできます。</span><span class="sxs-lookup"><span data-stu-id="508dc-182">The command source can then disable itself if the command cannot execute.</span></span>  <span data-ttu-id="508dc-183">たとえば、コマンドを実行できない場合、<xref:System.Windows.Controls.MenuItem> はそれ自体を灰色で表示します。</span><span class="sxs-lookup"><span data-stu-id="508dc-183">An example of this is a <xref:System.Windows.Controls.MenuItem> graying itself out when a command cannot execute.</span></span>  
  
 <span data-ttu-id="508dc-184"><xref:System.Windows.Input.InputGesture> はコマンド ソースとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="508dc-184">An <xref:System.Windows.Input.InputGesture> can be used as a command source.</span></span>  <span data-ttu-id="508dc-185">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] の 2 種類の入力ジェスチャは、<xref:System.Windows.Input.KeyGesture> と <xref:System.Windows.Input.MouseGesture> です。</span><span class="sxs-lookup"><span data-stu-id="508dc-185">Two types of input gestures in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the <xref:System.Windows.Input.KeyGesture> and <xref:System.Windows.Input.MouseGesture>.</span></span>  <span data-ttu-id="508dc-186"><xref:System.Windows.Input.KeyGesture> は、Ctrl + C キーなどのキーボード ショートカットと考えることができます。</span><span class="sxs-lookup"><span data-stu-id="508dc-186">You can think of a <xref:System.Windows.Input.KeyGesture> as a keyboard shortcut, such as CTRL+C.</span></span>  <span data-ttu-id="508dc-187"><xref:System.Windows.Input.KeyGesture> は、<xref:System.Windows.Input.Key> と、<xref:System.Windows.Input.ModifierKeys> のセットで構成されます。</span><span class="sxs-lookup"><span data-stu-id="508dc-187">A <xref:System.Windows.Input.KeyGesture> is comprised of a <xref:System.Windows.Input.Key> and a set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  <span data-ttu-id="508dc-188"><xref:System.Windows.Input.MouseGesture> は、<xref:System.Windows.Input.MouseAction> と、オプションの <xref:System.Windows.Input.ModifierKeys> のセットで構成されます。</span><span class="sxs-lookup"><span data-stu-id="508dc-188">A <xref:System.Windows.Input.MouseGesture> is comprised of a <xref:System.Windows.Input.MouseAction> and an optional set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  
  
 <span data-ttu-id="508dc-189"><xref:System.Windows.Input.InputGesture> がコマンド ソースとして機能するためには、コマンドと関連付けられる必要があります。</span><span class="sxs-lookup"><span data-stu-id="508dc-189">In order for an <xref:System.Windows.Input.InputGesture> to act as a command source, it must be associated with a command.</span></span> <span data-ttu-id="508dc-190">これを実現するにはいくつかの方法があります。</span><span class="sxs-lookup"><span data-stu-id="508dc-190">There are a few ways to accomplish this.</span></span>  <span data-ttu-id="508dc-191">1 つ目は、<xref:System.Windows.Input.InputBinding> を使用する方法です。</span><span class="sxs-lookup"><span data-stu-id="508dc-191">One way is to use an <xref:System.Windows.Input.InputBinding>.</span></span>  
  
 <span data-ttu-id="508dc-192"><xref:System.Windows.Input.KeyGesture> と <xref:System.Windows.Input.RoutedCommand> の間に <xref:System.Windows.Input.KeyBinding> を作成する方法の例を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="508dc-192">The following example shows how to create a <xref:System.Windows.Input.KeyBinding> between a <xref:System.Windows.Input.KeyGesture> and a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLKeyBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlkeybinding)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeybinding)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyBinding](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeybinding)]  
  
 <span data-ttu-id="508dc-193"><xref:System.Windows.Input.InputGesture> を <xref:System.Windows.Input.RoutedCommand> に関連付けるもう 1 つの方法は、<xref:System.Windows.Input.RoutedCommand> の <xref:System.Windows.Input.InputGestureCollection> に <xref:System.Windows.Input.InputGesture> を追加するというものです。</span><span class="sxs-lookup"><span data-stu-id="508dc-193">Another way to associate an <xref:System.Windows.Input.InputGesture> to a <xref:System.Windows.Input.RoutedCommand> is to add the <xref:System.Windows.Input.InputGesture> to the <xref:System.Windows.Input.InputGestureCollection> on the <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 <span data-ttu-id="508dc-194"><xref:System.Windows.Input.RoutedCommand> の <xref:System.Windows.Input.InputGestureCollection> に <xref:System.Windows.Input.KeyGesture> を追加する方法を次の例に示します。</span><span class="sxs-lookup"><span data-stu-id="508dc-194">The following example shows how to add a <xref:System.Windows.Input.KeyGesture> to the <xref:System.Windows.Input.InputGestureCollection> of a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeygestureoncmd)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeygestureoncmd)]  
  
<a name="Command_Binding"></a>
### <a name="commandbinding"></a><span data-ttu-id="508dc-195">CommandBinding</span><span class="sxs-lookup"><span data-stu-id="508dc-195">CommandBinding</span></span>  
 <span data-ttu-id="508dc-196"><xref:System.Windows.Input.CommandBinding> は、コマンドと、そのコマンドを実装するイベント ハンドラーを関連付けます。</span><span class="sxs-lookup"><span data-stu-id="508dc-196">A <xref:System.Windows.Input.CommandBinding> associates a command with the event handlers that implement the command.</span></span>  
  
 <span data-ttu-id="508dc-197"><xref:System.Windows.Input.CommandBinding> クラスには、<xref:System.Windows.Input.CommandBinding.Command%2A> プロパティと、<xref:System.Windows.Input.CommandBinding.PreviewExecuted>、<xref:System.Windows.Input.CommandBinding.Executed>、<xref:System.Windows.Input.CommandBinding.PreviewCanExecute>、<xref:System.Windows.Input.CommandBinding.CanExecute> イベントが含まれます。</span><span class="sxs-lookup"><span data-stu-id="508dc-197">The <xref:System.Windows.Input.CommandBinding> class contains a <xref:System.Windows.Input.CommandBinding.Command%2A> property, and <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute>, and <xref:System.Windows.Input.CommandBinding.CanExecute> events.</span></span>  
  
 <span data-ttu-id="508dc-198"><xref:System.Windows.Input.CommandBinding.Command%2A> は、<xref:System.Windows.Input.CommandBinding> が関連付けられているコマンドです。</span><span class="sxs-lookup"><span data-stu-id="508dc-198"><xref:System.Windows.Input.CommandBinding.Command%2A> is the command that the <xref:System.Windows.Input.CommandBinding> is being associated with.</span></span>  <span data-ttu-id="508dc-199"><xref:System.Windows.Input.CommandBinding.PreviewExecuted> および <xref:System.Windows.Input.CommandBinding.Executed> イベントに関連付けられているイベント ハンドラーは、コマンド ロジックを実装します。</span><span class="sxs-lookup"><span data-stu-id="508dc-199">The event handlers which are attached to the <xref:System.Windows.Input.CommandBinding.PreviewExecuted> and <xref:System.Windows.Input.CommandBinding.Executed> events implement the command logic.</span></span>  <span data-ttu-id="508dc-200"><xref:System.Windows.Input.CommandBinding.PreviewCanExecute> および <xref:System.Windows.Input.CommandBinding.CanExecute> イベントに関連付けられているイベント ハンドラーは、現在のコマンド ターゲットでコマンドを実行できるかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="508dc-200">The event handlers attached to the <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> and <xref:System.Windows.Input.CommandBinding.CanExecute> events determine if the command can execute on the current command target.</span></span>  
  
 <span data-ttu-id="508dc-201">アプリケーションのルート <xref:System.Windows.Window> で <xref:System.Windows.Input.CommandBinding> を作成する方法の例を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="508dc-201">The following example shows how to create a <xref:System.Windows.Input.CommandBinding> on the root <xref:System.Windows.Window> of an application.</span></span>  <span data-ttu-id="508dc-202"><xref:System.Windows.Input.CommandBinding> は、<xref:System.Windows.Input.ApplicationCommands.Open%2A> コマンドと、<xref:System.Windows.Input.CommandManager.Executed> および <xref:System.Windows.Input.CommandBinding.CanExecute> ハンドラーを関連付けます。</span><span class="sxs-lookup"><span data-stu-id="508dc-202">The <xref:System.Windows.Input.CommandBinding> associates the <xref:System.Windows.Input.ApplicationCommands.Open%2A> command with <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandBinding.CanExecute> handlers.</span></span>  
  
 [!code-xaml[commandwithhandler#CommandHandlerCommandBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml#commandhandlercommandbinding)]  
  
 [!code-csharp[CommandHandlerProcedural#CommandHandlerBindingInit](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandHandlerProcedural/CSharp/Window1.xaml.cs#commandhandlerbindinginit)]
 [!code-vb[CommandHandlerProcedural#CommandHandlerBindingInit](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandHandlerProcedural/visualbasic/window1.xaml.vb#commandhandlerbindinginit)]  
  
 <span data-ttu-id="508dc-203">次に、<xref:System.Windows.Input.ExecutedRoutedEventHandler> と <xref:System.Windows.Input.CanExecuteRoutedEventHandler> が作成されます。</span><span class="sxs-lookup"><span data-stu-id="508dc-203">Next, the <xref:System.Windows.Input.ExecutedRoutedEventHandler> and a <xref:System.Windows.Input.CanExecuteRoutedEventHandler> are created.</span></span>  <span data-ttu-id="508dc-204"><xref:System.Windows.Input.ExecutedRoutedEventHandler> は、コマンドが実行されたことを知らせる文字列を表示する <xref:System.Windows.MessageBox> を開きます。</span><span class="sxs-lookup"><span data-stu-id="508dc-204">The <xref:System.Windows.Input.ExecutedRoutedEventHandler> opens a <xref:System.Windows.MessageBox> that displays a string saying the command has been executed.</span></span>  <span data-ttu-id="508dc-205"><xref:System.Windows.Input.CanExecuteRoutedEventHandler> は、<xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> プロパティを `true` に設定します。</span><span class="sxs-lookup"><span data-stu-id="508dc-205">The <xref:System.Windows.Input.CanExecuteRoutedEventHandler> sets the <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> property to `true`.</span></span>  
  
 [!code-csharp[commandwithhandler#CommandHandlerExecutedHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlerexecutedhandler)]
 [!code-vb[commandwithhandler#CommandHandlerExecutedHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlerexecutedhandler)]  
  
 [!code-csharp[commandwithhandler#CommandHandlerCanExecuteHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlercanexecutehandler)]
 [!code-vb[commandwithhandler#CommandHandlerCanExecuteHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlercanexecutehandler)]  
  
 <span data-ttu-id="508dc-206"><xref:System.Windows.Input.CommandBinding> は、アプリケーションやコントロールのルート <xref:System.Windows.Window> など、特定のオブジェクトに関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="508dc-206">A <xref:System.Windows.Input.CommandBinding> is attached to a specific object, such as the root <xref:System.Windows.Window> of the application or a control.</span></span>  <span data-ttu-id="508dc-207"><xref:System.Windows.Input.CommandBinding> が関連付けられるオブジェクトにより、バインドのスコープが定義されます。</span><span class="sxs-lookup"><span data-stu-id="508dc-207">The object that the <xref:System.Windows.Input.CommandBinding> is attached to defines the scope of the binding.</span></span>  <span data-ttu-id="508dc-208">たとえば、<xref:System.Windows.Input.CommandBinding.Executed> イベントは、コマンド ターゲットの先祖に関連付けられた <xref:System.Windows.Input.CommandBinding> には到達できますが、コマンド ターゲットの子孫に関連付けられた <xref:System.Windows.Input.CommandBinding> には到達できません。</span><span class="sxs-lookup"><span data-stu-id="508dc-208">For example, a <xref:System.Windows.Input.CommandBinding> attached to an ancestor of the command target can be reached by the <xref:System.Windows.Input.CommandBinding.Executed> event, but a <xref:System.Windows.Input.CommandBinding> attached to a descendant of the command target cannot be reached.</span></span>  <span data-ttu-id="508dc-209">これは、イベントを発生させたオブジェクトからの <xref:System.Windows.RoutedEvent> のトンネリングとバブリングの方法の直接的な結果です。</span><span class="sxs-lookup"><span data-stu-id="508dc-209">This is a direct consequence of the way a <xref:System.Windows.RoutedEvent> tunnels and bubbles from the object that raises the event.</span></span>  
  
 <span data-ttu-id="508dc-210">状況によっては、<xref:System.Windows.Input.CommandBinding> は、<xref:System.Windows.Controls.TextBox> クラスや <xref:System.Windows.Input.ApplicationCommands.Cut%2A>、<xref:System.Windows.Input.ApplicationCommands.Copy%2A>、<xref:System.Windows.Input.ApplicationCommands.Paste%2A> コマンドなど、コマンド ターゲット自体に関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="508dc-210">In some situations the <xref:System.Windows.Input.CommandBinding> is attached to the command target itself, such as with the <xref:System.Windows.Controls.TextBox> class and the <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, and <xref:System.Windows.Input.ApplicationCommands.Paste%2A> commands.</span></span> <span data-ttu-id="508dc-211">ただし、ほとんどの場合は、メイン <xref:System.Windows.Window> や Application オブジェクトなど、コマンド ターゲットの先祖に <xref:System.Windows.Input.CommandBinding> を関連付ける方が便利です。同じ <xref:System.Windows.Input.CommandBinding> を複数のコマンド ターゲットに使うことができる場合は特にそうです。</span><span class="sxs-lookup"><span data-stu-id="508dc-211">Quite often though, it is more convenient to attach the <xref:System.Windows.Input.CommandBinding> to an ancestor of the command target, such as the main <xref:System.Windows.Window> or the Application object, especially if the same <xref:System.Windows.Input.CommandBinding> can be used for multiple command targets.</span></span>  <span data-ttu-id="508dc-212">これらは、コマンド実行のインフラストラクチャを作成するときに考慮する設計上の決定です。</span><span class="sxs-lookup"><span data-stu-id="508dc-212">These are design decisions you will want to consider when you are creating your commanding infrastructure.</span></span>  
  
<a name="Commane_Target"></a>
### <a name="command-target"></a><span data-ttu-id="508dc-213">コマンド ターゲット</span><span class="sxs-lookup"><span data-stu-id="508dc-213">Command Target</span></span>  
 <span data-ttu-id="508dc-214">コマンド ターゲットは、コマンドが実行される要素です。</span><span class="sxs-lookup"><span data-stu-id="508dc-214">The command target is the element on which the command is executed.</span></span>  <span data-ttu-id="508dc-215"><xref:System.Windows.Input.RoutedCommand> の場合、コマンド ターゲットは、<xref:System.Windows.Input.CommandManager.Executed> および <xref:System.Windows.Input.CommandManager.CanExecute> のルーティングが開始される要素です。</span><span class="sxs-lookup"><span data-stu-id="508dc-215">With regards to a <xref:System.Windows.Input.RoutedCommand>, the command target is the element at which routing of the <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandManager.CanExecute> starts.</span></span>  <span data-ttu-id="508dc-216">前述のとおり、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] では、<xref:System.Windows.Input.ICommandSource> の <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> プロパティは、<xref:System.Windows.Input.ICommand> が <xref:System.Windows.Input.RoutedCommand> である場合にのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="508dc-216">As noted previously, in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="508dc-217"><xref:System.Windows.Input.ICommandSource> で <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> が設定されていて、対応するコマンドが <xref:System.Windows.Input.RoutedCommand> ではない場合、コマンド ターゲットは無視されます。</span><span class="sxs-lookup"><span data-stu-id="508dc-217">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span>  
  
 <span data-ttu-id="508dc-218">コマンド ソースは、コマンド ターゲットを明示的に設定できます。</span><span class="sxs-lookup"><span data-stu-id="508dc-218">The command source can explicitly set the command target.</span></span>  <span data-ttu-id="508dc-219">コマンド ターゲットが定義されていない場合は、キーボード フォーカスを持つ要素がコマンド ターゲットとして使われます。</span><span class="sxs-lookup"><span data-stu-id="508dc-219">If the command target is not defined, the element with keyboard focus will be used as the command target.</span></span>  <span data-ttu-id="508dc-220">キーボード フォーカスを持つ要素をコマンド ターゲットとして使うことの、アプリケーション開発者にとっての利点の 1 つは、コマンド ターゲットを追跡しなくても、同じコマンド ソースを使って、複数のターゲットでコマンドを呼び出すことができることです。</span><span class="sxs-lookup"><span data-stu-id="508dc-220">One of the benefits of using the element with keyboard focus as the command target is that it allows the application developer to use the same command source to invoke a command on multiple targets without having to keep track of the command target.</span></span>  <span data-ttu-id="508dc-221">たとえば、<xref:System.Windows.Controls.MenuItem> が <xref:System.Windows.Controls.TextBox> コントロールと <xref:System.Windows.Controls.PasswordBox> コントロールのあるアプリケーションの**貼り付け**コマンドを呼び出した場合、どちらのコントロールにキーボード フォーカスがあるかに応じて、ターゲットは <xref:System.Windows.Controls.TextBox> または <xref:System.Windows.Controls.PasswordBox> になります。</span><span class="sxs-lookup"><span data-stu-id="508dc-221">For example, if a <xref:System.Windows.Controls.MenuItem> invokes the **Paste** command in an application that has a <xref:System.Windows.Controls.TextBox> control and a <xref:System.Windows.Controls.PasswordBox> control, the target can be either the <xref:System.Windows.Controls.TextBox> or <xref:System.Windows.Controls.PasswordBox> depending on which control has keyboard focus.</span></span>  
  
 <span data-ttu-id="508dc-222">次の例では、マークアップおよび分離コードでコマンド ターゲットを明示的に設定する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="508dc-222">The following example shows how to explicitly set the command target in markup and in code behind.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLCommandTarget](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlcommandtarget)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Command_Manager"></a>
### <a name="the-commandmanager"></a><span data-ttu-id="508dc-223">CommandManager</span><span class="sxs-lookup"><span data-stu-id="508dc-223">The CommandManager</span></span>  
 <span data-ttu-id="508dc-224"><xref:System.Windows.Input.CommandManager> は、コマンドに関連する複数の関数を提供します。</span><span class="sxs-lookup"><span data-stu-id="508dc-224">The <xref:System.Windows.Input.CommandManager> serves a number of command related functions.</span></span>  <span data-ttu-id="508dc-225">特定の要素の <xref:System.Windows.Input.CommandManager.PreviewExecuted>、<xref:System.Windows.Input.CommandManager.Executed>、<xref:System.Windows.Input.CommandManager.PreviewCanExecute>、<xref:System.Windows.Input.CommandManager.CanExecute> イベント ハンドラーを追加および削除するための、静的メソッドのセットを提供します。</span><span class="sxs-lookup"><span data-stu-id="508dc-225">It provides a set of static methods for adding and removing <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute>, and <xref:System.Windows.Input.CommandManager.CanExecute> event handlers to and from a specific element.</span></span>  <span data-ttu-id="508dc-226"><xref:System.Windows.Input.CommandBinding> および <xref:System.Windows.Input.InputBinding> オブジェクトを特定のクラスに登録するための手段を提供します。</span><span class="sxs-lookup"><span data-stu-id="508dc-226">It provides a means to register <xref:System.Windows.Input.CommandBinding> and <xref:System.Windows.Input.InputBinding> objects onto a specific class.</span></span>  <span data-ttu-id="508dc-227">また、<xref:System.Windows.Input.CommandManager> は、<xref:System.Windows.Input.ICommand.CanExecuteChanged> イベントを発生させる必要があるタイミングをコマンドに通知する手段を、<xref:System.Windows.Input.CommandManager.RequerySuggested> イベントによって提供します。</span><span class="sxs-lookup"><span data-stu-id="508dc-227">The <xref:System.Windows.Input.CommandManager> also provides a means, through the <xref:System.Windows.Input.CommandManager.RequerySuggested> event, to notify a command when it should raise the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event.</span></span>  
  
 <span data-ttu-id="508dc-228"><xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> メソッドは、<xref:System.Windows.Input.CommandManager> に <xref:System.Windows.Input.CommandManager.RequerySuggested> イベントを強制的に発生させます。</span><span class="sxs-lookup"><span data-stu-id="508dc-228">The <xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> method forces the <xref:System.Windows.Input.CommandManager> to raise the <xref:System.Windows.Input.CommandManager.RequerySuggested> event.</span></span>  <span data-ttu-id="508dc-229">これは、コマンドを無効または有効にする必要がある状況であっても、<xref:System.Windows.Input.CommandManager> がそれを認識しない場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="508dc-229">This is useful for conditions that should disable/enable a command but are not conditions that the <xref:System.Windows.Input.CommandManager> is aware of.</span></span>  
  
<a name="Command_Library"></a>
## <a name="command-library"></a><span data-ttu-id="508dc-230">コマンド ライブラリ</span><span class="sxs-lookup"><span data-stu-id="508dc-230">Command Library</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="508dc-231">には、定義済みのコマンドのセットが用意されています。</span><span class="sxs-lookup"><span data-stu-id="508dc-231">provides a set of predefined commands.</span></span>  <span data-ttu-id="508dc-232">コマンド ライブラリは、<xref:System.Windows.Input.ApplicationCommands>、<xref:System.Windows.Input.NavigationCommands>、<xref:System.Windows.Input.MediaCommands>、<xref:System.Windows.Documents.EditingCommands>、<xref:System.Windows.Input.ComponentCommands> というクラスで構成されています。</span><span class="sxs-lookup"><span data-stu-id="508dc-232">The command library consists of the following classes: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands>, and the <xref:System.Windows.Input.ComponentCommands>.</span></span>  <span data-ttu-id="508dc-233">これらのクラスでは、<xref:System.Windows.Input.ApplicationCommands.Cut%2A>、<xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> と <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>、<xref:System.Windows.Input.MediaCommands.Play%2A>、<xref:System.Windows.Input.MediaCommands.Stop%2A>、<xref:System.Windows.Input.MediaCommands.Pause%2A> などのコマンドが提供されます。</span><span class="sxs-lookup"><span data-stu-id="508dc-233">These classes provide commands such as <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> and <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A>, and <xref:System.Windows.Input.MediaCommands.Pause%2A>.</span></span>  
  
 <span data-ttu-id="508dc-234">これらのコマンドの多くには、既定の入力バインディングのセットが含まれます。</span><span class="sxs-lookup"><span data-stu-id="508dc-234">Many of these commands include a set of default input bindings.</span></span>  <span data-ttu-id="508dc-235">たとえば、アプリケーションがコピー コマンドを処理することを指定すると、キーボード バインディング "Ctrl + C" が自動的に有効になります。また、タブレット PC のペン ジェスチャや音声情報などの他の入力デバイスに対するバインディングも有効になります。</span><span class="sxs-lookup"><span data-stu-id="508dc-235">For example, if you specify that your application handles the copy command, you automatically get the keyboard binding "CTRL+C" You also get bindings for other input devices, such as Tablet PC pen gestures and speech information.</span></span>  
  
 <span data-ttu-id="508dc-236">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] を使ってさまざまなコマンド ライブラリのコマンドを参照するときは、通常、静的なコマンド プロパティを公開するライブラリ クラスのクラス名を省略できます。</span><span class="sxs-lookup"><span data-stu-id="508dc-236">When you reference commands in the various command libraries using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can usually omit the class name of the library class that exposes the static command property.</span></span> <span data-ttu-id="508dc-237">一般に、コマンド名に文字列としての曖昧さはなく、所有する型は、コマンドの論理グループを提供するために存在しますが、曖昧さの解消のためには必要ありません。</span><span class="sxs-lookup"><span data-stu-id="508dc-237">Generally, the command names are unambiguous as strings, and the owning types exist to provide a logical grouping of commands but are not necessary for disambiguation.</span></span> <span data-ttu-id="508dc-238">たとえば、詳細な `Command="ApplicationCommands.Cut"` ではなく`Command="Cut"` と指定できます。</span><span class="sxs-lookup"><span data-stu-id="508dc-238">For instance, you can specify `Command="Cut"` rather than the more verbose `Command="ApplicationCommands.Cut"`.</span></span> <span data-ttu-id="508dc-239">これは、コマンドに対する [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] プロセッサに組み込まれた便利なメカニズムです (つまり、これは <xref:System.Windows.Input.ICommand> の型コンバーターの動作であり、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] プロセッサは読み込み時にこれを参照します)。</span><span class="sxs-lookup"><span data-stu-id="508dc-239">This is a convenience mechanism that is built in to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor for commands (more precisely, it is a type converter behavior of <xref:System.Windows.Input.ICommand>, which the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor references at load time).</span></span>  
  
<a name="creating_commands"></a>
## <a name="creating-custom-commands"></a><span data-ttu-id="508dc-240">カスタム コマンドの作成</span><span class="sxs-lookup"><span data-stu-id="508dc-240">Creating Custom Commands</span></span>  
 <span data-ttu-id="508dc-241">コマンド ライブラリ クラスのコマンドがニーズを満たさない場合は、独自のコマンドを作成できます。</span><span class="sxs-lookup"><span data-stu-id="508dc-241">If the commands in the command library classes do not meet your needs, then you can create your own commands.</span></span>  <span data-ttu-id="508dc-242">カスタム コマンドを作成するには 2 つの方法があります。</span><span class="sxs-lookup"><span data-stu-id="508dc-242">There are two ways to create a custom command.</span></span>  <span data-ttu-id="508dc-243">1 つは、一から始めて <xref:System.Windows.Input.ICommand> インターフェイスを実装する方法です。</span><span class="sxs-lookup"><span data-stu-id="508dc-243">The first is to start from the ground up and implement the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="508dc-244">もう 1 つのさらに一般的な方法は、<xref:System.Windows.Input.RoutedCommand> または <xref:System.Windows.Input.RoutedUICommand> を作成するものです。</span><span class="sxs-lookup"><span data-stu-id="508dc-244">The other way, and the more common approach, is to create a <xref:System.Windows.Input.RoutedCommand> or a <xref:System.Windows.Input.RoutedUICommand>.</span></span>  
  
 <span data-ttu-id="508dc-245">カスタムの <xref:System.Windows.Input.RoutedCommand> を作成する例については、「[Create a Custom RoutedCommand Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand)」 (カスタム RoutedCommand の作成のサンプル) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="508dc-245">For an example of creating a custom <xref:System.Windows.Input.RoutedCommand>, see [Create a Custom RoutedCommand Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="508dc-246">関連項目</span><span class="sxs-lookup"><span data-stu-id="508dc-246">See also</span></span>

- <xref:System.Windows.Input.RoutedCommand>
- <xref:System.Windows.Input.CommandBinding>
- <xref:System.Windows.Input.InputBinding>
- <xref:System.Windows.Input.CommandManager>
- [<span data-ttu-id="508dc-247">入力の概要</span><span class="sxs-lookup"><span data-stu-id="508dc-247">Input Overview</span></span>](input-overview.md)
- [<span data-ttu-id="508dc-248">ルーティング イベントの概要</span><span class="sxs-lookup"><span data-stu-id="508dc-248">Routed Events Overview</span></span>](routed-events-overview.md)
- [<span data-ttu-id="508dc-249">ICommandSource を実装する</span><span class="sxs-lookup"><span data-stu-id="508dc-249">Implement ICommandSource</span></span>](how-to-implement-icommandsource.md)
- <span data-ttu-id="508dc-250">[方法: メニュー アイテムにコマンドを追加する](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms741839(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="508dc-250">[How to: Add a Command to a MenuItem](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms741839(v=vs.90))</span></span>
- [<span data-ttu-id="508dc-251">カスタム RoutedCommand の作成のサンプル</span><span class="sxs-lookup"><span data-stu-id="508dc-251">Create a Custom RoutedCommand Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand)
