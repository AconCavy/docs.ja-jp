---
title: プロパティ値の継承
ms.date: 03/30/2017
helpviewer_keywords:
- inheritance [WPF], property values
- value inheritance [WPF]
- properties [WPF], value inheritance
ms.assetid: d7c338f9-f2bf-48ed-832c-7be58ac390e4
ms.openlocfilehash: b63f307d9edffd14315d383d8e06419fa141aee1
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/12/2020
ms.locfileid: "79187186"
---
# <a name="property-value-inheritance"></a><span data-ttu-id="bec86-102">プロパティ値の継承</span><span class="sxs-lookup"><span data-stu-id="bec86-102">Property Value Inheritance</span></span>
<span data-ttu-id="bec86-103">プロパティ値の継承は、[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] プロパティ システムの機能です。</span><span class="sxs-lookup"><span data-stu-id="bec86-103">Property value inheritance is a feature of the [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] property system.</span></span> <span data-ttu-id="bec86-104">プロパティ値の継承により、要素のツリー内の子要素は、親要素から特定のプロパティの値を取得できます。これは、最も近い親要素のいずれかに設定されているとおりにその値を継承することで行われます。</span><span class="sxs-lookup"><span data-stu-id="bec86-104">Property value inheritance enables child elements in a tree of elements to obtain the value of a particular property from parent elements, inheriting that value as it was set anywhere in the nearest parent element.</span></span> <span data-ttu-id="bec86-105">親要素もプロパティ値の継承を通じてその値を取得している場合があるため、システムはページ ルートまで再帰している可能性があります。</span><span class="sxs-lookup"><span data-stu-id="bec86-105">The parent element might also have obtained its value through property value inheritance, so the system potentially recurses all the way to the page root.</span></span> <span data-ttu-id="bec86-106">プロパティ値の継承は、プロパティ システムの既定の動作ではありません。あるプロパティに子要素でのプロパティ値の継承を実行させるには、そのプロパティに特定のメタデータを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bec86-106">Property value inheritance is not the default property system behavior; a property must be established with a particular metadata setting in order to cause that property to initiate property value inheritance on child elements.</span></span>  

<a name="Property_Value_Inheritance_is_Containment_Inheritance"></a>
## <a name="property-value-inheritance-is-containment-inheritance"></a><span data-ttu-id="bec86-107">プロパティ値の継承は包含継承である</span><span class="sxs-lookup"><span data-stu-id="bec86-107">Property Value Inheritance Is Containment Inheritance</span></span>  
 <span data-ttu-id="bec86-108">ここで言う "継承" は、型や一般的なオブジェクト指向プログラミングのコンテキストにおける継承 (派生クラスがその基底クラスからメンバー定義を継承する) とは若干異なる概念です。</span><span class="sxs-lookup"><span data-stu-id="bec86-108">"Inheritance" as a term here is not quite the same concept as inheritance in the context of types and general object-oriented programming, where derived classes inherit member definitions from their base classes.</span></span> <span data-ttu-id="bec86-109">この意味での継承は、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] でも使用されます。さまざまな基底クラスで定義されたプロパティは、要素として使用される場合の派生 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] クラスの属性として、およびコードのメンバーとして公開されます。</span><span class="sxs-lookup"><span data-stu-id="bec86-109">That meaning of inheritance is also active in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]: properties defined in various base classes are exposed as attributes for derived [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] classes when used as elements, and exposed as members for code.</span></span> <span data-ttu-id="bec86-110">プロパティ値の継承は、要素のツリー内の親子のリレーションシップに基づいて、ある要素から別の要素にプロパティ値が継承されるしくみに特に関連します。</span><span class="sxs-lookup"><span data-stu-id="bec86-110">Property value inheritance is particularly about how property values can inherit from one element to another on the basis of the parent-child relationships within a tree of elements.</span></span> <span data-ttu-id="bec86-111">その要素のツリーが最も直接的に認識されるのは、[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] マークアップでアプリケーションを定義する際にさまざまな要素を別の要素内に入れ子にする場合です。</span><span class="sxs-lookup"><span data-stu-id="bec86-111">That tree of elements is most directly visible when nesting elements inside other elements as you define applications in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] markup.</span></span> <span data-ttu-id="bec86-112">オブジェクトのツリーはプログラムで作成することもできます。これを行うには、オブジェクトを別のオブジェクトの指定したコレクションに追加します。完成したツリーでも、実行時にプロパティ値の継承が同様に動作します。</span><span class="sxs-lookup"><span data-stu-id="bec86-112">Trees of objects can also be created programmatically by adding objects to designated collections of other objects, and property value inheritance works the same way in the finished tree at run time.</span></span>  
  
<a name="Practical_Applications_of_Property_Value_Inheritance"></a>
## <a name="practical-applications-of-property-value-inheritance"></a><span data-ttu-id="bec86-113">プロパティ値の継承を実際の応用例</span><span class="sxs-lookup"><span data-stu-id="bec86-113">Practical Applications of Property Value Inheritance</span></span>  
 <span data-ttu-id="bec86-114">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] API には、プロパティの継承が有効なプロパティがいくつか含まれています。</span><span class="sxs-lookup"><span data-stu-id="bec86-114">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] APIs include several properties that have property inheritance enabled.</span></span> <span data-ttu-id="bec86-115">これらのプロパティの一般的なシナリオは次のとおりです。これらのプロパティは、ページごとに一度だけ設定するのが適していますが、いずれかの基本要素クラスのメンバーでもあるため、ほとんどの子要素にも存在することになります。</span><span class="sxs-lookup"><span data-stu-id="bec86-115">Typically, the scenario for these is that they involve a property where it is appropriate that the property be set only once per page, but where that property is also a member of one of the base element classes and thus would also exist on most of the child elements.</span></span> <span data-ttu-id="bec86-116">たとえば、<xref:System.Windows.FrameworkElement.FlowDirection%2A> プロパティでは、フロー コンテンツをページ上に表示および配置する方向が制御されます。</span><span class="sxs-lookup"><span data-stu-id="bec86-116">For example, the <xref:System.Windows.FrameworkElement.FlowDirection%2A> property controls which direction flowed content should be presented and arranged on the page.</span></span> <span data-ttu-id="bec86-117">通常、テキスト フローの概念は、すべての子要素で一貫して処理される必要があります。</span><span class="sxs-lookup"><span data-stu-id="bec86-117">Typically, you want the text flow concept to be handled consistently throughout all child elements.</span></span> <span data-ttu-id="bec86-118">要素ツリーのあるレベルにおいて、何らかの理由でユーザーまたは環境の操作によってフロー方向がリセットされた場合は、一般に要素全体でリセットする必要があります。</span><span class="sxs-lookup"><span data-stu-id="bec86-118">If flow direction were for some reason reset in some level of the element tree by user or environment action, it should typically be reset throughout.</span></span> <span data-ttu-id="bec86-119"><xref:System.Windows.FrameworkElement.FlowDirection%2A> プロパティが継承されるようにすると、アプリケーション内の各ページの表示ニーズがすべて含まれる要素ツリー内のレベルで、値を 1 回設定またはリセットするだけで済むようになります。</span><span class="sxs-lookup"><span data-stu-id="bec86-119">When the <xref:System.Windows.FrameworkElement.FlowDirection%2A> property is made to inherit, the value need only be set or reset once at the level in the element tree that encompasses the presentation needs of each page in the application.</span></span> <span data-ttu-id="bec86-120">初期既定値であっても、同様の方法で値を継承します。</span><span class="sxs-lookup"><span data-stu-id="bec86-120">Even the initial default value will inherit in this way.</span></span> <span data-ttu-id="bec86-121">プロパティ値の継承モデルでは、要素の値を個別にリセットすることもできます。これは、複数のフロー方向の混在を意図したまれなケースに対応するためです。</span><span class="sxs-lookup"><span data-stu-id="bec86-121">The property value inheritance model still enables individual elements to reset the value for the rare cases where having a mix of flow directions is intentional.</span></span>  
  
<a name="Making_a_Custom_Property_Inheritable"></a>
## <a name="making-a-custom-property-inheritable"></a><span data-ttu-id="bec86-122">カスタム プロパティを継承可能にする</span><span class="sxs-lookup"><span data-stu-id="bec86-122">Making a Custom Property Inheritable</span></span>  
 <span data-ttu-id="bec86-123">カスタム プロパティのメタデータを変更することで、独自のカスタム プロパティを継承可能にすることもできます。</span><span class="sxs-lookup"><span data-stu-id="bec86-123">By changing a custom property's metadata, you can also make your own custom properties inheritable.</span></span> <span data-ttu-id="bec86-124">ただし、プロパティを継承可能にする場合は、パフォーマンスについて考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bec86-124">Note, however, that designating a property as inheritable does have some performance considerations.</span></span> <span data-ttu-id="bec86-125">ローカル値や、スタイル、テンプレート、またはデータ バインディングから取得した値がそのプロパティに設定されていない場合、継承可能なプロパティは、それ自身に割り当てられた値を論理ツリー内のすべての子要素に提供します。</span><span class="sxs-lookup"><span data-stu-id="bec86-125">In cases where that property does not have an established local value, or a value obtained through styles, templates, or data binding, an inheritable property provides its assigned property values to all child elements in the logical tree.</span></span>  
  
 <span data-ttu-id="bec86-126">プロパティを値の継承に参加させるには、「[添付プロパティを登録する](how-to-register-an-attached-property.md)」の説明に従ってカスタム添付プロパティを作成します。</span><span class="sxs-lookup"><span data-stu-id="bec86-126">To make a property participate in value inheritance, create a custom attached property, as described in [Register an Attached Property](how-to-register-an-attached-property.md).</span></span> <span data-ttu-id="bec86-127">メタデータ (<xref:System.Windows.FrameworkPropertyMetadata>) を指定してプロパティを登録し、そのメタデータ内のオプション設定で "継承" オプションを指定します。</span><span class="sxs-lookup"><span data-stu-id="bec86-127">Register the property with metadata (<xref:System.Windows.FrameworkPropertyMetadata>) and specify the "Inherits" option in the options settings within that metadata.</span></span> <span data-ttu-id="bec86-128">また、値が継承されるようになったため、プロパティに既定値が設定されていることも確認します。</span><span class="sxs-lookup"><span data-stu-id="bec86-128">Also make sure that the property has an established default value, because that value will now inherit.</span></span> <span data-ttu-id="bec86-129">プロパティを添付プロパティとして登録しましたが、"非添付" の依存関係プロパティの場合と同様に、所有者型で get アクセスおよび set アクセスのプロパティ "ラッパー" を作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="bec86-129">Although you registered the property as attached, you might also want to create a property "wrapper" for get/set access on the owner type, just as you would for an "nonattached" dependency property.</span></span> <span data-ttu-id="bec86-130">これにより、所有者型または派生型で直接プロパティ ラッパーを使用して、または、<xref:System.Windows.DependencyObject> で添付プロパティ構文を使用して、継承可能なプロパティを設定できます。</span><span class="sxs-lookup"><span data-stu-id="bec86-130">After doing so, the inheritable property can either be set by using the direct property wrapper on the owner type or derived types, or it can be set by using the attached property syntax on any <xref:System.Windows.DependencyObject>.</span></span>  
  
 <span data-ttu-id="bec86-131">添付プロパティは概念的にはグローバル プロパティに似ており、任意の <xref:System.Windows.DependencyObject> の値をチェックして、有効な結果を取得できます。</span><span class="sxs-lookup"><span data-stu-id="bec86-131">Attached properties are conceptually similar to global properties; you can check for the value on any <xref:System.Windows.DependencyObject> and get a valid result.</span></span> <span data-ttu-id="bec86-132">添付プロパティの典型的なシナリオとして、子要素のプロパティ値を設定する場合があります。このシナリオは、該当のプロパティが、ツリー内の各要素 (<xref:System.Windows.DependencyObject>) の添付プロパティとして常に暗黙的に存在する添付プロパティの場合に、さらに効果的です。</span><span class="sxs-lookup"><span data-stu-id="bec86-132">The typical scenario for attached properties is to set property values on child elements, and that scenario is more effective if the property in question is an attached property that is always implicitly present as an attached property on each element (<xref:System.Windows.DependencyObject>) in the tree.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="bec86-133">プロパティ値の継承は、非添付依存関係プロパティについても機能しているように見えることがありますが、ランタイム ツリーでの特定の要素の境界を介する非添付プロパティの継承動作は定義されていません。</span><span class="sxs-lookup"><span data-stu-id="bec86-133">Although property value inheritance might appear to work for nonattached dependency properties, the inheritance behavior for a nonattached property through certain element boundaries in the run-time tree is undefined.</span></span> <span data-ttu-id="bec86-134">メタデータで <xref:System.Windows.FrameworkPropertyMetadata.Inherits%2A> を指定する場合は、必ず <xref:System.Windows.DependencyProperty.RegisterAttached%2A> を使用してプロパティを登録します。</span><span class="sxs-lookup"><span data-stu-id="bec86-134">Always use <xref:System.Windows.DependencyProperty.RegisterAttached%2A> to register properties where you specify <xref:System.Windows.FrameworkPropertyMetadata.Inherits%2A> in the metadata.</span></span>  
  
<a name="InheritanceContext"></a>
## <a name="inheriting-property-values-across-tree-boundaries"></a><span data-ttu-id="bec86-135">ツリー境界を越えてプロパティ値を継承する</span><span class="sxs-lookup"><span data-stu-id="bec86-135">Inheriting Property Values Across Tree Boundaries</span></span>  
 <span data-ttu-id="bec86-136">プロパティの継承は、要素のツリーを走査して行われます。</span><span class="sxs-lookup"><span data-stu-id="bec86-136">Property inheritance works by traversing a tree of elements.</span></span> <span data-ttu-id="bec86-137">多くの場合、このツリーは論理ツリーに対応します。</span><span class="sxs-lookup"><span data-stu-id="bec86-137">This tree is often parallel to the logical tree.</span></span> <span data-ttu-id="bec86-138">しかし、要素ツリーを定義するマークアップ内に、<xref:System.Windows.Media.Brush> など、WPF コアレベルのオブジェクトを含めると、連続しない論理ツリーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="bec86-138">However, whenever you include a WPF core-level object in the markup that defines an element tree, such as a <xref:System.Windows.Media.Brush>, you have created a discontinuous logical tree.</span></span> <span data-ttu-id="bec86-139">論理ツリーは WPF フレームワークレベルの概念であるため、本当の論理ツリーは、<xref:System.Windows.Media.Brush> を通じて概念的に拡張されません。</span><span class="sxs-lookup"><span data-stu-id="bec86-139">A true logical tree does not conceptually extend through the <xref:System.Windows.Media.Brush>, because the logical tree is a WPF framework-level concept.</span></span> <span data-ttu-id="bec86-140"><xref:System.Windows.LogicalTreeHelper> のメソッドを使用すると、これが反映された結果を確認できます。</span><span class="sxs-lookup"><span data-stu-id="bec86-140">You can see this reflected in the results when using the methods of <xref:System.Windows.LogicalTreeHelper>.</span></span> <span data-ttu-id="bec86-141">ただし、継承可能なプロパティが添付プロパティとして登録されており、意図的な継承ブロッキング境界 (<xref:System.Windows.Controls.Frame> など) がない限り、プロパティ値の継承は、論理ツリー内のこのギャップを埋めることができ、継承された値を渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="bec86-141">However, property value inheritance can bridge this gap in the logical tree and can still pass inherited values through, so long as the inheritable property was registered as an attached property and no deliberate inheritance-blocking boundary (such as a <xref:System.Windows.Controls.Frame>) is encountered.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bec86-142">関連項目</span><span class="sxs-lookup"><span data-stu-id="bec86-142">See also</span></span>

- [<span data-ttu-id="bec86-143">依存関係プロパティのメタデータ</span><span class="sxs-lookup"><span data-stu-id="bec86-143">Dependency Property Metadata</span></span>](dependency-property-metadata.md)
- [<span data-ttu-id="bec86-144">添付プロパティの概要</span><span class="sxs-lookup"><span data-stu-id="bec86-144">Attached Properties Overview</span></span>](attached-properties-overview.md)
- [<span data-ttu-id="bec86-145">依存関係プロパティ値の優先順位</span><span class="sxs-lookup"><span data-stu-id="bec86-145">Dependency Property Value Precedence</span></span>](dependency-property-value-precedence.md)
