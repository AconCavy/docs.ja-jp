---
title: 印刷の概要
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print path [WPF], XPS
- printers [WPF], XPSDrv-based
- printing [WPF]
- PrintQueue class PrintServer class [WPF]
- XML Paper Specification (XPS) file format
- XPS (XML Paper Specification) file format
- XPSDrv-based printers
- GDI print path [WPF]
ms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1
ms.openlocfilehash: 3f99b0e93e6b16ac66f6869c284c1119ddfc3751
ms.sourcegitcommit: 9a97c76e141333394676bc5d264c6624b6f45bcf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/08/2020
ms.locfileid: "75740310"
---
# <a name="printing-overview"></a><span data-ttu-id="63f93-102">印刷の概要</span><span class="sxs-lookup"><span data-stu-id="63f93-102">Printing Overview</span></span>
<span data-ttu-id="63f93-103">Microsoft .NET Framework を使用すると、Windows Presentation Foundation (WPF) を使用するアプリケーション開発者は、豊富な新しい印刷および印刷システム管理 Api を利用できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-103">With Microsoft .NET Framework, application developers using Windows Presentation Foundation (WPF) have a rich new set of printing and print system management APIs.</span></span> <span data-ttu-id="63f93-104">Windows Vista では、これらの印刷システムの拡張機能の一部が、アンマネージコードを使用して [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] アプリケーションや開発者を作成する開発者にも使用できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-104">With Windows Vista, some of these print system enhancements are also available to developers creating [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] applications and developers using unmanaged code.</span></span> <span data-ttu-id="63f93-105">この新しい機能の中核となるのは、新しい XML Paper Specification (XPS) ファイル形式と XPS 印刷パスです。</span><span class="sxs-lookup"><span data-stu-id="63f93-105">At the core of this new functionality is the new XML Paper Specification (XPS) file format and the XPS print path.</span></span>  
  
 <span data-ttu-id="63f93-106">このトピックは、次のセクションで構成されています。</span><span class="sxs-lookup"><span data-stu-id="63f93-106">This topic contains the following sections.</span></span>  
  
<a name="introduction_to_XPS"></a>   
## <a name="about-xps"></a><span data-ttu-id="63f93-107">XPS について</span><span class="sxs-lookup"><span data-stu-id="63f93-107">About XPS</span></span>  
 <span data-ttu-id="63f93-108">XPS は、電子ドキュメント形式、スプールファイル形式、およびページ記述言語です。</span><span class="sxs-lookup"><span data-stu-id="63f93-108">XPS is an electronic document format, a spool file format and a page description language.</span></span> <span data-ttu-id="63f93-109">これは、XML、Open パッケージング規則 (OPC)、およびその他の業界標準を使用してクロスプラットフォームドキュメントを作成するオープンドキュメント形式です。</span><span class="sxs-lookup"><span data-stu-id="63f93-109">It is an open document format that uses XML, Open Packaging Conventions (OPC), and other industry standards to create cross-platform documents.</span></span> <span data-ttu-id="63f93-110">XPS は、デジタルドキュメントの作成、共有、印刷、表示、アーカイブを行うプロセスを簡略化します。</span><span class="sxs-lookup"><span data-stu-id="63f93-110">XPS simplifies the process by which digital documents are created, shared, printed, viewed, and archived.</span></span> <span data-ttu-id="63f93-111">XPS の詳細については、「 [Xps ドキュメント](/windows/desktop/printdocs/documents)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="63f93-111">For additional information on XPS, see [XPS Documents](/windows/desktop/printdocs/documents).</span></span>  
  
 <span data-ttu-id="63f93-112">WPF を使用して XPS ベースのコンテンツを印刷するためのいくつかの手法については、「[プログラムによる Xps ファイルの印刷](how-to-programmatically-print-xps-files.md)」をご利用ください</span><span class="sxs-lookup"><span data-stu-id="63f93-112">Several techniques for printing XPS-based content using WPF are demonstrated in [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="63f93-113">このトピックに含まれるコンテンツの確認中にこれらのサンプルを参照すると、役に立つ場合があります。</span><span class="sxs-lookup"><span data-stu-id="63f93-113">You may find it useful to reference these samples during review of content contained in this topic.</span></span> <span data-ttu-id="63f93-114">(アンマネージコードの開発者は、 [MXDC_ESCAPE 関数](/windows/desktop/printdocs/mxdc-escape)のドキュメントを参照する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63f93-114">(Unmanaged code developers should see documentation for the [MXDC_ESCAPE function](/windows/desktop/printdocs/mxdc-escape).</span></span> <span data-ttu-id="63f93-115">Windows フォーム開発者は、完全な XPS 印刷パスをサポートしていない <xref:System.Drawing.Printing> 名前空間の API を使用する必要がありますが、ハイブリッド GDI から XPS への印刷パスはサポートされています。</span><span class="sxs-lookup"><span data-stu-id="63f93-115">Windows Forms developers must use the API in the <xref:System.Drawing.Printing> namespace which does not support the full XPS print path, but does support a hybrid GDI-to-XPS print path.</span></span> <span data-ttu-id="63f93-116">以下の**印刷パスのアーキテクチャ**をご覧ください。)</span><span class="sxs-lookup"><span data-stu-id="63f93-116">See **Print Path Architecture** below.)</span></span>  
  
<a name="XPS_print_path_intro"></a>   
## <a name="xps-print-path"></a><span data-ttu-id="63f93-117">XPS 印刷パス</span><span class="sxs-lookup"><span data-stu-id="63f93-117">XPS Print Path</span></span>  
 <span data-ttu-id="63f93-118">XML Paper Specification (XPS) の印刷パスは、Windows アプリケーションでの印刷の処理方法を再定義する新しい Windows 機能です。</span><span class="sxs-lookup"><span data-stu-id="63f93-118">The XML Paper Specification (XPS) print path is a new Windows feature that redefines how printing is handled in Windows applications.</span></span> <span data-ttu-id="63f93-119">XPS はドキュメントのプレゼンテーション言語 (RTF など)、印刷スプーラの形式 (WMF など)、およびページ記述言語 (PCL や Postscript など) に置き換えることができるため、新しい印刷パスは、アプリケーションパブリケーションから印刷ドライバーまたはデバイスでの最終処理まで XPS 形式を維持します。</span><span class="sxs-lookup"><span data-stu-id="63f93-119">Because XPS can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the XPS format from application publication to the final processing in the print driver or device.</span></span>  
  
 <span data-ttu-id="63f93-120">XPS 印刷パスは XPS プリンタードライバーモデル (XPSDrv) に基づいて構築されています。これにより、"どのようなものが得られるか" (WYSIWYG) の印刷、改良された色のサポート、印刷パフォーマンスの大幅な向上など、開発者にとっていくつかのメリットが得られます。</span><span class="sxs-lookup"><span data-stu-id="63f93-120">The XPS print path is built upon the XPS printer driver model (XPSDrv), which provides several benefits for developers such as "what you see is what you get" (WYSIWYG) printing, improved color support, and significantly improved print performance.</span></span> <span data-ttu-id="63f93-121">(XPSDrv の詳細については、 [Windows Driver Kit のドキュメント](/windows-hardware/drivers/)を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="63f93-121">(For more on XPSDrv, see the [Windows Driver Kit documentation](/windows-hardware/drivers/).)</span></span>  
  
 <span data-ttu-id="63f93-122">XPS ドキュメントの印刷スプーラの操作は、基本的に以前のバージョンの Windows と同じです。</span><span class="sxs-lookup"><span data-stu-id="63f93-122">The operation of the print spooler for XPS documents is essentially the same as in previous versions of Windows.</span></span> <span data-ttu-id="63f93-123">ただし、既存の GDI 印刷パスに加えて XPS 印刷パスをサポートするように強化されています。</span><span class="sxs-lookup"><span data-stu-id="63f93-123">However, it has been enhanced to support the XPS print path in addition to the existing GDI print path.</span></span> <span data-ttu-id="63f93-124">新しい印刷パスは、ネイティブで XPS スプールファイルを使用します。</span><span class="sxs-lookup"><span data-stu-id="63f93-124">The new print path natively consumes an XPS spool file.</span></span> <span data-ttu-id="63f93-125">以前のバージョンの Windows 用に記述されたユーザーモードのプリンタードライバーは引き続き機能しますが、XPS 印刷パスを使用するには XPS プリンタードライバー (XPSDrv) が必要です。</span><span class="sxs-lookup"><span data-stu-id="63f93-125">While user-mode printer drivers written for previous versions of Windows will continue to work, an XPS printer driver (XPSDrv) is required in order to use the XPS print path.</span></span>  
  
 <span data-ttu-id="63f93-126">XPS 印刷パスの利点は、次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="63f93-126">The benefits of the XPS print path are significant, and include:</span></span>  
  
- <span data-ttu-id="63f93-127">WYSIWYG 印刷のサポート</span><span class="sxs-lookup"><span data-stu-id="63f93-127">WYSIWYG print support</span></span>  
  
- <span data-ttu-id="63f93-128">高度なカラー プロファイルのネイティブ サポート (1 チャンネルあたり 32 ビット (bpc)、CMYK、名前付きの色、n インクなど)、および透明度とグラデーションのネイティブ サポート。</span><span class="sxs-lookup"><span data-stu-id="63f93-128">Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.</span></span>  
  
- <span data-ttu-id="63f93-129">.NET Framework と Win32 ベースの両方のアプリケーションの印刷パフォーマンスが向上しました。</span><span class="sxs-lookup"><span data-stu-id="63f93-129">Improved print performance for both .NET Framework and Win32 based applications.</span></span>  
  
- <span data-ttu-id="63f93-130">業界標準の XPS 形式。</span><span class="sxs-lookup"><span data-stu-id="63f93-130">Industry standard XPS format.</span></span>  
  
 <span data-ttu-id="63f93-131">基本的な印刷シナリオでは、ユーザーインターフェイス、構成、およびジョブの送信用の1つのエントリポイントで、シンプルで直感的な API を使用できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-131">For basic print scenarios, a simple and intuitive API is available with a single entry point for user interface, configuration and job submission.</span></span> <span data-ttu-id="63f93-132">高度なシナリオ用に、[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] のカスタマイズ (または [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] がまったくない)、同期または非同期の印刷、および一括印刷の機能のサポートが追加されました。</span><span class="sxs-lookup"><span data-stu-id="63f93-132">For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities.</span></span> <span data-ttu-id="63f93-133">いずれのオプションでも、完全または部分的な信頼モードでの印刷のサポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="63f93-133">Both options provide print support in full or partial trust mode.</span></span>  
  
 <span data-ttu-id="63f93-134">XPS は、拡張性を考慮して設計されています。</span><span class="sxs-lookup"><span data-stu-id="63f93-134">XPS was designed with extensibility in mind.</span></span> <span data-ttu-id="63f93-135">機能拡張フレームワークを使用することにより、機能をモジュール方式で XPS に追加できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-135">By using the extensibility framework, features and capabilities can be added to XPS in a modular manner.</span></span> <span data-ttu-id="63f93-136">拡張機能は、次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="63f93-136">Extensibility features include:</span></span>  
  
- <span data-ttu-id="63f93-137">印刷スキーマ。</span><span class="sxs-lookup"><span data-stu-id="63f93-137">Print Schema.</span></span> <span data-ttu-id="63f93-138">パブリックのスキーマは定期的に更新され、デバイスの機能を迅速に拡張することができます。</span><span class="sxs-lookup"><span data-stu-id="63f93-138">The public schema is updated regularly and enables rapid extension of device capabilities.</span></span> <span data-ttu-id="63f93-139">(下記の「**PrintTicket と PrintCapabilities**」をご覧ください。)</span><span class="sxs-lookup"><span data-stu-id="63f93-139">(See **PrintTicket and PrintCapabilities** below.)</span></span>  
  
- <span data-ttu-id="63f93-140">拡張可能なフィルター パイプライン。</span><span class="sxs-lookup"><span data-stu-id="63f93-140">Extensible Filter Pipeline.</span></span> <span data-ttu-id="63f93-141">XPS プリンタードライバー (XPSDrv) フィルターパイプラインは、XPS ドキュメントの直接およびスケーラブルな印刷を有効にするように設計されています。</span><span class="sxs-lookup"><span data-stu-id="63f93-141">The XPS printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of XPS documents.</span></span> <span data-ttu-id="63f93-142">詳しくは、[XPSDrv プリンター ドライバーに関するページ](/windows-hardware/drivers/print/xpsdrv-printer-drivers)をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="63f93-142">For more information, see [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span> 
  
### <a name="print-path-architecture"></a><span data-ttu-id="63f93-143">印刷パスのアーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="63f93-143">Print Path Architecture</span></span>  
 <span data-ttu-id="63f93-144">Win32 と .NET Framework の両方のアプリケーションが XPS をサポートしていますが、Win32 および Windows フォームアプリケーションは、xps プリンタードライバー (XPSDrv) 用の XPS 形式のコンテンツを作成するために、GDI から XPS への変換を使用します。</span><span class="sxs-lookup"><span data-stu-id="63f93-144">While both Win32 and .NET Framework applications support XPS, Win32 and Windows Forms applications use a GDI to XPS conversion in order to create XPS formatted content for the XPS printer driver (XPSDrv).</span></span> <span data-ttu-id="63f93-145">これらのアプリケーションは XPS 印刷パスを使用する必要がなく、拡張メタファイル (EMF) ベースの印刷を引き続き使用できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-145">These applications are not required to use the XPS print path, and can continue to use Enhanced Metafile (EMF) based printing.</span></span> <span data-ttu-id="63f93-146">ただし、ほとんどの XPS 機能と拡張機能は、XPS 印刷パスを対象とするアプリケーションでのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-146">However, most XPS features and enhancements are only available to applications that target the XPS print path.</span></span>  
  
 <span data-ttu-id="63f93-147">Win32 および Windows フォームアプリケーションで XPSDrv ベースのプリンターを使用できるようにするために、XPS プリンタードライバー (XPSDrv) は、GDI から XPS 形式への変換をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="63f93-147">To enable the use of XPSDrv-based printers by Win32 and Windows Forms applications, the XPS printer driver (XPSDrv) supports conversion of GDI to XPS format.</span></span> <span data-ttu-id="63f93-148">XPSDrv モデルでは、Win32 アプリケーションが XPS ドキュメントを印刷できるように、XPS から GDI 形式のコンバーターも提供されています。</span><span class="sxs-lookup"><span data-stu-id="63f93-148">The XPSDrv model also provides a converter for XPS to GDI format so that Win32 applications can print XPS Documents.</span></span> <span data-ttu-id="63f93-149">WPF アプリケーションの場合、XPS 形式から GDI 形式への変換は、書き込み操作の対象の印刷キューに XPSDrv ドライバーがない場合は常に、<xref:System.Windows.Xps.XpsDocumentWriter> クラスの <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> および <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> メソッドによって自動的に行われます。</span><span class="sxs-lookup"><span data-stu-id="63f93-149">For WPF applications, conversion of XPS to GDI format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver.</span></span> <span data-ttu-id="63f93-150">(Windows フォームアプリケーションは XPS ドキュメントを印刷できません)。</span><span class="sxs-lookup"><span data-stu-id="63f93-150">(Windows Forms applications cannot print XPS Documents.)</span></span>  
  
 <span data-ttu-id="63f93-151">次の図は、印刷サブシステムを示し、Microsoft によって提供される部分と、ソフトウェアとハードウェアのベンダーによって定義される部分を定義しています。</span><span class="sxs-lookup"><span data-stu-id="63f93-151">The following illustration depicts the print subsystem and defines the portions provided by Microsoft, and the portions defined by software and hardware vendors:</span></span>  
  
 ![スクリーンショットは XPS 印刷システムを示しています。](./media/printing-overview/xml-paper-specification-print-system.png)  
  
### <a name="basic-xps-printing"></a><span data-ttu-id="63f93-153">XPS の基本的な印刷</span><span class="sxs-lookup"><span data-stu-id="63f93-153">Basic XPS Printing</span></span>  
 <span data-ttu-id="63f93-154">WPF では、basic と advanced の両方の API が定義されています。</span><span class="sxs-lookup"><span data-stu-id="63f93-154">WPF defines both a basic and advanced API.</span></span> <span data-ttu-id="63f93-155">広範な印刷のカスタマイズや完全な XPS 機能セットへのアクセスを必要としないアプリケーションでは、基本的な印刷サポートを利用できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-155">For those applications that do not require extensive print customization or access to the complete XPS feature set, basic print support is available.</span></span> <span data-ttu-id="63f93-156">基本的な印刷サポートは、最小構成を必要とし、使い慣れた [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] を特長とする印刷ダイアログ コントロールを介して公開されます。</span><span class="sxs-lookup"><span data-stu-id="63f93-156">Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="63f93-157">この簡略化された印刷モデルを使用して、多くの XPS 機能を使用できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-157">Many XPS features are available using this simplified print model.</span></span>  
  
#### <a name="printdialog"></a><span data-ttu-id="63f93-158">PrintDialog</span><span class="sxs-lookup"><span data-stu-id="63f93-158">PrintDialog</span></span>  
 <span data-ttu-id="63f93-159"><xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> コントロールは、[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]、構成、および XPS ジョブを送信するための1つのエントリポイントを提供します。</span><span class="sxs-lookup"><span data-stu-id="63f93-159">The <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and XPS job submission.</span></span> <span data-ttu-id="63f93-160">コントロールのインスタンス化と使用方法については、「[方法 : 印刷ダイアログ ボックスを呼び出す](how-to-invoke-a-print-dialog.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="63f93-160">For information about how to instantiate and use the control, see [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).</span></span>  
  
### <a name="advanced-xps-printing"></a><span data-ttu-id="63f93-161">高度な XPS の印刷</span><span class="sxs-lookup"><span data-stu-id="63f93-161">Advanced XPS Printing</span></span>  
 <span data-ttu-id="63f93-162">XPS 機能の完全なセットにアクセスするには、高度な印刷 API を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63f93-162">To access the complete set of XPS features, the advanced print API must be used.</span></span> <span data-ttu-id="63f93-163">いくつかの関連する API については、以下で詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="63f93-163">Several relevant API are described in greater detail below.</span></span> <span data-ttu-id="63f93-164">XPS 印刷パス Api の完全な一覧については、<xref:System.Windows.Xps> と <xref:System.Printing> 名前空間の参照に関するページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63f93-164">For a complete list of XPS print path APIs, see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.</span></span>  
  
#### <a name="printticket-and-printcapabilities"></a><span data-ttu-id="63f93-165">PrintTicket と PrintCapabilities</span><span class="sxs-lookup"><span data-stu-id="63f93-165">PrintTicket and PrintCapabilities</span></span>  
 <span data-ttu-id="63f93-166"><xref:System.Printing.PrintTicket> クラスと <xref:System.Printing.PrintCapabilities> クラスは、XPS の高度な機能の基盤です。</span><span class="sxs-lookup"><span data-stu-id="63f93-166">The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced XPS features.</span></span> <span data-ttu-id="63f93-167">どちらの種類のオブジェクトも、照合順序、両面印刷、ホチキス止めなどの印刷指向機能の XML 形式の構造です。これらの構造は、印刷スキーマによって定義されます。</span><span class="sxs-lookup"><span data-stu-id="63f93-167">Both types of objects are XML formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.</span></span> <span data-ttu-id="63f93-168"><xref:System.Printing.PrintTicket> は、プリンターに印刷ジョブの処理方法を指示します。</span><span class="sxs-lookup"><span data-stu-id="63f93-168">A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job.</span></span> <span data-ttu-id="63f93-169"><xref:System.Printing.PrintCapabilities> クラスは、プリンターの機能を定義します。</span><span class="sxs-lookup"><span data-stu-id="63f93-169">The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer.</span></span> <span data-ttu-id="63f93-170">プリンターの機能のクエリを実行すると、プリンターのサポート機能を最大限に活用する <xref:System.Printing.PrintTicket> を作成できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-170">By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features.</span></span> <span data-ttu-id="63f93-171">同様に、サポートされていない機能を回避できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-171">Similarly, unsupported features can be avoided.</span></span>  
  
 <span data-ttu-id="63f93-172">次の例は、プリンターの <xref:System.Printing.PrintCapabilities> でクエリを実行する方法と、コードを使用した <xref:System.Printing.PrintTicket> の作成方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="63f93-172">The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.</span></span>  
  
 [!code-cpp[xpscreate#PrinterCapabilities](~/samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]
 [!code-csharp[xpscreate#PrinterCapabilities](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]
 [!code-vb[xpscreate#PrinterCapabilities](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  
  
#### <a name="printserver-and-printqueue"></a><span data-ttu-id="63f93-173">PrintServer と PrintQueue</span><span class="sxs-lookup"><span data-stu-id="63f93-173">PrintServer and PrintQueue</span></span>  
 <span data-ttu-id="63f93-174"><xref:System.Printing.PrintServer> クラスはネットワーク プリント サーバーを表し、<xref:System.Printing.PrintQueue> クラスはプリンターとそれに関連付けられた出力ジョブのキューを表します。</span><span class="sxs-lookup"><span data-stu-id="63f93-174">The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it.</span></span> <span data-ttu-id="63f93-175">これらの Api を一緒に使用することで、サーバーの印刷ジョブを高度に管理できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-175">Together, these APIs allow advanced management of a server's print jobs.</span></span> <span data-ttu-id="63f93-176"><xref:System.Printing.PrintServer>、またはその派生クラスのいずれかを使用すると、<xref:System.Printing.PrintQueue> を管理できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-176">A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="63f93-177">新しい印刷ジョブをキューに挿入するには、<xref:System.Printing.PrintQueue.AddJob%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="63f93-177">The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.</span></span>  
  
 <span data-ttu-id="63f93-178">次の例は、コードを使用して <xref:System.Printing.LocalPrintServer> を作成し、既定の <xref:System.Printing.PrintQueue> にアクセスする方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="63f93-178">The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.</span></span>  
  
 [!code-csharp[xpsprint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[xpsprint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
#### <a name="xpsdocumentwriter"></a><span data-ttu-id="63f93-179">XpsDocumentWriter</span><span class="sxs-lookup"><span data-stu-id="63f93-179">XpsDocumentWriter</span></span>  
 <span data-ttu-id="63f93-180"><xref:System.Windows.Xps.XpsDocumentWriter>は、多くの <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> メソッドと <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> メソッドを使用して、XPS ドキュメントを <xref:System.Printing.PrintQueue>に書き込むために使用されます。</span><span class="sxs-lookup"><span data-stu-id="63f93-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write XPS documents to a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="63f93-181">たとえば、<xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> メソッドは、XPS ドキュメントを出力し、同期的に <xref:System.Printing.PrintTicket> するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="63f93-181">For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> synchronously.</span></span> <span data-ttu-id="63f93-182"><xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> メソッドは、XPS ドキュメントを出力し、非同期的に <xref:System.Printing.PrintTicket> するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="63f93-182">The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> asynchronously.</span></span>  
  
 <span data-ttu-id="63f93-183">次の例は、コードを使用して <xref:System.Windows.Xps.XpsDocumentWriter> を作成する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="63f93-183">The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.</span></span>  
  
 [!code-csharp[XpsPrint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[XpsPrint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
 <span data-ttu-id="63f93-184">さらに <xref:System.Printing.PrintQueue.AddJob%2A> メソッドは印刷方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="63f93-184">The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print.</span></span> <span data-ttu-id="63f93-185">「[方法 : XPS ファイルをプログラムにより印刷する](how-to-programmatically-print-xps-files.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="63f93-185">See [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="63f93-186">詳細について。</span><span class="sxs-lookup"><span data-stu-id="63f93-186">for details.</span></span>  
  
<a name="GDI_Print_Path_intro"></a>   
## <a name="gdi-print-path"></a><span data-ttu-id="63f93-187">GDI 印刷パス</span><span class="sxs-lookup"><span data-stu-id="63f93-187">GDI Print Path</span></span>  
 <span data-ttu-id="63f93-188">WPF アプリケーションは XPS 印刷パスをネイティブでサポートしていますが、Win32 アプリケーションや Windows フォームアプリケーションも一部の XPS 機能を利用できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-188">While WPF applications natively support the XPS print path, Win32 and Windows Forms applications can also take advantage of some XPS features.</span></span> <span data-ttu-id="63f93-189">XPS プリンタードライバー (XPSDrv) は、GDI ベースの出力を XPS 形式に変換できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-189">The XPS printer driver (XPSDrv) can convert GDI based output to XPS format.</span></span> <span data-ttu-id="63f93-190">高度なシナリオでは、 [MICROSOFT XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)を使用して、コンテンツのカスタム変換がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="63f93-190">For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span></span> <span data-ttu-id="63f93-191">同様に、WPF アプリケーションは、<xref:System.Windows.Xps.XpsDocumentWriter> クラスの <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> または <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> メソッドの1つを呼び出して、XpsDrv 以外のプリンターをターゲットの印刷キューとして指定することによって、GDI 印刷パスに出力することもできます。</span><span class="sxs-lookup"><span data-stu-id="63f93-191">Similarly, WPF applications can also output to the GDI print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.</span></span>  

<span data-ttu-id="63f93-192">XPS の機能やサポートを必要としないアプリケーションでは、現在の GDI 印刷パスは変更されません。</span><span class="sxs-lookup"><span data-stu-id="63f93-192">For applications that do not require XPS functionality or support, the current GDI print path remains unchanged.</span></span>  
  
- <span data-ttu-id="63f93-193">GDI 印刷パスおよびさまざまな XPS 変換オプションに関するその他の参照情報については、「 [MICROSOFT Xps Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) 」および「 [XPSDrv プリンタードライバー](/windows-hardware/drivers/print/xpsdrv-printer-drivers)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="63f93-193">For additional reference material on the GDI print path and the various XPS conversion options, see [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) and [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>  
  
<a name="XPS_Driver_Model_intro"></a>   
## <a name="xpsdrv-driver-model"></a><span data-ttu-id="63f93-194">XPSDrv ドライバー モデル</span><span class="sxs-lookup"><span data-stu-id="63f93-194">XPSDrv Driver Model</span></span>  
 <span data-ttu-id="63f93-195">Xps 印刷パスを使用すると、xps 対応のプリンターまたはドライバーに印刷するときに、ネイティブの印刷スプール形式として XPS を使用することでスプーラの効率性が向上します。</span><span class="sxs-lookup"><span data-stu-id="63f93-195">The XPS print path improves spooler efficiency by using XPS as the native print spool format when printing to an XPS -enabled printer or driver.</span></span> <span data-ttu-id="63f93-196">簡略化されたスプールプロセスにより、ドキュメントをスプールする前に、EMF データファイルなどの中間スプールファイルを生成する必要がなくなります。</span><span class="sxs-lookup"><span data-stu-id="63f93-196">The simplified spooling process eliminates the need to generate an intermediate spool file, such as an EMF data file, before the document is spooled.</span></span> <span data-ttu-id="63f93-197">スプールファイルのサイズを小さくすることで、XPS の印刷パスを使用してネットワークトラフィックを削減し、印刷のパフォーマンスを向上させることができます。</span><span class="sxs-lookup"><span data-stu-id="63f93-197">Through smaller spool file sizes, the XPS print path can reduce network traffic and improve print performance.</span></span>  
  
 <span data-ttu-id="63f93-198">EMF は、アプリケーションの出力を、レンダリングサービスの GDI への一連の呼び出しとして表すクローズ形式です。</span><span class="sxs-lookup"><span data-stu-id="63f93-198">EMF is a closed format that represents application output as a series of calls into GDI for rendering services.</span></span> <span data-ttu-id="63f93-199">EMF とは異なり、XPS スプール形式は、XPS ベースのプリンタードライバー (XPSDrv) に出力するときに、さらに解釈する必要なく、実際のドキュメントを表します。</span><span class="sxs-lookup"><span data-stu-id="63f93-199">Unlike EMF, the XPS spool format represents the actual document without requiring further interpretation when output to an XPS-based printer driver (XPSDrv).</span></span> <span data-ttu-id="63f93-200">ドライバーは、その形式のデータを直接操作できます。</span><span class="sxs-lookup"><span data-stu-id="63f93-200">The drivers can operate directly on the data in the format.</span></span> <span data-ttu-id="63f93-201">この機能により、EMF ファイルおよび GDI ベースの印刷ドライバーを使用するときに必要なデータと色空間の変換が不要になります。</span><span class="sxs-lookup"><span data-stu-id="63f93-201">This capability eliminates the data and color space conversions required when you use EMF files and GDI-based print drivers.</span></span>  
  
 <span data-ttu-id="63f93-202">通常は、XPS プリンタードライバー (XPSDrv) を対象とする XPS ドキュメントを EMF と同等のものと比較すると、スプールファイルのサイズが小さくなります。ただし、例外があります。</span><span class="sxs-lookup"><span data-stu-id="63f93-202">Spool file sizes are usually reduced when you use XPS Documents that target an XPS printer driver (XPSDrv) compared with their EMF equivalents; however, there are exceptions:</span></span>  
  
- <span data-ttu-id="63f93-203">ベクター グラフィックが非常に複雑で、複数の階層があるか、非効率的に記述されている場合、同じグラフィックスのビットマップ形式のバージョンよりもサイズが大きくなることがあります。</span><span class="sxs-lookup"><span data-stu-id="63f93-203">A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.</span></span>  
  
- <span data-ttu-id="63f93-204">画面表示の目的で、XPS ファイルにはデバイス フォントおよびコンピューター ベースのフォントが埋め込まれます。一方、GDI のスプール ファイルにはデバイス フォントは埋め込まれません。</span><span class="sxs-lookup"><span data-stu-id="63f93-204">For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.</span></span> <span data-ttu-id="63f93-205">しかし、両方の種類のフォントがサブセット化されているため (下記参照)、プリンター ドライバーは、ファイルをプリンターに送信する前にデバイス フォントを削除することができます。</span><span class="sxs-lookup"><span data-stu-id="63f93-205">But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.</span></span>  
  
 <span data-ttu-id="63f93-206">スプール サイズの削減は、いくつかのメカニズムを通じて行われます。</span><span class="sxs-lookup"><span data-stu-id="63f93-206">Spool size reduction is performed through several mechanisms:</span></span>  
  
- <span data-ttu-id="63f93-207">**フォントのサブセット化**。</span><span class="sxs-lookup"><span data-stu-id="63f93-207">**Font subsetting**.</span></span> <span data-ttu-id="63f93-208">実際のドキュメント内で使用されている文字だけが XPS ファイルに格納されます。</span><span class="sxs-lookup"><span data-stu-id="63f93-208">Only characters used within the actual document are stored in the XPS file.</span></span>  
  
- <span data-ttu-id="63f93-209">**高度なグラフィックスのサポート**。</span><span class="sxs-lookup"><span data-stu-id="63f93-209">**Advanced Graphics Support**.</span></span> <span data-ttu-id="63f93-210">透明度とグラデーションのプリミティブのネイティブサポートにより、XPS ドキュメント内のコンテンツのラスタライズが回避されます。</span><span class="sxs-lookup"><span data-stu-id="63f93-210">Native support for transparency and gradient primitives avoids rasterization of content in the XPS Document.</span></span>  
  
- <span data-ttu-id="63f93-211">**共通リソースの識別**。</span><span class="sxs-lookup"><span data-stu-id="63f93-211">**Identification of common resources**.</span></span> <span data-ttu-id="63f93-212">複数回使用するリソース (会社のロゴを表す画像など) は共有リソースとして扱われ、一度だけ読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="63f93-212">Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.</span></span>  
  
- <span data-ttu-id="63f93-213">**ZIP 圧縮**。</span><span class="sxs-lookup"><span data-stu-id="63f93-213">**ZIP compression**.</span></span> <span data-ttu-id="63f93-214">すべての XPS ドキュメントで ZIP 圧縮を使用します。</span><span class="sxs-lookup"><span data-stu-id="63f93-214">All XPS documents use ZIP compression.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="63f93-215">関連項目</span><span class="sxs-lookup"><span data-stu-id="63f93-215">See also</span></span>

- <xref:System.Windows.Controls.PrintDialog>
- <xref:System.Windows.Xps.XpsDocumentWriter>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.Printing.PrintTicket>
- <xref:System.Printing.PrintCapabilities>
- <xref:System.Printing.PrintServer>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="63f93-216">方法のトピック</span><span class="sxs-lookup"><span data-stu-id="63f93-216">How-to Topics</span></span>](printing-how-to-topics.md)
- [<span data-ttu-id="63f93-217">WPF のドキュメント</span><span class="sxs-lookup"><span data-stu-id="63f93-217">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="63f93-218">XPS ドキュメント</span><span class="sxs-lookup"><span data-stu-id="63f93-218">XPS Documents</span></span>](/windows/desktop/printdocs/documents)
- [<span data-ttu-id="63f93-219">ドキュメントのシリアル化および保存</span><span class="sxs-lookup"><span data-stu-id="63f93-219">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
- [<span data-ttu-id="63f93-220">Microsoft XPS Document Converter (MXDC)</span><span class="sxs-lookup"><span data-stu-id="63f93-220">Microsoft XPS Document Converter (MXDC)</span></span>](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)
