---
title: データとデータ オブジェクト
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- data transfer [WPF], drag-and-drop
- DataFormats class [WPF]
- DataObject class [WPF]
ms.assetid: 5967d557-1867-420f-a524-ae3af78402da
ms.openlocfilehash: 532c254f997da183b073ddc9e00b4364ecfcd739
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/12/2020
ms.locfileid: "79186346"
---
# <a name="data-and-data-objects"></a><span data-ttu-id="7e6d1-102">データとデータ オブジェクト</span><span class="sxs-lookup"><span data-stu-id="7e6d1-102">Data and Data Objects</span></span>
<span data-ttu-id="7e6d1-103">ドラッグ アンド ドロップ操作の一部として転送されるデータは、データ オブジェクトに格納されます。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-103">Data that is transferred as part of a drag-and-drop operation is stored in a data object.</span></span>  <span data-ttu-id="7e6d1-104">概念的には、データ オブジェクトは、次の 1 つ以上のペアで構成されます。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-104">Conceptually, a data object consists of one or more of the following pairs:</span></span>  
  
- <span data-ttu-id="7e6d1-105">実際<xref:System.Object>のデータを含む。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-105">An <xref:System.Object> that contains the actual data.</span></span>  
  
- <span data-ttu-id="7e6d1-106">対応するデータ形式識別子。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-106">A corresponding data format identifier.</span></span>  
  
 <span data-ttu-id="7e6d1-107">データ自体は、 ベース<xref:System.Object>として表現できる何でもで構成できます。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-107">The data itself can consist of anything that can be represented as a base <xref:System.Object>.</span></span>  <span data-ttu-id="7e6d1-108">対応するデータ形式は文字列であるか<xref:System.Type>、データの形式に関するヒントを提供します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-108">The corresponding data format is a string or <xref:System.Type> that provides a hint about what format the data is in.</span></span>  <span data-ttu-id="7e6d1-109">データ オブジェクトは、複数のデータ/データ形式のペアのホストをサポートします。これにより、単一のデータ オブジェクトが複数の形式でデータを提供できます。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-109">Data objects support hosting multiple data/data format pairs; this enables a single data object to provide data in multiple formats.</span></span>  
  
<a name="Data_and_Data_Objects"></a>
## <a name="data-objects"></a><span data-ttu-id="7e6d1-110">データ オブジェクト</span><span class="sxs-lookup"><span data-stu-id="7e6d1-110">Data Objects</span></span>  
 <span data-ttu-id="7e6d1-111">すべてのデータ オブジェクトは、<xref:System.Windows.IDataObject>データ転送を有効にし、容易にする次の標準的なメソッドセットを提供するインターフェイスを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-111">All data objects must implement the <xref:System.Windows.IDataObject> interface, which provides the following standard set of methods that enable and facilitate data transfer.</span></span>  
  
|<span data-ttu-id="7e6d1-112">Method</span><span class="sxs-lookup"><span data-stu-id="7e6d1-112">Method</span></span>|<span data-ttu-id="7e6d1-113">まとめ</span><span class="sxs-lookup"><span data-stu-id="7e6d1-113">Summary</span></span>|  
|------------|-------------|  
|<xref:System.Windows.IDataObject.GetData%2A>|<span data-ttu-id="7e6d1-114">データ オブジェクトを指定したデータ形式で取得します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-114">Retrieves a data object in a specified data format.</span></span>|  
|<xref:System.Windows.IDataObject.GetDataPresent%2A>|<span data-ttu-id="7e6d1-115">データが指定した形式で使用可能かどうか、または指定した形式に変換可能かどうかをチェックします。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-115">Checks to see whether the data is available in, or can be converted to, a specified format.</span></span>|  
|<xref:System.Windows.IDataObject.GetFormats%2A>|<span data-ttu-id="7e6d1-116">このデータ オブジェクトのデータが格納されているか、または変換可能である形式のリストを返します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-116">Returns a list of formats that the data in this data object is stored in, or can be converted to.</span></span>|  
|<xref:System.Windows.IDataObject.SetData%2A>|<span data-ttu-id="7e6d1-117">指定したデータをこのデータ オブジェクトに格納します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-117">Stores the specified data in this data object.</span></span>|  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="7e6d1-118">は、クラス<xref:System.Windows.IDataObject>の基本的な実装<xref:System.Windows.DataObject>を提供します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-118">provides a basic implementation of <xref:System.Windows.IDataObject> in the <xref:System.Windows.DataObject> class.</span></span> <span data-ttu-id="7e6d1-119">在庫<xref:System.Windows.DataObject>クラスは、多くの一般的なデータ転送シナリオで十分です。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-119">The stock <xref:System.Windows.DataObject> class is sufficient for many common data transfer scenarios.</span></span>  
  
 <span data-ttu-id="7e6d1-120">ビットマップ、CSV、ファイル、HTML、RTF、文字列、テキスト、オーディオなど、定義済みのフォーマットがいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-120">There are several pre-defined formats, such as bitmap, CSV, file, HTML, RTF, string, text, and audio.</span></span> <span data-ttu-id="7e6d1-121">で[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]提供される定義済みのデータ形式については、クラスのリファレンストピック<xref:System.Windows.DataFormats>を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-121">For information about pre-defined data formats provided with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see the <xref:System.Windows.DataFormats> class reference topic.</span></span>  
  
 <span data-ttu-id="7e6d1-122">データ オブジェクトには、通常、データを抽出するときに、ある形式で格納されたデータを別の形式に自動的に変換する機能が含まれます。この機能は自動変換と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-122">Data objects commonly include a facility for automatically converting data stored in one format to a different format while extracting data; this facility is referred to as auto-convert.</span></span> <span data-ttu-id="7e6d1-123">データ オブジェクトで使用できるデータ形式を照会する場合、 <xref:System.Windows.DataObject.GetFormats%28System.Boolean%29> or<xref:System.Windows.DataObject.GetDataPresent%28System.String%2CSystem.Boolean%29>メソッドを呼び出してパラメーターを`autoConvert``false`に指定することで、自動変換可能なデータ形式をネイティブ データ形式からフィルター処理できます。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-123">When querying for the data formats available in a data object, auto-convertible data formats can be filtered from native data formats by calling the <xref:System.Windows.DataObject.GetFormats%28System.Boolean%29> or <xref:System.Windows.DataObject.GetDataPresent%28System.String%2CSystem.Boolean%29> method and specifying the `autoConvert` parameter as `false`.</span></span>  <span data-ttu-id="7e6d1-124">メソッドを使用してデータオブジェクトにデータを<xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%2CSystem.Boolean%29>追加する場合、パラメータを`autoConvert``false`に設定することでデータの自動変換を禁止できます。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-124">When adding data to a data object with the <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%2CSystem.Boolean%29> method, auto-conversion of data can be prohibited by setting the `autoConvert` parameter to `false`.</span></span>  
  
<a name="Working_with_Data_Objects"></a>
## <a name="working-with-data-objects"></a><span data-ttu-id="7e6d1-125">データ オブジェクトの操作</span><span class="sxs-lookup"><span data-stu-id="7e6d1-125">Working with Data Objects</span></span>  
 <span data-ttu-id="7e6d1-126">このセクションでは、データ オブジェクトを作成および操作するための一般的な手法について説明します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-126">This section describes common techniques for creating and working with data objects.</span></span>  
  
### <a name="creating-new-data-objects"></a><span data-ttu-id="7e6d1-127">新しいデータ オブジェクトの作成</span><span class="sxs-lookup"><span data-stu-id="7e6d1-127">Creating New Data Objects</span></span>  
 <span data-ttu-id="7e6d1-128">この<xref:System.Windows.DataObject>クラスには、単一のデータ/データ形式のペアで新しい<xref:System.Windows.DataObject>インスタンスを簡単に設定するための、オーバーロードされた複数のコンストラクターが用意されています。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-128">The <xref:System.Windows.DataObject> class provides several overloaded constructors that facilitate populating a new <xref:System.Windows.DataObject> instance with a single data/data format pair.</span></span>  
  
 <span data-ttu-id="7e6d1-129">次のコード例では、新しいデータ オブジェクトを作成し、オーバーロードされたコンストラクター <xref:System.Windows.DataObject.%23ctor%2A><xref:System.Windows.DataObject.%23ctor(System.String,System.Object)>( ) のいずれかを使用して、文字列と指定したデータ形式でデータ オブジェクトを初期化します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-129">The following example code creates a new data object and uses one of the overloaded constructors <xref:System.Windows.DataObject.%23ctor%2A>(<xref:System.Windows.DataObject.%23ctor(System.String,System.Object)>) to initialize the data object with a string and a specified data format.</span></span>  <span data-ttu-id="7e6d1-130">この場合、データ形式は文字列で指定されます。この<xref:System.Windows.DataFormats>クラスは、定義済みの型文字列のセットを提供します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-130">In this case, the data format is specified by a string; the <xref:System.Windows.DataFormats> class provides a set of pre-defined type strings.</span></span> <span data-ttu-id="7e6d1-131">デフォルトでは、格納されたデータの自動変換が可能です。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-131">Auto-conversion of the stored data is allowed by default.</span></span>  
  
 [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString](~/samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_createdataobject_typestring)]
 [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_createdataobject_typestring)]  
  
 <span data-ttu-id="7e6d1-132">データ オブジェクトを作成するコードの例については、「[データ オブジェクトの作成](how-to-create-a-data-object.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-132">For more examples of code that creates a data object, see [Create a Data Object](how-to-create-a-data-object.md).</span></span>  
  
### <a name="storing-data-in-multiple-formats"></a><span data-ttu-id="7e6d1-133">複数の形式でのデータの格納</span><span class="sxs-lookup"><span data-stu-id="7e6d1-133">Storing Data in Multiple Formats</span></span>  
 <span data-ttu-id="7e6d1-134">1 つのデータ オブジェクトは、複数の形式でデータを格納できます。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-134">A single data object is able to store data in multiple formats.</span></span>   <span data-ttu-id="7e6d1-135">単一のデータ オブジェクト内で複数のデータ形式を戦略的に使用すると、単一のデータ形式しか表現できない場合よりも、データ オブジェクトが幅広いドロップ ターゲットによって消費される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-135">Strategic use of multiple data formats within a single data object potentially makes the data object consumable by a wider variety of drop targets than if only a single data format could be represented.</span></span>  <span data-ttu-id="7e6d1-136">一般に、ドラッグ ソースは、潜在的なドロップ ターゲットによって消費されるデータ形式に関しては、まったく問題がない必要があります。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-136">Note that, in general, a drag source must be agnostic about the data formats that are consumable by potential drop targets.</span></span>  
  
 <span data-ttu-id="7e6d1-137">メソッドを使用して、複数の<xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%29>形式のデータ オブジェクトにデータを追加する方法を次の例に示します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-137">The following example shows how to use the <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%29> method to add data to a data object in multiple formats.</span></span>  
  
 [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats](~/samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_storemultipleformats)]
 [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_storemultipleformats)]  
  
### <a name="querying-a-data-object-for-available-formats"></a><span data-ttu-id="7e6d1-138">データ オブジェクトに使用可能な形式を照会する</span><span class="sxs-lookup"><span data-stu-id="7e6d1-138">Querying a Data Object for Available Formats</span></span>  
 <span data-ttu-id="7e6d1-139">1 つのデータ オブジェクトには任意の数のデータ形式を含めることができるため、データ オブジェクトには、使用可能なデータ形式のリストを取得するための機能が含まれます。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-139">Because a single data object can contain an arbitrary number of data formats, data objects include facilities for retrieving a list of available data formats.</span></span>  
  
 <span data-ttu-id="7e6d1-140">次のコード例では、<xref:System.Windows.DataObject.GetFormats%2A>オーバーロードを使用して、データ オブジェクトで使用できるすべてのデータ形式 (ネイティブと自動変換の両方) を示す文字列の配列を取得します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-140">The following example code uses the <xref:System.Windows.DataObject.GetFormats%2A> overload to get an array of strings denoting all data formats available in a data object (both native and by auto-convert).</span></span>  
  
 [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats](~/samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_getalldataformats)]
 [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_getalldataformats)]  
  
 <span data-ttu-id="7e6d1-141">データ オブジェクトに使用可能なデータ形式を照会するコードの例については、「[データ オブジェクトにデータ形式をリストする](how-to-list-the-data-formats-in-a-data-object.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-141">For more examples of code that queries a data object for available data formats, see [List the Data Formats in a Data Object](how-to-list-the-data-formats-in-a-data-object.md).</span></span>  <span data-ttu-id="7e6d1-142">データ オブジェクトに対して特定のデータ形式が存在するかどうかのクエリの例については、「[データ 形式がデータ オブジェクトに存在するかどうかを判断](how-to-determine-if-a-data-format-is-present-in-a-data-object.md)する 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-142">For examples of querying a data object for the presence of a particular data format, see [Determine if a Data Format is Present in a Data Object](how-to-determine-if-a-data-format-is-present-in-a-data-object.md).</span></span>  
  
### <a name="retrieving-data-from-a-data-object"></a><span data-ttu-id="7e6d1-143">データ オブジェクトからのデータの取得</span><span class="sxs-lookup"><span data-stu-id="7e6d1-143">Retrieving Data from a Data Object</span></span>  
 <span data-ttu-id="7e6d1-144">特定の形式でデータ オブジェクトからデータを取得するには、<xref:System.Windows.DataObject.GetData%2A>メソッドの 1 つを呼び出して目的のデータ形式を指定するだけです。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-144">Retrieving data from a data object in a particular format simply involves calling one of the <xref:System.Windows.DataObject.GetData%2A> methods and specifying the desired data format.</span></span>  <span data-ttu-id="7e6d1-145">メソッドの<xref:System.Windows.DataObject.GetDataPresent%2A>1 つを使用して、特定のデータ形式の有無をチェックできます。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-145">One of the <xref:System.Windows.DataObject.GetDataPresent%2A> methods can be used to check for the presence of a particular data format.</span></span>  <span data-ttu-id="7e6d1-146"><xref:System.Windows.DataObject.GetData%2A>でデータを返します<xref:System.Object>。データ形式に応じて、このオブジェクトを型固有のコンテナーにキャストできます。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-146"><xref:System.Windows.DataObject.GetData%2A> returns the data in an <xref:System.Object>; depending on the data format, this object can be cast to a type-specific container.</span></span>  
  
 <span data-ttu-id="7e6d1-147">次のコード例では、<xref:System.Windows.DataObject.GetDataPresent%28System.String%29>指定したデータ形式 (ネイティブまたは自動変換) が使用可能かどうかを調べるオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-147">The following example code uses the <xref:System.Windows.DataObject.GetDataPresent%28System.String%29> overload to check if a specified data format is available (native or by auto-convert).</span></span> <span data-ttu-id="7e6d1-148">指定した形式が使用可能な場合、この例では、メソッドを使用して<xref:System.Windows.DataObject.GetData%28System.String%29>データを取得します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-148">If the specified format is available, the example retrieves the data by using the <xref:System.Windows.DataObject.GetData%28System.String%29> method.</span></span>  
  
 [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat](~/samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_getspecificdataformat)]
 [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_getspecificdataformat)]  
  
 <span data-ttu-id="7e6d1-149">データ オブジェクトからデータを取得するコードの例については、「特定の[データ形式でデータを取得する](how-to-retrieve-data-in-a-particular-data-format.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-149">For more examples of code that retrieves data from a data object, see [Retrieve Data in a Particular Data Format](how-to-retrieve-data-in-a-particular-data-format.md).</span></span>  
  
### <a name="removing-data-from-a-data-object"></a><span data-ttu-id="7e6d1-150">データ オブジェクトからのデータの削除</span><span class="sxs-lookup"><span data-stu-id="7e6d1-150">Removing Data From a Data Object</span></span>  
 <span data-ttu-id="7e6d1-151">データ オブジェクトからデータを直接削除することはできません。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-151">Data cannot be directly removed from a data object.</span></span>  <span data-ttu-id="7e6d1-152">データ オブジェクトからデータを効果的に削除するには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-152">To effectively remove data from a data object, follow these steps:</span></span>  
  
1. <span data-ttu-id="7e6d1-153">保持するデータのみを含む新しいデータ オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-153">Create a new data object that will contain only the data you want to retain.</span></span>  
  
2. <span data-ttu-id="7e6d1-154">古いデータ オブジェクトから新しいデータ オブジェクトに目的のデータをコピーします。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-154">"Copy" the desired data from the old data object to the new data object.</span></span>  <span data-ttu-id="7e6d1-155">データをコピーするには、いずれかのメソッドを<xref:System.Windows.DataObject.GetData%2A>使用して生データを<xref:System.Object>含む を取得し、その<xref:System.Windows.DataObject.SetData%2A>メソッドの 1 つを使用して新しいデータ オブジェクトにデータを追加します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-155">To copy the data, use one of the <xref:System.Windows.DataObject.GetData%2A> methods to retrieve an <xref:System.Object> that contains the raw data, and then use one of the <xref:System.Windows.DataObject.SetData%2A> methods to add the data to the new data object.</span></span>  
  
3. <span data-ttu-id="7e6d1-156">古いデータ オブジェクトを新しいデータ オブジェクトに置き換えます。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-156">Replace the old data object with the new one.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7e6d1-157">メソッド<xref:System.Windows.DataObject.SetData%2A>はデータオブジェクトにのみデータを追加します。データとデータ形式が前回の呼び出しとまったく同じであっても、データは置き換わりません。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-157">The <xref:System.Windows.DataObject.SetData%2A> methods only add data to a data object; they do not replace data, even if the data and data format are exactly the same as a previous call.</span></span> <span data-ttu-id="7e6d1-158">同<xref:System.Windows.DataObject.SetData%2A>じデータとデータ形式に対して 2 回呼び出すと、データ/データ形式がデータ オブジェクト内に 2 回存在します。</span><span class="sxs-lookup"><span data-stu-id="7e6d1-158">Calling <xref:System.Windows.DataObject.SetData%2A> twice for the same data and data format will result in the data/data format being present twice in the data object.</span></span>
