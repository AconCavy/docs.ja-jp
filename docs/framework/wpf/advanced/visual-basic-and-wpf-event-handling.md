---
title: Visual Basic でのイベントの処理
ms.date: 03/30/2017
helpviewer_keywords:
- Visual Basic [WPF], event handlers
- event handlers [WPF], Visual Basic
ms.assetid: ad4eb9aa-3afc-4a71-8cf6-add3fbea54a1
ms.openlocfilehash: 959ef66f41f6c5f06e18a202109fba058c522d1d
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/24/2020
ms.locfileid: "76735409"
---
# <a name="visual-basic-and-wpf-event-handling"></a><span data-ttu-id="83ef4-102">Visual Basic と WPF のイベント処理</span><span class="sxs-lookup"><span data-stu-id="83ef4-102">Visual Basic and WPF Event Handling</span></span>
<span data-ttu-id="83ef4-103">特に Microsoft Visual Basic .NET 言語では、言語固有の `Handles` キーワードを使用してイベントハンドラーをインスタンスに関連付けることができます。これには、イベントハンドラーを属性または <xref:System.Windows.UIElement.AddHandler%2A> メソッドを使用してアタッチする必要があります。</span><span class="sxs-lookup"><span data-stu-id="83ef4-103">For the Microsoft Visual Basic .NET language specifically, you can use the language-specific `Handles` keyword to associate event handlers with instances, instead of attaching event handlers with attributes or using the <xref:System.Windows.UIElement.AddHandler%2A> method.</span></span> <span data-ttu-id="83ef4-104">ただし、インスタンスにハンドラーをアタッチする `Handles` 技法にはいくつかの制限があります。これは、`Handles` 構文が [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] イベントシステムの特定のルーティングイベント機能の一部をサポートできないためです。</span><span class="sxs-lookup"><span data-stu-id="83ef4-104">However, the `Handles` technique for attaching handlers to instances does have some limitations, because the `Handles` syntax cannot support some of the specific routed event features of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span>  
  
## <a name="using-handles-in-a-wpf-application"></a><span data-ttu-id="83ef4-105">WPF アプリケーションでの "ハンドル" の使用</span><span class="sxs-lookup"><span data-stu-id="83ef4-105">Using "Handles" in a WPF Application</span></span>  
 <span data-ttu-id="83ef4-106">`Handles` を持つインスタンスおよびイベントに接続されているイベントハンドラーはすべて、インスタンスの部分クラス宣言内で定義する必要があります。これは、要素の属性値によって割り当てられるイベントハンドラーにも必要です。</span><span class="sxs-lookup"><span data-stu-id="83ef4-106">The event handlers that are connected to instances and events with `Handles` must all be defined within the partial class declaration of the instance, which is also a requirement for event handlers that are assigned through attribute values on elements.</span></span> <span data-ttu-id="83ef4-107">`Handles` は、<xref:System.Windows.FrameworkContentElement.Name%2A> プロパティ値 (または[X:Name ディレクティブ](../../../desktop-wpf/xaml-services/xname-directive.md)が宣言されている) を持つページ上の要素に対してのみ指定できます。</span><span class="sxs-lookup"><span data-stu-id="83ef4-107">You can only specify `Handles` for an element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property value (or [x:Name Directive](../../../desktop-wpf/xaml-services/xname-directive.md) declared).</span></span> <span data-ttu-id="83ef4-108">これは、[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] の <xref:System.Windows.FrameworkContentElement.Name%2A> によって、`Handles` 構文で必要とされるインスタンス参照が作成されるためです *。*</span><span class="sxs-lookup"><span data-stu-id="83ef4-108">This is because the <xref:System.Windows.FrameworkContentElement.Name%2A> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] creates the instance reference that is necessary to support the *Instance.Event* reference format required by the `Handles` syntax.</span></span> <span data-ttu-id="83ef4-109"><xref:System.Windows.FrameworkContentElement.Name%2A> 参照のない `Handles` に使用できる唯一の要素は、部分クラスを定義するルート要素のインスタンスです。</span><span class="sxs-lookup"><span data-stu-id="83ef4-109">The only element that can be used for `Handles` without a <xref:System.Windows.FrameworkContentElement.Name%2A> reference is the root-element instance that defines the partial class.</span></span>  
  
 <span data-ttu-id="83ef4-110">インスタンスを分離することによって、複数の要素に同じハンドラーを割り当てることができます。 `Handles` の後にコンマが含まれるように*なり*ます。</span><span class="sxs-lookup"><span data-stu-id="83ef4-110">You can assign the same handler to multiple elements by separating *Instance.Event* references after `Handles` with commas.</span></span>  
  
 <span data-ttu-id="83ef4-111">`Handles` を使用して、同じインスタンスに複数のハンドラーを割り当てることができ*ます。イベント*の参照。</span><span class="sxs-lookup"><span data-stu-id="83ef4-111">You can use `Handles` to assign more than one handler to the same *Instance.Event*reference.</span></span> <span data-ttu-id="83ef4-112">`Handles` 参照でハンドラーが指定されている順序には、重要度を割り当てないでください。同じイベントを処理するハンドラーを任意の順序で呼び出すことを想定してください。</span><span class="sxs-lookup"><span data-stu-id="83ef4-112">Do not assign any importance to the order in which handlers are given in the `Handles` reference; you should assume that handlers that handle the same event can be invoked in any order.</span></span>  
  
 <span data-ttu-id="83ef4-113">宣言内の `Handles` と共に追加されたハンドラーを削除するには、<xref:System.Windows.UIElement.RemoveHandler%2A>を呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="83ef4-113">To remove a handler that was added with `Handles` in the declaration, you can call <xref:System.Windows.UIElement.RemoveHandler%2A>.</span></span>  
  
 <span data-ttu-id="83ef4-114">メンバーテーブルで処理されるイベントを定義するインスタンスにハンドラーをアタッチする限り、`Handles` を使用して、ルーティングイベントのハンドラーをアタッチできます。</span><span class="sxs-lookup"><span data-stu-id="83ef4-114">You can use `Handles` to attach handlers for routed events, so long as you attach handlers to instances that define the event being handled in their members tables.</span></span> <span data-ttu-id="83ef4-115">ルーティングイベントの場合、`Handles` にアタッチされるハンドラーは、[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 属性として、または <xref:System.Windows.UIElement.AddHandler%2A>の共通署名と共にアタッチされるハンドラーと同じルーティング規則に従います。</span><span class="sxs-lookup"><span data-stu-id="83ef4-115">For routed events, handlers that are attached with `Handles` follow the same routing rules as do handlers that are attached as [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] attributes, or with the common signature of <xref:System.Windows.UIElement.AddHandler%2A>.</span></span> <span data-ttu-id="83ef4-116">これは、イベントが既に処理済みとしてマークされている場合 (イベントデータの <xref:System.Windows.RoutedEventArgs.Handled%2A> プロパティが `True`)、そのイベントインスタンスへの応答として `Handles` にアタッチされたハンドラーが呼び出されないことを意味します。</span><span class="sxs-lookup"><span data-stu-id="83ef4-116">This means that if the event is already marked handled (the <xref:System.Windows.RoutedEventArgs.Handled%2A> property in the event data is `True`), then handlers attached with `Handles` are not invoked in response to that event instance.</span></span> <span data-ttu-id="83ef4-117">イベントは、ルート内の別の要素のインスタンスハンドラーによって処理されるようにマークすることも、現在の要素またはルートの前の要素に対するクラス処理によって処理することもできます。</span><span class="sxs-lookup"><span data-stu-id="83ef4-117">The event could be marked handled by instance handlers on another element in the route, or by class handling either on the current element or earlier elements along the route.</span></span> <span data-ttu-id="83ef4-118">ペアのトンネル/バブルイベントをサポートする入力イベントの場合、トンネリングルートでは、イベントペアが処理済みとマークされている可能性があります。</span><span class="sxs-lookup"><span data-stu-id="83ef4-118">For input events that support paired tunnel/bubble events, the tunneling route may have marked the event pair handled.</span></span> <span data-ttu-id="83ef4-119">ルーティング イベントの詳細については、「[ルーティング イベントの概要](routed-events-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="83ef4-119">For more information about routed events, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
## <a name="limitations-of-handles-for-adding-handlers"></a><span data-ttu-id="83ef4-120">ハンドラーを追加するための "処理" の制限事項</span><span class="sxs-lookup"><span data-stu-id="83ef4-120">Limitations of "Handles" for Adding Handlers</span></span>  
 <span data-ttu-id="83ef4-121">`Handles` は、添付イベントのハンドラーを参照できません。</span><span class="sxs-lookup"><span data-stu-id="83ef4-121">`Handles` cannot reference handlers for attached events.</span></span> <span data-ttu-id="83ef4-122">この添付イベントには `add` アクセサーメソッドを使用し、[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]では*typename*イベント属性を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83ef4-122">You must use the `add` accessor method for that attached event, or *typename.eventname* event attributes in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="83ef4-123">詳細については、「[ルーティングイベントの概要](routed-events-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="83ef4-123">For details, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="83ef4-124">ルーティングイベントの場合、インスタンスメンバーテーブルにそのイベントが存在するインスタンスに対してのみ、`Handles` を使用してハンドラーを割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="83ef4-124">For routed events, you can only use `Handles` to assign handlers for instances where that event exists in the instance members table.</span></span> <span data-ttu-id="83ef4-125">ただし、一般的なルーティングイベントでは、親要素がメンバーテーブルにそのイベントを持たない場合でも、子要素からのイベントのリスナーになります。</span><span class="sxs-lookup"><span data-stu-id="83ef4-125">However, with routed events in general, a parent element can be a listener for an event from child elements, even if the parent element does not have that event in its members table.</span></span> <span data-ttu-id="83ef4-126">属性構文では、 *typename. membername*属性フォームを使用して指定できます。これは、処理するイベントを実際に定義する型を修飾します。</span><span class="sxs-lookup"><span data-stu-id="83ef4-126">In attribute syntax, you can specify this through a *typename.membername* attribute form that qualifies which type actually defines the event you want to handle.</span></span> <span data-ttu-id="83ef4-127">たとえば、(`Click` イベントが定義されていない) 親 `Page` は、`Button.Click`の形式で属性ハンドラーを割り当てることにより、ボタンクリックイベントをリッスンできます。</span><span class="sxs-lookup"><span data-stu-id="83ef4-127">For instance, a parent `Page` (with no `Click` event defined) can listen for button-click events by assigning an attribute handler in the form `Button.Click`.</span></span> <span data-ttu-id="83ef4-128">ただし `Handles` では、競合する*インスタンスのイベント*フォームをサポートする必要があるため、 *typename*フォームはサポートされません。</span><span class="sxs-lookup"><span data-stu-id="83ef4-128">But `Handles` does not support the *typename.membername* form, because it must support a conflicting *Instance.Event* form.</span></span> <span data-ttu-id="83ef4-129">詳細については、「[ルーティングイベントの概要](routed-events-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="83ef4-129">For details, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="83ef4-130">既に処理済みとマークされているイベントに対して呼び出されるハンドラーをアタッチ `Handles` ことはできません。</span><span class="sxs-lookup"><span data-stu-id="83ef4-130">`Handles` cannot attach handlers that are invoked for events that are already marked handled.</span></span> <span data-ttu-id="83ef4-131">代わりに、コードを使用し、<xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>の `handledEventsToo` オーバーロードを呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="83ef4-131">Instead, you must use code and call the `handledEventsToo` overload of <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="83ef4-132">XAML で同じイベントに対してイベントハンドラーを指定する場合は、Visual Basic コードで `Handles` 構文を使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="83ef4-132">Do not use the `Handles` syntax in Visual Basic code when you specify an event handler for the same event in XAML.</span></span> <span data-ttu-id="83ef4-133">この場合、イベントハンドラーは2回呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="83ef4-133">In this case, the event handler is called twice.</span></span>  
  
## <a name="how-wpf-implements-handles-functionality"></a><span data-ttu-id="83ef4-134">WPF が "ハンドル" 機能を実装する方法</span><span class="sxs-lookup"><span data-stu-id="83ef4-134">How WPF Implements "Handles" Functionality</span></span>  
 <span data-ttu-id="83ef4-135">[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] ページがコンパイルされると、中間ファイルによって、<xref:System.Windows.FrameworkContentElement.Name%2A> プロパティが設定されている (または[X:Name ディレクティブ](../../../desktop-wpf/xaml-services/xname-directive.md)が宣言されている) ページ上のすべての要素への `Friend` `WithEvents` 参照が宣言されます。</span><span class="sxs-lookup"><span data-stu-id="83ef4-135">When a [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] page is compiled, the intermediate file declares `Friend` `WithEvents` references to every element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property set (or [x:Name Directive](../../../desktop-wpf/xaml-services/xname-directive.md) declared).</span></span> <span data-ttu-id="83ef4-136">各名前付きインスタンスは、`Handles`によってハンドラーに割り当てることができる要素である可能性があります。</span><span class="sxs-lookup"><span data-stu-id="83ef4-136">Each named instance is potentially an element that can be assigned to a handler through `Handles`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="83ef4-137">Visual Studio では、IntelliSense を使用して、ページ内の `Handles` 参照に使用できる要素の完了を確認できます。</span><span class="sxs-lookup"><span data-stu-id="83ef4-137">Within Visual Studio, IntelliSense can show you completion for which elements are available for a `Handles` reference in a page.</span></span> <span data-ttu-id="83ef4-138">ただし、この場合、中間ファイルがすべての `Friends` 参照を設定できるように、1つのコンパイルパスが必要になることがあります。</span><span class="sxs-lookup"><span data-stu-id="83ef4-138">However, this might take one compile pass so that the intermediate file can populate all the `Friends` references.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="83ef4-139">参照</span><span class="sxs-lookup"><span data-stu-id="83ef4-139">See also</span></span>

- <xref:System.Windows.UIElement.AddHandler%2A>
- [<span data-ttu-id="83ef4-140">ルーティング イベントの処理済みとしてのマーキング、およびクラス処理</span><span class="sxs-lookup"><span data-stu-id="83ef4-140">Marking Routed Events as Handled, and Class Handling</span></span>](marking-routed-events-as-handled-and-class-handling.md)
- [<span data-ttu-id="83ef4-141">ルーティング イベントの概要</span><span class="sxs-lookup"><span data-stu-id="83ef4-141">Routed Events Overview</span></span>](routed-events-overview.md)
- [<span data-ttu-id="83ef4-142">XAML の概要 (WPF)</span><span class="sxs-lookup"><span data-stu-id="83ef4-142">XAML Overview (WPF)</span></span>](../../../desktop-wpf/fundamentals/xaml.md)
