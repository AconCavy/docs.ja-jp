---
title: 技術領域の概要
ms.date: 03/30/2017
helpviewer_keywords:
- window regions [WPF]
- Win32 code [WPF], WPF interoperation
- Win32 code [WPF], airspace
- airspace [WPF]
- interoperability [WPF], airspace
- Win32 code [WPF], window regions
ms.assetid: b7cc350f-b9e2-48b1-be14-60f3d853222e
ms.openlocfilehash: 0b6ad222737f992da3074770fb5a2bff17860c00
ms.sourcegitcommit: 9a97c76e141333394676bc5d264c6624b6f45bcf
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/08/2020
ms.locfileid: "75740294"
---
# <a name="technology-regions-overview"></a><span data-ttu-id="2502a-102">技術領域の概要</span><span class="sxs-lookup"><span data-stu-id="2502a-102">Technology Regions Overview</span></span>
<span data-ttu-id="2502a-103">WPF、Win32、DirectX などのアプリケーションで複数の表示テクノロジを使用する場合、共通のトップレベル ウィンドウ内のレンダリング領域を共有する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2502a-103">If multiple presentation technologies are used in an application, such as WPF, Win32, or DirectX, they must share the rendering areas within a common top-level window.</span></span> <span data-ttu-id="2502a-104">このトピックでは、WPF 相互運用アプリケーションの表示と入力に影響する可能性がある問題について説明します。</span><span class="sxs-lookup"><span data-stu-id="2502a-104">This topic describes issues that might influence the presentation and input for your WPF interoperation application.</span></span>  
  
## <a name="regions"></a><span data-ttu-id="2502a-105">領域</span><span class="sxs-lookup"><span data-stu-id="2502a-105">Regions</span></span>  
 <span data-ttu-id="2502a-106">トップレベル ウィンドウ内では、相互運用アプリケーションのテクノロジの 1 つを構成する各 HWND に独自の領域 ("空域" とも呼ばれます) があることを概念化することができます。</span><span class="sxs-lookup"><span data-stu-id="2502a-106">Within a top-level window, you can conceptualize that each HWND that comprises one of the technologies of an interoperation application has its own region (also called "airspace").</span></span> <span data-ttu-id="2502a-107">ウィンドウ内の個々のピクセルは 1 つの HWND に属し、それによってその HWND の領域が構成されます</span><span class="sxs-lookup"><span data-stu-id="2502a-107">Each pixel within the window belongs to exactly one HWND, which constitutes the region of that HWND.</span></span> <span data-ttu-id="2502a-108">(厳密に言えば、複数の [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] HWND がある場合は複数の [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 領域がありますが、この説明の目的として、存在するのは 1 つのみと想定してください)。</span><span class="sxs-lookup"><span data-stu-id="2502a-108">(Strictly speaking, there is more than one [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] region if there is more than one [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] HWND, but for purposes of this discussion, you can assume there is only one).</span></span> <span data-ttu-id="2502a-109">この領域は、すべてのレイヤーまたは他のウィンドウは、アプリケーションの有効期間中にそのピクセル上にレンダリングされる場合、同じレンダリングレベル テクノロジに含まれる必要があることを意味します。</span><span class="sxs-lookup"><span data-stu-id="2502a-109">The region implies that all layers or other windows that attempt to render above that pixel during application lifetime must be part of the same render-level technology.</span></span> <span data-ttu-id="2502a-110">Win32 で [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] ピクセルをレンダリングしようとすると、望ましくない結果が生じるため、可能な限り相互運用 API によって禁止されます。</span><span class="sxs-lookup"><span data-stu-id="2502a-110">Attempting to render [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pixels over Win32 leads to undesirable results, and is disallowed as much as possible through the interoperation APIs.</span></span>  
  
### <a name="region-examples"></a><span data-ttu-id="2502a-111">領域の例</span><span class="sxs-lookup"><span data-stu-id="2502a-111">Region Examples</span></span>  
 <span data-ttu-id="2502a-112">次の図は、Win32、DirectX、および [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] が混在するアプリケーションを示しています。</span><span class="sxs-lookup"><span data-stu-id="2502a-112">The following illustration shows an application that mixes Win32, DirectX, and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span> <span data-ttu-id="2502a-113">各テクノロジには個別の重複しないピクセル セットが使用されているので、領域に関する問題はありません。</span><span class="sxs-lookup"><span data-stu-id="2502a-113">Each technology uses its own separate, non-overlapping set of pixels, and there are no region issues.</span></span>  
  
 ![Win32、DirectX、および WPF が混在するアプリケーションの例。](./media/technology-regions-overview/win32-directx-windows-presentation-foundation-application.png)  
  
 <span data-ttu-id="2502a-115">このアプリケーションでは、マウス ポインターの位置を使用して、これら 3 つの領域のいずれかにレンダリングされるアニメーションが作成されるとします。</span><span class="sxs-lookup"><span data-stu-id="2502a-115">Suppose that this application uses the mouse pointer position to create an animation that attempts to render over any of these three regions.</span></span> <span data-ttu-id="2502a-116">アニメーションにどのようなテクノロジが使われたかにかかわらず、そのテクノロジは他の 2 つの領域に違反しています。</span><span class="sxs-lookup"><span data-stu-id="2502a-116">No matter which technology was responsible for the animation itself, that technology would violate the region of the other two.</span></span> <span data-ttu-id="2502a-117">次の図は、Win32 領域上に WPF の円をレンダリングする試行を示しています。</span><span class="sxs-lookup"><span data-stu-id="2502a-117">The following illustration shows an attempt to render a WPF circle over a Win32 region.</span></span>  
  
 ![Win32 領域上に WPF の円をレンダリングする試行。](./media/technology-regions-overview/render-windows-presentation-foundation-circle-over-win32-region.png)  
  
 <span data-ttu-id="2502a-119">もう 1 つの違反は、異なるテクノロジ間で透明度またはアルファ ブレンドを使用しようとする場合です。</span><span class="sxs-lookup"><span data-stu-id="2502a-119">Another violation is if you try to use transparency/alpha blending between different technologies.</span></span>  <span data-ttu-id="2502a-120">次の図の [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] ボックスは Win32 および DirectX 領域に違反しています。</span><span class="sxs-lookup"><span data-stu-id="2502a-120">In the following illustration, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] box violates the Win32 and DirectX regions.</span></span> <span data-ttu-id="2502a-121">その [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]ボックスのピクセルは半透明なので、DirectX と [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] の両方によって共同で所有される必要がありますが、それは不可能です。</span><span class="sxs-lookup"><span data-stu-id="2502a-121">Because pixels in that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] box are semi-transparent, they would have to be owned jointly by both DirectX and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], which is not possible.</span></span>  <span data-ttu-id="2502a-122">そのため、これはもう 1 つの違反であり、構築できません。</span><span class="sxs-lookup"><span data-stu-id="2502a-122">So this is another violation and cannot be built.</span></span>  
  
 ![Win32 および DirectX 領域に違反する WPF ボックスを示す図。](./media/technology-regions-overview/windows-foundation-presentation-box-violate-win32-directx-region.png)  
  
 <span data-ttu-id="2502a-124">前述した 3 つの例では四角形の領域を使用しましたが、異なるシェイプも考えられます。</span><span class="sxs-lookup"><span data-stu-id="2502a-124">The previous three examples used rectangular regions, but different shapes are possible.</span></span>  <span data-ttu-id="2502a-125">たとえば、穴のある領域も使用できます。</span><span class="sxs-lookup"><span data-stu-id="2502a-125">For example, a region can have a hole.</span></span> <span data-ttu-id="2502a-126">次の図は、四角形の穴がある Win32 領域を示しています。これは、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 領域と DirectX 領域を合わせたサイズです。</span><span class="sxs-lookup"><span data-stu-id="2502a-126">The following illustration shows a Win32 region with a rectangular hole this is the size of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and DirectX regions combined.</span></span>  
  
 ![四角形の穴がある Win32 領域を示す図。](./media/technology-regions-overview/win32-region-rectangular-hole.png)  
  
 <span data-ttu-id="2502a-128">領域は、完全に四角形以外にすることや、Win32 HRGN (領域) で記述できる任意のシェイプにすることができます。</span><span class="sxs-lookup"><span data-stu-id="2502a-128">Regions can also be completely nonrectangular, or any shape describable by a Win32 HRGN (region).</span></span>  
  
 ![四角形以外の領域を示す図。](./media/technology-regions-overview/nonrectangular-win32-region.png)  
  
## <a name="transparency-and-top-level-windows"></a><span data-ttu-id="2502a-130">透明度とトップレベル ウィンドウ</span><span class="sxs-lookup"><span data-stu-id="2502a-130">Transparency and Top-Level Windows</span></span>  
 <span data-ttu-id="2502a-131">Windows のウィンドウ マネージャーでは、実際には Win32 HWND のみが処理されます。</span><span class="sxs-lookup"><span data-stu-id="2502a-131">The window manager in Windows only really processes Win32 HWNDs.</span></span> <span data-ttu-id="2502a-132">そのため、すべての [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> は HWND です。</span><span class="sxs-lookup"><span data-stu-id="2502a-132">Therefore, every [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> is an HWND.</span></span> <span data-ttu-id="2502a-133"><xref:System.Windows.Window> HWND は、すべての HWND の一般的な規則に従う必要があります。</span><span class="sxs-lookup"><span data-stu-id="2502a-133">The <xref:System.Windows.Window> HWND must abide by the general rules for any HWND.</span></span> <span data-ttu-id="2502a-134">その HWND 内で、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] コードでは、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] API 全体がサポートするあらゆることを実行できます。</span><span class="sxs-lookup"><span data-stu-id="2502a-134">Within that HWND, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] code can do whatever the overall [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] APIs support.</span></span> <span data-ttu-id="2502a-135">ただし、デスクトップ上の他の HWND との相互作用の場合、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] は Win32 処理とレンダリング規則に従う必要があります。</span><span class="sxs-lookup"><span data-stu-id="2502a-135">But for interactions with other HWNDs on the desktop, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] must abide by Win32 processing and rendering rules.</span></span>  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="2502a-136">は、Win32 API (四角形以外のウィンドウには HRGN、ピクセル単位のアルファにはレイヤード ウィンドウ) を使用することで、四角形以外のウィンドウをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="2502a-136">supports non-rectangular windows by using Win32 APIs—HRGNs for non-rectangular windows, and layered windows for a per-pixel alpha.</span></span>  
  
 <span data-ttu-id="2502a-137">定数アルファ キーとカラー キーはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="2502a-137">Constant alpha and color keys are not supported.</span></span>  <span data-ttu-id="2502a-138">Win32 レイヤード ウィンドウ機能は、プラットフォームによって異なります。</span><span class="sxs-lookup"><span data-stu-id="2502a-138">Win32 layered window capabilities vary by platform.</span></span>  
  
 <span data-ttu-id="2502a-139">レイヤード ウィンドウは、ウィンドウ内のすべてのピクセルに適用するアルファ値を指定することにより、ウィンドウ全体を半透明にすることができます</span><span class="sxs-lookup"><span data-stu-id="2502a-139">Layered windows can make the entire window translucent (semi-transparent) by specifying an alpha value to apply to every pixel in the window.</span></span>  <span data-ttu-id="2502a-140">(Win32 では実際にはピクセル単位のアルファをサポートしていますが、このモードでは、ダイアログやドロップダウンを含め、子 HWND を自分で描画する必要があるため、これを実際のプログラムで使用するのは非常に困難です)。</span><span class="sxs-lookup"><span data-stu-id="2502a-140">(Win32 in fact supports per-pixel alpha, but this is very difficult to use in practical programs because in this mode you would need to draw any child HWND yourself, including dialogs and dropdowns).</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="2502a-141">では HRGN をサポートしています。ただし、この機能用のマネージド API はありません。</span><span class="sxs-lookup"><span data-stu-id="2502a-141">supports HRGNs; however, there are no managed APIs for this functionality.</span></span> <span data-ttu-id="2502a-142">プラットフォームの呼び出しと <xref:System.Windows.Interop.HwndSource> を使用して、関連する Win32 API を呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="2502a-142">You can use platform invoke and <xref:System.Windows.Interop.HwndSource> to call the relevant Win32 APIs.</span></span> <span data-ttu-id="2502a-143">詳細については、「[マネージド コードからのネイティブ関数の呼び出し](/cpp/dotnet/calling-native-functions-from-managed-code)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2502a-143">For more information, see [Calling Native Functions from Managed Code](/cpp/dotnet/calling-native-functions-from-managed-code).</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="2502a-144">レイヤード ウィンドウは、オペレーティング システムによって機能が異なります。</span><span class="sxs-lookup"><span data-stu-id="2502a-144">layered windows have different capabilities on different operating systems.</span></span> <span data-ttu-id="2502a-145">これは、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] にレンダリングに DirectX が使用され、レイヤード ウィンドウが DirectX レンダリングではなく主に GDI レンダリング用に設計されたためです。</span><span class="sxs-lookup"><span data-stu-id="2502a-145">This is because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses DirectX to render, and layered windows were primarily designed for GDI rendering, not DirectX rendering.</span></span>  
  
- <span data-ttu-id="2502a-146">WPF では、ハードウェア アクセラレータによるレイヤード ウィンドウをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="2502a-146">WPF supports hardware accelerated layered windows.</span></span>  
  
- [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="2502a-147">では透明カラー キーをサポートしていません。これは、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] では要求された正確な色のレンダリングを保証できないためです。レンダリングにハードウェア アクセラレータが使用される場合は特にそうです。</span><span class="sxs-lookup"><span data-stu-id="2502a-147">does not support transparency color keys, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] cannot guarantee to render the exact color you requested, particularly when rendering is hardware-accelerated.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2502a-148">関連項目</span><span class="sxs-lookup"><span data-stu-id="2502a-148">See also</span></span>

- [<span data-ttu-id="2502a-149">WPF と Win32 の相互運用性</span><span class="sxs-lookup"><span data-stu-id="2502a-149">WPF and Win32 Interoperation</span></span>](wpf-and-win32-interoperation.md)
- [<span data-ttu-id="2502a-150">チュートリアル: Win32 での WPF クロックのホスト</span><span class="sxs-lookup"><span data-stu-id="2502a-150">Walkthrough: Hosting a WPF Clock in Win32</span></span>](walkthrough-hosting-a-wpf-clock-in-win32.md)
- [<span data-ttu-id="2502a-151">WPF での Win32 コンテンツのホスト</span><span class="sxs-lookup"><span data-stu-id="2502a-151">Hosting Win32 Content in WPF</span></span>](hosting-win32-content-in-wpf.md)
