---
title: ControlTemplate の作成による既存のコントロールの外観のカスタマイズ
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- control contract [WPF]
- controls [WPF], visual structure changes
- ControlTemplate [WPF], customizing for existing controls
- skinning controls [WPF]
- controls [WPF], appearance specified by state
- templates [WPF], custom for existing controls
ms.assetid: 678dd116-43a2-4b8c-82b5-6b826f126e31
ms.openlocfilehash: 6d7401f9614e663351968dc6a2f85548735a176d
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/03/2019
ms.locfileid: "73460426"
---
# <a name="customizing-the-appearance-of-an-existing-control-by-creating-a-controltemplate"></a><span data-ttu-id="a7d2e-102">ControlTemplate の作成による既存のコントロールの外観のカスタマイズ</span><span class="sxs-lookup"><span data-stu-id="a7d2e-102">Customizing the Appearance of an Existing Control by Creating a ControlTemplate</span></span>
<a name="introduction"></a><span data-ttu-id="a7d2e-103">コントロールの視覚的な構造と視覚的な動作を指定 <xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-103">A <xref:System.Windows.Controls.ControlTemplate> specifies the visual structure and visual behavior of a control.</span></span> <span data-ttu-id="a7d2e-104">コントロールの外観をカスタマイズするには、新しい <xref:System.Windows.Controls.ControlTemplate>を指定します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-104">You can customize the appearance of a control by giving it a new <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="a7d2e-105"><xref:System.Windows.Controls.ControlTemplate>を作成すると、その機能を変更せずに既存のコントロールの外観を置き換えることができます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-105">When you create a <xref:System.Windows.Controls.ControlTemplate>, you replace the appearance of an existing control without changing its functionality.</span></span> <span data-ttu-id="a7d2e-106">たとえば、既定の四角形の形ではなく、アプリケーションのボタンを丸めることができますが、ボタンをクリックすると <xref:System.Windows.Controls.Primitives.ButtonBase.Click> イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-106">For example, you can make the buttons in your application round instead of the default square shape, but the button will still raise the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event.</span></span>

 <span data-ttu-id="a7d2e-107">このトピックでは、<xref:System.Windows.Controls.ControlTemplate>のさまざまな部分について説明し、<xref:System.Windows.Controls.Button>の単純な <xref:System.Windows.Controls.ControlTemplate> を作成する方法と、コントロールのコントロールコントラクトを理解してその外観をカスタマイズできるようにする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-107">This topic explains the various parts of a <xref:System.Windows.Controls.ControlTemplate>, demonstrates creating a simple <xref:System.Windows.Controls.ControlTemplate> for a <xref:System.Windows.Controls.Button>, and explains how to understand the control contract of a control so that you can customize its appearance.</span></span> <span data-ttu-id="a7d2e-108">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]に <xref:System.Windows.Controls.ControlTemplate> を作成するため、コードを記述することなく、コントロールの外観を変更できます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-108">Because you create a <xref:System.Windows.Controls.ControlTemplate> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can change a control's appearance without writing any code.</span></span> <span data-ttu-id="a7d2e-109">Blend for Visual Studio などのデザイナーを使用して、カスタムコントロールテンプレートを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-109">You can also use a designer, such as Blend for Visual Studio, to create custom control templates.</span></span> <span data-ttu-id="a7d2e-110">このトピックでは、<xref:System.Windows.Controls.Button> の外観をカスタマイズする [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] の例を示し、トピックの最後にある完全な例を示します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-110">This topic shows examples in the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] that customize the appearance of a <xref:System.Windows.Controls.Button> and lists the complete example at the end of the topic.</span></span> <span data-ttu-id="a7d2e-111">Blend for Visual Studio の使用方法の詳細については、「[テンプレートをサポートするコントロールのスタイル](https://go.microsoft.com/fwlink/?LinkId=161153)を設定する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-111">For more information about using Blend for Visual Studio, see [Styling a control that supports templates](https://go.microsoft.com/fwlink/?LinkId=161153).</span></span>

 <span data-ttu-id="a7d2e-112">次の図は、このトピックで作成した <xref:System.Windows.Controls.ControlTemplate> を使用する <xref:System.Windows.Controls.Button> を示しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-112">The following illustrations show a <xref:System.Windows.Controls.Button> that uses the <xref:System.Windows.Controls.ControlTemplate> that is created in this topic.</span></span>

 <span data-ttu-id="a7d2e-113">![カスタム コントロール テンプレートを使用したボタン](./media/ndp-buttonnormal.png "NDP_ButtonNormal")</span><span class="sxs-lookup"><span data-stu-id="a7d2e-113">![A button with a custom control template.](./media/ndp-buttonnormal.png "NDP_ButtonNormal")</span></span>
<span data-ttu-id="a7d2e-114">カスタム コントロール テンプレートを使用しているボタン</span><span class="sxs-lookup"><span data-stu-id="a7d2e-114">A button that uses a custom control template</span></span>

 <span data-ttu-id="a7d2e-115">![赤い境界線付きのボタン](./media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span><span class="sxs-lookup"><span data-stu-id="a7d2e-115">![A button with a red border.](./media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span></span>
<span data-ttu-id="a7d2e-116">カスタム コントロール テンプレートを使用したボタンにマウス ポインターを置いた状態</span><span class="sxs-lookup"><span data-stu-id="a7d2e-116">A button that uses a custom control template and has the mouse pointer over it</span></span>

<a name="prerequisites"></a>
## <a name="prerequisites"></a><span data-ttu-id="a7d2e-117">必要条件</span><span class="sxs-lookup"><span data-stu-id="a7d2e-117">Prerequisites</span></span>
 <span data-ttu-id="a7d2e-118">このトピックは、「[コントロール](index.md)」で説明したコントロールとスタイルの作成方法および使用方法を理解していることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-118">This topic assumes that you understand how to create and use controls and styles as discussed in [Controls](index.md).</span></span> <span data-ttu-id="a7d2e-119">このトピックで説明する概念は、<xref:System.Windows.Controls.Control> クラスを継承する要素に適用されます。ただし、<xref:System.Windows.Controls.UserControl>は除きます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-119">The concepts discussed in this topic apply to elements that inherit from the <xref:System.Windows.Controls.Control> class, except for the <xref:System.Windows.Controls.UserControl>.</span></span> <span data-ttu-id="a7d2e-120"><xref:System.Windows.Controls.UserControl>に <xref:System.Windows.Controls.ControlTemplate> を適用することはできません。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-120">You cannot apply a <xref:System.Windows.Controls.ControlTemplate> to a <xref:System.Windows.Controls.UserControl>.</span></span>

<a name="when_you_should_create_a_controltemplate"></a>
## <a name="when-you-should-create-a-controltemplate"></a><span data-ttu-id="a7d2e-121">ControlTemplate の作成が必要な場合</span><span class="sxs-lookup"><span data-stu-id="a7d2e-121">When You Should Create a ControlTemplate</span></span>
 <span data-ttu-id="a7d2e-122">コントロールには <xref:System.Windows.Controls.Border.Background%2A>、<xref:System.Windows.Controls.Control.Foreground%2A>、<xref:System.Windows.Controls.Control.FontFamily%2A>などの多くのプロパティがあります。このプロパティを設定すると、コントロールの外観のさまざまな側面を指定できますが、これらのプロパティを設定することによって行うことができる変更は制限されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-122">Controls have many properties, such as <xref:System.Windows.Controls.Border.Background%2A>, <xref:System.Windows.Controls.Control.Foreground%2A>, and <xref:System.Windows.Controls.Control.FontFamily%2A>, that you can set to specify different aspects of the control's appearance, but the changes that you can make by setting these properties are limited.</span></span> <span data-ttu-id="a7d2e-123">たとえば、<xref:System.Windows.Controls.CheckBox>では、<xref:System.Windows.Controls.Control.Foreground%2A> プロパティを blue に、<xref:System.Windows.Controls.Control.FontStyle%2A> を斜体に設定できます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-123">For example, you can set the <xref:System.Windows.Controls.Control.Foreground%2A> property to blue and <xref:System.Windows.Controls.Control.FontStyle%2A> to italic on a <xref:System.Windows.Controls.CheckBox>.</span></span>

 <span data-ttu-id="a7d2e-124">コントロール用の新しい <xref:System.Windows.Controls.ControlTemplate> を作成する機能がないと、すべての [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]ベースのアプリケーションのすべてのコントロールの全般的な外観は同じになります。これにより、カスタムの外観でアプリケーションを作成する機能が制限されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-124">Without the ability to create a new <xref:System.Windows.Controls.ControlTemplate> for controls, all controls in every [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based application would have the same general appearance, which would limit the ability to create an application with a custom look and feel.</span></span> <span data-ttu-id="a7d2e-125">既定では、すべての <xref:System.Windows.Controls.CheckBox> に同様の特性があります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-125">By default, every <xref:System.Windows.Controls.CheckBox> has similar characteristics.</span></span> <span data-ttu-id="a7d2e-126">たとえば、<xref:System.Windows.Controls.CheckBox> の内容は常に選択インジケーターの右側にあり、チェックマークは、<xref:System.Windows.Controls.CheckBox> が選択されていることを示すために常に使用されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-126">For example, the content of the <xref:System.Windows.Controls.CheckBox> is always to the right of the selection indicator, and the check mark is always used to indicate that the <xref:System.Windows.Controls.CheckBox> is selected.</span></span>

 <span data-ttu-id="a7d2e-127">コントロールの他のプロパティが行う設定よりも、コントロールの外観をカスタマイズする必要がある場合は、<xref:System.Windows.Controls.ControlTemplate> を作成します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-127">You create a <xref:System.Windows.Controls.ControlTemplate> when you want to customize the control's appearance beyond what setting the other properties on the control will do.</span></span> <span data-ttu-id="a7d2e-128"><xref:System.Windows.Controls.CheckBox>の例では、チェックボックスの内容を選択インジケーターの上に配置し、<xref:System.Windows.Controls.CheckBox> が選択されていることを X で示す必要があるとします。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-128">In the example of the <xref:System.Windows.Controls.CheckBox>, suppose that you want the content of the check box to be above the selection indicator and you want an X to indicate that the <xref:System.Windows.Controls.CheckBox> is selected.</span></span> <span data-ttu-id="a7d2e-129">これらの変更は、<xref:System.Windows.Controls.CheckBox>の <xref:System.Windows.Controls.ControlTemplate> で指定します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-129">You specify these changes in the <xref:System.Windows.Controls.ControlTemplate> of the <xref:System.Windows.Controls.CheckBox>.</span></span>

 <span data-ttu-id="a7d2e-130">次の図は、既定の <xref:System.Windows.Controls.ControlTemplate>を使用する <xref:System.Windows.Controls.CheckBox> を示しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-130">The following illustration shows a <xref:System.Windows.Controls.CheckBox> that uses a default <xref:System.Windows.Controls.ControlTemplate>.</span></span>

 <span data-ttu-id="a7d2e-131">![既定のコントロール テンプレートを使用するチェックボックス。](./media/ndp-checkboxdefault.png "NDP_CheckBoxDefault")</span><span class="sxs-lookup"><span data-stu-id="a7d2e-131">![A checkbox with the default control template.](./media/ndp-checkboxdefault.png "NDP_CheckBoxDefault")</span></span>
<span data-ttu-id="a7d2e-132">既定のコントロール テンプレートを使用する CheckBox</span><span class="sxs-lookup"><span data-stu-id="a7d2e-132">A CheckBox that uses the default control template</span></span>

 <span data-ttu-id="a7d2e-133">次の図は、カスタム <xref:System.Windows.Controls.ControlTemplate> を使用して <xref:System.Windows.Controls.CheckBox> の内容を選択インジケーターの上に配置し、<xref:System.Windows.Controls.CheckBox> を選択したときに X を表示する <xref:System.Windows.Controls.CheckBox> を示しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-133">The following illustration shows a <xref:System.Windows.Controls.CheckBox> that uses a custom <xref:System.Windows.Controls.ControlTemplate> to place the content of the <xref:System.Windows.Controls.CheckBox> above the selection indicator and displays an X when the <xref:System.Windows.Controls.CheckBox> is selected.</span></span>

 <span data-ttu-id="a7d2e-134">![カスタム コントロール テンプレートを使用するチェックボックス。](./media/ndp-checkboxcustom.png "NDP_CheckBoxCustom")</span><span class="sxs-lookup"><span data-stu-id="a7d2e-134">![A checkbox with a custom control template.](./media/ndp-checkboxcustom.png "NDP_CheckBoxCustom")</span></span>
<span data-ttu-id="a7d2e-135">カスタム コントロール テンプレートを使用する CheckBox</span><span class="sxs-lookup"><span data-stu-id="a7d2e-135">A CheckBox that uses a custom control template</span></span>

 <span data-ttu-id="a7d2e-136">このサンプルの <xref:System.Windows.Controls.CheckBox> の <xref:System.Windows.Controls.ControlTemplate> は比較的複雑であるため、このトピックでは <xref:System.Windows.Controls.Button>の <xref:System.Windows.Controls.ControlTemplate> を作成する簡単な例を使用します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-136">The <xref:System.Windows.Controls.ControlTemplate> for the <xref:System.Windows.Controls.CheckBox> in this sample is relatively complex, so this topic uses a simpler example of creating a <xref:System.Windows.Controls.ControlTemplate> for a <xref:System.Windows.Controls.Button>.</span></span>

<a name="changing_the_visual_structure_of_a_control"></a>
## <a name="changing-the-visual-structure-of-a-control"></a><span data-ttu-id="a7d2e-137">コントロールの視覚的な構造の変更</span><span class="sxs-lookup"><span data-stu-id="a7d2e-137">Changing the Visual Structure of a Control</span></span>
 <span data-ttu-id="a7d2e-138">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]では、多くの場合、コントロールは複合 <xref:System.Windows.FrameworkElement> オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-138">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], a control is often a composite <xref:System.Windows.FrameworkElement> objects.</span></span> <span data-ttu-id="a7d2e-139"><xref:System.Windows.Controls.ControlTemplate>を作成するときに、<xref:System.Windows.FrameworkElement> オブジェクトを組み合わせて1つのコントロールを作成します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-139">When you create a <xref:System.Windows.Controls.ControlTemplate>, you combine <xref:System.Windows.FrameworkElement> objects to build a single control.</span></span> <span data-ttu-id="a7d2e-140"><xref:System.Windows.Controls.ControlTemplate> には、ルート要素として <xref:System.Windows.FrameworkElement> が1つだけ必要です。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-140">A <xref:System.Windows.Controls.ControlTemplate> must have only one <xref:System.Windows.FrameworkElement> as its root element.</span></span> <span data-ttu-id="a7d2e-141">ルート要素には、通常、他の <xref:System.Windows.FrameworkElement> オブジェクトが含まれます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-141">The root element usually contains other <xref:System.Windows.FrameworkElement> objects.</span></span> <span data-ttu-id="a7d2e-142">複数のオブジェクトを組み合わせて、コントロールの視覚的な構造を構成します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-142">The combination of objects makes up the control's visual structure.</span></span>

 <span data-ttu-id="a7d2e-143">次の例では、<xref:System.Windows.Controls.Button>のカスタム <xref:System.Windows.Controls.ControlTemplate> を作成します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-143">The following example creates a custom <xref:System.Windows.Controls.ControlTemplate> for the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="a7d2e-144"><xref:System.Windows.Controls.ControlTemplate> によって、<xref:System.Windows.Controls.Button>のビジュアル構造が作成されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-144">The <xref:System.Windows.Controls.ControlTemplate> creates the visual structure of the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="a7d2e-145">この例では、ボタンの上にマウス ポインターを移動しても、ボタンをクリックしても、その外観は変化しません。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-145">This example does not change the button's appearance when you move the mouse pointer over it or click it.</span></span> <span data-ttu-id="a7d2e-146">状態に応じて外観が変化するボタンについては、このトピックで後述します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-146">Changing the button's appearance when it is in a different state is discussed later in this topic.</span></span>

 <span data-ttu-id="a7d2e-147">この例では、以下のパーツで視覚的な構造を構成しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-147">In this example, the visual structure consists of the following parts:</span></span>

- <span data-ttu-id="a7d2e-148">テンプレートのルート <xref:System.Windows.FrameworkElement>として機能する `RootElement` という名前の <xref:System.Windows.Controls.Border>。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-148">A <xref:System.Windows.Controls.Border> named `RootElement` that serves as the template's root <xref:System.Windows.FrameworkElement>.</span></span>

- <span data-ttu-id="a7d2e-149">`RootElement`の子である <xref:System.Windows.Controls.Grid>。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-149">A <xref:System.Windows.Controls.Grid> that is a child of `RootElement`.</span></span>

- <span data-ttu-id="a7d2e-150">ボタンの内容を表示する <xref:System.Windows.Controls.ContentPresenter>。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-150">A <xref:System.Windows.Controls.ContentPresenter> that displays the button's content.</span></span> <span data-ttu-id="a7d2e-151"><xref:System.Windows.Controls.ContentPresenter> を使用すると、任意の型のオブジェクトを表示できます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-151">The <xref:System.Windows.Controls.ContentPresenter> enables any type of object to be displayed.</span></span>

 [!code-xaml[VSMButtonTemplate#BasicTemplate](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#basictemplate)]

### <a name="preserving-the-functionality-of-a-controls-properties-by-using-templatebinding"></a><span data-ttu-id="a7d2e-152">TemplateBinding を使用してコントロールのプロパティの機能を維持する方法</span><span class="sxs-lookup"><span data-stu-id="a7d2e-152">Preserving the Functionality of a Control's Properties by Using TemplateBinding</span></span>
 <span data-ttu-id="a7d2e-153">新しい <xref:System.Windows.Controls.ControlTemplate>を作成する場合でも、パブリックプロパティを使用してコントロールの外観を変更することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-153">When you create a new <xref:System.Windows.Controls.ControlTemplate>, you still might want to use the public properties to change the control's appearance.</span></span> <span data-ttu-id="a7d2e-154">[TemplateBinding](../advanced/templatebinding-markup-extension.md)マークアップ拡張機能は、<xref:System.Windows.Controls.ControlTemplate> 内の要素のプロパティを、コントロールで定義されているパブリックプロパティにバインドします。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-154">The [TemplateBinding](../advanced/templatebinding-markup-extension.md) markup extension binds a property of an element that is in the <xref:System.Windows.Controls.ControlTemplate> to a public property that is defined by the control.</span></span> <span data-ttu-id="a7d2e-155">[TemplateBinding](../advanced/templatebinding-markup-extension.md) を使用すると、コントロールのプロパティをテンプレートのパラメーターとして機能させることができます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-155">When you use [TemplateBinding](../advanced/templatebinding-markup-extension.md), you enable properties on the control to act as parameters to the template.</span></span> <span data-ttu-id="a7d2e-156">つまり、コントロールのプロパティを設定すると、その値は [TemplateBinding](../advanced/templatebinding-markup-extension.md) が機能している要素に渡されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-156">That is, when a property on a control is set, that value is passed on to the element that has the [TemplateBinding](../advanced/templatebinding-markup-extension.md) on it.</span></span>

 <span data-ttu-id="a7d2e-157">次の例では、前の例の一部を繰り返します。この例では、 [TemplateBinding](../advanced/templatebinding-markup-extension.md)マークアップ拡張機能を使用して、<xref:System.Windows.Controls.ControlTemplate> 内の要素のプロパティを、ボタンで定義されているパブリックプロパティにバインドしています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-157">The following example repeats the part of the preceding example that uses the [TemplateBinding](../advanced/templatebinding-markup-extension.md) markup extension to bind properties of elements that are in the <xref:System.Windows.Controls.ControlTemplate> to public properties that are defined by the button.</span></span>

 [!code-xaml[VSMButtonTemplate#TemplateBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#templatebinding)]

 <span data-ttu-id="a7d2e-158">この例では、<xref:System.Windows.Controls.Grid> の <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> プロパティテンプレートが <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType>にバインドされています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-158">In this example, the <xref:System.Windows.Controls.Grid> has its <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> property template bound to <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="a7d2e-159"><xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> がテンプレートにバインドされているため、同じ <xref:System.Windows.Controls.ControlTemplate> を使用する複数のボタンを作成し、各ボタンの <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> を異なる値に設定することができます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-159">Because <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> is template bound, you can create multiple buttons that use the same <xref:System.Windows.Controls.ControlTemplate> and set the <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> to different values on each button.</span></span> <span data-ttu-id="a7d2e-160"><xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> が <xref:System.Windows.Controls.ControlTemplate>内の要素のプロパティにテンプレートバインドされていない場合、ボタンの <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> を設定しても、ボタンの外観には影響しません。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-160">If <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> was not template bound to a property of an element in the <xref:System.Windows.Controls.ControlTemplate>, setting the <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> of a button would have no impact on the button's appearance.</span></span>

 <span data-ttu-id="a7d2e-161">2 つのプロパティの名前は同じである必要はありません。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-161">Note that the names of the two properties do not need to be identical.</span></span> <span data-ttu-id="a7d2e-162">前の例では、<xref:System.Windows.Controls.Button> の [<xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType>] プロパティは <xref:System.Windows.Controls.ContentPresenter>の <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType> プロパティにバインドされています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-162">In the preceding example, the <xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> property of the <xref:System.Windows.Controls.Button> is template bound to the <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType> property of the <xref:System.Windows.Controls.ContentPresenter>.</span></span> <span data-ttu-id="a7d2e-163">これにより、ボタンのコンテンツを水平方向に配置できます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-163">This enables the content of the button to be positioned horizontally.</span></span> <span data-ttu-id="a7d2e-164"><xref:System.Windows.Controls.ContentPresenter> には `HorizontalContentAlignment`という名前のプロパティはありませんが、<xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> を <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType>にバインドすることはできます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-164"><xref:System.Windows.Controls.ContentPresenter> does not have a property named `HorizontalContentAlignment`, but <xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> can be bound to <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="a7d2e-165">プロパティをテンプレート バインディングするときは、ターゲットとソースのプロパティが同じ型であることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-165">When you template bind a property, be sure that the target and source properties are the same type.</span></span>

 <span data-ttu-id="a7d2e-166"><xref:System.Windows.Controls.Control> クラスは、コントロールテンプレートが設定されたときにコントロールに影響を与えるために使用する必要があるいくつかのプロパティを定義します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-166">The <xref:System.Windows.Controls.Control> class defines several properties that must be used by the control template to have an effect on the control when they are set.</span></span> <span data-ttu-id="a7d2e-167"><xref:System.Windows.Controls.ControlTemplate> でのプロパティの使用方法は、プロパティによって異なります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-167">How the <xref:System.Windows.Controls.ControlTemplate> uses the property depends on the property.</span></span> <span data-ttu-id="a7d2e-168"><xref:System.Windows.Controls.ControlTemplate> では、次のいずれかの方法でプロパティを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-168">The <xref:System.Windows.Controls.ControlTemplate> must use the property in one of the following ways:</span></span>

- <span data-ttu-id="a7d2e-169"><xref:System.Windows.Controls.ControlTemplate> テンプレート内の要素は、プロパティにバインドされます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-169">An element in the <xref:System.Windows.Controls.ControlTemplate> template binds to the property.</span></span>

- <span data-ttu-id="a7d2e-170"><xref:System.Windows.Controls.ControlTemplate> 内の要素は、親 <xref:System.Windows.FrameworkElement>からプロパティを継承します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-170">An element in the <xref:System.Windows.Controls.ControlTemplate> inherits the property from a parent <xref:System.Windows.FrameworkElement>.</span></span>

 <span data-ttu-id="a7d2e-171">次の表に、<xref:System.Windows.Controls.Control> クラスからコントロールによって継承されるビジュアルプロパティの一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-171">The following table lists the visual properties inherited by a control from the <xref:System.Windows.Controls.Control> class.</span></span> <span data-ttu-id="a7d2e-172">また、コントロールの既定のコントロール テンプレートで継承されたプロパティ値を使用するかどうか、テンプレート バインディングする必要があるかどうかも示します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-172">It also indicates whether the default control template of a control uses the inherited property value or if it must be template bound.</span></span>

|<span data-ttu-id="a7d2e-173">property</span><span class="sxs-lookup"><span data-stu-id="a7d2e-173">Property</span></span>|<span data-ttu-id="a7d2e-174">使用するメソッド</span><span class="sxs-lookup"><span data-stu-id="a7d2e-174">Usage method</span></span>|
|--------------|------------------|
|<xref:System.Windows.Controls.Control.Background%2A>|<span data-ttu-id="a7d2e-175">テンプレート バインディング</span><span class="sxs-lookup"><span data-stu-id="a7d2e-175">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.BorderThickness%2A>|<span data-ttu-id="a7d2e-176">テンプレート バインディング</span><span class="sxs-lookup"><span data-stu-id="a7d2e-176">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.BorderBrush%2A>|<span data-ttu-id="a7d2e-177">テンプレート バインディング</span><span class="sxs-lookup"><span data-stu-id="a7d2e-177">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.FontFamily%2A>|<span data-ttu-id="a7d2e-178">プロパティの継承またはテンプレート バインディング</span><span class="sxs-lookup"><span data-stu-id="a7d2e-178">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.FontSize%2A>|<span data-ttu-id="a7d2e-179">プロパティの継承またはテンプレート バインディング</span><span class="sxs-lookup"><span data-stu-id="a7d2e-179">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.FontStretch%2A>|<span data-ttu-id="a7d2e-180">プロパティの継承またはテンプレート バインディング</span><span class="sxs-lookup"><span data-stu-id="a7d2e-180">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.FontWeight%2A>|<span data-ttu-id="a7d2e-181">プロパティの継承またはテンプレート バインディング</span><span class="sxs-lookup"><span data-stu-id="a7d2e-181">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.Foreground%2A>|<span data-ttu-id="a7d2e-182">プロパティの継承またはテンプレート バインディング</span><span class="sxs-lookup"><span data-stu-id="a7d2e-182">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A>|<span data-ttu-id="a7d2e-183">テンプレート バインディング</span><span class="sxs-lookup"><span data-stu-id="a7d2e-183">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.Padding%2A>|<span data-ttu-id="a7d2e-184">テンプレート バインディング</span><span class="sxs-lookup"><span data-stu-id="a7d2e-184">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.VerticalContentAlignment%2A>|<span data-ttu-id="a7d2e-185">テンプレート バインディング</span><span class="sxs-lookup"><span data-stu-id="a7d2e-185">Template binding</span></span>|

 <span data-ttu-id="a7d2e-186">このテーブルには、<xref:System.Windows.Controls.Control> クラスから継承されたビジュアルプロパティのみが表示されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-186">The table lists only the visual properties inherited from the <xref:System.Windows.Controls.Control> class.</span></span> <span data-ttu-id="a7d2e-187">コントロールは、表に示されているプロパティとは別に、<xref:System.Windows.FrameworkElement.DataContext%2A>、<xref:System.Windows.FrameworkElement.Language%2A>、および <xref:System.Windows.Controls.TextBlock.TextDecorations%2A> の各プロパティを親フレームワーク要素から継承することもあります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-187">Apart from the properties listed in the table, a control may also inherit the <xref:System.Windows.FrameworkElement.DataContext%2A>, <xref:System.Windows.FrameworkElement.Language%2A>, and <xref:System.Windows.Controls.TextBlock.TextDecorations%2A> properties from the parent framework element.</span></span>

 <span data-ttu-id="a7d2e-188">また、<xref:System.Windows.Controls.ContentPresenter> が <xref:System.Windows.Controls.ContentControl>の <xref:System.Windows.Controls.ControlTemplate> にある場合、<xref:System.Windows.Controls.ContentPresenter> は自動的に <xref:System.Windows.Controls.ContentControl.ContentTemplate%2A> および <xref:System.Windows.Controls.ContentControl.Content%2A> のプロパティにバインドされます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-188">Also, if the <xref:System.Windows.Controls.ContentPresenter> is in the <xref:System.Windows.Controls.ControlTemplate> of a <xref:System.Windows.Controls.ContentControl>, the <xref:System.Windows.Controls.ContentPresenter> will automatically bind to the <xref:System.Windows.Controls.ContentControl.ContentTemplate%2A> and <xref:System.Windows.Controls.ContentControl.Content%2A> properties.</span></span> <span data-ttu-id="a7d2e-189">同様に、<xref:System.Windows.Controls.ItemsControl> の <xref:System.Windows.Controls.ControlTemplate> にある <xref:System.Windows.Controls.ItemsPresenter> は、<xref:System.Windows.Controls.ItemsControl.Items%2A> および <xref:System.Windows.Controls.ItemsPresenter> のプロパティに自動的にバインドされます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-189">Likewise, an <xref:System.Windows.Controls.ItemsPresenter> that is in the <xref:System.Windows.Controls.ControlTemplate> of an <xref:System.Windows.Controls.ItemsControl> will automatically bind to the <xref:System.Windows.Controls.ItemsControl.Items%2A> and <xref:System.Windows.Controls.ItemsPresenter> properties.</span></span>

 <span data-ttu-id="a7d2e-190">次の例では、前の例で定義した <xref:System.Windows.Controls.ControlTemplate> を使用する2つのボタンを作成します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-190">The following example creates two buttons that use the <xref:System.Windows.Controls.ControlTemplate> defined in the preceding example.</span></span> <span data-ttu-id="a7d2e-191">この例では、各ボタンの <xref:System.Windows.Controls.Control.Background%2A>、<xref:System.Windows.Controls.Control.Foreground%2A>、および <xref:System.Windows.Controls.Control.FontSize%2A> の各プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-191">The example sets the <xref:System.Windows.Controls.Control.Background%2A>, <xref:System.Windows.Controls.Control.Foreground%2A>, and <xref:System.Windows.Controls.Control.FontSize%2A> properties on each button.</span></span> <span data-ttu-id="a7d2e-192"><xref:System.Windows.Controls.Control.Background%2A> プロパティの設定は、<xref:System.Windows.Controls.ControlTemplate>でテンプレートにバインドされているため、効果があります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-192">Setting the <xref:System.Windows.Controls.Control.Background%2A> property has an effect because it is template bound in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="a7d2e-193"><xref:System.Windows.Controls.Control.Foreground%2A> プロパティと <xref:System.Windows.Controls.Control.FontSize%2A> プロパティがテンプレートにバインドされていない場合でも、値が継承されるため、設定が有効になります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-193">Even though the <xref:System.Windows.Controls.Control.Foreground%2A> and <xref:System.Windows.Controls.Control.FontSize%2A> properties are not template bound, setting them has an effect because their values are inherited.</span></span>

 [!code-xaml[VSMButtonTemplate#ButtonDeclaration](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#buttondeclaration)]

 <span data-ttu-id="a7d2e-194">前の例では、次の図のような出力を生成します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-194">The preceding example produces output that is similar to the following illustration.</span></span>

 <span data-ttu-id="a7d2e-195">![2 つのボタン (青色のボタンと紫色のボタン)](./media/ndp-buttontwo.png "NDP_ButtonTwo")</span><span class="sxs-lookup"><span data-stu-id="a7d2e-195">![Two buttons, one blue and one purple.](./media/ndp-buttontwo.png "NDP_ButtonTwo")</span></span>
<span data-ttu-id="a7d2e-196">背景色が異なる 2 つのボタン</span><span class="sxs-lookup"><span data-stu-id="a7d2e-196">Two buttons with different background colors</span></span>

<a name="changing_the_appearance_of_a_control_depending_on_its_state"></a>
## <a name="changing-the-appearance-of-a-control-depending-on-its-state"></a><span data-ttu-id="a7d2e-197">状態に応じたコントロールの外観の変化</span><span class="sxs-lookup"><span data-stu-id="a7d2e-197">Changing the Appearance of a Control Depending on Its State</span></span>
 <span data-ttu-id="a7d2e-198">既定の外観のボタンと前の例のボタンの違いは、既定のボタンが別の状態になったときにわずかに変化することです。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-198">The difference between a button with its default appearance and the button in the preceding example is that the default button subtly changes when it is in different states.</span></span> <span data-ttu-id="a7d2e-199">たとえば、ボタンをクリックしたときやマウス ポインターをボタンの上に置いたときに、既定のボタンは外観が変化します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-199">For example, the default button's appearance changes when the button is pressed, or when the mouse pointer is over the button.</span></span> <span data-ttu-id="a7d2e-200"><xref:System.Windows.Controls.ControlTemplate> はコントロールの機能を変更しませんが、コントロールの視覚的な動作を変更します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-200">Although the <xref:System.Windows.Controls.ControlTemplate> does not change the functionality of a control, it does change the control's visual behavior.</span></span> <span data-ttu-id="a7d2e-201">視覚的な動作とは、コントロールが特定の状態にあるときの外観を指しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-201">A visual behavior describes the control appearance when it is in a certain state.</span></span> <span data-ttu-id="a7d2e-202">コントロールの機能と視覚的な動作の違いを理解するために、ボタンの例について考えてみます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-202">To understand the difference between the functionality and visual behavior of a control, consider the button example.</span></span> <span data-ttu-id="a7d2e-203">ボタンの機能は、クリックされると <xref:System.Windows.Controls.Primitives.ButtonBase.Click> イベントを発生させることですが、ボタンの視覚的な動作は、ポイントまたは押されたときの外観を変更することです。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-203">The button's functionality is to raise the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event when it is clicked, but the button's visual behavior is to change its appearance when it is pointed to or pressed.</span></span>

 <span data-ttu-id="a7d2e-204"><xref:System.Windows.VisualState> オブジェクトを使用して、コントロールが特定の状態にあるときのコントロールの外観を指定します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-204">You use <xref:System.Windows.VisualState> objects to specify the appearance of a control when it is in a certain state.</span></span> <span data-ttu-id="a7d2e-205"><xref:System.Windows.VisualState> には、<xref:System.Windows.Controls.ControlTemplate>内の要素の外観を変更する <xref:System.Windows.Media.Animation.Storyboard> が含まれています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-205">A <xref:System.Windows.VisualState> contains a <xref:System.Windows.Media.Animation.Storyboard> that changes the appearance of the elements that are in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="a7d2e-206">コントロールのロジックが <xref:System.Windows.VisualStateManager>を使用して状態を変更するため、このようなコードを記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-206">You do not have to write any code to make this occur because the control's logic changes state by using the <xref:System.Windows.VisualStateManager>.</span></span> <span data-ttu-id="a7d2e-207">コントロールが <xref:System.Windows.VisualState.Name%2A?displayProperty=nameWithType> プロパティによって指定された状態になると、<xref:System.Windows.Media.Animation.Storyboard> が開始されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-207">When the control enters the state that is specified by the <xref:System.Windows.VisualState.Name%2A?displayProperty=nameWithType> property, the <xref:System.Windows.Media.Animation.Storyboard> begins.</span></span> <span data-ttu-id="a7d2e-208">コントロールが状態を終了すると、<xref:System.Windows.Media.Animation.Storyboard> が停止します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-208">When the control exits the state, the <xref:System.Windows.Media.Animation.Storyboard> stops.</span></span>

 <span data-ttu-id="a7d2e-209">次の例は、マウスポインターが上にあるときの <xref:System.Windows.Controls.Button> の外観を変更する <xref:System.Windows.VisualState> を示しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-209">The following example shows the <xref:System.Windows.VisualState> that changes the appearance of a <xref:System.Windows.Controls.Button> when the mouse pointer is over it.</span></span> <span data-ttu-id="a7d2e-210"><xref:System.Windows.Media.Animation.Storyboard> は、`BorderBrush`の色を変更して、ボタンの境界線の色を変更します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-210">The <xref:System.Windows.Media.Animation.Storyboard> changes the button's border color by changing the color of the `BorderBrush`.</span></span> <span data-ttu-id="a7d2e-211">このトピックの冒頭にある <xref:System.Windows.Controls.ControlTemplate> の例を参照している場合は、`BorderBrush` が <xref:System.Windows.Controls.Border>の <xref:System.Windows.Controls.Border.Background%2A> に割り当てられている <xref:System.Windows.Media.SolidColorBrush> の名前であることを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-211">If you refer to the <xref:System.Windows.Controls.ControlTemplate> example at the beginning of this topic, you will recall that `BorderBrush` is the name of the <xref:System.Windows.Media.SolidColorBrush> that is assigned to the <xref:System.Windows.Controls.Border.Background%2A> of the <xref:System.Windows.Controls.Border>.</span></span>

 [!code-xaml[VSMButtonTemplate#4](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#4)]

 <span data-ttu-id="a7d2e-212">このコントロールは、コントロール コントラクトの一部として状態を定義する役割を果たします。詳細については、このトピックの「[コントロール コントラクトについて理解しその他のコントロールをカスタマイズする方法](#customizing_other_controls_by_understanding_the_control_contract)」で後述します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-212">The control is responsible for defining the states as part of its control contract, which is discussed in detail in [Customizing Other Controls by Understanding the Control Contract](#customizing_other_controls_by_understanding_the_control_contract) later in this topic.</span></span> <span data-ttu-id="a7d2e-213">次の表に、<xref:System.Windows.Controls.Button>に対して指定されている状態を示します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-213">The following table lists the states that are specified for the <xref:System.Windows.Controls.Button>.</span></span>

|<span data-ttu-id="a7d2e-214">VisualState 名</span><span class="sxs-lookup"><span data-stu-id="a7d2e-214">VisualState Name</span></span>|<span data-ttu-id="a7d2e-215">VisualStateGroup 名</span><span class="sxs-lookup"><span data-stu-id="a7d2e-215">VisualStateGroup Name</span></span>|<span data-ttu-id="a7d2e-216">説明</span><span class="sxs-lookup"><span data-stu-id="a7d2e-216">Description</span></span>|
|----------------------|---------------------------|-----------------|
|<span data-ttu-id="a7d2e-217">標準</span><span class="sxs-lookup"><span data-stu-id="a7d2e-217">Normal</span></span>|<span data-ttu-id="a7d2e-218">CommonStates</span><span class="sxs-lookup"><span data-stu-id="a7d2e-218">CommonStates</span></span>|<span data-ttu-id="a7d2e-219">既定の状態です。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-219">The default state.</span></span>|
|<span data-ttu-id="a7d2e-220">MouseOver</span><span class="sxs-lookup"><span data-stu-id="a7d2e-220">MouseOver</span></span>|<span data-ttu-id="a7d2e-221">CommonStates</span><span class="sxs-lookup"><span data-stu-id="a7d2e-221">CommonStates</span></span>|<span data-ttu-id="a7d2e-222">マウス ポインターがコントロール上に配置されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-222">The mouse pointer is positioned over the control.</span></span>|
|<span data-ttu-id="a7d2e-223">押されている</span><span class="sxs-lookup"><span data-stu-id="a7d2e-223">Pressed</span></span>|<span data-ttu-id="a7d2e-224">CommonStates</span><span class="sxs-lookup"><span data-stu-id="a7d2e-224">CommonStates</span></span>|<span data-ttu-id="a7d2e-225">コントロールが押されています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-225">The control is pressed.</span></span>|
|<span data-ttu-id="a7d2e-226">Disabled</span><span class="sxs-lookup"><span data-stu-id="a7d2e-226">Disabled</span></span>|<span data-ttu-id="a7d2e-227">CommonStates</span><span class="sxs-lookup"><span data-stu-id="a7d2e-227">CommonStates</span></span>|<span data-ttu-id="a7d2e-228">コントロールが無効になっています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-228">The control is disabled.</span></span>|
|<span data-ttu-id="a7d2e-229">フォーカスされている</span><span class="sxs-lookup"><span data-stu-id="a7d2e-229">Focused</span></span>|<span data-ttu-id="a7d2e-230">FocusStates</span><span class="sxs-lookup"><span data-stu-id="a7d2e-230">FocusStates</span></span>|<span data-ttu-id="a7d2e-231">コントロールにフォーカスがあります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-231">The control has focus.</span></span>|
|<span data-ttu-id="a7d2e-232">フォーカスされていない</span><span class="sxs-lookup"><span data-stu-id="a7d2e-232">Unfocused</span></span>|<span data-ttu-id="a7d2e-233">FocusStates</span><span class="sxs-lookup"><span data-stu-id="a7d2e-233">FocusStates</span></span>|<span data-ttu-id="a7d2e-234">コントロールにフォーカスがありません。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-234">The control does not have focus.</span></span>|

 <span data-ttu-id="a7d2e-235"><xref:System.Windows.Controls.Button> は2つの状態グループを定義します。 `CommonStates` グループには、`Normal`、`MouseOver`、`Pressed`、および `Disabled` の各状態が含まれます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-235">The <xref:System.Windows.Controls.Button> defines two state groups: the `CommonStates` group contains the `Normal`, `MouseOver`, `Pressed`, and `Disabled` states.</span></span> <span data-ttu-id="a7d2e-236">`FocusStates` グループには、`Focused` 状態と `Unfocused` 状態が含まれます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-236">The `FocusStates` group contains the `Focused` and `Unfocused` states.</span></span> <span data-ttu-id="a7d2e-237">同じ状態グループ内の状態を同時に複数指定することはできません。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-237">States in the same state group are mutually exclusive.</span></span> <span data-ttu-id="a7d2e-238">コントロールが取り得る状態は、常に 1 グループにつき 1 つです。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-238">The control is always in exactly one state per group.</span></span> <span data-ttu-id="a7d2e-239">たとえば、<xref:System.Windows.Controls.Button> は、マウスポインターが上にない場合でもフォーカスを持つことができるので、`Focused` 状態の <xref:System.Windows.Controls.Button> は `MouseOver`、`Pressed`、または `Normal` 状態になります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-239">For example, a <xref:System.Windows.Controls.Button> can have focus even when the mouse pointer is not over it, so a <xref:System.Windows.Controls.Button> in the `Focused` state can be in the `MouseOver`, `Pressed`, or `Normal` state.</span></span>

 <span data-ttu-id="a7d2e-240"><xref:System.Windows.VisualStateGroup> オブジェクトに <xref:System.Windows.VisualState> オブジェクトを追加します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-240">You add <xref:System.Windows.VisualState> objects to <xref:System.Windows.VisualStateGroup> objects.</span></span> <span data-ttu-id="a7d2e-241"><xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> 添付プロパティに <xref:System.Windows.VisualStateGroup> オブジェクトを追加します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-241">You add <xref:System.Windows.VisualStateGroup> objects to the <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> attached property.</span></span> <span data-ttu-id="a7d2e-242">次の例では、`Normal`、`MouseOver`、および `Pressed` の状態の <xref:System.Windows.VisualState> オブジェクトを定義しています。これらはすべて `CommonStates` グループに含まれています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-242">The following example defines the <xref:System.Windows.VisualState> objects for the `Normal`, `MouseOver`, and `Pressed` states, which are all in the `CommonStates` group.</span></span> <span data-ttu-id="a7d2e-243">各 <xref:System.Windows.VisualState> の <xref:System.Windows.VisualState.Name%2A> は、前の表の名前と一致します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-243">The <xref:System.Windows.VisualState.Name%2A> of each <xref:System.Windows.VisualState> matches the name in the preceding table.</span></span> <span data-ttu-id="a7d2e-244">`Disabled` の状態および `FocusStates` グループの状態は、例を簡潔にするために省略していますが、このトピックの最後で紹介している完全なコード例には含まれています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-244">The `Disabled` state and the states in the `FocusStates` group are omitted to keep the example short, but they are included in the entire example at the end of this topic.</span></span>

> [!NOTE]
> <span data-ttu-id="a7d2e-245"><xref:System.Windows.Controls.ControlTemplate>のルート <xref:System.Windows.FrameworkElement> には、<xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> 添付プロパティを必ず設定してください。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-245">Be sure to set the <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> attached property on the root <xref:System.Windows.FrameworkElement> of the <xref:System.Windows.Controls.ControlTemplate>.</span></span>

 [!code-xaml[VSMButtonTemplate#VisualStates](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#visualstates)]

 <span data-ttu-id="a7d2e-246">前の例では、次の図のような出力を生成します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-246">The preceding example produces output that is similar to the following illustrations.</span></span>

 <span data-ttu-id="a7d2e-247">![カスタム コントロール テンプレートを使用したボタン](./media/ndp-buttonnormal.png "NDP_ButtonNormal")</span><span class="sxs-lookup"><span data-stu-id="a7d2e-247">![A button with a custom control template.](./media/ndp-buttonnormal.png "NDP_ButtonNormal")</span></span>
<span data-ttu-id="a7d2e-248">通常状態のカスタム コントロール テンプレートを使用しているボタン</span><span class="sxs-lookup"><span data-stu-id="a7d2e-248">A button that uses a custom control template in the normal state</span></span>

 <span data-ttu-id="a7d2e-249">![赤い境界線付きのボタン](./media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span><span class="sxs-lookup"><span data-stu-id="a7d2e-249">![A button with a red border.](./media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span></span>
<span data-ttu-id="a7d2e-250">マウス オーバー状態のカスタム コントロール テンプレートを使用しているボタン</span><span class="sxs-lookup"><span data-stu-id="a7d2e-250">A button that uses a custom control template in the mouse over state</span></span>

 <span data-ttu-id="a7d2e-251">![ボタンが押されて境界線が透明になっている状態。](./media/ndp-buttonpressed.png "NDP_ButtonPressed")</span><span class="sxs-lookup"><span data-stu-id="a7d2e-251">![The border is transparent on a pressed button.](./media/ndp-buttonpressed.png "NDP_ButtonPressed")</span></span>
<span data-ttu-id="a7d2e-252">押された状態のカスタム コントロール テンプレートを使用しているボタン</span><span class="sxs-lookup"><span data-stu-id="a7d2e-252">A button that uses a custom control template in the pressed state</span></span>

 <span data-ttu-id="a7d2e-253">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] に付属するコントロールの視覚的な状態については、「[コントロールのスタイルとテンプレート](control-styles-and-templates.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-253">To find the visual states for controls that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Control Styles and Templates](control-styles-and-templates.md).</span></span>

<a name="specifying_the_behavior_of_a_control_when_it_transitions_between_states"></a>
## <a name="specifying-the-behavior-of-a-control-when-it-transitions-between-states"></a><span data-ttu-id="a7d2e-254">状態間を遷移するときのコントロールの動作の指定</span><span class="sxs-lookup"><span data-stu-id="a7d2e-254">Specifying the Behavior of a Control When It Transitions Between States</span></span>
 <span data-ttu-id="a7d2e-255">前の例では、ボタンをクリックしたときにもボタンの外観が変化しましたが、ボタンを 1 秒間押したままにしない限り、効果を確認できません。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-255">In the preceding example, the appearance of the button also changes when the user clicks it, but unless the button is pressed for a full second, the user does not see the effect.</span></span> <span data-ttu-id="a7d2e-256">既定では、アニメーションが開始されるまでに 1 秒かかります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-256">By default, the animation takes one second to occur.</span></span> <span data-ttu-id="a7d2e-257">多くの場合、ユーザーはボタンをクリックしてすぐに離すことができるので、<xref:System.Windows.Controls.ControlTemplate> を既定の状態のままにしておくと、視覚的なフィードバックが有効になりません。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-257">Because users are likely to click and release a button in much less time, the visual feedback will not be effective if you leave the <xref:System.Windows.Controls.ControlTemplate> in its default state.</span></span>

 <span data-ttu-id="a7d2e-258"><xref:System.Windows.Controls.ControlTemplate>に <xref:System.Windows.VisualTransition> オブジェクトを追加することによって、コントロールをある状態から別の状態にスムーズに遷移させるために、アニメーションを実行する時間を指定できます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-258">You can specify the amount of time that it takes an animation to occur to smoothly transition a control from one state to another by adding <xref:System.Windows.VisualTransition> objects to the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="a7d2e-259"><xref:System.Windows.VisualTransition>を作成する場合は、次のいずれかまたは複数を指定します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-259">When you create a <xref:System.Windows.VisualTransition>, you specify one or more of the following:</span></span>

- <span data-ttu-id="a7d2e-260">状態間の遷移を開始するまでに要する時間。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-260">The time it takes for a transition between states to occur.</span></span>

- <span data-ttu-id="a7d2e-261">遷移時に発生するコントロールの外観への追加の変更。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-261">Additional changes in the control's appearance that occur at the time of the transition.</span></span>

- <span data-ttu-id="a7d2e-262"><xref:System.Windows.VisualTransition> が適用される状態。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-262">Which states the <xref:System.Windows.VisualTransition> is applied to.</span></span>

### <a name="specifying-the-duration-of-a-transition"></a><span data-ttu-id="a7d2e-263">遷移の継続時間の指定</span><span class="sxs-lookup"><span data-stu-id="a7d2e-263">Specifying the Duration of a Transition</span></span>
 <span data-ttu-id="a7d2e-264">移行にかかる時間を指定するには、<xref:System.Windows.VisualTransition.GeneratedDuration%2A> プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-264">You can specify how long a transition takes by setting the <xref:System.Windows.VisualTransition.GeneratedDuration%2A> property.</span></span> <span data-ttu-id="a7d2e-265">前の例には、ボタンが押されたときにボタンの境界線が透明になることを指定する <xref:System.Windows.VisualState> がありますが、ボタンがすぐに押されて解放されると、アニメーションの処理に時間がかかりすぎます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-265">The preceding example has a <xref:System.Windows.VisualState> that specifies that the button's border becomes transparent when the button is pressed, but the animation takes too long to be noticeable if the button is quickly pressed and released.</span></span> <span data-ttu-id="a7d2e-266"><xref:System.Windows.VisualTransition> を使用すると、コントロールが押された状態に遷移するまでの時間を指定できます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-266">You can use a <xref:System.Windows.VisualTransition> to specify the amount of time it takes the control to transition into the pressed state.</span></span> <span data-ttu-id="a7d2e-267">次の例では、コントロールが押された状態になるのに要する時間を 1/100 秒に指定しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-267">The following example specifies that the control takes one hundredth of a second to go into the pressed state.</span></span>

 [!code-xaml[VSMButtonTemplate#PressedTransition](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#pressedtransition)]

### <a name="specifying-changes-to-the-controls-appearance-during-a-transition"></a><span data-ttu-id="a7d2e-268">遷移時にコントロールの外観の変更を指定する方法</span><span class="sxs-lookup"><span data-stu-id="a7d2e-268">Specifying Changes to the Control's Appearance During a Transition</span></span>
 <span data-ttu-id="a7d2e-269"><xref:System.Windows.VisualTransition> には、コントロールが状態間を遷移するときに開始される <xref:System.Windows.Media.Animation.Storyboard> が含まれています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-269">The <xref:System.Windows.VisualTransition> contains a <xref:System.Windows.Media.Animation.Storyboard> that begins when the control transitions between states.</span></span> <span data-ttu-id="a7d2e-270">たとえば、コントロールが `MouseOver` 状態から `Normal` 状態に遷移する場合に、特定のアニメーションが実行されるように指定できます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-270">For example, you can specify that a certain animation occurs when the control transitions from the `MouseOver` state to the `Normal` State.</span></span> <span data-ttu-id="a7d2e-271">次の例では、ユーザーがマウスポインターをボタンの上に移動したときに、ボタンの境界線が青に変わり、黄色の場合は1.5 秒で黒に変更されることを指定する <xref:System.Windows.VisualTransition> を作成します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-271">The following example creates a <xref:System.Windows.VisualTransition> that specifies that when the user moves the mouse pointer away from the button, the button's border changes to blue, then to yellow, then to black in 1.5 seconds.</span></span>

 [!code-xaml[VSMButtonTemplate#8](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#8)]

### <a name="specifying-when-a-visualtransition-is-applied"></a><span data-ttu-id="a7d2e-272">VisualTransition を適用するタイミングの指定</span><span class="sxs-lookup"><span data-stu-id="a7d2e-272">Specifying When a VisualTransition Is Applied</span></span>
 <span data-ttu-id="a7d2e-273"><xref:System.Windows.VisualTransition> は、特定の状態にのみ適用されるように制限することも、コントロールが状態間を遷移するたびに適用することもできます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-273">A <xref:System.Windows.VisualTransition> can be restricted to apply to only certain states, or it can be applied any time the control transitions between states.</span></span> <span data-ttu-id="a7d2e-274">前の例では、コントロールが `MouseOver` 状態から `Normal` 状態に移動したときに、<xref:System.Windows.VisualTransition> が適用されます。この前の例では、コントロールが `Pressed` 状態になると <xref:System.Windows.VisualTransition> が適用されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-274">In the preceding example, the <xref:System.Windows.VisualTransition> is applied when the control goes from the `MouseOver` state to the `Normal` state; in the example before that, the <xref:System.Windows.VisualTransition> is applied when the control goes into the `Pressed` state.</span></span> <span data-ttu-id="a7d2e-275"><xref:System.Windows.VisualTransition> が適用されるタイミングを制限するには、<xref:System.Windows.VisualTransition.To%2A> プロパティと <xref:System.Windows.VisualTransition.From%2A> プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-275">You restrict when a <xref:System.Windows.VisualTransition> is applied by setting the <xref:System.Windows.VisualTransition.To%2A> and <xref:System.Windows.VisualTransition.From%2A> properties.</span></span> <span data-ttu-id="a7d2e-276">次の表では、制限が最も厳しいレベルから最も緩いレベルまでを一覧にして示しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-276">The following table describes the levels of restriction from most restrictive to least restrictive.</span></span>

|<span data-ttu-id="a7d2e-277">制限の種類</span><span class="sxs-lookup"><span data-stu-id="a7d2e-277">Type of restriction</span></span>|<span data-ttu-id="a7d2e-278">からの値</span><span class="sxs-lookup"><span data-stu-id="a7d2e-278">Value of From</span></span>|<span data-ttu-id="a7d2e-279">の値</span><span class="sxs-lookup"><span data-stu-id="a7d2e-279">Value of To</span></span>|
|-------------------------|-------------------|-----------------|
|<span data-ttu-id="a7d2e-280">指定した状態から別の指定した状態まで</span><span class="sxs-lookup"><span data-stu-id="a7d2e-280">From a specified state to another specified state</span></span>|<span data-ttu-id="a7d2e-281"><xref:System.Windows.VisualState> の名前</span><span class="sxs-lookup"><span data-stu-id="a7d2e-281">The name of a <xref:System.Windows.VisualState></span></span>|<span data-ttu-id="a7d2e-282"><xref:System.Windows.VisualState> の名前</span><span class="sxs-lookup"><span data-stu-id="a7d2e-282">The name of a <xref:System.Windows.VisualState></span></span>|
|<span data-ttu-id="a7d2e-283">任意の状態から指定された状態まで</span><span class="sxs-lookup"><span data-stu-id="a7d2e-283">From any state to a specified state</span></span>|<span data-ttu-id="a7d2e-284">未設定</span><span class="sxs-lookup"><span data-stu-id="a7d2e-284">Not set</span></span>|<span data-ttu-id="a7d2e-285"><xref:System.Windows.VisualState> の名前</span><span class="sxs-lookup"><span data-stu-id="a7d2e-285">The name of a <xref:System.Windows.VisualState></span></span>|
|<span data-ttu-id="a7d2e-286">指定した状態から任意の状態まで</span><span class="sxs-lookup"><span data-stu-id="a7d2e-286">From a specified state to any state</span></span>|<span data-ttu-id="a7d2e-287"><xref:System.Windows.VisualState> の名前</span><span class="sxs-lookup"><span data-stu-id="a7d2e-287">The name of a <xref:System.Windows.VisualState></span></span>|<span data-ttu-id="a7d2e-288">未設定</span><span class="sxs-lookup"><span data-stu-id="a7d2e-288">Not set</span></span>|
|<span data-ttu-id="a7d2e-289">任意の状態から他の状態へ</span><span class="sxs-lookup"><span data-stu-id="a7d2e-289">From any state to any other state</span></span>|<span data-ttu-id="a7d2e-290">未設定</span><span class="sxs-lookup"><span data-stu-id="a7d2e-290">Not set</span></span>|<span data-ttu-id="a7d2e-291">未設定</span><span class="sxs-lookup"><span data-stu-id="a7d2e-291">Not set</span></span>|

 <span data-ttu-id="a7d2e-292"><xref:System.Windows.VisualStateGroup> には、同じ状態を参照する複数の <xref:System.Windows.VisualTransition> オブジェクトを含めることができますが、これらは、前の表で指定した順序で使用されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-292">You can have multiple <xref:System.Windows.VisualTransition> objects in a <xref:System.Windows.VisualStateGroup> that refer to the same state, but they will be used in the order that the previous table specifies.</span></span> <span data-ttu-id="a7d2e-293">次の例では、2つの <xref:System.Windows.VisualTransition> オブジェクトがあります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-293">In the following example, there are two <xref:System.Windows.VisualTransition> objects.</span></span> <span data-ttu-id="a7d2e-294">コントロールが `Pressed` 状態から `MouseOver` 状態に遷移すると、<xref:System.Windows.VisualTransition.From%2A> と <xref:System.Windows.VisualTransition.To%2A> セットの両方を持つ <xref:System.Windows.VisualTransition> が使用されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-294">When the control transitions from the `Pressed` state to the `MouseOver` state, the <xref:System.Windows.VisualTransition> that has both <xref:System.Windows.VisualTransition.From%2A> and <xref:System.Windows.VisualTransition.To%2A> set is used.</span></span> <span data-ttu-id="a7d2e-295">コントロールが `Pressed` ではない状態から `MouseOver` 状態に遷移するときには、別の状態を使用します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-295">When the control transitions from a state that is not `Pressed` to the `MouseOver` state, the other state is used.</span></span>

 [!code-xaml[VSMButtonTemplate#7](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#7)]

 <span data-ttu-id="a7d2e-296"><xref:System.Windows.VisualStateGroup> には、<xref:System.Windows.VisualStateGroup>内の <xref:System.Windows.VisualState> オブジェクトに適用される <xref:System.Windows.VisualTransition> オブジェクトを含む <xref:System.Windows.VisualStateGroup.Transitions%2A> プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-296">The <xref:System.Windows.VisualStateGroup> has a <xref:System.Windows.VisualStateGroup.Transitions%2A> property that contains the <xref:System.Windows.VisualTransition> objects that apply to the <xref:System.Windows.VisualState> objects in the <xref:System.Windows.VisualStateGroup>.</span></span> <span data-ttu-id="a7d2e-297"><xref:System.Windows.Controls.ControlTemplate> 作成者は、任意の <xref:System.Windows.VisualTransition> を自由に含めることができます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-297">As the <xref:System.Windows.Controls.ControlTemplate> author, you are free to include any <xref:System.Windows.VisualTransition> you want.</span></span> <span data-ttu-id="a7d2e-298">ただし、<xref:System.Windows.VisualTransition.To%2A> プロパティと <xref:System.Windows.VisualTransition.From%2A> プロパティが <xref:System.Windows.VisualStateGroup>にない状態名に設定されている場合、<xref:System.Windows.VisualTransition> は無視されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-298">However, if the <xref:System.Windows.VisualTransition.To%2A> and <xref:System.Windows.VisualTransition.From%2A> properties are set to state names that are not in the <xref:System.Windows.VisualStateGroup>, the <xref:System.Windows.VisualTransition> is ignored.</span></span>

 <span data-ttu-id="a7d2e-299">次の例は、`CommonStates`の <xref:System.Windows.VisualStateGroup> を示しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-299">The following example shows the <xref:System.Windows.VisualStateGroup> for the `CommonStates`.</span></span> <span data-ttu-id="a7d2e-300">この例では、ボタンの次の遷移ごとに <xref:System.Windows.VisualTransition> を定義します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-300">The example defines a <xref:System.Windows.VisualTransition> for each of the button's following transitions.</span></span>

- <span data-ttu-id="a7d2e-301">`Pressed` 状態への遷移。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-301">To the `Pressed` state.</span></span>

- <span data-ttu-id="a7d2e-302">`MouseOver` 状態への遷移。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-302">To the `MouseOver` state.</span></span>

- <span data-ttu-id="a7d2e-303">`Pressed` 状態から `MouseOver` 状態への遷移。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-303">From the `Pressed` state to the `MouseOver` state.</span></span>

- <span data-ttu-id="a7d2e-304">`MouseOver` 状態から `Normal` 状態への遷移。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-304">From the `MouseOver` state to the `Normal` state.</span></span>

 [!code-xaml[VSMButtonTemplate#VisualTransitions](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#visualtransitions)]

<a name="customizing_other_controls_by_understanding_the_control_contract"></a>
## <a name="customizing-other-controls-by-understanding-the-control-contract"></a><span data-ttu-id="a7d2e-305">コントロール コントラクトについて理解しその他のコントロールをカスタマイズする方法</span><span class="sxs-lookup"><span data-stu-id="a7d2e-305">Customizing Other Controls by Understanding the Control Contract</span></span>
 <span data-ttu-id="a7d2e-306">(<xref:System.Windows.FrameworkElement> オブジェクトを使用して) ビジュアル構造を指定するために <xref:System.Windows.Controls.ControlTemplate> を使用するコントロールと、(<xref:System.Windows.VisualState> オブジェクトを使用した) 視覚的な動作では、パーツコントロールモデルを使用します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-306">A control that uses a <xref:System.Windows.Controls.ControlTemplate> to specify its visual structure (by using <xref:System.Windows.FrameworkElement> objects) and visual behavior (by using <xref:System.Windows.VisualState> objects) uses the parts control model.</span></span> <span data-ttu-id="a7d2e-307">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 4 に含まれるコントロールの多くは、このモデルを採用しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-307">Many of the controls that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 4 use this model.</span></span> <span data-ttu-id="a7d2e-308"><xref:System.Windows.Controls.ControlTemplate> 作成者が認識する必要があるパーツは、コントロールコントラクトを通じて伝達されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-308">The parts that a <xref:System.Windows.Controls.ControlTemplate> author needs to be aware of are communicated through the control contract.</span></span> <span data-ttu-id="a7d2e-309">コントロール コントラクトのパーツについて理解すると、パーツ コントロール モデルを採用するあらゆるコントロールの外観をカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-309">When you understand the parts of a control contract, you can customize the appearance of any control that uses the parts control model.</span></span>

 <span data-ttu-id="a7d2e-310">コントロール コントラクトには、次の 3 つの要素があります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-310">A control contract has three elements:</span></span>

- <span data-ttu-id="a7d2e-311">コントロールのロジックが使用する視覚的要素。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-311">The visual elements that the control's logic uses.</span></span>

- <span data-ttu-id="a7d2e-312">コントロールの状態および各状態が所属するグループ。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-312">The states of the control and the group each state belongs to.</span></span>

- <span data-ttu-id="a7d2e-313">コントロールに対して視覚的に作用するパブリック プロパティ。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-313">The public properties that visually affect the control.</span></span>

### <a name="visual-elements-in-the-control-contract"></a><span data-ttu-id="a7d2e-314">コントロール コントラクトの視覚的要素</span><span class="sxs-lookup"><span data-stu-id="a7d2e-314">Visual Elements in the Control Contract</span></span>
 <span data-ttu-id="a7d2e-315">場合によっては、コントロールのロジックが <xref:System.Windows.Controls.ControlTemplate>内の <xref:System.Windows.FrameworkElement> と対話します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-315">Sometimes a control's logic interacts with a <xref:System.Windows.FrameworkElement> that is in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="a7d2e-316">たとえば、コントロールがその要素のイベントを処理する場合などです。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-316">For example, the control might handle an event of one of its elements.</span></span> <span data-ttu-id="a7d2e-317">コントロールが <xref:System.Windows.Controls.ControlTemplate>内の特定の <xref:System.Windows.FrameworkElement> を検索する場合は、その情報を <xref:System.Windows.Controls.ControlTemplate> 作成者に伝える必要があります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-317">When a control expects to find a particular <xref:System.Windows.FrameworkElement> in the <xref:System.Windows.Controls.ControlTemplate>, it must convey that information to the <xref:System.Windows.Controls.ControlTemplate> author.</span></span> <span data-ttu-id="a7d2e-318">コントロールは、<xref:System.Windows.TemplatePartAttribute> を使用して、想定される要素の型と、要素の名前を伝達します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-318">The control uses the <xref:System.Windows.TemplatePartAttribute> to convey the type of element that is expected, and what the name of the element should be.</span></span> <span data-ttu-id="a7d2e-319"><xref:System.Windows.Controls.Button> には、コントロールコントラクトに <xref:System.Windows.FrameworkElement> パーツはありませんが、<xref:System.Windows.Controls.ComboBox>などの他のコントロールは実行されます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-319">The <xref:System.Windows.Controls.Button> does not have <xref:System.Windows.FrameworkElement> parts in its control contract, but other controls, such as the <xref:System.Windows.Controls.ComboBox>, do.</span></span>

 <span data-ttu-id="a7d2e-320">次の例は、<xref:System.Windows.Controls.ComboBox> クラスで指定されている <xref:System.Windows.TemplatePartAttribute> オブジェクトを示しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-320">The following example shows the <xref:System.Windows.TemplatePartAttribute> objects that are specified on the <xref:System.Windows.Controls.ComboBox> class.</span></span> <span data-ttu-id="a7d2e-321"><xref:System.Windows.Controls.ComboBox> のロジックでは、`PART_EditableTextBox` という名前の <xref:System.Windows.Controls.TextBox> と `PART_Popup` 内の <xref:System.Windows.Controls.Primitives.Popup> を検索する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-321">The logic of <xref:System.Windows.Controls.ComboBox> expects to find a <xref:System.Windows.Controls.TextBox> named `PART_EditableTextBox` and a <xref:System.Windows.Controls.Primitives.Popup> named `PART_Popup` in its <xref:System.Windows.Controls.ControlTemplate>.</span></span>

 [!code-csharp[VSMButtonTemplate#ComboBoxContract](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/controlcontracts.cs#comboboxcontract)]
 [!code-vb[VSMButtonTemplate#ComboBoxContract](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmbuttontemplate/visualbasic/window1.xaml.vb#comboboxcontract)]

 <span data-ttu-id="a7d2e-322">次の例は、<xref:System.Windows.Controls.ComboBox> クラスの <xref:System.Windows.TemplatePartAttribute> オブジェクトによって指定された要素を含む <xref:System.Windows.Controls.ComboBox> の簡略化された <xref:System.Windows.Controls.ControlTemplate> を示しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-322">The following example shows a simplified <xref:System.Windows.Controls.ControlTemplate> for the <xref:System.Windows.Controls.ComboBox> that includes the elements that are specified by the <xref:System.Windows.TemplatePartAttribute> objects on the <xref:System.Windows.Controls.ComboBox> class.</span></span>

 [!code-xaml[VSMButtonTemplate#ComboBoxTemplate](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/window1.xaml#comboboxtemplate)]

### <a name="states-in-the-control-contract"></a><span data-ttu-id="a7d2e-323">コントロール コントラクトの状態</span><span class="sxs-lookup"><span data-stu-id="a7d2e-323">States in the Control Contract</span></span>
 <span data-ttu-id="a7d2e-324">コントロールの状態もコントロール コントラクトの一部です。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-324">The states of a control are also a part of the control contract.</span></span> <span data-ttu-id="a7d2e-325"><xref:System.Windows.Controls.Button> の <xref:System.Windows.Controls.ControlTemplate> を作成する例は、状態に応じて <xref:System.Windows.Controls.Button> の外観を指定する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-325">The example of creating a <xref:System.Windows.Controls.ControlTemplate> for a <xref:System.Windows.Controls.Button> shows how to specify the appearance of a <xref:System.Windows.Controls.Button> depending on its states.</span></span> <span data-ttu-id="a7d2e-326">このトピックの「[状態に応じてコントロールの外観を変更](#changing_the_appearance_of_a_control_depending_on_its_state)する」で説明されているように、指定した各状態の <xref:System.Windows.VisualState> を作成し、<xref:System.Windows.TemplateVisualStateAttribute.GroupName%2A> を共有するすべての <xref:System.Windows.VisualState> オブジェクトを <xref:System.Windows.VisualStateGroup>に配置します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-326">You create a <xref:System.Windows.VisualState> for each specified state and put all <xref:System.Windows.VisualState> objects that share a <xref:System.Windows.TemplateVisualStateAttribute.GroupName%2A> in a <xref:System.Windows.VisualStateGroup>, as described in [Changing the Appearance of a Control Depending on Its State](#changing_the_appearance_of_a_control_depending_on_its_state) earlier in this topic.</span></span> <span data-ttu-id="a7d2e-327">サードパーティのコントロールでは、<xref:System.Windows.TemplateVisualStateAttribute>を使用して状態を指定する必要があります。これにより、Visual Studio や Blend for Visual Studio の[XAML デザイナー](/visualstudio/xaml-tools/designing-xaml-in-visual-studio)などのデザイナーツールを使用して、コントロールテンプレートを作成するためのコントロールの状態を公開できます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-327">Third-party controls should specify states by using the <xref:System.Windows.TemplateVisualStateAttribute>, which enables designer tools, such as the [XAML Designer](/visualstudio/xaml-tools/designing-xaml-in-visual-studio) in Visual Studio and Blend for Visual Studio, to expose the control's states for authoring control templates.</span></span>

 <span data-ttu-id="a7d2e-328">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] に付属するコントロールのコントロール コントラクトについては、「[コントロールのスタイルとテンプレート](control-styles-and-templates.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-328">To find the control contract for controls that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Control Styles and Templates](control-styles-and-templates.md).</span></span>

### <a name="properties-in-the-control-contract"></a><span data-ttu-id="a7d2e-329">コントロール コントラクトのプロパティ</span><span class="sxs-lookup"><span data-stu-id="a7d2e-329">Properties in the Control Contract</span></span>
 <span data-ttu-id="a7d2e-330">コントロールに視覚的な影響を与えるパブリック プロパティも、コントロール コントラクトに含まれています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-330">The public properties that visually affect the control are also included in the control contract.</span></span> <span data-ttu-id="a7d2e-331">これらのプロパティを設定して、新しい <xref:System.Windows.Controls.ControlTemplate>を作成せずにコントロールの外観を変更することができます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-331">You can set these properties to change the appearance of the control without creating a new <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="a7d2e-332">また、 [TemplateBinding](../advanced/templatebinding-markup-extension.md)マークアップ拡張機能を使用して、<xref:System.Windows.Controls.ControlTemplate> 内の要素のプロパティを、<xref:System.Windows.Controls.Button>で定義されているパブリックプロパティにバインドすることもできます。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-332">You can also use the [TemplateBinding](../advanced/templatebinding-markup-extension.md) markup extension to bind properties of elements that are in the <xref:System.Windows.Controls.ControlTemplate> to public properties that are defined by the <xref:System.Windows.Controls.Button>.</span></span>

 <span data-ttu-id="a7d2e-333">次の例では、ボタンのコントロール コントラクトを示します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-333">The following example shows the control contract for the button.</span></span>

 [!code-csharp[VSMButtonTemplate#ButtonContract](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/controlcontracts.cs#buttoncontract)]
 [!code-vb[VSMButtonTemplate#ButtonContract](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmbuttontemplate/visualbasic/window1.xaml.vb#buttoncontract)]

 <span data-ttu-id="a7d2e-334"><xref:System.Windows.Controls.ControlTemplate>を作成する場合、多くの場合、既存の <xref:System.Windows.Controls.ControlTemplate> を使用して変更を加えるのが最も簡単です。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-334">When creating a <xref:System.Windows.Controls.ControlTemplate>, it is often easiest to begin with an existing <xref:System.Windows.Controls.ControlTemplate> and make changes to it.</span></span> <span data-ttu-id="a7d2e-335">既存の <xref:System.Windows.Controls.ControlTemplate>を変更するには、次のいずれかの操作を行います。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-335">You can do one of the following to change an existing <xref:System.Windows.Controls.ControlTemplate>:</span></span>

- <span data-ttu-id="a7d2e-336">コントロールテンプレートを作成するためのグラフィカルユーザーインターフェイスを提供する、Blend for Visual Studio などのデザイナーを使用します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-336">Use a designer, such as Blend for Visual Studio, that provides a graphical user interface for creating control templates.</span></span> <span data-ttu-id="a7d2e-337">詳細については、「[テンプレートをサポートするコントロールのスタイル処理](https://go.microsoft.com/fwlink/?LinkId=161153)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-337">For more information, see [Styling a control that supports templates](https://go.microsoft.com/fwlink/?LinkId=161153).</span></span>

- <span data-ttu-id="a7d2e-338">既定の <xref:System.Windows.Controls.ControlTemplate> を取得して編集します。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-338">Get the default <xref:System.Windows.Controls.ControlTemplate> and edit it.</span></span> <span data-ttu-id="a7d2e-339">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] に付属する既定のコントロール テンプレートについては、「[デフォルトの WPF テーマ](https://go.microsoft.com/fwlink/?LinkID=158252)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-339">To find the default control templates that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Default WPF Themes](https://go.microsoft.com/fwlink/?LinkID=158252).</span></span>

<a name="complete_example"></a>
## <a name="complete-example"></a><span data-ttu-id="a7d2e-340">コード例全体</span><span class="sxs-lookup"><span data-stu-id="a7d2e-340">Complete Example</span></span>
 <span data-ttu-id="a7d2e-341">次の例は、このトピックで説明する完全な <xref:System.Windows.Controls.Button><xref:System.Windows.Controls.ControlTemplate> を示しています。</span><span class="sxs-lookup"><span data-stu-id="a7d2e-341">The following example shows the complete <xref:System.Windows.Controls.Button><xref:System.Windows.Controls.ControlTemplate> that is discussed in this topic.</span></span>

 [!code-xaml[VSMButtonTemplate#3](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#3)]

## <a name="see-also"></a><span data-ttu-id="a7d2e-342">関連項目</span><span class="sxs-lookup"><span data-stu-id="a7d2e-342">See also</span></span>

- [<span data-ttu-id="a7d2e-343">スタイルとテンプレート</span><span class="sxs-lookup"><span data-stu-id="a7d2e-343">Styling and Templating</span></span>](../../../desktop-wpf/fundamentals/styles-templates-overview.md)
