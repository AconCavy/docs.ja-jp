---
title: .NET Framework での side-by-side 実行
ms.date: 03/30/2017
helpviewer_keywords:
- side-by-side execution
ms.assetid: 649f1342-766b-49e6-a90d-5b019a751e11
ms.openlocfilehash: e965702943149d3ed34be39bb2923ad52dcf90ca
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/15/2020
ms.locfileid: "79181646"
---
# <a name="side-by-side-execution-in-the-net-framework"></a><span data-ttu-id="08f4f-102">.NET Framework での side-by-side 実行</span><span class="sxs-lookup"><span data-stu-id="08f4f-102">Side-by-Side Execution in the .NET Framework</span></span>

<span data-ttu-id="08f4f-103">side-by-side 実行は、アプリケーションまたはコンポーネントの複数のバージョンを同じコンピューターで実行する機能です。</span><span class="sxs-lookup"><span data-stu-id="08f4f-103">Side-by-side execution is the ability to run multiple versions of an application or component on the same computer.</span></span> <span data-ttu-id="08f4f-104">共通言語ランタイムの複数のバージョン、および 1 つの共通言語ランタイムを使用するアプリケーションとコンポーネントの複数のバージョンを同じコンピューターで同時に実行できます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-104">You can have multiple versions of the common language runtime, and multiple versions of applications and components that use a version of the runtime, on the same computer at the same time.</span></span>  
  
<span data-ttu-id="08f4f-105">共通言語ランタイムの 2 つの異なるバージョンを同じコンピューターで使用する複数のアプリケーションを次の図に示します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-105">The following illustration shows several applications using two different versions of the runtime on the same computer.</span></span> <span data-ttu-id="08f4f-106">アプリケーション A、B、および C はランタイム バージョン 1.0 を使用し、アプリケーション D はランタイム バージョン 1.1 を使用します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-106">Applications A, B, and C use runtime version 1.0, while application D uses runtime version 1.1.</span></span>  
  
![異なるランタイム バージョンの side-by-side 実行](./media/side-by-side-execution/side-by-side-runtime-execution.gif)  
  
<span data-ttu-id="08f4f-108">.NET Framework は、共通言語ランタイムと API 型を含むアセンブリのコレクションで構成されています。</span><span class="sxs-lookup"><span data-stu-id="08f4f-108">The .NET Framework consists of the common language runtime and a collection of assemblies that contain the API types.</span></span> <span data-ttu-id="08f4f-109">ランタイムと .NET Framework アセンブリは、個別にバージョン管理されます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-109">The runtime and the .NET Framework assemblies are versioned separately.</span></span> <span data-ttu-id="08f4f-110">たとえば、ランタイムのバージョン 4.0 は実際にはバージョン 4.0.319 で、.NET Framework アセンブリのバージョン 1.0 はバージョン 1.0.3300.0 です。</span><span class="sxs-lookup"><span data-stu-id="08f4f-110">For example, version 4.0 of the runtime is actually version 4.0.319, while version 1.0 of the .NET Framework assemblies is version 1.0.3300.0.</span></span>  
  
<span data-ttu-id="08f4f-111">コンポーネントの 2 つの異なるバージョンを同じコンピューターで使用する複数のアプリケーションを次の図に示します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-111">The following illustration shows several applications using two different versions of a component on the same computer.</span></span> <span data-ttu-id="08f4f-112">アプリケーション A とアプリケーション B はコンポーネントのバージョン 1.0 を使用し、アプリケーション C は同じコンポーネントのバージョン 2.0 を使用します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-112">Application A and B use version 1.0 of the component while Application C uses version 2.0 of the same component.</span></span>  
  
![コンポーネントの side-by-side 実行を示す図。](./media/side-by-side-execution/side-by-side-component-execution.gif)  
  
<span data-ttu-id="08f4f-114">side-by-side 実行により、アプリケーションがバインドするコンポーネントのバージョンやアプリケーションが使用するランタイムのバージョンをより詳細に制御できます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-114">Side-by-side execution gives you more control over which versions of a component an application binds to, and more control over which version of the runtime an application uses.</span></span>  
  
## <a name="benefits-of-side-by-side-execution"></a><span data-ttu-id="08f4f-115">side-by-side 実行の利点</span><span class="sxs-lookup"><span data-stu-id="08f4f-115">Benefits of Side-by-Side Execution</span></span>  

<span data-ttu-id="08f4f-116">Windows XP および .NET Framework 以前では、アプリケーションは同じコードの非互換バージョンを識別できないため、DLL の競合が発生することがありました。</span><span class="sxs-lookup"><span data-stu-id="08f4f-116">Prior to Windows XP and the .NET Framework, DLL conflicts occurred because applications were unable to distinguish between incompatible versions of the same code.</span></span> <span data-ttu-id="08f4f-117">DLL に含まれる型情報は、ファイル名だけに関連付けられていました。</span><span class="sxs-lookup"><span data-stu-id="08f4f-117">Type information contained in a DLL was bound only to a file name.</span></span> <span data-ttu-id="08f4f-118">アプリケーションは、DLL に含まれている型とアプリケーションの作成に使用された型が同じであるかどうかを判断できませんでした。</span><span class="sxs-lookup"><span data-stu-id="08f4f-118">An application had no way of knowing if the types contained in a DLL were the same types that the application was built with.</span></span> <span data-ttu-id="08f4f-119">この結果、新しいバージョンのコンポーネントが古いバージョンを書き変え、アプリケーションが壊れてしまうことがありました。</span><span class="sxs-lookup"><span data-stu-id="08f4f-119">As a result, a new version of a component could overwrite an older version and break applications.</span></span>  
  
<span data-ttu-id="08f4f-120">side-by-side 実行と .NET Framework によって、DLL の競合を防ぐ次の機能が得られます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-120">Side-by-side execution and the .NET Framework provide the following features to eliminate DLL conflicts:</span></span>  
  
- <span data-ttu-id="08f4f-121">厳密な名前付きアセンブリ</span><span class="sxs-lookup"><span data-stu-id="08f4f-121">Strong-named assemblies.</span></span>  
  
     <span data-ttu-id="08f4f-122">side-by-side 実行機能は、厳密な名前付きアセンブリを使用して、型情報をアセンブリの特定のバージョンにバインドします。</span><span class="sxs-lookup"><span data-stu-id="08f4f-122">Side-by-side execution uses strong-named assemblies to bind type information to a specific version of an assembly.</span></span> <span data-ttu-id="08f4f-123">これによって、アプリケーションまたはコンポーネントが、アセンブリの無効なバージョンをバインドするのを防げます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-123">This prevents an application or component from binding to an invalid version of an assembly.</span></span> <span data-ttu-id="08f4f-124">また、厳密な名前付きアセンブリによって、1 つのファイルの複数のバージョンが同じコンピューター上に存在することが可能で、アプリケーションはこれらを使用できます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-124">Strong-named assemblies also allow multiple versions of a file to exist on the same computer and to be used by applications.</span></span> <span data-ttu-id="08f4f-125">詳細については、「[厳密な名前付きアセンブリ](../../standard/assembly/strong-named.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="08f4f-125">For more information, see [Strong-Named Assemblies](../../standard/assembly/strong-named.md).</span></span>  
  
- <span data-ttu-id="08f4f-126">バージョンを認識するコード ストレージ</span><span class="sxs-lookup"><span data-stu-id="08f4f-126">Version-aware code storage.</span></span>  
  
     <span data-ttu-id="08f4f-127">.NET Framework のグローバル アセンブリ キャッシュには、バージョンを認識するコード ストレージが用意されています。</span><span class="sxs-lookup"><span data-stu-id="08f4f-127">The .NET Framework provides version-aware code storage in the global assembly cache.</span></span> <span data-ttu-id="08f4f-128">グローバル アセンブリ キャッシュは、コンピューター全体にわたるコード キャッシュで、.NET Framework がインストールされているすべてのコンピューターに存在します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-128">The global assembly cache is a computer-wide code cache present on all computers with the .NET Framework installed.</span></span> <span data-ttu-id="08f4f-129">グローバル アセンブリ キャッシュは、バージョン、カルチャ、発行者の情報に基づいてアセンブリを格納し、コンポーネントおよびアプリケーションの複数バージョンをサポートします。</span><span class="sxs-lookup"><span data-stu-id="08f4f-129">It stores assemblies based on version, culture, and publisher information, and supports multiple versions of components and applications.</span></span> <span data-ttu-id="08f4f-130">詳細については、「[グローバル アセンブリ キャッシュ](../app-domains/gac.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="08f4f-130">For more information, see [Global Assembly Cache](../app-domains/gac.md).</span></span>  
  
- <span data-ttu-id="08f4f-131">分離。</span><span class="sxs-lookup"><span data-stu-id="08f4f-131">Isolation.</span></span>  
  
     <span data-ttu-id="08f4f-132">.NET Framework を使用すると、分離して実行できるアプリケーションとコンポーネントを作成できます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-132">Using the .NET Framework, you can create applications and components that execute in isolation.</span></span> <span data-ttu-id="08f4f-133">分離は、side-by-side 実行に欠くことのできない構成要素です。</span><span class="sxs-lookup"><span data-stu-id="08f4f-133">Isolation is an essential component of side-by-side execution.</span></span> <span data-ttu-id="08f4f-134">分離には、使用しているリソースを認識し、アプリケーションまたはコンポーネントの複数のバージョンでこれを確実に共有する処理も含まれます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-134">It involves being aware of the resources you are using and sharing resources with confidence among multiple versions of an application or component.</span></span> <span data-ttu-id="08f4f-135">また、分離には、バージョンに固有の方法でファイルを格納する方法も含まれます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-135">Isolation also includes storing files in a version-specific way.</span></span> <span data-ttu-id="08f4f-136">分離の詳細については、「[side-by-side 実行用のコンポーネントを作成するためのガイドライン](guidelines-for-creating-components-for-side-by-side-execution.md)」 を参照してください。</span><span class="sxs-lookup"><span data-stu-id="08f4f-136">For more information about isolation, see [Guidelines for Creating Components for Side-by-Side Execution](guidelines-for-creating-components-for-side-by-side-execution.md).</span></span>  
  
## <a name="version-compatibility"></a><span data-ttu-id="08f4f-137">バージョンの互換性</span><span class="sxs-lookup"><span data-stu-id="08f4f-137">Version Compatibility</span></span>  

<span data-ttu-id="08f4f-138">.NET Framework Version 1.0 と 1.1 は互換性を持つようにデザインされています。</span><span class="sxs-lookup"><span data-stu-id="08f4f-138">Versions 1.0 and 1.1 of the .NET Framework are designed to be compatible with one another.</span></span> <span data-ttu-id="08f4f-139">.NET Framework Version 1.0 で作成されたアプリケーションはバージョン 1.1 で動作し、.NET Framework Version 1.1 で作成されたアプリケーションはバージョン 1.0 で動作する必要があります。</span><span class="sxs-lookup"><span data-stu-id="08f4f-139">An application built with the .NET Framework version 1.0 should run on version 1.1, and an application built with the .NET Framework version 1.1 should run on version 1.0.</span></span> <span data-ttu-id="08f4f-140">ただし、.NET Framework Version 1.1 で追加された API 機能は、.NET Framework Version 1.0 では動作しません。</span><span class="sxs-lookup"><span data-stu-id="08f4f-140">Note, however, that API features added in version 1.1 of the .NET Framework will not work with version 1.0 of the .NET Framework.</span></span> <span data-ttu-id="08f4f-141">.NET Framework Version 2.0 で作成されたアプリケーションは .NET Framework Version 2.0 でのみ動作します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-141">Applications created with version 2.0 will run on version 2.0 only.</span></span> <span data-ttu-id="08f4f-142">.NET Framework Version 2.0 で作成されたアプリケーションは、Version 1.1 以前では動作しません。</span><span class="sxs-lookup"><span data-stu-id="08f4f-142">Version 2.0 applications will not run on version 1.1 or earlier.</span></span>  
  
<span data-ttu-id="08f4f-143">.NET Framework のバージョンは、ランタイムとそれに対応する .NET Framework アセンブリで構成される単一のユニットとして扱われます。この概念をアセンブリの統一と呼んでいます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-143">Versions of the .NET Framework are treated as a single unit consisting of the runtime and its associated .NET Framework assemblies (a concept referred to as assembly unification).</span></span> <span data-ttu-id="08f4f-144">他のバージョンの .NET Framework アセンブリを含むようにアセンブリ バインディングをリダイレクトすることもできますが、既定のアセンブリ バインディングのオーバーライドは危険性が伴うため、配置する前に厳密なテストが必要です。</span><span class="sxs-lookup"><span data-stu-id="08f4f-144">You can redirect assembly binding to include other versions of the .NET Framework assemblies, but overriding the default assembly binding can be risky and must be rigorously tested before deployment.</span></span>  
  
## <a name="locating-runtime-version-information"></a><span data-ttu-id="08f4f-145">ランタイム バージョン情報の検索</span><span class="sxs-lookup"><span data-stu-id="08f4f-145">Locating Runtime Version Information</span></span>  

<span data-ttu-id="08f4f-146">アプリケーションまたはコンポーネントのコンパイルに使用したランタイム バージョンおよびアプリケーションの実行時に必要なランタイム バージョンは、2 つの場所に格納されています。</span><span class="sxs-lookup"><span data-stu-id="08f4f-146">Information on which runtime version an application or component was compiled with and which versions of the runtime the application requires to run are stored in two locations.</span></span> <span data-ttu-id="08f4f-147">アプリケーションまたはコンポーネントをコンパイルするとき、コンパイルに使用したランタイム バージョンの情報がマネージド実行可能ファイルに格納されます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-147">When an application or component is compiled, information on the runtime version used to compile it is stored in the managed executable.</span></span> <span data-ttu-id="08f4f-148">アプリケーションまたはコンポーネントが要求するランタイム バージョンの情報は、アプリケーション構成ファイルに格納されています。</span><span class="sxs-lookup"><span data-stu-id="08f4f-148">Information on the runtime versions the application or component requires is stored in the application configuration file.</span></span>  
  
### <a name="runtime-version-information-in-the-managed-executable"></a><span data-ttu-id="08f4f-149">マネージド実行可能ファイルのランタイム バージョン情報</span><span class="sxs-lookup"><span data-stu-id="08f4f-149">Runtime Version Information in the Managed Executable</span></span>  

<span data-ttu-id="08f4f-150">各マネージド アプリケーションおよびマネージド コンポーネントのポータブル実行可能 (PE) ファイル ヘッダーには、その作成に使用されたランタイム バージョンに関する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="08f4f-150">The portable executable (PE) file header of each managed application and component contains information about the runtime version it was built with.</span></span> <span data-ttu-id="08f4f-151">共通言語ランタイムは、この情報に基づいて、アプリケーションの実行に必要なランタイムの最も適したバージョンを決定します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-151">The common language runtime uses this information to determine the most likely version of the runtime the application needs to run.</span></span>  
  
### <a name="runtime-version-information-in-the-application-configuration-file"></a><span data-ttu-id="08f4f-152">アプリケーション構成ファイルのランタイム バージョン情報</span><span class="sxs-lookup"><span data-stu-id="08f4f-152">Runtime Version Information in the Application Configuration File</span></span>  

<span data-ttu-id="08f4f-153">PE ファイル ヘッダーの情報に加え、アプリケーションは、ランタイム バージョン情報が含まれるアプリケーション構成ファイルと共に配置できます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-153">In addition to the information in the PE file header, an application can be deployed with an application configuration file that provides runtime version information.</span></span> <span data-ttu-id="08f4f-154">アプリケーション構成ファイルは XML ベースのファイルで、アプリケーションの開発者によって作成され、アプリケーションと共に出荷されます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-154">The application configuration file is an XML-based file that is created by the application developer and that ships with an application.</span></span> <span data-ttu-id="08f4f-155">このファイルに [\<startup> セクション](../configure-apps/file-schema/startup/startup-element.md)の [\<requiredRuntime> 要素](../configure-apps/file-schema/startup/requiredruntime-element.md)が存在する場合、この要素にアプリケーションでサポートするランタイムのバージョンとコンポーネントのバージョンを指定します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-155">The [\<requiredRuntime> Element](../configure-apps/file-schema/startup/requiredruntime-element.md) of the [\<startup> section](../configure-apps/file-schema/startup/startup-element.md), if it is present in this file, specifies which versions of the runtime and which versions of a component the application supports.</span></span> <span data-ttu-id="08f4f-156">また、このファイルを使用して、ランタイムの別のバージョンとアプリケーションの互換性をテストすることができます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-156">You can also use this file in testing to test an application's compatibility with different versions of the runtime.</span></span>  
  
<span data-ttu-id="08f4f-157">COM アプリケーションおよび COM+ アプリケーションを含むアンマネージド コードは、ランタイムがマネージド コードとやり取りするときに使用するアプリケーション構成ファイルを持つことができます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-157">Unmanaged code, including COM and COM+ applications, can have application configuration files that the runtime uses for interacting with managed code.</span></span> <span data-ttu-id="08f4f-158">アプリケーション構成ファイルは、COM 経由で起動するどのマネージド コードにも適用されます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-158">The application configuration file affects any managed code that you activate through COM.</span></span> <span data-ttu-id="08f4f-159">このファイルは、サポートするランタイム バージョンやアセンブリのリダイレクトを指定できます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-159">The file can specify which runtime versions it supports, as well as assembly redirects.</span></span> <span data-ttu-id="08f4f-160">既定では、マネージド コードを呼び出す COM 相互運用アプリケーションは、コンピューターにインストールされている最新のバージョンを使用します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-160">By default, COM interop applications calling to managed code use the latest version of the runtime installed on the computer.</span></span>  
  
 <span data-ttu-id="08f4f-161">アプリケーション構成ファイルの詳細については、[アプリケーションの構成](../configure-apps/index.md)に関するページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="08f4f-161">For more information about the application configuration files, see [Configuring Apps](../configure-apps/index.md).</span></span>  
  
## <a name="determining-which-version-of-the-runtime-to-load"></a><span data-ttu-id="08f4f-162">読み込むランタイム バージョンの決定</span><span class="sxs-lookup"><span data-stu-id="08f4f-162">Determining Which Version of the Runtime to Load</span></span>  

<span data-ttu-id="08f4f-163">共通言語ランタイムは、次の情報を使用して、アプリケーションのために読み込むランタイム バージョンを決定します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-163">The common language runtime uses the following information to determine which version of the runtime to load for an application:</span></span>  
  
- <span data-ttu-id="08f4f-164">利用できるランタイム バージョン</span><span class="sxs-lookup"><span data-stu-id="08f4f-164">The runtime versions that are available.</span></span>  
  
- <span data-ttu-id="08f4f-165">アプリケーションがサポートするランタイム バージョン</span><span class="sxs-lookup"><span data-stu-id="08f4f-165">The runtime versions that an application supports.</span></span>  
  
### <a name="supported-runtime-versions"></a><span data-ttu-id="08f4f-166">サポートされているランタイム バージョン</span><span class="sxs-lookup"><span data-stu-id="08f4f-166">Supported Runtime Versions</span></span>  

<span data-ttu-id="08f4f-167">ランタイムは、アプリケーション構成ファイルとポータブル実行可能 (PE) ファイル ヘッダーを使用して、アプリケーションがサポートするランタイムのバージョンを決定します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-167">The runtime uses the application configuration file and the portable executable (PE) file header to determine which version of the runtime an application supports.</span></span> <span data-ttu-id="08f4f-168">アプリケーション構成ファイルが存在しない場合、ランタイムはアプリケーションの PE ファイル ヘッダーで指定されているランタイム バージョンを読み込みます。ただし、このバージョンが利用できる場合です。</span><span class="sxs-lookup"><span data-stu-id="08f4f-168">If no application configuration file is present, the runtime loads the runtime version specified in the application's PE file header, if that version is available.</span></span>  
  
<span data-ttu-id="08f4f-169">アプリケーション構成ファイルが存在する場合は、次のプロセスの結果に基づいて、ランタイムは読み込むランタイムの適切なバージョンを決定します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-169">If an application configuration file is present, the runtime determines the appropriate runtime version to load based on the results of the following process:</span></span>  
  
1. <span data-ttu-id="08f4f-170">ランタイムは、アプリケーション構成ファイルの [\<supportedRuntime> 要素](../configure-apps/file-schema/startup/supportedruntime-element.md)を調べます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-170">The runtime examines the [\<supportedRuntime> Element](../configure-apps/file-schema/startup/supportedruntime-element.md) element in the application configuration file.</span></span> <span data-ttu-id="08f4f-171">**\<supportedRuntime>** 要素で指定されたサポートされるランタイム バージョンが 1 つ以上が見つかった場合、ランタイムは最初の **\<supportedRuntime>** 要素で指定されているランタイム バージョンを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-171">If one or more of the supported runtime versions specified in the **\<supportedRuntime>** element are present, the runtime loads the runtime version specified by the first **\<supportedRuntime>** element.</span></span> <span data-ttu-id="08f4f-172">このバージョンが利用できない場合、ランタイムは **\<supportedRuntime>** の次の要素を調べ、指定されているランタイム バージョンを読み込むようにしようとします。</span><span class="sxs-lookup"><span data-stu-id="08f4f-172">If this version is not available, the runtime examines the next **\<supportedRuntime>** element and attempts to load the runtime version specified.</span></span> <span data-ttu-id="08f4f-173">このランタイム バージョンが利用できない場合は、 **\<supportedRuntime>** の後続の要素を調べます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-173">If this runtime version is not available, subsequent **\<supportedRuntime>** elements are examined.</span></span> <span data-ttu-id="08f4f-174">サポートされるランタイム バージョンがどれも利用できない場合、ランタイムはランタイム バージョンの読み込みに失敗し、ユーザーに対してメッセージが表示されます (手順 3. 参照)。</span><span class="sxs-lookup"><span data-stu-id="08f4f-174">If none of the supported runtime versions are available, the runtime fails to load a runtime version and displays a message to the user (see step 3).</span></span>  
  
2. <span data-ttu-id="08f4f-175">ランタイムはアプリケーションの実行可能ファイルの PE ファイル ヘッダーを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-175">The runtime reads the PE file header of the application's executable file.</span></span> <span data-ttu-id="08f4f-176">PE ファイル ヘッダーで指定されたランタイム バージョンが利用できる場合、ランタイムはこのバージョンを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-176">If the runtime version specified by the PE file header is available, the runtime loads that version.</span></span> <span data-ttu-id="08f4f-177">指定されたランタイム バージョンが利用できない場合は、PE ヘッダーのランタイム バージョンと互換性があると Microsoft によって決められたランタイム バージョンがランタイムによって検索されます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-177">If the runtime version specified is not available, the runtime searches for a runtime version determined by Microsoft to be compatible with the runtime version in the PE header.</span></span> <span data-ttu-id="08f4f-178">このバージョンが見つからない場合、プロセスは手順 3. に進みます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-178">If that version is not found, the process continues to step 3.</span></span>  
  
3. <span data-ttu-id="08f4f-179">ランタイムは、アプリケーションがサポートしているランタイム バージョンが利用できないことを示すメッセージを表示します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-179">The runtime displays a message stating that the runtime version supported by the application is unavailable.</span></span> <span data-ttu-id="08f4f-180">ランタイムは読み込まれません。</span><span class="sxs-lookup"><span data-stu-id="08f4f-180">The runtime is not loaded.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="08f4f-181">このメッセージが表示されないようにするには、レジストリ キー HKLM\Software\Microsoft\\.NETFramework の値 NoGuiFromShim を使用するか、環境変数 COMPLUS_NoGuiFromShim を使用します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-181">You can suppress the display of this message by using the NoGuiFromShim value under the registry key HKLM\Software\Microsoft\\.NETFramework or using the environment variable COMPLUS_NoGuiFromShim.</span></span> <span data-ttu-id="08f4f-182">たとえば、無人インストールや Windows サービスなど、一般にはユーザーとの対話が不要なアプリケーションの場合、このメッセージを抑制できます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-182">For example, you can suppress the message for applications that do not typically interact with the user, such as unattended installations or Windows services.</span></span> <span data-ttu-id="08f4f-183">このメッセージを抑制すると、ランタイムによって、イベント ログにメッセージが書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-183">When this message display is suppressed, the runtime writes a message to the event log.</span></span>  <span data-ttu-id="08f4f-184">レジストリ値 NoGuiFromShim を 1 に設定すると、コンピューター上のすべてのアプリケーションで、このメッセージが抑制されます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-184">Set the registry value NoGuiFromShim to 1 to suppress this message for all applications on a computer.</span></span> <span data-ttu-id="08f4f-185">別の方法として、COMPLUS_NoGuiFromShim 環境変数を 1 に設定すると、特定のユーザー コンテキストで実行されるアプリケーションについてメッセージを抑制できます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-185">Alternately, set the COMPLUS_NoGuiFromShim environment variable to 1 to suppress the message for applications running in a particular user context.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="08f4f-186">ランタイム バージョンが読み込まれた後、アセンブリ バインディングのリダイレクトによって、.NET Framework アセンブリの異なるバージョンを読み込むように指定されることがあります。</span><span class="sxs-lookup"><span data-stu-id="08f4f-186">After a runtime version is loaded, assembly binding redirects can specify that a different version of an individual .NET Framework assembly be loaded.</span></span> <span data-ttu-id="08f4f-187">これらのバインディングのリダイレクトは、リダイレクトされた特定のアセンブリだけに影響します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-187">These binding redirects affect only the specific assembly that is redirected.</span></span>  
  
## <a name="partially-qualified-assembly-names-and-side-by-side-execution"></a><span data-ttu-id="08f4f-188">部分修飾アセンブリ名と side-by-side 実行</span><span class="sxs-lookup"><span data-stu-id="08f4f-188">Partially Qualified Assembly Names and Side-by-Side Execution</span></span>  

<span data-ttu-id="08f4f-189">部分限定アセンブリ参照は、side-by-side 実行の潜在的な問題の原因となり得るので、アプリケーション ディレクトリ内のアセンブリへのバインドだけで使用します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-189">Because they are a potential source of side-by-side problems, partially qualified assembly references can be used only to bind to assemblies within an application directory.</span></span> <span data-ttu-id="08f4f-190">開発するコード内では、部分限定アセンブリ参照は使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="08f4f-190">Avoid partially qualified assembly references in your code.</span></span>  
  
<span data-ttu-id="08f4f-191">コードの部分修飾アセンブリ参照を軽減するには、アプリケーション構成ファイルで完全にコード内で発生する部分修飾アセンブリ参照を修飾するために [\<qualifyAssembly>](../configure-apps/file-schema/runtime/qualifyassembly-element.md) 要素を使用できます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-191">To mitigate partially qualified assembly references in code, you can use the [\<qualifyAssembly>](../configure-apps/file-schema/runtime/qualifyassembly-element.md) element in an application configuration file to fully qualify partially qualified assembly references that occur in code.</span></span> <span data-ttu-id="08f4f-192">部分参照に設定されていないフィールドだけを指定するために **\<qualifyAssembly>** 要素を使用します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-192">Use the **\<qualifyAssembly>** element to specify only fields that were not set in the partial reference.</span></span> <span data-ttu-id="08f4f-193">**fullName** 属性で指定されているアセンブリ ID には、アセンブリ名を完全に修飾するのに必要なすべての情報 (つまり、アセンブリ名、公開キー、カルチャ、およびバージョン) が含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="08f4f-193">The assembly identity listed in the **fullName** attribute must contain all the information needed to fully qualify the assembly name: assembly name, public key, culture, and version.</span></span>  
  
 <span data-ttu-id="08f4f-194">`myAssembly` というアセンブリを完全に修飾する、アプリケーション構成ファイルのエントリの例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-194">The following example shows the application configuration file entry to fully qualify an assembly called `myAssembly`.</span></span>  
  
```xml  
<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
<qualifyAssembly partialName="myAssembly"
fullName="myAssembly,  
      version=1.0.0.0,
publicKeyToken=...,
      culture=neutral"/>
</assemblyBinding>
```  
  
 <span data-ttu-id="08f4f-195">アセンブリの読み込みステートメントが `myAssembly` を参照するたびに、構成ファイルのこれらの設定により、ランタイムは部分修飾された `myAssembly` 参照を完全限定参照に自動的に変換します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-195">Whenever an assembly load statement references `myAssembly`, these configuration file settings cause the runtime to automatically translate the partially qualified `myAssembly` reference to a fully qualified reference.</span></span> <span data-ttu-id="08f4f-196">たとえば、Assembly.Load("myAssembly") は Assembly.Load("myAssembly, version=1.0.0.0, publicKeyToken=..., culture=neutral") に変換されます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-196">For example, Assembly.Load("myAssembly") becomes Assembly.Load("myAssembly, version=1.0.0.0, publicKeyToken=..., culture=neutral").</span></span>  
  
> [!NOTE]
> <span data-ttu-id="08f4f-197">**LoadWithPartialName** メソッドを使用すると、グローバル アセンブリ キャッシュから部分参照アセンブリを読み込むのを禁止する共通言語ランタイムの制限をバイパスできます。</span><span class="sxs-lookup"><span data-stu-id="08f4f-197">You can use the **LoadWithPartialName** method to bypass the common language runtime restriction that prohibits partially referenced assemblies from being loaded from the global assembly cache.</span></span> <span data-ttu-id="08f4f-198">このメソッドは、side-by-side 実行で問題になりやすいので、リモート処理のシナリオだけで使用してください。</span><span class="sxs-lookup"><span data-stu-id="08f4f-198">This method should be used only in remoting scenarios as it can easily cause problems in side-by-side execution.</span></span>  
  
## <a name="related-topics"></a><span data-ttu-id="08f4f-199">関連トピック</span><span class="sxs-lookup"><span data-stu-id="08f4f-199">Related Topics</span></span>  
  
|<span data-ttu-id="08f4f-200">Title</span><span class="sxs-lookup"><span data-stu-id="08f4f-200">Title</span></span>|<span data-ttu-id="08f4f-201">説明</span><span class="sxs-lookup"><span data-stu-id="08f4f-201">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="08f4f-202">方法: 自動バインディング リダイレクトを有効/無効にする</span><span class="sxs-lookup"><span data-stu-id="08f4f-202">How to: Enable and Disable Automatic Binding Redirection</span></span>](../configure-apps/how-to-enable-and-disable-automatic-binding-redirection.md)|<span data-ttu-id="08f4f-203">アプリケーションをアセンブリの特定のバージョンにバインドする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-203">Describes how to bind an application to a specific version of an assembly.</span></span>|  
|[<span data-ttu-id="08f4f-204">アセンブリ バインディングのリダイレクトの構成</span><span class="sxs-lookup"><span data-stu-id="08f4f-204">Configuring Assembly Binding Redirection</span></span>](configuring-assembly-binding-redirection.md)|<span data-ttu-id="08f4f-205">.NET Framework アセンブリの特定のバージョンへのアセンブリ バインドの参照をリダイレクトする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-205">Explains how to redirect assembly binding references to a specific version of the .NET Framework assemblies.</span></span>|  
|[<span data-ttu-id="08f4f-206">インプロセスの side-by-side 実行</span><span class="sxs-lookup"><span data-stu-id="08f4f-206">In-Process Side-by-Side Execution</span></span>](in-process-side-by-side-execution.md)|<span data-ttu-id="08f4f-207">インプロセスのランタイム ホストの並行アクティブ化を使用して、1 つのプロセスで複数のバージョンの CLR を実行する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-207">Discusses how you can use in-process side-by-side runtime host activation to run multiple versions of the CLR in a single process.</span></span>|  
|[<span data-ttu-id="08f4f-208">.NET のアセンブリ</span><span class="sxs-lookup"><span data-stu-id="08f4f-208">Assemblies in .NET</span></span>](../../standard/assembly/index.md)|<span data-ttu-id="08f4f-209">アセンブリの概念的な概要を説明します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-209">Provides a conceptual overview of assemblies.</span></span>|  
|[<span data-ttu-id="08f4f-210">アプリケーション ドメイン</span><span class="sxs-lookup"><span data-stu-id="08f4f-210">Application Domains</span></span>](../app-domains/application-domains.md)|<span data-ttu-id="08f4f-211">アプリケーション ドメインの概念的な概要を説明します。</span><span class="sxs-lookup"><span data-stu-id="08f4f-211">Provides a conceptual overview of application domains.</span></span>|  
  
## <a name="reference"></a><span data-ttu-id="08f4f-212">関連項目</span><span class="sxs-lookup"><span data-stu-id="08f4f-212">Reference</span></span>  

[<span data-ttu-id="08f4f-213">\<supportedRuntime> 要素</span><span class="sxs-lookup"><span data-stu-id="08f4f-213">\<supportedRuntime> Element</span></span>](../configure-apps/file-schema/startup/supportedruntime-element.md)
