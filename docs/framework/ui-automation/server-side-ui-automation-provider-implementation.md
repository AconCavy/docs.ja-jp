---
title: サーバー側 UI オートメーション プロバイダーの実装
ms.date: 03/30/2017
helpviewer_keywords:
- server-side UI Automation provider implementation
- UI Automation, server-side provider implementation
- provider implementation, UI Automation
ms.assetid: 6acc6d08-bd67-4e2e-915c-9c1d34eb86fe
ms.openlocfilehash: 35754d49bf223e7afcdec32e8b24cfb749f48aa6
ms.sourcegitcommit: 9a39f2a06f110c9c7ca54ba216900d038aa14ef3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/23/2019
ms.locfileid: "74446852"
---
# <a name="server-side-ui-automation-provider-implementation"></a><span data-ttu-id="cd52f-102">サーバー側 UI オートメーション プロバイダーの実装</span><span class="sxs-lookup"><span data-stu-id="cd52f-102">Server-Side UI Automation Provider Implementation</span></span>

> [!NOTE]
> <span data-ttu-id="cd52f-103">このドキュメントは、[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 名前空間で定義されているマネージド <xref:System.Windows.Automation> クラスを使用する .NET Framework 開発者を対象としています。</span><span class="sxs-lookup"><span data-stu-id="cd52f-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="cd52f-104">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]の最新情報については、「 [Windows Automation API: UI Automation (Windows のオートメーション API: UI オートメーション)](/windows/win32/winauto/entry-uiauto-win32)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="cd52f-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="cd52f-105">このセクションでは、カスタム コントロールのサーバー側 UI オートメーション プロバイダーを実装する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-105">This section describes how to implement a server-side UI Automation provider for a custom control.</span></span>

<span data-ttu-id="cd52f-106">The implementation for Windows Presentation Foundation (WPF) elements and non-[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] elements (such as those designed for [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]) is fundamentally different.</span><span class="sxs-lookup"><span data-stu-id="cd52f-106">The implementation for Windows Presentation Foundation (WPF) elements and non-[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] elements (such as those designed for [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]) is fundamentally different.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="cd52f-107">要素は、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] から派生したクラスを使用して <xref:System.Windows.Automation.Peers.AutomationPeer>をサポートします。</span><span class="sxs-lookup"><span data-stu-id="cd52f-107">elements provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] through a class derived from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="cd52f-108">非[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 要素は、プロバイダー インターフェイスの実装を通じてサポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-108">Non-[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] elements provide support through implementations of provider interfaces.</span></span>

<a name="Security_Considerations"></a>

## <a name="security-considerations"></a><span data-ttu-id="cd52f-109">セキュリティの考慮事項</span><span class="sxs-lookup"><span data-stu-id="cd52f-109">Security Considerations</span></span>

<span data-ttu-id="cd52f-110">プロバイダーは、部分的に信頼された環境で動作できるように記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-110">Providers should be written so that they can work in a partial-trust environment.</span></span> <span data-ttu-id="cd52f-111">UIAutomationClient.dll は部分的な信頼で動作するように構成されていないため、プロバイダーのコードではこのアセンブリを参照しないでください。</span><span class="sxs-lookup"><span data-stu-id="cd52f-111">Because UIAutomationClient.dll is not configured to run under partial trust, your provider code should not reference that assembly.</span></span> <span data-ttu-id="cd52f-112">参照している場合、完全に信頼された環境ではコードを実行できますが、部分的に信頼された環境では失敗します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-112">If it does so, the code may run in a full-trust environment but then fail in a partial-trust environment.</span></span>

<span data-ttu-id="cd52f-113">具体的には、 <xref:System.Windows.Automation.AutomationElement>などの UIAutomationClient.dll のクラスのフィールドを使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="cd52f-113">In particular, do not use fields from classes in UIAutomationClient.dll such as those in <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="cd52f-114">代わりに、 <xref:System.Windows.Automation.AutomationElementIdentifiers>などの UIAutomationTypes.dll のクラスの同等のフィールドを使用します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-114">Instead, use the equivalent fields from classes in UIAutomationTypes.dll, such as <xref:System.Windows.Automation.AutomationElementIdentifiers>.</span></span>

<a name="Provider_Implementation_by_WPF_Elements"></a>

## <a name="provider-implementation-by-windows-presentation-foundation-elements"></a><span data-ttu-id="cd52f-115">Windows Presentation Foundation 要素によるプロバイダーの実装</span><span class="sxs-lookup"><span data-stu-id="cd52f-115">Provider Implementation by Windows Presentation Foundation Elements</span></span>

<span data-ttu-id="cd52f-116">このトピックの詳細については、「 [WPF カスタム コントロールの UI オートメーション](../wpf/controls/ui-automation-of-a-wpf-custom-control.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="cd52f-116">For more information on this topic, please see [UI Automation of a WPF Custom Control](../wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span></span>

<a name="Provider_Implementation_by_non_WPF_Elements"></a>

## <a name="provider-implementation-by-non-wpf-elements"></a><span data-ttu-id="cd52f-117">非 WPF 要素によるプロバイダーの実装</span><span class="sxs-lookup"><span data-stu-id="cd52f-117">Provider Implementation by non-WPF Elements</span></span>

<span data-ttu-id="cd52f-118">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] フレームワークの一部ではないが、マネージド コードで記述されたカスタム コントロール (多くの場合、 [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] コントロール) は、インターフェイスを実装することで [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] をサポートします。</span><span class="sxs-lookup"><span data-stu-id="cd52f-118">Custom controls that are not part of the [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] framework, but that are written in managed code (most often these are [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] controls), provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] by implementing interfaces.</span></span> <span data-ttu-id="cd52f-119">すべての要素は、次のセクションの最初のテーブルに示されているインターフェイスを 1 つ以上実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-119">Every element must implement at least one of the interfaces listed in the first table in the next section.</span></span> <span data-ttu-id="cd52f-120">さらに、要素が 1 つ以上のコントロール パターンをサポートする場合、コントロール パターンごとに適切なインターフェイスを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-120">In addition, if the element supports one or more control patterns, it must implement the appropriate interface for each control pattern.</span></span>

<span data-ttu-id="cd52f-121">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] プロバイダー プロジェクトは、次のアセンブリを参照する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-121">Your [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider project must reference the following assemblies:</span></span>

- <span data-ttu-id="cd52f-122">UIAutomationProviders.dll</span><span class="sxs-lookup"><span data-stu-id="cd52f-122">UIAutomationProviders.dll</span></span>

- <span data-ttu-id="cd52f-123">UIAutomationTypes.dll</span><span class="sxs-lookup"><span data-stu-id="cd52f-123">UIAutomationTypes.dll</span></span>

- <span data-ttu-id="cd52f-124">WindowsBase.dll</span><span class="sxs-lookup"><span data-stu-id="cd52f-124">WindowsBase.dll</span></span>

<a name="Provider_Interfaces"></a>

### <a name="provider-interfaces"></a><span data-ttu-id="cd52f-125">プロバイダーのインターフェイス</span><span class="sxs-lookup"><span data-stu-id="cd52f-125">Provider Interfaces</span></span>

<span data-ttu-id="cd52f-126">すべての [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] プロバイダーは、次のインターフェイスのいずれかを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-126">Every [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider must implement one of the following interfaces.</span></span>

|<span data-ttu-id="cd52f-127">Interface</span><span class="sxs-lookup"><span data-stu-id="cd52f-127">Interface</span></span>|<span data-ttu-id="cd52f-128">説明</span><span class="sxs-lookup"><span data-stu-id="cd52f-128">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderSimple>|<span data-ttu-id="cd52f-129">コントロール パターンやプロパティのサポートを含む、ウィンドウでホストされる単純なコントロールの機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-129">Provides functionality for a simple control hosted in a window, including support for control patterns and properties.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragment>|<span data-ttu-id="cd52f-130"><xref:System.Windows.Automation.Provider.IRawElementProviderSimple>から継承します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-130">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span></span> <span data-ttu-id="cd52f-131">フラグメント内のナビゲーション、フォーカスの設定、要素の四角形領域の復帰などを含む、複雑なコントロールの要素の機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-131">Adds functionality for an element in a complex control, including navigation within the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>|<span data-ttu-id="cd52f-132"><xref:System.Windows.Automation.Provider.IRawElementProviderFragment>から継承します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-132">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span></span> <span data-ttu-id="cd52f-133">指定した座標での子要素の検索やコントロール全体のフォーカス状態の設定などを含む、複雑なコントロールのルート要素の機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-133">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span>|

<span data-ttu-id="cd52f-134">次のインターフェイスは追加機能を提供しますが、実装する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="cd52f-134">The following interfaces provide added functionality but are not required to be implemented.</span></span>

|<span data-ttu-id="cd52f-135">Interface</span><span class="sxs-lookup"><span data-stu-id="cd52f-135">Interface</span></span>|<span data-ttu-id="cd52f-136">説明</span><span class="sxs-lookup"><span data-stu-id="cd52f-136">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="cd52f-137">プロバイダーがイベントの要求を追跡できるようにします。</span><span class="sxs-lookup"><span data-stu-id="cd52f-137">Enables the provider to track requests for events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride>|<span data-ttu-id="cd52f-138">フラグメントの [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ツリー内のウィンドウ ベースの要素の位置を変更できるようにします。</span><span class="sxs-lookup"><span data-stu-id="cd52f-138">Enables repositioning of window-based elements within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree of a fragment.</span></span>|

<span data-ttu-id="cd52f-139"><xref:System.Windows.Automation.Provider> 名前空間内の他のすべてのインターフェイスは、コントロール パターンをサポートします。</span><span class="sxs-lookup"><span data-stu-id="cd52f-139">All other interfaces in the <xref:System.Windows.Automation.Provider> namespace are for control pattern support.</span></span>

<a name="Requirements_for_Non_WPF_Providers"></a>

### <a name="requirements-for-non-wpf-providers"></a><span data-ttu-id="cd52f-140">非 WPF プロバイダーの要件</span><span class="sxs-lookup"><span data-stu-id="cd52f-140">Requirements for Non-WPF Providers</span></span>

<span data-ttu-id="cd52f-141">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]と通信するために、コントロールは次の主な領域の機能を実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-141">In order to communicate with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], your control must implement the following main areas of functionality:</span></span>

|<span data-ttu-id="cd52f-142">機能</span><span class="sxs-lookup"><span data-stu-id="cd52f-142">Functionality</span></span>|<span data-ttu-id="cd52f-143">実装</span><span class="sxs-lookup"><span data-stu-id="cd52f-143">Implementation</span></span>|
|-------------------|--------------------|
|<span data-ttu-id="cd52f-144">プロバイダーを [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]に公開する</span><span class="sxs-lookup"><span data-stu-id="cd52f-144">Expose the provider to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span></span>|<span data-ttu-id="cd52f-145">コントロール ウィンドウに送信された WM_GETOBJECT メッセージの応答として、 <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (または派生インターフェイス) を実装するオブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-145">In response to a WM_GETOBJECT message sent to the control window, return the object that implements <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (or a derived interface).</span></span> <span data-ttu-id="cd52f-146">フラグメントの場合、これはフラグメント ルートのプロバイダーである必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-146">For fragments, this must be the provider for the fragment root.</span></span>|
|<span data-ttu-id="cd52f-147">プロパティ値を指定する</span><span class="sxs-lookup"><span data-stu-id="cd52f-147">Provide property values</span></span>|<span data-ttu-id="cd52f-148">値を指定またはオーバーライドする <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> を実装します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-148">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> to provide or override values.</span></span>|
|<span data-ttu-id="cd52f-149">クライアントがコントロールと対話できるようにする</span><span class="sxs-lookup"><span data-stu-id="cd52f-149">Enable the client to interact with the control</span></span>|<span data-ttu-id="cd52f-150"><xref:System.Windows.Automation.Provider.IInvokeProvider>などのコントロール パターンをサポートするインターフェイスを実装します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-150">Implement interfaces that support control patterns, such as <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span></span> <span data-ttu-id="cd52f-151"><xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>の実装でこれらのパターンのプロバイダーを返します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-151">Return these pattern providers in your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>.</span></span>|
|<span data-ttu-id="cd52f-152">イベントを発生させる</span><span class="sxs-lookup"><span data-stu-id="cd52f-152">Raise events</span></span>|<span data-ttu-id="cd52f-153"><xref:System.Windows.Automation.Provider.AutomationInteropProvider> のメソッドの 1 つを呼び出して、クライアントがリッスンできるイベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-153">Call one of the static methods of <xref:System.Windows.Automation.Provider.AutomationInteropProvider> to raise an event that a client can listen for.</span></span>|
|<span data-ttu-id="cd52f-154">フラグメント内のナビゲーションとフォーカス設定を有効にする</span><span class="sxs-lookup"><span data-stu-id="cd52f-154">Enable navigation and focusing within a fragment</span></span>|<span data-ttu-id="cd52f-155">フラグメント内の各要素に <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> を実装します</span><span class="sxs-lookup"><span data-stu-id="cd52f-155">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> for each element within the fragment.</span></span> <span data-ttu-id="cd52f-156">(フラグメントの一部でない要素に対しては必要ありません)。</span><span class="sxs-lookup"><span data-stu-id="cd52f-156">(Not necessary for elements that are not part of a fragment.)</span></span>|
|<span data-ttu-id="cd52f-157">フラグメント内のフォーカス設定と子要素の配置を有効にする</span><span class="sxs-lookup"><span data-stu-id="cd52f-157">Enable focusing and location of child element in a fragment</span></span>|<span data-ttu-id="cd52f-158"><xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>を実装します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-158">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span></span> <span data-ttu-id="cd52f-159">(フラグメント ルートでない要素に対しては必要ありません)。</span><span class="sxs-lookup"><span data-stu-id="cd52f-159">(Not necessary for elements that are not fragment roots.)</span></span>|

<a name="Property_Values_in_Non_WPF_Providers"></a>

### <a name="property-values-in-non-wpf-providers"></a><span data-ttu-id="cd52f-160">非 WPF プロバイダー内のプロパティ値</span><span class="sxs-lookup"><span data-stu-id="cd52f-160">Property Values in Non-WPF Providers</span></span>

<span data-ttu-id="cd52f-161">カスタム コントロールの[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] プロバイダーは、オートメーション システムおよびクライアント アプリケーションで使用できる特定のプロパティをサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-161">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] providers for custom controls must support certain properties that can be used by the automation system as well as by client applications.</span></span> <span data-ttu-id="cd52f-162">ウィンドウでホストされている (HWND) 要素の場合、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] は一部のプロパティを既定のウィンドウ プロバイダーから取得できますが、他のプロパティはカスタム プロバイダーから取得する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-162">For elements that are hosted in windows (HWNDs), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="cd52f-163">HWND ベースのコントロールのプロバイダーは通常、次のプロパティを指定する必要はありません (フィールド値で識別されます)。</span><span class="sxs-lookup"><span data-stu-id="cd52f-163">Providers for HWND based controls do not usually need to provide the following properties (identified by field values):</span></span>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.BoundingRectangleProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClickablePointProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ProcessIdProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClassNameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.HasKeyboardFocusProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsEnabledProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsPasswordProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty>

> [!NOTE]
> <span data-ttu-id="cd52f-164">単純な要素またはウィンドウでホストされているフラグメント ルートの <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> は、ウィンドウから取得されます。ただし、ルートの下にあるフラグメント要素 (リスト ボックス内のリスト項目など) は独自の識別子を提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-164">The <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> of a simple element or fragment root hosted in a window is obtained from the window; however, fragment elements below the root (such as list items in a list box) must provide their own identifiers.</span></span> <span data-ttu-id="cd52f-165">詳細については、「<xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="cd52f-165">For more information, see <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span></span>
>
> <span data-ttu-id="cd52f-166"><xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> は、 [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] コントロールでホストされるプロバイダーに返される必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-166">The <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> should be returned for providers hosted in a [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] control.</span></span> <span data-ttu-id="cd52f-167">この場合、ウィンドウの既定のプロバイダーは適切な値を取得できないことがあります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-167">In this case, the default window provider may be unable to retrieve the correct value.</span></span>
>
> <span data-ttu-id="cd52f-168"><xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> は通常、ホスト プロバイダーによって提供されます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-168">The <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> is usually supplied by the host provider.</span></span> <span data-ttu-id="cd52f-169">たとえば、カスタム コントロールが <xref:System.Windows.Forms.Control>から派生している場合、名前はこのコントロールの `Text` プロパティから派生します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-169">For example, if a custom control is derived from <xref:System.Windows.Forms.Control>, the name is derived from the `Text` property of the control.</span></span>

<span data-ttu-id="cd52f-170">コード例については、「 [UI オートメーション プロバイダーからのプロパティの返却](return-properties-from-a-ui-automation-provider.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="cd52f-170">For example code, see [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md).</span></span>

<a name="Events_in_Non_WPF_Providers"></a>

### <a name="events-in-non-wpf-providers"></a><span data-ttu-id="cd52f-171">非 WPF プロバイダー内のイベント</span><span class="sxs-lookup"><span data-stu-id="cd52f-171">Events in Non-WPF Providers</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="cd52f-172">プロバイダーは、イベントを発生させて、UI の状態の変更をクライアント アプリケーションに通知する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-172">providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="cd52f-173">イベントを発生させるには、次のメソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-173">The following methods are used to raise events.</span></span>

|<span data-ttu-id="cd52f-174">メソッド</span><span class="sxs-lookup"><span data-stu-id="cd52f-174">Method</span></span>|<span data-ttu-id="cd52f-175">説明</span><span class="sxs-lookup"><span data-stu-id="cd52f-175">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationEvent%2A>|<span data-ttu-id="cd52f-176">コントロール パターンによってトリガーされるイベントを含む、さまざまなイベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-176">Raises various events, including events triggered by control patterns.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationPropertyChangedEvent%2A>|<span data-ttu-id="cd52f-177">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] プロパティが変更された場合にイベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-177">Raises an event when a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property has changed.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseStructureChangedEvent%2A>|<span data-ttu-id="cd52f-178">要素の追加や削除などによって [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ツリーの構造が変更された場合にイベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-178">Raises an event when the structure of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree has changed; for example, by the removal or addition of an element.</span></span>|

<span data-ttu-id="cd52f-179">イベントの目的は、 [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)]システム自体によってトリガーされたアクティビティかどうかにかかわらず、何かが [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 内で行われたことをクライアントに通知することです。</span><span class="sxs-lookup"><span data-stu-id="cd52f-179">The purpose of an event is to notify the client of something taking place in the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], whether or not the activity is triggered by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] system itself.</span></span> <span data-ttu-id="cd52f-180">たとえば、 <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> によって識別されるイベントは、ユーザーの直接入力の場合でもクライアント アプリケーションの <xref:System.Windows.Automation.InvokePattern.Invoke%2A>呼び出しの場合でも、コントロールが呼び出されるたびに発生させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-180">For example, the event identified by <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> should be raised whenever the control is invoked, either through direct user input or by the client application calling <xref:System.Windows.Automation.InvokePattern.Invoke%2A>.</span></span>

<span data-ttu-id="cd52f-181">パフォーマンスを最適化するため、プロバイダーは選択的にイベントを発生させたり、イベントを受け取るクライアント アプリケーションが登録されていないときにはイベントを発生させないようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-181">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="cd52f-182">最適化には、次のメソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-182">The following methods are used for optimization.</span></span>

|<span data-ttu-id="cd52f-183">メソッド</span><span class="sxs-lookup"><span data-stu-id="cd52f-183">Method</span></span>|<span data-ttu-id="cd52f-184">説明</span><span class="sxs-lookup"><span data-stu-id="cd52f-184">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.ClientsAreListening%2A>|<span data-ttu-id="cd52f-185">この静的プロパティは、クライアント アプリケーションが [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] イベントにサブスクライブしているかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-185">This static property specifies whether any client applications have subscribed to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="cd52f-186">プロバイダーがこのインターフェイスをフラグメント ルートに実装すると、クライアントがフラグメント上のイベント用のイベント ハンドラーを登録および登録解除したときに通知されるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-186">The provider's implementation of this interface on a fragment root enables it to be advised when clients register and unregister event handlers for events on the fragment.</span></span>|

<a name="Non_WPF_Provider_Navigation"></a>

### <a name="non-wpf-provider-navigation"></a><span data-ttu-id="cd52f-187">非 WPF プロバイダーのナビゲーション</span><span class="sxs-lookup"><span data-stu-id="cd52f-187">Non-WPF Provider Navigation</span></span>

<span data-ttu-id="cd52f-188">ウィンドウでホストされる (HWND) カスタム ボタンなどの単純なコントロールのプロバイダーは、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ツリー内のナビゲーションをサポートする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="cd52f-188">Providers for simple controls such as a custom button hosted in a window (HWND) do not need to support navigation within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="cd52f-189">要素間のナビゲーションは、ホスト ウィンドウの既定のプロバイダーによって処理されます。これは、 <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>の実装で指定されます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-189">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>.</span></span> <span data-ttu-id="cd52f-190">ただし、複雑なカスタム コントロール用のプロバイダーを実装する場合は、フラグメントのルート ノードと子孫ノード、および兄弟ノード間のナビゲーションをサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-190">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!NOTE]
> <span data-ttu-id="cd52f-191">ルート以外のフラグメントの要素は、 `null` から <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>参照を返す必要があります。これらが直接ウィンドウでホストされておらず、これらの間のナビゲーションをサポートできる既定のプロバイダーがないためです。</span><span class="sxs-lookup"><span data-stu-id="cd52f-191">Elements of a fragment other than the root must return a `null` reference  from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

<span data-ttu-id="cd52f-192">フラグメントの構造は、 <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>の実装によって決まります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-192">The structure of the fragment is determined by your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>.</span></span> <span data-ttu-id="cd52f-193">このメソッドは、各フラグメントから可能なそれぞれの方向に対して、その方向の要素に対するプロバイダー オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-193">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="cd52f-194">その方向に要素がない場合、メソッドは `null` 参照を返します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-194">If there is no element in that direction, the method returns a `null` reference.</span></span>

<span data-ttu-id="cd52f-195">フラグメント ルートは、子要素へのナビゲーションのみをサポートします。</span><span class="sxs-lookup"><span data-stu-id="cd52f-195">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="cd52f-196">たとえば、リスト ボックスは、方向が <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>の場合はリスト内の最初の項目を、方向が <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>の場合は最後の項目を返します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-196">For example, a list box returns the first item in the list when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>, and the last item when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>.</span></span> <span data-ttu-id="cd52f-197">フラグメント ルートは、親または兄弟へのナビゲーションをサポートしません。これはホスト ウィンドウ プロバイダーによって処理されます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-197">The fragment root does not support navigation to a parent or siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="cd52f-198">ルート以外のフラグメントの要素は、親へのナビゲーションと、(存在する場合は) 兄弟や子へのナビゲーションをサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-198">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

<a name="Non_WPF_Provider_Reparenting"></a>

### <a name="non-wpf-provider-reparenting"></a><span data-ttu-id="cd52f-199">非 WPF プロバイダーの親の変更</span><span class="sxs-lookup"><span data-stu-id="cd52f-199">Non-WPF Provider Reparenting</span></span>

<span data-ttu-id="cd52f-200">ポップアップ ウィンドウは、実際には最上位のウィンドウであり、既定ではデスクトップの子として [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ツリーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-200">Pop-up windows are actually top-level windows, and so by default appear in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree as children of the desktop.</span></span> <span data-ttu-id="cd52f-201">ただし、多くの場合、ポップアップ ウィンドウは論理的には他のコントロールの子になります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-201">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="cd52f-202">たとえば、コンボ ボックスのドロップダウン リストは、論理的にはコンボ ボックスの子です。</span><span class="sxs-lookup"><span data-stu-id="cd52f-202">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="cd52f-203">同様に、メニューのポップアップ ウィンドウは、論理的にはメニューの子になります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-203">Similarly, a menu pop-up window is logically a child of the menu.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="cd52f-204">はポップアップ ウィンドウの親の変更をサポートしているため、ポップアップ ウィンドウを関連するコントロールの子として表示できます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-204">provides support to reparent pop-up windows so that they appear to be children of the associated control.</span></span>

<span data-ttu-id="cd52f-205">ポップアップ ウィンドウの親を変更するには:</span><span class="sxs-lookup"><span data-stu-id="cd52f-205">To reparent a pop-up window:</span></span>

1. <span data-ttu-id="cd52f-206">ポップアップ ウィンドウ用のプロバイダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-206">Create a provider for the pop-up window.</span></span> <span data-ttu-id="cd52f-207">これには、ポップアップ ウィンドウのクラスを事前に知っておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-207">This requires that the class of the pop-up window is known in advance.</span></span>

2. <span data-ttu-id="cd52f-208">そのポップアップ自体がコントロールであるかのように、ポップアップのすべてのプロパティとパターンを通常どおりに実装します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-208">Implement all properties and patterns as usual for that pop-up, as though it were a control in its own right.</span></span>

3. <span data-ttu-id="cd52f-209"><xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> プロパティを実装し、 <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>から取得した値を返せるようにします。パラメーターは、ポップアップ ウィンドウのウィンドウ ハンドルです。</span><span class="sxs-lookup"><span data-stu-id="cd52f-209">Implement the <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> property so that it returns the value obtained from <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, where the parameter is the window handle of the pop-up window.</span></span>

4. <span data-ttu-id="cd52f-210">ポップアップ ウィンドウとその親の <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> を実装し、論理上の親から論理上の子へのナビゲーションおよび子の兄弟間のナビゲーションが適切に処理されるようにします。</span><span class="sxs-lookup"><span data-stu-id="cd52f-210">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="cd52f-211">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] は、ポップアップ ウィンドウを検出すると、既定のナビゲーションがオーバーライドされていると認識し、デスクトップの子として検出されたポップアップ ウィンドウをスキップします。</span><span class="sxs-lookup"><span data-stu-id="cd52f-211">When [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="cd52f-212">代わりに、ノードはフラグメントによってのみ、到達可能になります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-212">Instead, the node will only be reachable through the fragment.</span></span>

<span data-ttu-id="cd52f-213">コントロールが任意のクラスのウィンドウをホストできる場合には、親の変更は適切ではありません。</span><span class="sxs-lookup"><span data-stu-id="cd52f-213">Reparenting is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="cd52f-214">たとえば、Rebar はそのバンド内で任意の型の HWND をホストできます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-214">For example, a rebar can host any type of HWND in its bands.</span></span> <span data-ttu-id="cd52f-215">このような場合を処理するため、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] は次のセクションで説明する、別の形の HWND 再配置をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="cd52f-215">To handle these cases, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] supports an alternative form of HWND relocation, as described in the next section.</span></span>

<a name="Non_WPF_Provider_Repositioning"></a>

### <a name="non-wpf-provider-repositioning"></a><span data-ttu-id="cd52f-216">非 WPF プロバイダーの再配置</span><span class="sxs-lookup"><span data-stu-id="cd52f-216">Non-WPF Provider Repositioning</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="cd52f-217">フラグメントは、それぞれウィンドウ (HWND) に含まれる 2 つ以上の要素を含んでいる場合があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-217">fragments may contain two or more elements that are each contained in a window (HWND).</span></span> <span data-ttu-id="cd52f-218">各 HWND には独自の既定のプロバイダーがあり、その HWND を含む HWND をその親と見なしているため、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ツリーは既定で、HWND を親ウィンドウの子としてフラグメント内に表示します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-218">Because each HWND has its own default provider that considers the HWND to be a child of a containing HWND, the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree will, by default, show the HWNDs in the fragment as children of the parent window.</span></span> <span data-ttu-id="cd52f-219">ほとんどの場合、これは適切な動作ですが、場合によっては [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]の論理構造が一致しないために混乱を招く可能性があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-219">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span>

<span data-ttu-id="cd52f-220">良い例が Rebar コントロールです。</span><span class="sxs-lookup"><span data-stu-id="cd52f-220">A good example of this is a rebar control.</span></span> <span data-ttu-id="cd52f-221">Rebar はバンドを格納し、各バンドはツール バー、編集ボックス、コンボ ボックスなど HWND ベースのコントロールを格納します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-221">A rebar contains bands, each of which can in turn contain an HWND-based control such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="cd52f-222">Rebar HWND の既定のウィンドウ プロバイダーは、バンド コントロール HWND を子と見なし、Rebar プロバイダーはバンドを子と見なします。</span><span class="sxs-lookup"><span data-stu-id="cd52f-222">The default window provider for the rebar HWND sees the band control HWNDs as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="cd52f-223">HWND プロバイダーと Rebar プロバイダーは連動し、互いの子を結合するため、バンドと HWND ベースのコントロールはどちらも Rebar の子として表示されます。</span><span class="sxs-lookup"><span data-stu-id="cd52f-223">Because the HWND provider and the rebar provider are working in tandem and combining their children, both the bands and the HWND-based controls appear as children of the rebar.</span></span> <span data-ttu-id="cd52f-224">ただし、論理的には、バンドのみが Rebar の子として表示され、各バンド プロバイダーは、格納されるコントロールの既定の HWND プロバイダーと結合される必要があります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-224">Logically, however, only the bands should appear as children of the rebar, and each band provider should be coupled with the default HWND provider for the control it contains.</span></span>

<span data-ttu-id="cd52f-225">これを実現するため、Rebar のフラグメント ルート プロバイダーは、バンドを表す子のセットを公開します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-225">To accomplish this, the fragment root provider for the rebar exposes a set of children representing the bands.</span></span> <span data-ttu-id="cd52f-226">各バンドには、プロパティとパターンを公開するプロバイダーが 1 つあります。</span><span class="sxs-lookup"><span data-stu-id="cd52f-226">Each band has a single provider that may expose properties and patterns.</span></span> <span data-ttu-id="cd52f-227">その <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>の実装で、バンド プロバイダーはコントロール HWND の既定のウィンドウ プロバイダーを返します。これを取得するには、コントロールのウィンドウ ハンドルを渡して <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-227">In its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, the band provider returns the default window provider for the control HWND, which it obtains by calling <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, passing in the control's window handle.</span></span> <span data-ttu-id="cd52f-228">最後に、Rebar のフラグメント ルート プロバイダーは <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> インターフェイスを実装し、その <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> の実装で、指定した HWND に含まれるコントロールの適切なバンド プロバイダーを返します。</span><span class="sxs-lookup"><span data-stu-id="cd52f-228">Finally, the fragment root provider for the rebar implements the <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> interface, and in its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> it returns the appropriate band provider for the control contained in the specified HWND.</span></span>

## <a name="see-also"></a><span data-ttu-id="cd52f-229">関連項目</span><span class="sxs-lookup"><span data-stu-id="cd52f-229">See also</span></span>

- [<span data-ttu-id="cd52f-230">UI オートメーション プロバイダーの概要</span><span class="sxs-lookup"><span data-stu-id="cd52f-230">UI Automation Providers Overview</span></span>](ui-automation-providers-overview.md)
- [<span data-ttu-id="cd52f-231">サーバー側 UI オートメーション プロバイダーの公開</span><span class="sxs-lookup"><span data-stu-id="cd52f-231">Expose a Server-side UI Automation Provider</span></span>](expose-a-server-side-ui-automation-provider.md)
- [<span data-ttu-id="cd52f-232">UI オートメーション プロバイダーからのプロパティの返却</span><span class="sxs-lookup"><span data-stu-id="cd52f-232">Return Properties from a UI Automation Provider</span></span>](return-properties-from-a-ui-automation-provider.md)
- [<span data-ttu-id="cd52f-233">UI オートメーション プロバイダーからのイベントの発生</span><span class="sxs-lookup"><span data-stu-id="cd52f-233">Raise Events from a UI Automation Provider</span></span>](raise-events-from-a-ui-automation-provider.md)
- [<span data-ttu-id="cd52f-234">UI オートメーション フラグメント プロバイダーでのナビゲーションの有効化</span><span class="sxs-lookup"><span data-stu-id="cd52f-234">Enable Navigation in a UI Automation Fragment Provider</span></span>](enable-navigation-in-a-ui-automation-fragment-provider.md)
- [<span data-ttu-id="cd52f-235">UI オートメーション プロバイダーでのコントロール パターンのサポート</span><span class="sxs-lookup"><span data-stu-id="cd52f-235">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
