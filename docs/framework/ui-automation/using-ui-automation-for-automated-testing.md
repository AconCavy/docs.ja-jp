---
title: UI オートメーションによる自動テスト
ms.date: 03/30/2017
helpviewer_keywords:
- automated testing
- testing, UI Automation
- UI Automation, automated testing
ms.assetid: 3a0435c0-a791-4ad7-ba92-a4c1d1231fde
ms.openlocfilehash: 59c4076712823faa1602448653680a31b8cd8c69
ms.sourcegitcommit: 9a97c76e141333394676bc5d264c6624b6f45bcf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/08/2020
ms.locfileid: "75741071"
---
# <a name="using-ui-automation-for-automated-testing"></a><span data-ttu-id="dd170-102">UI オートメーションによる自動テスト</span><span class="sxs-lookup"><span data-stu-id="dd170-102">Using UI Automation for Automated Testing</span></span>
> [!NOTE]
> <span data-ttu-id="dd170-103">このドキュメントは、[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 名前空間で定義されているマネージド <xref:System.Windows.Automation> クラスを使用する .NET Framework 開発者を対象としています。</span><span class="sxs-lookup"><span data-stu-id="dd170-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="dd170-104">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]の最新情報については、「 [Windows Automation API: UI オートメーション](/windows/win32/winauto/entry-uiauto-win32)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>  
  
 <span data-ttu-id="dd170-105">ここでは、自動テストのシナリオで、プログラムによるアクセスのためのフレームワークとして [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] がどのように役立つかについて説明します。</span><span class="sxs-lookup"><span data-stu-id="dd170-105">This overview describes how [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] can be useful as a framework for programmatic access in automated testing scenarios.</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="dd170-106">の統一されたオブジェクト モデルを使用すると、すべての [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] フレームワークにおいて、複雑で豊富な機能をアクセシビリティが高く自動化しやすい方法で公開できます。</span><span class="sxs-lookup"><span data-stu-id="dd170-106">provides a unified object model that enables all [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] frameworks to expose complex and rich functionality in an accessible and easily automated manner.</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="dd170-107">は、Microsoft Active Accessibility の後継として開発されました。</span><span class="sxs-lookup"><span data-stu-id="dd170-107">was developed as a successor to Microsoft Active Accessibility.</span></span> <span data-ttu-id="dd170-108">Active Accessibility は、コントロールとアプリケーションにアクセスできるようにするためのソリューションを提供するように設計された既存のフレームワークです。</span><span class="sxs-lookup"><span data-stu-id="dd170-108">Active Accessibility is an existing framework designed to provide a solution for making controls and applications accessible.</span></span> <span data-ttu-id="dd170-109">Active Accessibility は、ユーザー補助と自動化の非常によく似た要件があるため、テストの自動化を考慮して設計されていませんでした。</span><span class="sxs-lookup"><span data-stu-id="dd170-109">Active Accessibility was not designed with test automation in mind even though it evolved into that role due to the very similar requirements of accessibility and automation.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="dd170-110">は、ユーザー補助のためのより洗練されたソリューションを提供するだけでなく、信頼性の高い自動テスト機能を提供するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="dd170-110">, in addition to providing more refined solutions for accessibility, is also specifically designed to provide robust functionality for automated testing.</span></span> <span data-ttu-id="dd170-111">たとえば、Active Accessibility は、UI に関する情報を公開し、製品ので必要な情報を収集するために、1つのインターフェイスに依存しています。[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 2 つのモデルを分離します。</span><span class="sxs-lookup"><span data-stu-id="dd170-111">For example, Active Accessibility relies on a single interface to both expose information about the UI and collect the information needed by AT products; [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] separates the two models.</span></span>  
  
 <span data-ttu-id="dd170-112">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] を自動テスト ツールとして利用するには、プロバイダーとクライアントの両方にこれを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dd170-112">Both a provider and client are required to implement [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] for it to be useful as an automated test tool.</span></span> <span data-ttu-id="dd170-113">UI オートメーションプロバイダーは、microsoft Word、Excel、その他のサードパーティ製アプリケーション、Microsoft Windows オペレーティングシステムに基づくコントロールなどのアプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="dd170-113">UI Automation providers are applications such as Microsoft Word, Excel, and other third-party applications or controls based on the Microsoft Windows operating system.</span></span> <span data-ttu-id="dd170-114">UI オートメーション クライアントは、自動テスト スクリプトや支援テクノロジ アプリケーションなどです。</span><span class="sxs-lookup"><span data-stu-id="dd170-114">UI Automation clients include automated test scripts and assistive technology applications.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="dd170-115">この概要の目的は、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]の、自動テストに関する新機能と強化された機能について説明することです。</span><span class="sxs-lookup"><span data-stu-id="dd170-115">The intent of this overview is to showcase the new and improved automated testing capabilities of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span> <span data-ttu-id="dd170-116">この概要はユーザー補助機能に関する情報の提供を目的とするものではなく、必要な場合以外、ユーザー補助については説明しません。</span><span class="sxs-lookup"><span data-stu-id="dd170-116">This overview is not intended to provide information on accessibility features and will not address accessibility other than where necessary.</span></span>  
  
## <a name="ui-automation-in-a-provider"></a><span data-ttu-id="dd170-117">プロバイダーにおける UI オートメーション</span><span class="sxs-lookup"><span data-stu-id="dd170-117">UI Automation in a Provider</span></span>  
 <span data-ttu-id="dd170-118">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] を自動化するためにアプリケーションやコントロールの開発者が注意する必要があるのは、その [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] オブジェクトでキーボードとマウスの標準操作を使用して実行できるエンド ユーザーのアクションです。</span><span class="sxs-lookup"><span data-stu-id="dd170-118">For a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] to be automated, a developer of an application or control must look at what actions an end-user can perform on the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] object using standard keyboard and mouse interaction.</span></span>  
  
 <span data-ttu-id="dd170-119">これらの主要なアクションを特定したら、対応する [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] コントロール パターン (つまり、 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 要素の機能と動作をミラー化するコントロール パターン) をコントロール上に実装します。</span><span class="sxs-lookup"><span data-stu-id="dd170-119">Once these key actions have been identified, the corresponding [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] control patterns (that is, the control patterns that mirror the functionality and behavior of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] element) should be implemented on the control.</span></span> <span data-ttu-id="dd170-120">たとえば、コンボ ボックス コントロール (実行用のダイアログなど) でのユーザー操作には、通常、項目の一覧を非表示にしたり表示したりするためのコンボ ボックスの展開と折りたたみ、一覧からの項目の選択、またはキーボード入力による新しい値の追加が含まれます。</span><span class="sxs-lookup"><span data-stu-id="dd170-120">For example, user interaction with a combo box control (such as the run dialog) typically involves expanding and collapsing the combo box to hide or display a list of items, selecting an item from that list, or adding a new value via keyboard input.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="dd170-121">他のユーザー補助モデルでは、開発者が直接、個々のボタン、メニューなどのコントロールから情報を収集する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dd170-121">With other accessibility models, developers must gather information directly from individual buttons, menus, or other controls.</span></span> <span data-ttu-id="dd170-122">しかも、各コントロール型には、細部の異なるバリエーションが多数存在します。</span><span class="sxs-lookup"><span data-stu-id="dd170-122">Unfortunately, every control type comes in dozens of minor variations.</span></span> <span data-ttu-id="dd170-123">つまり、あるプッシュボタンに 10 個のバリエーションが存在すると、それらすべての動作と機能が同じであっても、それぞれを別個のコントロールとして扱う必要があります。</span><span class="sxs-lookup"><span data-stu-id="dd170-123">In other words, even though ten variations of a pushbutton may all work the same way and perform the same function, they must all be treated as unique controls.</span></span> <span data-ttu-id="dd170-124">これらのコントロールが機能的に同等であることを知る方法はありません。</span><span class="sxs-lookup"><span data-stu-id="dd170-124">There is no way to know that these controls are functionally equivalent.</span></span> <span data-ttu-id="dd170-125">コントロール パターンは、こうした共通のコントロール動作を表すために開発されました。</span><span class="sxs-lookup"><span data-stu-id="dd170-125">Control patterns were developed to represent these common control behaviors.</span></span> <span data-ttu-id="dd170-126">詳細については、「 [UI Automation Control Patterns Overview](ui-automation-control-patterns-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-126">For more information, see [UI Automation Control Patterns Overview](ui-automation-control-patterns-overview.md).</span></span>  
  
### <a name="implementing-ui-automation"></a><span data-ttu-id="dd170-127">UI オートメーションの実装</span><span class="sxs-lookup"><span data-stu-id="dd170-127">Implementing UI Automation</span></span>  
 <span data-ttu-id="dd170-128">既に述べたように、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]の統一されたモデルを使用しない場合、フレームワーク内のコントロールのプロパティや動作を公開するためには、フレームワーク固有の情報をテスト ツールや開発者が知る必要があります。</span><span class="sxs-lookup"><span data-stu-id="dd170-128">As mentioned earlier, without the unified model provided by [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], test tools and developers are required to know framework-specific information in order to expose properties and behaviors of controls in that framework.</span></span> <span data-ttu-id="dd170-129">Win32、[!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]、Windows Presentation Foundation (WPF) など、Windows オペレーティングシステム内では、1回に複数の UI フレームワークが存在する可能性があるため、似たようなコントロールを持つ複数のアプリケーションをテストするのは困難な作業になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="dd170-129">Since there can be several different UI frameworks present at any single time within Windows operating systems, including Win32, [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)], and Windows Presentation Foundation (WPF), it can be a daunting task to test multiple applications with controls that seem similar.</span></span> <span data-ttu-id="dd170-130">次の表では、例として、あるボタン コントロールに関連付けられた名前 (またはテキスト) を取得するために必要なフレームワーク固有のプロパティ名と、それと同等の単一 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] プロパティを示します。</span><span class="sxs-lookup"><span data-stu-id="dd170-130">For example, the following table outlines the framework-specific property names required to retrieve the name (or text) associated with a button control and shows the single equivalent [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property.</span></span>  
  
|<span data-ttu-id="dd170-131">UI オートメーション コントロール型</span><span class="sxs-lookup"><span data-stu-id="dd170-131">UI Automation Control Type</span></span>|<span data-ttu-id="dd170-132">UI フレームワーク</span><span class="sxs-lookup"><span data-stu-id="dd170-132">UI Framework</span></span>|<span data-ttu-id="dd170-133">フレームワーク固有のプロパティ</span><span class="sxs-lookup"><span data-stu-id="dd170-133">Framework Specific Property</span></span>|<span data-ttu-id="dd170-134">UI Automation のプロパティ</span><span class="sxs-lookup"><span data-stu-id="dd170-134">UI Automation Property</span></span>|  
|--------------------------------|------------------|---------------------------------|----------------------------|  
|<span data-ttu-id="dd170-135">Button</span><span class="sxs-lookup"><span data-stu-id="dd170-135">Button</span></span>|<span data-ttu-id="dd170-136">Windows Presentation Foundation</span><span class="sxs-lookup"><span data-stu-id="dd170-136">Windows Presentation Foundation</span></span>|<span data-ttu-id="dd170-137">Content</span><span class="sxs-lookup"><span data-stu-id="dd170-137">Content</span></span>|<span data-ttu-id="dd170-138">NameProperty</span><span class="sxs-lookup"><span data-stu-id="dd170-138">NameProperty</span></span>|  
|<span data-ttu-id="dd170-139">Button</span><span class="sxs-lookup"><span data-stu-id="dd170-139">Button</span></span>|<span data-ttu-id="dd170-140">Win32</span><span class="sxs-lookup"><span data-stu-id="dd170-140">Win32</span></span>|<span data-ttu-id="dd170-141">[キャプション]</span><span class="sxs-lookup"><span data-stu-id="dd170-141">Caption</span></span>|<span data-ttu-id="dd170-142">NameProperty</span><span class="sxs-lookup"><span data-stu-id="dd170-142">NameProperty</span></span>|  
|<span data-ttu-id="dd170-143">イメージ</span><span class="sxs-lookup"><span data-stu-id="dd170-143">Image</span></span>|<span data-ttu-id="dd170-144">HTML</span><span class="sxs-lookup"><span data-stu-id="dd170-144">HTML</span></span>|<span data-ttu-id="dd170-145">alt</span><span class="sxs-lookup"><span data-stu-id="dd170-145">alt</span></span>|<span data-ttu-id="dd170-146">NameProperty</span><span class="sxs-lookup"><span data-stu-id="dd170-146">NameProperty</span></span>|  
  
 <span data-ttu-id="dd170-147">UI オートメーション プロバイダーは、そのコントロールのフレームワーク固有のプロパティから、同等の [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] プロパティへのマッピングを行います。</span><span class="sxs-lookup"><span data-stu-id="dd170-147">UI Automation providers are responsible for mapping the framework-specific properties of their controls to the equivalent [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties.</span></span>  
  
 <span data-ttu-id="dd170-148">プロバイダーでの [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] の実装については、「[マネージコードの UI オートメーションプロバイダー](ui-automation-providers-for-managed-code.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-148">Information on implementing [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] in a provider can be found at [UI Automation Providers for Managed Code](ui-automation-providers-for-managed-code.md).</span></span> <span data-ttu-id="dd170-149">コントロール パターンを実装する方法については、「 [UI Automation Control Patterns](ui-automation-control-patterns.md) 」および「 [UI Automation Text Pattern](ui-automation-text-pattern.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-149">Information on implementing control patterns is available at [UI Automation Control Patterns](ui-automation-control-patterns.md) and [UI Automation Text Pattern](ui-automation-text-pattern.md).</span></span>  
  
## <a name="ui-automation-in-a-client"></a><span data-ttu-id="dd170-150">クライアントにおける UI オートメーション</span><span class="sxs-lookup"><span data-stu-id="dd170-150">UI Automation in a Client</span></span>  
 <span data-ttu-id="dd170-151">多くの自動テスト ツールやシナリオの目的は、一貫性があって再現可能なユーザー インターフェイス操作です。</span><span class="sxs-lookup"><span data-stu-id="dd170-151">The goal of many automated test tools and scenarios is the consistent and repeatable manipulation of the user interface.</span></span> <span data-ttu-id="dd170-152">これには、特定のコントロールの単体テストから、コントロールのグループに対する一連の一般的なアクションを反復処理するテスト スクリプトの記録と再生までが含まれます。</span><span class="sxs-lookup"><span data-stu-id="dd170-152">This can involve unit testing specific controls through to the recording and playback of test scripts that iterate through a series of generic actions on a group of controls.</span></span>  
  
 <span data-ttu-id="dd170-153">自動アプリケーションでの問題は、動的な対象にテストを合わせることが難しい点です。</span><span class="sxs-lookup"><span data-stu-id="dd170-153">A complication that arises from automated applications is the difficulty synchronizing a test with a dynamic target.</span></span> <span data-ttu-id="dd170-154">たとえば、Windows タスク マネージャーに含まれているような、現在実行中のアプリケーションを一覧表示するリスト ボックス コントロールがあります。</span><span class="sxs-lookup"><span data-stu-id="dd170-154">For example, a list box control, such as one contained in the Windows Task Manager, that displays a list of currently running applications.</span></span> <span data-ttu-id="dd170-155">リスト ボックス内の項目はテスト アプリケーションの制御範囲外で動的に更新されるため、リスト ボックスの特定の項目を一貫性を保って繰り返し選択することは不可能です。</span><span class="sxs-lookup"><span data-stu-id="dd170-155">Since the items in the list box are dynamically updated outside the control of the test application, attempting to repeat the selection of a specific item in the list box with any consistency is impossible.</span></span> <span data-ttu-id="dd170-156">テスト アプリケーションの制御範囲外の [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] でフォーカスの単純な変更を繰り返そうとした場合も、同様の問題が起きることがあります。</span><span class="sxs-lookup"><span data-stu-id="dd170-156">Similar issues can also arise when attempting to repeat simple focus changes in a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] that is outside the control of the test application.</span></span>  
  
### <a name="programmatic-access"></a><span data-ttu-id="dd170-157">プログラムによるアクセス</span><span class="sxs-lookup"><span data-stu-id="dd170-157">Programmatic Access</span></span>  
 <span data-ttu-id="dd170-158">プログラムによるアクセスでは、従来のマウス入力やキーボード入力によって公開される対話やエクスペリエンスをコードによって模倣する機能が提供されます。</span><span class="sxs-lookup"><span data-stu-id="dd170-158">Programmatic access provides the ability to imitate, through code, any interaction and experience exposed by traditional mouse and keyboard input.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="dd170-159">は、5 つのコンポーネントにより、プログラムによるアクセスを有効にします。</span><span class="sxs-lookup"><span data-stu-id="dd170-159">enables programmatic access through five components:</span></span>  
  
- <span data-ttu-id="dd170-160">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ツリーは、 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]の構造全体にわたってナビゲーションを容易にします。</span><span class="sxs-lookup"><span data-stu-id="dd170-160">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree facilitates navigation through the structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="dd170-161">ツリーは、hWnd のコレクションから構築されます。</span><span class="sxs-lookup"><span data-stu-id="dd170-161">The tree is built from the collection of hWnd's.</span></span> <span data-ttu-id="dd170-162">詳細については、「 [UI Automation Tree Overview](ui-automation-tree-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-162">For more information, see [UI Automation Tree Overview](ui-automation-tree-overview.md)</span></span>  
  
- <span data-ttu-id="dd170-163">オートメーション要素は、 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]の個々のコンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="dd170-163">Automation elements are individual components in the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="dd170-164">通常、これらは hWnd よりも細かい単位です。</span><span class="sxs-lookup"><span data-stu-id="dd170-164">These can often be more granular than an hWnd.</span></span> <span data-ttu-id="dd170-165">詳細については、「 [UI Automation Control Types Overview](ui-automation-control-types-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-165">For more information, see [UI Automation Control Types Overview](ui-automation-control-types-overview.md).</span></span>  
  
- <span data-ttu-id="dd170-166">オートメーション プロパティは、 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 要素に関する具体的な情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="dd170-166">Automation properties provide specific information about [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements.</span></span> <span data-ttu-id="dd170-167">詳細については、「 [UI Automation Properties Overview](ui-automation-properties-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-167">For more information, see [UI Automation Properties Overview](ui-automation-properties-overview.md).</span></span>  
  
- <span data-ttu-id="dd170-168">コントロール パターンは、コントロールが持つ機能の特定の側面を定義します。プロパティ、メソッド、イベント、および構造体の情報で構成することができます。</span><span class="sxs-lookup"><span data-stu-id="dd170-168">Control patterns define a particular aspect of a control's functionality; they can consist of property, method, event, and structure information.</span></span> <span data-ttu-id="dd170-169">詳細については、「 [UI Automation Control Patterns Overview](ui-automation-control-patterns-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-169">For more information, see [UI Automation Control Patterns Overview](ui-automation-control-patterns-overview.md).</span></span>  
  
- <span data-ttu-id="dd170-170">オートメーション イベントは、イベント通知と情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="dd170-170">Automation events provide event notifications and information.</span></span> <span data-ttu-id="dd170-171">詳細については、「 [UI Automation Events Overview](ui-automation-events-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-171">For more information, see [UI Automation Events Overview](ui-automation-events-overview.md).</span></span>  
  
### <a name="key-properties-for-test-automation"></a><span data-ttu-id="dd170-172">自動テストの主要なプロパティ</span><span class="sxs-lookup"><span data-stu-id="dd170-172">Key Properties for Test Automation</span></span>  
 <span data-ttu-id="dd170-173">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 内の任意のコントロールを一意に識別して検索する機能は、自動テスト アプリケーションがその [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]を処理する基盤です。</span><span class="sxs-lookup"><span data-stu-id="dd170-173">The ability to uniquely identify and subsequently locate any control within the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] provides the basis for automated test applications to operate on that [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="dd170-174">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] プロパティの中にはこれを支援するものがいくつかあり、クライアントとプロバイダーによって使用されます。</span><span class="sxs-lookup"><span data-stu-id="dd170-174">There are several [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] properties used by clients and providers that assist in this.</span></span>  
  
#### <a name="automationid"></a><span data-ttu-id="dd170-175">AutomationID</span><span class="sxs-lookup"><span data-stu-id="dd170-175">AutomationID</span></span>  
 <span data-ttu-id="dd170-176">オートメーション要素をその兄弟から一意に識別します。</span><span class="sxs-lookup"><span data-stu-id="dd170-176">Uniquely identifies an automation element from its siblings.</span></span> <span data-ttu-id="dd170-177">製品が複数言語で出荷される場合に通常ローカライズされる<xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> などのプロパティとは異なり、 <xref:System.Windows.Automation.AutomationElement.NameProperty> はローカライズされません。</span><span class="sxs-lookup"><span data-stu-id="dd170-177"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> is not localized, unlike a property such as <xref:System.Windows.Automation.AutomationElement.NameProperty> that is typically localized if a product gets shipped in multiple languages.</span></span> <span data-ttu-id="dd170-178">「 [Use the AutomationID Property](use-the-automationid-property.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-178">See [Use the AutomationID Property](use-the-automationid-property.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="dd170-179"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> では、オートメーション ツリー全体にわたって一意に識別できるとは限りません。</span><span class="sxs-lookup"><span data-stu-id="dd170-179"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> does not guarantee a unique identity throughout the automation tree.</span></span> <span data-ttu-id="dd170-180">たとえば、アプリケーションには複数のトップレベルのメニュー項目を持つメニュー コントロールが含まれ、さらに、それらのメニュー項目に複数の子メニュー項目が含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="dd170-180">For example, an application may contain a menu control with multiple top-level menu items that, in turn, have multiple child menu items.</span></span> <span data-ttu-id="dd170-181">これらの 2 次メニュー項目は、Item1、Item2、Item3 などの汎用スキームで識別され、トップレベルのメニュー項目間で子の識別子が重複することがあります。</span><span class="sxs-lookup"><span data-stu-id="dd170-181">These secondary menu items may be identified by a generic scheme such as "Item1, Item 2, Item3, etc.", allowing duplicate identifiers for children across top-level menu items.</span></span>  
  
#### <a name="controltype"></a><span data-ttu-id="dd170-182">ControlType</span><span class="sxs-lookup"><span data-stu-id="dd170-182">ControlType</span></span>  
 <span data-ttu-id="dd170-183">オートメーション要素によって表されるコントロール型を識別します。</span><span class="sxs-lookup"><span data-stu-id="dd170-183">Identifies the type of control represented by an automation element.</span></span> <span data-ttu-id="dd170-184">コントロール型がわかると、そこから多くの情報を推測できます。</span><span class="sxs-lookup"><span data-stu-id="dd170-184">Significant information can be inferred from knowledge of the control type.</span></span> <span data-ttu-id="dd170-185">「 [UI Automation Control Types Overview](ui-automation-control-types-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-185">See [UI Automation Control Types Overview](ui-automation-control-types-overview.md).</span></span>  
  
#### <a name="nameproperty"></a><span data-ttu-id="dd170-186">NameProperty</span><span class="sxs-lookup"><span data-stu-id="dd170-186">NameProperty</span></span>  
 <span data-ttu-id="dd170-187">これは、コントロールを識別または説明するテキスト文字列です。</span><span class="sxs-lookup"><span data-stu-id="dd170-187">This is a text string that identifies or explains a control.</span></span> <span data-ttu-id="dd170-188"><xref:System.Windows.Automation.AutomationElement.NameProperty> はローカライズされる可能性があるため、注意して使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dd170-188"><xref:System.Windows.Automation.AutomationElement.NameProperty> should be used with caution since it can be localized.</span></span> <span data-ttu-id="dd170-189">「 [UI Automation Properties Overview](ui-automation-properties-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-189">See [UI Automation Properties Overview](ui-automation-properties-overview.md).</span></span>  
  
### <a name="implementing-ui-automation-in-a-test-application"></a><span data-ttu-id="dd170-190">テスト アプリケーションへの UI オートメーションの実装</span><span class="sxs-lookup"><span data-stu-id="dd170-190">Implementing UI Automation in a Test Application</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="dd170-191">UI オートメーション参照を追加します。</span><span class="sxs-lookup"><span data-stu-id="dd170-191">Add the UI Automation References.</span></span>|<span data-ttu-id="dd170-192">UI オートメーション クライアントに必要な [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] の dll を次に示します。</span><span class="sxs-lookup"><span data-stu-id="dd170-192">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] dll's necessary for UI Automation clients are listed here.</span></span><br /><br /> <span data-ttu-id="dd170-193">-Uiautomationclient.dll は、[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] のクライアント側 Api にアクセスできるようにします。</span><span class="sxs-lookup"><span data-stu-id="dd170-193">-   UIAutomationClient.dll provides access to the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] client-side APIs.</span></span><br /><span data-ttu-id="dd170-194">-UIAutomationClientSideProvider は、Win32 コントロールを自動化する機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="dd170-194">-   UIAutomationClientSideProvider.dll provides the ability to automate Win32 controls.</span></span> <span data-ttu-id="dd170-195">「 [UI Automation Support for Standard Controls](ui-automation-support-for-standard-controls.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-195">See [UI Automation Support for Standard Controls](ui-automation-support-for-standard-controls.md).</span></span><br /><span data-ttu-id="dd170-196">-Uiautomationtypes.dll は、[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]で定義されている特定の型へのアクセスを提供します。</span><span class="sxs-lookup"><span data-stu-id="dd170-196">-   UIAutomationTypes.dll provides access to the specific types defined in [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>|  
|<span data-ttu-id="dd170-197"><xref:System.Windows.Automation> 名前空間を追加します。</span><span class="sxs-lookup"><span data-stu-id="dd170-197">Add the <xref:System.Windows.Automation> namespace.</span></span>|<span data-ttu-id="dd170-198">この名前空間には、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] のテキスト処理以外の機能を使用するために UI オートメーション クライアントが必要とするすべてのものが含まれています。</span><span class="sxs-lookup"><span data-stu-id="dd170-198">This namespace contains everything UI Automation clients need to use the capabilities of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] except text handling.</span></span>|  
|<span data-ttu-id="dd170-199"><xref:System.Windows.Automation.Text> 名前空間を追加します。</span><span class="sxs-lookup"><span data-stu-id="dd170-199">Add the <xref:System.Windows.Automation.Text> namespace.</span></span>|<span data-ttu-id="dd170-200">この名前空間には、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] のテキスト処理機能を使用するために UI オートメーション クライアントが必要とするすべてのものが含まれています。</span><span class="sxs-lookup"><span data-stu-id="dd170-200">This namespace contains everything a UI Automation clients need to use the capabilities of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text handling.</span></span>|  
|<span data-ttu-id="dd170-201">目的のコントロールを検索します。</span><span class="sxs-lookup"><span data-stu-id="dd170-201">Find controls of interest</span></span>|<span data-ttu-id="dd170-202">自動テスト スクリプトは、目的のコントロールを表す UI オートメーション要素をオートメーション ツリー内で検索します。</span><span class="sxs-lookup"><span data-stu-id="dd170-202">Automated test scripts locate UI Automation elements that represent controls of interest within the automation tree.</span></span><br /><br /> <span data-ttu-id="dd170-203">コードで UI オートメーション要素を取得する方法は複数あります。</span><span class="sxs-lookup"><span data-stu-id="dd170-203">There are multiple ways to obtain UI Automation elements with code.</span></span><br /><br /> <span data-ttu-id="dd170-204">-<xref:System.Windows.Automation.Condition> ステートメントを使用して、[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] に対してクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="dd170-204">-   Query the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] using a <xref:System.Windows.Automation.Condition> statement.</span></span> <span data-ttu-id="dd170-205">この場合は、通常、言語に依存しない <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> を使用します。</span><span class="sxs-lookup"><span data-stu-id="dd170-205">This is typically where the language-neutral <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> is used.</span></span> <span data-ttu-id="dd170-206">**注:** <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> を取得するには、コントロールの [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] プロパティを設定できる、sn.exe などのツールを使用します。</span><span class="sxs-lookup"><span data-stu-id="dd170-206">**Note:**  An <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> can be obtained using a tool such as Inspect.exe that is able to itemize the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties of a control.</span></span> <br /><br /> <span data-ttu-id="dd170-207">-<xref:System.Windows.Automation.TreeWalker> クラスを使用して、[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ツリー全体またはそのサブセットを走査します。</span><span class="sxs-lookup"><span data-stu-id="dd170-207">-   Use the <xref:System.Windows.Automation.TreeWalker> class to traverse the entire [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree or a subset thereof.</span></span><br /><span data-ttu-id="dd170-208">-フォーカスを追跡します。</span><span class="sxs-lookup"><span data-stu-id="dd170-208">-   Track focus.</span></span><br /><span data-ttu-id="dd170-209">-コントロールの hWnd を使用します。</span><span class="sxs-lookup"><span data-stu-id="dd170-209">-   Use the hWnd of the control.</span></span><br /><span data-ttu-id="dd170-210">-マウスカーソルの位置など、画面の場所を使用します。</span><span class="sxs-lookup"><span data-stu-id="dd170-210">-   Use screen location, such as the location of the mouse cursor.</span></span><br /><br /> <span data-ttu-id="dd170-211">「 [Obtaining UI Automation Elements](obtaining-ui-automation-elements.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-211">See [Obtaining UI Automation Elements](obtaining-ui-automation-elements.md)</span></span>|  
|<span data-ttu-id="dd170-212">コントロール パターンを取得します。</span><span class="sxs-lookup"><span data-stu-id="dd170-212">Obtain Control Patterns</span></span>|<span data-ttu-id="dd170-213">コントロール パターンは、機能的によく似た複数のコントロールにおける共通の動作を公開します。</span><span class="sxs-lookup"><span data-stu-id="dd170-213">Control patterns expose common behaviors for functionally similar controls.</span></span><br /><br /> <span data-ttu-id="dd170-214">自動テスト スクリプトは、テストする必要があるコントロールを特定すると、それらの UI オートメーション要素から目的のコントロール パターンを取得します。</span><span class="sxs-lookup"><span data-stu-id="dd170-214">After locating the controls that require testing, automated test scripts obtain the control patterns of interest from those UI Automation elements.</span></span> <span data-ttu-id="dd170-215">たとえば、一般的なボタン機能には <xref:System.Windows.Automation.InvokePattern> コントロール パターンを、ウィンドウ機能には <xref:System.Windows.Automation.WindowPattern> コントロール パターンを使用します。</span><span class="sxs-lookup"><span data-stu-id="dd170-215">For example, the <xref:System.Windows.Automation.InvokePattern> control pattern for typical button functionality or the <xref:System.Windows.Automation.WindowPattern> control pattern for window functionality.</span></span><br /><br /> <span data-ttu-id="dd170-216">「 [UI Automation Control Patterns Overview](ui-automation-control-patterns-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-216">See [UI Automation Control Patterns Overview](ui-automation-control-patterns-overview.md).</span></span>|  
|<span data-ttu-id="dd170-217">UI を自動化します。</span><span class="sxs-lookup"><span data-stu-id="dd170-217">Automate the UI</span></span>|<span data-ttu-id="dd170-218">自動テスト スクリプトで、 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] フレームワークの任意の [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] を、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] コントロール パターンによって公開された情報や機能を使用して制御できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="dd170-218">Automated test scripts can now control any [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] of interest from a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] framework using the information and functionality exposed by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] control patterns.</span></span>|  
  
## <a name="related-tools-and-technologies"></a><span data-ttu-id="dd170-219">関連ツールと関連技術</span><span class="sxs-lookup"><span data-stu-id="dd170-219">Related Tools and Technologies</span></span>  
 <span data-ttu-id="dd170-220">複数の関連ツールや関連技術で、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]を使用した自動テストがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="dd170-220">There are a number of related tools and technologies that support automated testing with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  
  
- <span data-ttu-id="dd170-221">Setup.exe はグラフィカルユーザーインターフェイス (GUI) アプリケーションであり、プロバイダーとクライアントの両方の開発とデバッグのために [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 情報を収集するために使用できます。</span><span class="sxs-lookup"><span data-stu-id="dd170-221">Inspect.exe is a graphical user interface (GUI) application that can be used to gather [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] information for both provider and client development and debugging.</span></span> <span data-ttu-id="dd170-222">Windows SDK には、setup.exe が含まれています。</span><span class="sxs-lookup"><span data-stu-id="dd170-222">Inspect.exe is included in the Windows SDK.</span></span>  
  
- <span data-ttu-id="dd170-223">MSAABridge は Active Accessibility クライアントに [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 情報を公開します。</span><span class="sxs-lookup"><span data-stu-id="dd170-223">MSAABridge exposes [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] information to Active Accessibility clients.</span></span> <span data-ttu-id="dd170-224">Active Accessibility に [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] をブリッジングする主な目的は、既存の Active Accessibility クライアントが [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]を実装した任意のフレームワークと対話できるようにすることです。</span><span class="sxs-lookup"><span data-stu-id="dd170-224">The primary goal of bridging [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] to Active Accessibility is to allow existing Active Accessibility clients the ability to interact with any framework that has implemented [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  
  
## <a name="security"></a><span data-ttu-id="dd170-225">セキュリティ</span><span class="sxs-lookup"><span data-stu-id="dd170-225">Security</span></span>  
 <span data-ttu-id="dd170-226">セキュリティについては、「 [UI Automation Security Overview](ui-automation-security-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dd170-226">For security information, see [UI Automation Security Overview](ui-automation-security-overview.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dd170-227">関連項目</span><span class="sxs-lookup"><span data-stu-id="dd170-227">See also</span></span>

- [<span data-ttu-id="dd170-228">UI オートメーションの基礎</span><span class="sxs-lookup"><span data-stu-id="dd170-228">UI Automation Fundamentals</span></span>](index.md)
