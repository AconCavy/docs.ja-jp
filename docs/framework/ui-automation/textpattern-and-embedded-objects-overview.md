---
title: TextPattern および埋め込みオブジェクトの概要
description: TextPattern と Textpattern 範囲を使用して、UI オートメーションがテキストドキュメントまたはコンテナー内の埋め込みオブジェクト (子要素) を公開する方法の概要について説明します。
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, TextPattern class
- embedded objects, accessing
- accessing embedded objects
- embedded objects, UI Automation
ms.assetid: 93fdfbb9-0025-4b72-8ca0-0714adbb70d5
ms.openlocfilehash: 9d348b130ef26dfd27b27ecd93755919615afb68
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/26/2020
ms.locfileid: "96252466"
---
# <a name="textpattern-and-embedded-objects-overview"></a><span data-ttu-id="bf1c2-103">TextPattern および埋め込みオブジェクトの概要</span><span class="sxs-lookup"><span data-stu-id="bf1c2-103">TextPattern and Embedded Objects Overview</span></span>

> [!NOTE]
> <span data-ttu-id="bf1c2-104">このドキュメントは、[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 名前空間で定義されているマネージド <xref:System.Windows.Automation> クラスを使用する .NET Framework 開発者を対象としています。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-104">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="bf1c2-105">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]の最新情報については、「 [Windows Automation API: UI オートメーション](/windows/win32/winauto/entry-uiauto-win32)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-105">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>  
  
 <span data-ttu-id="bf1c2-106">この概要では、 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] がテキスト ドキュメントまたはコンテナー内で埋め込みオブジェクトや子要素を公開する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-106">This overview describes how [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] exposes embedded objects, or child elements, within a text document or container.</span></span>  
  
 <span data-ttu-id="bf1c2-107">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]埋め込みオブジェクトは、テキスト以外の境界を持つ任意の要素です。たとえば、イメージ、ハイパーリンク、テーブル、ドキュメントの種類 (Microsoft Excel スプレッドシートや Microsoft Windows Media ファイルなど) です。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-107">In [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] an embedded object is any element that has non-textual boundaries; for example, an image, hyperlink, table, or document type such as an Microsoft Excel spreadsheet or Microsoft Windows Media file.</span></span> <span data-ttu-id="bf1c2-108">これは、あるアプリケーションで要素が作成され、別のアプリケーション内に埋め込まれる (リンクされる) 標準的な定義とは異なります。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-108">This differs from the standard definition, where an element is created in one application and embedded, or linked, within another.</span></span> <span data-ttu-id="bf1c2-109">オブジェクトを元のアプリケーション内で編集できるかどうかは、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]の状況とは無関係です。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-109">Whether the object can be edited within its original application is irrelevant in the context of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  
  
<a name="Embedded_Objects_and_the_UI_Automation_Tree"></a>

## <a name="embedded-objects-and-the-ui-automation-tree"></a><span data-ttu-id="bf1c2-110">埋め込みオブジェクトと UI オートメーション ツリー</span><span class="sxs-lookup"><span data-stu-id="bf1c2-110">Embedded Objects and the UI Automation Tree</span></span>  

 <span data-ttu-id="bf1c2-111">埋め込みオブジェクトは、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ツリーのコントロール ビュー内では個々の要素として扱われます。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-111">Embedded objects are treated as individual elements within the control view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="bf1c2-112">これらはテキスト コンテナーの子として公開され、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]の他のコントロールと同じモデルを介してアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-112">They are exposed as children of the text container so that they can be accessed through the same model as other controls in [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  
  
 <span data-ttu-id="bf1c2-113">![テキスト コンテナー内にイメージを含む埋め込みテーブル](./media/uia-textpattern-embedded-objects-overview-example1.png "UIA_TextPattern_Embedded_Objects_Overview_Example1")</span><span class="sxs-lookup"><span data-stu-id="bf1c2-113">![Embedded Table with Image in a Text Container](./media/uia-textpattern-embedded-objects-overview-example1.png "UIA_TextPattern_Embedded_Objects_Overview_Example1")</span></span>  
<span data-ttu-id="bf1c2-114">テーブル、イメージ、ハイパーリンクの埋め込みオブジェクトを含むテキスト コンテナーの例</span><span class="sxs-lookup"><span data-stu-id="bf1c2-114">Example of a Text Container with Table, Image, and Hyperlink Embedded Objects</span></span>  
  
 <span data-ttu-id="bf1c2-115">![前の例の内容ビュー](./media/uia-textpattern-embedded-objects-overview-example2.PNG "UIA_TextPattern_Embedded_Objects_Overview_Example2")</span><span class="sxs-lookup"><span data-stu-id="bf1c2-115">![Content view for the preceding example](./media/uia-textpattern-embedded-objects-overview-example2.PNG "UIA_TextPattern_Embedded_Objects_Overview_Example2")</span></span>  
<span data-ttu-id="bf1c2-116">前のテキスト コンテナーの一部のコンテンツ ビューの例</span><span class="sxs-lookup"><span data-stu-id="bf1c2-116">Example of the Content View for a Portion of the Preceding Text Container</span></span>  
  
<a name="Expose_Embedded_Objects_Using_TextPattern_and"></a>

## <a name="expose-embedded-objects-using-textpattern-and-textpatternrange"></a><span data-ttu-id="bf1c2-117">TextPattern と TextPatternRange を使用した埋め込みオブジェクトの公開</span><span class="sxs-lookup"><span data-stu-id="bf1c2-117">Expose Embedded Objects Using TextPattern and TextPatternRange</span></span>  

 <span data-ttu-id="bf1c2-118"><xref:System.Windows.Automation.TextPattern> コントロール パターン クラスと <xref:System.Windows.Automation.Text.TextPatternRange> クラスを組み合わせて使用すると、埋め込みオブジェクトのナビゲーションと照会を容易にするメソッドとプロパティが公開されます。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-118">Used in conjunction, the <xref:System.Windows.Automation.TextPattern> control pattern class and the <xref:System.Windows.Automation.Text.TextPatternRange> class expose methods and properties that facilitate navigation and querying of embedded objects.</span></span>  
  
 <span data-ttu-id="bf1c2-119">テキスト コンテナーのテキスト コンテンツ (内部テキスト) と埋め込みオブジェクト (ハイパーリンクやテーブルのセルなど) は、連続する単一のテキスト ストリームとして、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ツリーのコントロール ビューとコンテンツ ビューの両方で公開されます。そのため、オブジェクトの境界は無視されます。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-119">The textual content (or inner text) of a text container and an embedded object, such as a hyperlink or table cell, is exposed as a single, continuous text stream in both the control view and the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree; object boundaries are ignored.</span></span> <span data-ttu-id="bf1c2-120">UI オートメーション クライアントがなんらかの方法で列挙、解釈、分析を目的としてテキストを取得している場合、テキスト コンテンツを含むテーブルやその他の埋め込みオブジェクトなど、特殊なケースについて、テキスト範囲を確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-120">If a UI Automation client is retrieving the text for the purpose of reciting, interpreting, or analyzing in some manner, the text range should be checked for special cases, such as a table with textual content or other embedded objects.</span></span> <span data-ttu-id="bf1c2-121">これを行うには、 <xref:System.Windows.Automation.Text.TextPatternRange.GetChildren%2A> を呼び出して各埋め込みオブジェクトの <xref:System.Windows.Automation.AutomationElement> を取得した後、 <xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> を呼び出して各要素のテキスト範囲を取得します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-121">This can be accomplished by calling <xref:System.Windows.Automation.Text.TextPatternRange.GetChildren%2A> to obtain an <xref:System.Windows.Automation.AutomationElement> for each embedded object and then calling <xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> to obtain a text range for each element.</span></span> <span data-ttu-id="bf1c2-122">この操作は、すべてのテキスト コンテンツが取得されるまで再帰的に行われます。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-122">This is done recursively until all textual content has been retrieved.</span></span>  
  
 <span data-ttu-id="bf1c2-123">![埋め込みオブジェクトにまたがるテキスト範囲。](./media/uia-textpattern-embeddedobjecttextranges.png "UIA_TextPattern_EmbeddedObjectTextRanges")</span><span class="sxs-lookup"><span data-stu-id="bf1c2-123">![Text ranges spanned by embedded objects.](./media/uia-textpattern-embeddedobjecttextranges.png "UIA_TextPattern_EmbeddedObjectTextRanges")</span></span>  
<span data-ttu-id="bf1c2-124">埋め込みオブジェクトとその範囲を含むテキスト ストリームの例</span><span class="sxs-lookup"><span data-stu-id="bf1c2-124">Example of a text stream with embedded objects and their range spans</span></span>  
  
 <span data-ttu-id="bf1c2-125">テキスト範囲の内容を走査する必要がある場合、 <xref:System.Windows.Automation.Text.TextPatternRange.Move%2A> メソッドを正常に実行するために、一連の手順がその背後で関係しています。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-125">When it is necessary to traverse the content of a text range, a series of steps are involved behind the scenes in order for the <xref:System.Windows.Automation.Text.TextPatternRange.Move%2A> method to execute successfully.</span></span>  
  
1. <span data-ttu-id="bf1c2-126">テキスト範囲は正規化されます。つまり、テキスト範囲は <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> エンドポイントで低次元テキスト範囲に縮小されるため、 <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> エンドポイントは不要になります。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-126">The text range is normalized; that is, the text range is collapsed to a degenerate range at the <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> endpoint, which makes the <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> endpoint superfluous.</span></span> <span data-ttu-id="bf1c2-127">この手順は、テキスト範囲が複数の境界にまたがる状況であいまいさを解消するために必要です。 <xref:System.Windows.Automation.Text.TextUnit> たとえば、 `{The URL https://www.microsoft.com is embedded in text` "{" と "}" がテキスト範囲エンドポイントである場合です。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-127">This step is necessary to remove ambiguity in situations where a text range spans <xref:System.Windows.Automation.Text.TextUnit> boundaries: for example, `{The URL https://www.microsoft.com is embedded in text` where "{" and "}" are the text range endpoints.</span></span>  
  
2. <span data-ttu-id="bf1c2-128">結果として得られる範囲は、 <xref:System.Windows.Automation.TextPattern.DocumentRange%2A> 内で、要求された <xref:System.Windows.Automation.Text.TextUnit> 境界の先頭に向かって後方に移動されます。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-128">The resulting range is moved backward in the <xref:System.Windows.Automation.TextPattern.DocumentRange%2A> to the beginning of the requested <xref:System.Windows.Automation.Text.TextUnit> boundary.</span></span>  
  
3. <span data-ttu-id="bf1c2-129">この範囲は、 <xref:System.Windows.Automation.TextPattern.DocumentRange%2A> 内で、 <xref:System.Windows.Automation.Text.TextUnit> 境界の要求された数だけ、前方または後方に移動されます。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-129">The range is moved forward or backward in the <xref:System.Windows.Automation.TextPattern.DocumentRange%2A> by the requested number of <xref:System.Windows.Automation.Text.TextUnit> boundaries.</span></span>  
  
4. <span data-ttu-id="bf1c2-130">その後、この範囲は、要求された 1 つの <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> 境界の分、 <xref:System.Windows.Automation.Text.TextUnit> エンドポイントを移動することによって、低次元テキスト範囲の状態から展開されます。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-130">The range is then expanded from a degenerate range state by moving the <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> endpoint by one requested <xref:System.Windows.Automation.Text.TextUnit> boundary.</span></span>  
  
 <span data-ttu-id="bf1c2-131">![移動 & ExpandToEnclosingUnit による範囲の調整](./media/uia-textpattern-moveandexpand-examples.png "UIA_TextPattern_MoveAndExpand_Examples")</span><span class="sxs-lookup"><span data-stu-id="bf1c2-131">![Range adjustments by Move & ExpandToEnclosingUnit](./media/uia-textpattern-moveandexpand-examples.png "UIA_TextPattern_MoveAndExpand_Examples")</span></span>  
<span data-ttu-id="bf1c2-132">テキスト範囲を Move() と ExpandToEnclosingUnit() に対して調整する方法の例</span><span class="sxs-lookup"><span data-stu-id="bf1c2-132">Examples of how a text range is adjusted for Move() and ExpandToEnclosingUnit()</span></span>  
  
<a name="Common_Scenarios"></a>

## <a name="common-scenarios"></a><span data-ttu-id="bf1c2-133">一般的なシナリオ</span><span class="sxs-lookup"><span data-stu-id="bf1c2-133">Common Scenarios</span></span>  

 <span data-ttu-id="bf1c2-134">以下のセクションでは、埋め込みオブジェクトが関連する最も一般的なシナリオの例を紹介します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-134">The following sections present examples of the most common scenarios that involve embedded objects.</span></span>  
  
 <span data-ttu-id="bf1c2-135">この例で使用される凡例は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-135">Legend for the examples shown:</span></span>  
  
 <span data-ttu-id="bf1c2-136">{ = <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start></span><span class="sxs-lookup"><span data-stu-id="bf1c2-136">{ = <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start></span></span>  
  
 <span data-ttu-id="bf1c2-137">} = <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End></span><span class="sxs-lookup"><span data-stu-id="bf1c2-137">} = <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End></span></span>  
  
### <a name="hyperlink"></a><span data-ttu-id="bf1c2-138">ハイパーリンク</span><span class="sxs-lookup"><span data-stu-id="bf1c2-138">Hyperlink</span></span>  

<span data-ttu-id="bf1c2-139">**例 1: 埋め込みテキスト ハイパーリンクを含むテキスト範囲**</span><span class="sxs-lookup"><span data-stu-id="bf1c2-139">**Example 1 - A text range that contains an embedded text hyperlink**</span></span>
  
`{The URL https://www.microsoft.com is embedded in text}.`
  
|<span data-ttu-id="bf1c2-140">呼び出されるメソッド</span><span class="sxs-lookup"><span data-stu-id="bf1c2-140">Method called</span></span>|<span data-ttu-id="bf1c2-141">結果</span><span class="sxs-lookup"><span data-stu-id="bf1c2-141">Result</span></span>|  
|-------------------|------------|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>|<span data-ttu-id="bf1c2-142">string `The URL https://www.microsoft.com is embedded in text` が返されます。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-142">Returns the string `The URL https://www.microsoft.com is embedded in text`.</span></span>|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetEnclosingElement%2A>|<span data-ttu-id="bf1c2-143">テキスト範囲を囲む最も内側の <xref:System.Windows.Automation.AutomationElement> を返します。この場合は、テキスト プロバイダー自体を表す <xref:System.Windows.Automation.AutomationElement> を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-143">Returns the innermost <xref:System.Windows.Automation.AutomationElement> that encloses the text range; in this case, the <xref:System.Windows.Automation.AutomationElement> that represents the text provider itself.</span></span>|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetChildren%2A>|<span data-ttu-id="bf1c2-144">ハイパーリンク コントロールを表す <xref:System.Windows.Automation.AutomationElement> を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-144">Returns an <xref:System.Windows.Automation.AutomationElement> representing the hyperlink control.</span></span>|  
|<span data-ttu-id="bf1c2-145"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> ( <xref:System.Windows.Automation.AutomationElement> は、前の `GetChildren` メソッドから返されるオブジェクト)</span><span class="sxs-lookup"><span data-stu-id="bf1c2-145"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> where <xref:System.Windows.Automation.AutomationElement> is the object returned by the previous `GetChildren` method.</span></span>|<span data-ttu-id="bf1c2-146">を表す範囲を返し `https://www.microsoft.com` ます。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-146">Returns the range that represents `https://www.microsoft.com`.</span></span>|  
  
 <span data-ttu-id="bf1c2-147">**例 2: 埋め込みテキスト ハイパーリンクに部分的にかかるテキスト範囲**</span><span class="sxs-lookup"><span data-stu-id="bf1c2-147">**Example 2 - A text range that partially spans an embedded text hyperlink**</span></span>  
  
 <span data-ttu-id="bf1c2-148">URL `https://{[www]}` はテキストに埋め込まれています。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-148">The URL `https://{[www]}` is embedded in text.</span></span>  
  
|<span data-ttu-id="bf1c2-149">呼び出されるメソッド</span><span class="sxs-lookup"><span data-stu-id="bf1c2-149">Method called</span></span>|<span data-ttu-id="bf1c2-150">結果</span><span class="sxs-lookup"><span data-stu-id="bf1c2-150">Result</span></span>|  
|-------------------|------------|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>|<span data-ttu-id="bf1c2-151">文字列 "www" を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-151">Returns the string "www".</span></span>|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetEnclosingElement%2A>|<span data-ttu-id="bf1c2-152">テキスト範囲を囲む最も内側の <xref:System.Windows.Automation.AutomationElement> を返します。この場合は、ハイパーリンク コントロールです。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-152">Returns the innermost <xref:System.Windows.Automation.AutomationElement> that encloses the text range; in this case, the hyperlink control.</span></span>|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetChildren%2A>|<span data-ttu-id="bf1c2-153">テキスト範囲が URL 文字列全体をカバーしていないため、 `null` を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-153">Returns `null` since the text range doesn't span the entire URL string.</span></span>|  
  
<span data-ttu-id="bf1c2-154">**例 3: テキストコンテナーのコンテンツに部分的にまたがるテキスト範囲。テキストコンテナーには、テキスト範囲に含まれていないテキストハイパーリンクが埋め込まれています。**</span><span class="sxs-lookup"><span data-stu-id="bf1c2-154">**Example 3 - A text range that partially spans the content of a text container. The text container has an embedded text hyperlink that is not part of the text range.**</span></span>  
  
`{The URL} [https://www.microsoft.com](https://www.microsoft.com) is embedded in text.`
  
|<span data-ttu-id="bf1c2-155">呼び出されるメソッド</span><span class="sxs-lookup"><span data-stu-id="bf1c2-155">Method called</span></span>|<span data-ttu-id="bf1c2-156">結果</span><span class="sxs-lookup"><span data-stu-id="bf1c2-156">Result</span></span>|  
|-------------------|------------|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>|<span data-ttu-id="bf1c2-157">文字列 "The URL" を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-157">Returns the string "The URL".</span></span>|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetEnclosingElement%2A>|<span data-ttu-id="bf1c2-158">テキスト範囲を囲む最も内側の <xref:System.Windows.Automation.AutomationElement> を返します。この場合は、テキスト プロバイダー自体を表す <xref:System.Windows.Automation.AutomationElement> を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-158">Returns the innermost <xref:System.Windows.Automation.AutomationElement> that encloses the text range; in this case, the <xref:System.Windows.Automation.AutomationElement> that represents the text provider itself.</span></span>|  
|<span data-ttu-id="bf1c2-159"><xref:System.Windows.Automation.Text.TextPatternRange.Move%2A> (パラメーターは (TextUnit.Word, 1))</span><span class="sxs-lookup"><span data-stu-id="bf1c2-159"><xref:System.Windows.Automation.Text.TextPatternRange.Move%2A> with parameters of (TextUnit.Word, 1).</span></span>|<span data-ttu-id="bf1c2-160">ハイパーリンクのテキストは個々の単語で構成されているため、テキスト範囲は "http" に移動します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-160">Moves the text range span to "http" since the text of the hyperlink is comprised of individual words.</span></span> <span data-ttu-id="bf1c2-161">この場合、ハイパーリンクは 1 つのオブジェクトとして扱われません。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-161">In this case, the hyperlink is not treated as a single object.</span></span><br /><br /> <span data-ttu-id="bf1c2-162">URL {[http]} はテキストに埋め込まれています。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-162">The URL {[http]} is embedded in text.</span></span>|  
  
<a name="Image"></a>

### <a name="image"></a><span data-ttu-id="bf1c2-163">Image</span><span class="sxs-lookup"><span data-stu-id="bf1c2-163">Image</span></span>  

 <span data-ttu-id="bf1c2-164">**例 1: 埋め込みイメージを含むテキスト範囲**</span><span class="sxs-lookup"><span data-stu-id="bf1c2-164">**Example 1 - A text range that contains an embedded image**</span></span>  
  
 <span data-ttu-id="bf1c2-165">{画像の ![埋め込み画像の例](./media/uia-textpattern-embedded-objects-overview-imageexample.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample") は、テキストに埋め込まれています}。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-165">{The image ![Embedded Image Example](./media/uia-textpattern-embedded-objects-overview-imageexample.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample") is embedded in text}.</span></span>  
  
|<span data-ttu-id="bf1c2-166">呼び出されるメソッド</span><span class="sxs-lookup"><span data-stu-id="bf1c2-166">Method called</span></span>|<span data-ttu-id="bf1c2-167">結果</span><span class="sxs-lookup"><span data-stu-id="bf1c2-167">Result</span></span>|  
|-------------------|------------|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>|<span data-ttu-id="bf1c2-168">文字列 "The is embedded in text" を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-168">Returns the string "The is embedded in text".</span></span> <span data-ttu-id="bf1c2-169">イメージに関連付けられた代替テキストがテキスト ストリームに含まれることはありません。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-169">Any ALT text associated with the image cannot be expected to be included in the text stream.</span></span>|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetEnclosingElement%2A>|<span data-ttu-id="bf1c2-170">テキスト範囲を囲む最も内側の <xref:System.Windows.Automation.AutomationElement> を返します。この場合は、テキスト プロバイダー自体を表す <xref:System.Windows.Automation.AutomationElement> を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-170">Returns the innermost <xref:System.Windows.Automation.AutomationElement> that encloses the text range; in this case, the <xref:System.Windows.Automation.AutomationElement> that represents the text provider itself.</span></span>|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetChildren%2A>|<span data-ttu-id="bf1c2-171">イメージ コントロールを表す <xref:System.Windows.Automation.AutomationElement> を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-171">Returns an <xref:System.Windows.Automation.AutomationElement> representing the image control.</span></span>|  
|<span data-ttu-id="bf1c2-172"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> ( <xref:System.Windows.Automation.AutomationElement> は、前の <xref:System.Windows.Automation.Text.TextPatternRange.GetChildren%2A> メソッドから返されるオブジェクト)</span><span class="sxs-lookup"><span data-stu-id="bf1c2-172"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> where <xref:System.Windows.Automation.AutomationElement> is the object returned by the previous <xref:System.Windows.Automation.Text.TextPatternRange.GetChildren%2A> method.</span></span>|<span data-ttu-id="bf1c2-173">"![埋め込み画像の例](./media/uia-textpattern-embedded-objects-overview-imageexample.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample")" を表す低次元テキスト範囲を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-173">Returns the degenerate range that represents "![Embedded Image Example](./media/uia-textpattern-embedded-objects-overview-imageexample.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample")".</span></span>|  
  
 <span data-ttu-id="bf1c2-174">**例 2: テキストコンテナーのコンテンツに部分的にまたがるテキスト範囲。テキストコンテナーには、テキスト範囲に含まれない埋め込み画像が含まれています。**</span><span class="sxs-lookup"><span data-stu-id="bf1c2-174">**Example 2 - A text range that partially spans the content of a text container. The text container has an embedded image that is not part of the text range.**</span></span>  
  
 <span data-ttu-id="bf1c2-175">{イメージ} ![埋め込み画像の例](./media/uia-textpattern-embedded-objects-overview-imageexample.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample") は、テキストに埋め込まれています。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-175">{The image} ![Embedded Image Example](./media/uia-textpattern-embedded-objects-overview-imageexample.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample") is embedded in text.</span></span>  
  
|<span data-ttu-id="bf1c2-176">呼び出されるメソッド</span><span class="sxs-lookup"><span data-stu-id="bf1c2-176">Method called</span></span>|<span data-ttu-id="bf1c2-177">結果</span><span class="sxs-lookup"><span data-stu-id="bf1c2-177">Result</span></span>|  
|-------------------|------------|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>|<span data-ttu-id="bf1c2-178">文字列 "The image" を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-178">Returns the string "The image".</span></span>|  
|<xref:System.Windows.Automation.Text.TextPatternRange.GetEnclosingElement%2A>|<span data-ttu-id="bf1c2-179">テキスト範囲を囲む最も内側の <xref:System.Windows.Automation.AutomationElement> を返します。この場合は、テキスト プロバイダー自体を表す <xref:System.Windows.Automation.AutomationElement> を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-179">Returns the innermost <xref:System.Windows.Automation.AutomationElement> that encloses the text range; in this case, the <xref:System.Windows.Automation.AutomationElement> that represents the text provider itself.</span></span>|  
|<span data-ttu-id="bf1c2-180"><xref:System.Windows.Automation.Text.TextPatternRange.Move%2A> (パラメーターは (TextUnit.Word, 1))</span><span class="sxs-lookup"><span data-stu-id="bf1c2-180"><xref:System.Windows.Automation.Text.TextPatternRange.Move%2A> with parameters of (TextUnit.Word, 1).</span></span>|<span data-ttu-id="bf1c2-181">テキスト範囲は "is " に移動します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-181">Moves the text range span to "is ".</span></span> <span data-ttu-id="bf1c2-182">テキスト ベースの埋め込みオブジェクトのみがテキスト ストリームの一部と見なされるため、この例のイメージは Move やその戻り値 (この場合は 1) に影響を与えません。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-182">Because only text-based embedded objects are considered part of the text stream, the image in this example does not affect Move or its return value (1 in this case).</span></span>|  
  
<a name="Table"></a>

### <a name="table"></a><span data-ttu-id="bf1c2-183">テーブル</span><span class="sxs-lookup"><span data-stu-id="bf1c2-183">Table</span></span>  
  
### <a name="table-used-for-examples"></a><span data-ttu-id="bf1c2-184">例で使用するテーブル</span><span class="sxs-lookup"><span data-stu-id="bf1c2-184">Table used for examples</span></span>  
  
|<span data-ttu-id="bf1c2-185">イメージを含むセル</span><span class="sxs-lookup"><span data-stu-id="bf1c2-185">Cell with Image</span></span>|<span data-ttu-id="bf1c2-186">テキストを含むセル</span><span class="sxs-lookup"><span data-stu-id="bf1c2-186">Cell with Text</span></span>|  
|---------------------|--------------------|  
|<span data-ttu-id="bf1c2-187">![埋め込みイメージの例](./media/uia-textpattern-embedded-objects-overview-imageexample.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample")</span><span class="sxs-lookup"><span data-stu-id="bf1c2-187">![Embedded Image Example](./media/uia-textpattern-embedded-objects-overview-imageexample.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample")</span></span>|<span data-ttu-id="bf1c2-188">X</span><span class="sxs-lookup"><span data-stu-id="bf1c2-188">X</span></span>|  
|<span data-ttu-id="bf1c2-189">![埋め込みイメージの例 2](./media/uia-textpattern-embedded-objects-overview-imageexample2.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample2")</span><span class="sxs-lookup"><span data-stu-id="bf1c2-189">![Embedded Image Example 2](./media/uia-textpattern-embedded-objects-overview-imageexample2.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample2")</span></span>|<span data-ttu-id="bf1c2-190">Y</span><span class="sxs-lookup"><span data-stu-id="bf1c2-190">Y</span></span>|  
|<span data-ttu-id="bf1c2-191">![埋め込みイメージの例 3](./media/uia-textpattern-embedded-objects-overview-imageexample3.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample3")</span><span class="sxs-lookup"><span data-stu-id="bf1c2-191">![Embedded Image Example 3](./media/uia-textpattern-embedded-objects-overview-imageexample3.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample3")</span></span><br /><br /> <span data-ttu-id="bf1c2-192">Z のイメージ</span><span class="sxs-lookup"><span data-stu-id="bf1c2-192">Image for Z</span></span>|<span data-ttu-id="bf1c2-193">Z</span><span class="sxs-lookup"><span data-stu-id="bf1c2-193">Z</span></span>|  
  
 <span data-ttu-id="bf1c2-194">**例 1: セルのコンテンツからテキスト コンテナーを取得する**</span><span class="sxs-lookup"><span data-stu-id="bf1c2-194">**Example 1 - Get the text container from the content of a cell.**</span></span>  
  
|<span data-ttu-id="bf1c2-195">呼び出されるメソッド</span><span class="sxs-lookup"><span data-stu-id="bf1c2-195">Method Called</span></span>|<span data-ttu-id="bf1c2-196">結果</span><span class="sxs-lookup"><span data-stu-id="bf1c2-196">Result</span></span>|  
|-------------------|------------|  
|<span data-ttu-id="bf1c2-197"><xref:System.Windows.Automation.GridPattern.GetItem%2A> (パラメーターは (0, 0))</span><span class="sxs-lookup"><span data-stu-id="bf1c2-197"><xref:System.Windows.Automation.GridPattern.GetItem%2A> with parameters (0,0)</span></span>|<span data-ttu-id="bf1c2-198">セルのコンテンツを表す <xref:System.Windows.Automation.AutomationElement> を返します。この場合、要素はテキスト コントロールです。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-198">Returns the <xref:System.Windows.Automation.AutomationElement> representing the content of the table cell; in this case, the element is a text control.</span></span>|  
|<span data-ttu-id="bf1c2-199"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> ( <xref:System.Windows.Automation.AutomationElement> は、前の `GetItem` メソッドから返されるオブジェクト)</span><span class="sxs-lookup"><span data-stu-id="bf1c2-199"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> where <xref:System.Windows.Automation.AutomationElement> is the object returned by the previous `GetItem` method.</span></span>|<span data-ttu-id="bf1c2-200">画像の ![埋め込み画像の例](./media/uia-textpattern-embedded-objects-overview-imageexample.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample")にまたがる範囲を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-200">Returns the range that spans the image ![Embedded Image Example](./media/uia-textpattern-embedded-objects-overview-imageexample.PNG "UIA_TextPattern_Embedded_Objects_Overview_ImageExample").</span></span>|  
|<span data-ttu-id="bf1c2-201">前の<xref:System.Windows.Automation.Text.TextPatternRange.GetEnclosingElement%2A> メソッドから返されるオブジェクトの `RangeFromChild`</span><span class="sxs-lookup"><span data-stu-id="bf1c2-201"><xref:System.Windows.Automation.Text.TextPatternRange.GetEnclosingElement%2A> for the object returned by the previous `RangeFromChild` method.</span></span>|<span data-ttu-id="bf1c2-202">セルを表す <xref:System.Windows.Automation.AutomationElement> を返します。この場合、要素は TableItemPattern をサポートするテキスト コントロールです。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-202">Returns the <xref:System.Windows.Automation.AutomationElement> representing the table cell; in this case, the element is a text control that supports TableItemPattern.</span></span>|  
|<span data-ttu-id="bf1c2-203">前の<xref:System.Windows.Automation.Text.TextPatternRange.GetEnclosingElement%2A> メソッドから返されるオブジェクトの `GetEnclosingElement`</span><span class="sxs-lookup"><span data-stu-id="bf1c2-203"><xref:System.Windows.Automation.Text.TextPatternRange.GetEnclosingElement%2A> for the object returned by the previous `GetEnclosingElement` method.</span></span>|<span data-ttu-id="bf1c2-204">テーブルを表す <xref:System.Windows.Automation.AutomationElement> を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-204">Returns the <xref:System.Windows.Automation.AutomationElement> representing the table.</span></span>|  
|<span data-ttu-id="bf1c2-205">前の<xref:System.Windows.Automation.Text.TextPatternRange.GetEnclosingElement%2A> メソッドから返されるオブジェクトの `GetEnclosingElement`</span><span class="sxs-lookup"><span data-stu-id="bf1c2-205"><xref:System.Windows.Automation.Text.TextPatternRange.GetEnclosingElement%2A> for the object returned by the previous `GetEnclosingElement` method.</span></span>|<span data-ttu-id="bf1c2-206">テキスト プロバイダー自体を表す <xref:System.Windows.Automation.AutomationElement> を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-206">Returns the <xref:System.Windows.Automation.AutomationElement> that represents the text provider itself.</span></span>|  
  
 <span data-ttu-id="bf1c2-207">**例 2: セルのテキスト コンテンツを取得する**</span><span class="sxs-lookup"><span data-stu-id="bf1c2-207">**Example 2 - Get the text content of a cell.**</span></span>  
  
|<span data-ttu-id="bf1c2-208">呼び出されるメソッド</span><span class="sxs-lookup"><span data-stu-id="bf1c2-208">Method Called</span></span>|<span data-ttu-id="bf1c2-209">結果</span><span class="sxs-lookup"><span data-stu-id="bf1c2-209">Result</span></span>|  
|-------------------|------------|  
|<span data-ttu-id="bf1c2-210"><xref:System.Windows.Automation.GridPattern.GetItem%2A> (パラメーターは (1, 1))</span><span class="sxs-lookup"><span data-stu-id="bf1c2-210"><xref:System.Windows.Automation.GridPattern.GetItem%2A> with parameters of (1,1).</span></span>|<span data-ttu-id="bf1c2-211">セルのコンテンツを表す <xref:System.Windows.Automation.AutomationElement> を返します。この場合、要素はテキスト コントロールです。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-211">Returns the <xref:System.Windows.Automation.AutomationElement> representing the content of the table cell; in this case, the element is a text control.</span></span>|  
|<span data-ttu-id="bf1c2-212"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> ( <xref:System.Windows.Automation.AutomationElement> は、前の `GetItem` メソッドから返されるオブジェクト)</span><span class="sxs-lookup"><span data-stu-id="bf1c2-212"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> where <xref:System.Windows.Automation.AutomationElement> is the object returned by the previous `GetItem` method.</span></span>|<span data-ttu-id="bf1c2-213">"Y" を返します。</span><span class="sxs-lookup"><span data-stu-id="bf1c2-213">Returns "Y".</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="bf1c2-214">関連項目</span><span class="sxs-lookup"><span data-stu-id="bf1c2-214">See also</span></span>

- <xref:System.Windows.Automation.TextPattern>
- <xref:System.Windows.Automation.Text.TextPatternRange>
- <xref:System.Windows.Automation.Provider.ITextProvider>
- <xref:System.Windows.Automation.Provider.ITextRangeProvider>
- [<span data-ttu-id="bf1c2-215">UI オートメーションを使って埋め込みオブジェクトにアクセスする</span><span class="sxs-lookup"><span data-stu-id="bf1c2-215">Access Embedded Objects Using UI Automation</span></span>](access-embedded-objects-using-ui-automation.md)
- [<span data-ttu-id="bf1c2-216">UI オートメーションを使用したテーブルの内容の公開</span><span class="sxs-lookup"><span data-stu-id="bf1c2-216">Expose the Content of a Table Using UI Automation</span></span>](expose-the-content-of-a-table-using-ui-automation.md)
- [<span data-ttu-id="bf1c2-217">UI オートメーションを使用したテキストのスキャン</span><span class="sxs-lookup"><span data-stu-id="bf1c2-217">Traverse Text Using UI Automation</span></span>](traverse-text-using-ui-automation.md)
- [<span data-ttu-id="bf1c2-218">TextPattern の検索と選択のサンプル</span><span class="sxs-lookup"><span data-stu-id="bf1c2-218">TextPattern Search and Selection Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/FindText)
