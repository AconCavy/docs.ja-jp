---
title: UI オートメーション TextPattern の概要
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, TextPattern class
- TextPattern class
- classes, TextPattern
ms.assetid: 41787927-df1f-4f4a-aba3-641662854fc4
ms.openlocfilehash: 2f417aaba5361bea3bf2493001bca938d9dd08cb
ms.sourcegitcommit: f348c84443380a1959294cdf12babcb804cfa987
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/12/2019
ms.locfileid: "73975491"
---
# <a name="ui-automation-textpattern-overview"></a><span data-ttu-id="70c46-102">UI オートメーション TextPattern の概要</span><span class="sxs-lookup"><span data-stu-id="70c46-102">UI Automation TextPattern Overview</span></span>

> [!NOTE]
> <span data-ttu-id="70c46-103">このドキュメントは、[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 名前空間で定義されているマネージド <xref:System.Windows.Automation> クラスを使用する .NET Framework 開発者を対象としています。</span><span class="sxs-lookup"><span data-stu-id="70c46-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="70c46-104">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]の最新情報については、「 [Windows Automation API: UI Automation (Windows のオートメーション API: UI オートメーション)](https://go.microsoft.com/fwlink/?LinkID=156746)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="70c46-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).</span></span>

<span data-ttu-id="70c46-105">この概要では、 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] を使用して、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]でサポートされているプラットフォームのテキスト コントロールのテキストの内容 (書式とスタイルの属性など) を公開する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="70c46-105">This overview describes how to use [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] to expose the textual content, including format and style attributes, of text controls in [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]-supported platforms.</span></span> <span data-ttu-id="70c46-106">これらのコントロールには、Microsoft .NET Framework <xref:System.Windows.Controls.TextBox> と <xref:System.Windows.Controls.RichTextBox> だけでなく、それらに相当する [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] も含まれます。</span><span class="sxs-lookup"><span data-stu-id="70c46-106">These controls include, but are not limited to, the Microsoft .NET Framework <xref:System.Windows.Controls.TextBox> and <xref:System.Windows.Controls.RichTextBox> as well as their [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] equivalents.</span></span>

<span data-ttu-id="70c46-107">コントロールのテキストの内容は、 <xref:System.Windows.Automation.TextPattern> コントロール パターンを使用することで公開できます。コントロール パターンは、テキスト コンテナーの内容をテキスト ストリームとして表したものです。</span><span class="sxs-lookup"><span data-stu-id="70c46-107">Exposing the textual content of a control is accomplished through the use of the <xref:System.Windows.Automation.TextPattern> control pattern, which represents the contents of a text container as a text stream.</span></span> <span data-ttu-id="70c46-108">さらに、 <xref:System.Windows.Automation.TextPattern> は、書式とスタイルの属性を公開する <xref:System.Windows.Automation.Text.TextPatternRange> クラスをサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="70c46-108">In turn, <xref:System.Windows.Automation.TextPattern> requires the support of the <xref:System.Windows.Automation.Text.TextPatternRange> class to expose format and style attributes.</span></span> <span data-ttu-id="70c46-109"><xref:System.Windows.Automation.Text.TextPatternRange> は、 <xref:System.Windows.Automation.TextPattern> および <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> エンドポイントのコレクションがあるテキスト コンテナーに、連続する、または複数の非結合テキスト範囲を表すことで <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> をサポートします。</span><span class="sxs-lookup"><span data-stu-id="70c46-109"><xref:System.Windows.Automation.Text.TextPatternRange> supports <xref:System.Windows.Automation.TextPattern> by representing contiguous or multiple, disjoint text spans in a text container with a collection of <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> and <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> endpoints.</span></span> <span data-ttu-id="70c46-110"><xref:System.Windows.Automation.Text.TextPatternRange> は、選択、比較、取得、トラバースなどの機能をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="70c46-110"><xref:System.Windows.Automation.Text.TextPatternRange> supports functionality such as selection, comparison, retrieval and traversal.</span></span>

> [!NOTE]
> <span data-ttu-id="70c46-111"><xref:System.Windows.Automation.TextPattern> クラスには、テキストを挿入または変更する手段がありません。</span><span class="sxs-lookup"><span data-stu-id="70c46-111">The <xref:System.Windows.Automation.TextPattern> classes do not provide a means to insert or modify text.</span></span> <span data-ttu-id="70c46-112">しかし、コントロールによっては、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <xref:System.Windows.Automation.ValuePattern> によって、または直接キーボードから入力して、これを実現できます。</span><span class="sxs-lookup"><span data-stu-id="70c46-112">However, depending on the control, this may be accomplished by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <xref:System.Windows.Automation.ValuePattern> or through direct keyboard input.</span></span> <span data-ttu-id="70c46-113">例については、「 [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText) 」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="70c46-113">See the [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText) for an example.</span></span>

<span data-ttu-id="70c46-114">この概要で説明されている機能は、支援技術ベンダーとそのエンドユーザーにとって重要です。</span><span class="sxs-lookup"><span data-stu-id="70c46-114">The functionality described in this overview is vital to assistive technology vendors and their end users.</span></span> <span data-ttu-id="70c46-115">支援技術は、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] を使用してユーザー向けに完全なテキストの書式設定情報を収集するとともに、プログラムによるナビゲーションと、 <xref:System.Windows.Automation.Text.TextUnit> によるテキストの選択 (文字、単語、行、または段落) を行います。</span><span class="sxs-lookup"><span data-stu-id="70c46-115">Assistive technologies can use [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] to gather complete text formatting information for the user and provide programmatic navigation and selection of text by <xref:System.Windows.Automation.Text.TextUnit> (character, word, line, or paragraph).</span></span>

<a name="UI_Automation_TextPattern_vs__Cicero"></a>

## <a name="ui-automation-textpattern-vs-text-services-framework"></a><span data-ttu-id="70c46-116">UI オートメーション TextPattern とText Services Framework (TSF)</span><span class="sxs-lookup"><span data-stu-id="70c46-116">UI Automation TextPattern vs. Text Services Framework</span></span>

<span data-ttu-id="70c46-117">テキストサービスフレームワーク (TSF) は、デスクトップおよびアプリケーション内で自然言語サービスと高度なテキスト入力を可能にする、シンプルでスケーラブルなシステムフレームワークです。</span><span class="sxs-lookup"><span data-stu-id="70c46-117">Text Services Framework (TSF) is a simple and scalable system framework that enables natural language services and advanced text input on the desktop and within applications.</span></span> <span data-ttu-id="70c46-118">アプリケーションのテキスト ストアを公開するインターフェイスをアプリケーションに提供するだけでなく、そのテキスト ストアのメタデータもサポートします。</span><span class="sxs-lookup"><span data-stu-id="70c46-118">In addition to providing interfaces for applications to expose their text store it also supports metadata for that text store.</span></span>

<span data-ttu-id="70c46-119">ただし、TSF は、コンテキストに対応したシナリオに入力を挿入する必要があるアプリケーション向けに設計されていましたが、<xref:System.Windows.Automation.TextPattern> は読み取り専用のソリューションです (前述の制限付きの回避策を使用します)。これは、スクリーンリーダーと点字デバイスのテキストストアへのアクセスを最適化することを目的としています。</span><span class="sxs-lookup"><span data-stu-id="70c46-119">However, TSF was designed for applications that need to inject input into context-aware scenarios whereas <xref:System.Windows.Automation.TextPattern> is a read-only solution (with the limited workaround noted above) meant to provide optimized access to a text store for screen-readers and Braille devices.</span></span>

<span data-ttu-id="70c46-120">つまり、テキストストアへの読み取り専用アクセスを必要とするアクセス可能なテクノロジは <xref:System.Windows.Automation.TextPattern>を使用できますが、コンテキストに対応した入力については、TSF のより複雑な機能が必要になります。</span><span class="sxs-lookup"><span data-stu-id="70c46-120">In short, accessible technologies that require read-only access to a text store can use <xref:System.Windows.Automation.TextPattern>, but will need the more complex functionality of TSF for context-aware input.</span></span>

<a name="Control_Types"></a>

## <a name="control-types"></a><span data-ttu-id="70c46-121">コントロールの種類</span><span class="sxs-lookup"><span data-stu-id="70c46-121">Control Types</span></span>

### <a name="text"></a><span data-ttu-id="70c46-122">テキスト</span><span class="sxs-lookup"><span data-stu-id="70c46-122">Text</span></span>

<span data-ttu-id="70c46-123">テキスト コントロールは、画面上のテキストの一部を表す基本要素です。</span><span class="sxs-lookup"><span data-stu-id="70c46-123">The Text control is the basic element representing a piece of text on the screen.</span></span>

<span data-ttu-id="70c46-124">スタンドアロンのテキスト コントロールは、フォーム上のラベルまたは静的テキストとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="70c46-124">A standalone text control can be used as a label or static text on a form.</span></span> <span data-ttu-id="70c46-125">また、テキスト コントロールを、 <xref:System.Windows.Automation.ControlType.ListItem>、 <xref:System.Windows.Automation.ControlType.TreeItem> 、または <xref:System.Windows.Automation.ControlType.DataItem>の構造に含めることもできます。</span><span class="sxs-lookup"><span data-stu-id="70c46-125">Text controls can also be contained within the structure of a <xref:System.Windows.Automation.ControlType.ListItem>, <xref:System.Windows.Automation.ControlType.TreeItem> or <xref:System.Windows.Automation.ControlType.DataItem>.</span></span>

> [!NOTE]
> <span data-ttu-id="70c46-126">テキスト コントロールは、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ツリーのコンテンツ ビューに表示されないことがあります (「 [UI Automation Tree Overview](ui-automation-tree-overview.md)」をご覧ください)。</span><span class="sxs-lookup"><span data-stu-id="70c46-126">Text controls might not appear in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree (see [UI Automation Tree Overview](ui-automation-tree-overview.md)).</span></span> <span data-ttu-id="70c46-127">これは、テキスト コントロールが別のコントロールの Name プロパティを通じて表示されることがよくあるためです。</span><span class="sxs-lookup"><span data-stu-id="70c46-127">This is because text controls are often displayed through the Name property of another control.</span></span> <span data-ttu-id="70c46-128">たとえば、エディット コントロールのラベルに使用するテキストは、エディット コントロールの Name プロパティを通じて公開されます。</span><span class="sxs-lookup"><span data-stu-id="70c46-128">For instance, the text that is used to label an Edit control is exposed through the Name property of the Edit control.</span></span> <span data-ttu-id="70c46-129">エディット コントロールが [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ツリーのコンテンツ ビューに存在するので、テキスト要素自体は [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ツリーの対象のビューに存在する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="70c46-129">Because the Edit control is in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree, it is not necessary for the text element itself to be in that view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="70c46-130">コンテンツ ビューに表示されるテキストは、冗長な情報ではないテキストのみです。</span><span class="sxs-lookup"><span data-stu-id="70c46-130">The only text that shows up in the content view is text that is not redundant information.</span></span> <span data-ttu-id="70c46-131">これにより、支援テクノロジは、ユーザーが必要とする情報のみをすばやくフィルター処理できるようになります。</span><span class="sxs-lookup"><span data-stu-id="70c46-131">This enables any assistive technology to quickly filter only on the pieces of information that their users need.</span></span>

### <a name="edit"></a><span data-ttu-id="70c46-132">編集</span><span class="sxs-lookup"><span data-stu-id="70c46-132">Edit</span></span>

<span data-ttu-id="70c46-133">エディット コントロールを使用すると、ユーザーは 1 行のテキストを表示および編集できます。</span><span class="sxs-lookup"><span data-stu-id="70c46-133">Edit controls enable a user to view and edit a single line of text.</span></span>

> [!NOTE]
> <span data-ttu-id="70c46-134">1 行のテキストは、特定のレイアウトのシナリオでは折り返すことができます。</span><span class="sxs-lookup"><span data-stu-id="70c46-134">The single line of text may wrap in certain layout scenarios.</span></span>

### <a name="document"></a><span data-ttu-id="70c46-135">ドキュメント</span><span class="sxs-lookup"><span data-stu-id="70c46-135">Document</span></span>

<span data-ttu-id="70c46-136">ドキュメント コントロールを使用すると、ユーザーは複数のページのテキストに移動して、そこから情報を取得できます。</span><span class="sxs-lookup"><span data-stu-id="70c46-136">Document controls let a user navigate and obtain information from multiple pages of text.</span></span>

<a name="TextPattern_Client_API_s"></a>

## <a name="textpattern-client-apis"></a><span data-ttu-id="70c46-137">TextPattern クライアント Api</span><span class="sxs-lookup"><span data-stu-id="70c46-137">TextPattern Client APIs</span></span>

|||
|-|-|
|`System.Windows.Automation.TextPattern Class`|<span data-ttu-id="70c46-138">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] テキスト モデルのエントリ ポイントです。</span><span class="sxs-lookup"><span data-stu-id="70c46-138">The entry point for the [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] text model.</span></span><br /><br /> <span data-ttu-id="70c46-139">このクラスには、 <xref:System.Windows.Automation.TextPattern> と <xref:System.Windows.Automation.TextPattern.TextSelectionChangedEvent> という 2 つの <xref:System.Windows.Automation.TextPattern.TextChangedEvent>イベント リスナーが含まれています。</span><span class="sxs-lookup"><span data-stu-id="70c46-139">This class also contains the two <xref:System.Windows.Automation.TextPattern> event listeners, <xref:System.Windows.Automation.TextPattern.TextSelectionChangedEvent> and <xref:System.Windows.Automation.TextPattern.TextChangedEvent>.</span></span>|
|`System.Windows.Automation.Text.TextPatternRange Class`|<span data-ttu-id="70c46-140"><xref:System.Windows.Automation.TextPattern>をサポートする、テキスト コンテナー内のテキストの範囲の表記です。</span><span class="sxs-lookup"><span data-stu-id="70c46-140">The representation of a span of text within a text container that supports <xref:System.Windows.Automation.TextPattern>.</span></span><br /><br /> <span data-ttu-id="70c46-141">UI オートメーション クライアントは、 <xref:System.Windows.Automation.Text.TextPatternRange>を使用して作成されるテキスト範囲の現在の有効性に関して注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="70c46-141">UI Automation clients should be careful about the current validity of a text range created using <xref:System.Windows.Automation.Text.TextPatternRange>.</span></span> <span data-ttu-id="70c46-142">テキスト コントロールにある元のテキストが完全に新しいテキストに置き換えられた場合、現在のテキスト範囲は無効になります。</span><span class="sxs-lookup"><span data-stu-id="70c46-142">If the original text in the text control is completely replaced by new text, the current text range becomes invalid.</span></span> <span data-ttu-id="70c46-143">ただし、元のテキストの一部のみが変更され、基になるテキスト コントロールが、文字の絶対位置ではなくアンカー (またはエンドポイント) が付いたテキストの「ポインター」で管理している場合、テキスト範囲にはまだいくらかの有効性があります。</span><span class="sxs-lookup"><span data-stu-id="70c46-143">However, the text range may still have some viability if only part of the original text is changed and the underlying text control is managing its text "pointer" with anchors (or endpoints) rather than with absolute character positioning.</span></span><br /><br /> <span data-ttu-id="70c46-144">クライアントは、 <xref:System.Windows.Automation.TextPattern.TextChangedEvent> をリッスンして、操作するテキスト コンテンツに変更があった場合に通知を受けることができます。</span><span class="sxs-lookup"><span data-stu-id="70c46-144">Clients can listen for a <xref:System.Windows.Automation.TextPattern.TextChangedEvent> for notification of any changes to the textual content they are working with.</span></span>|
|`System.Windows.Automation.AutomationTextAttribute Class`|<span data-ttu-id="70c46-145">テキスト範囲の書式設定の属性を識別するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="70c46-145">Used to identify the formatting attributes of a text range.</span></span>|

<a name="TextPattern_Provider_API_s"></a>

## <a name="textpattern-provider-apis"></a><span data-ttu-id="70c46-146">TextPattern プロバイダー Api</span><span class="sxs-lookup"><span data-stu-id="70c46-146">TextPattern Provider APIs</span></span>

<span data-ttu-id="70c46-147">ネイティブに、または <xref:System.Windows.Automation.TextPattern> プロキシを介して <xref:System.Windows.Automation.Provider.ITextProvider> および <xref:System.Windows.Automation.Provider.ITextRangeProvider> の各インターフェイスを実装することで [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] をサポートする UI 要素またはコントロールは、堅牢なナビゲーション機能を提供するだけでなく、含まれている任意のテキストの詳細な属性情報を公開することができます。</span><span class="sxs-lookup"><span data-stu-id="70c46-147">UI elements or controls that support <xref:System.Windows.Automation.TextPattern> by implementing the <xref:System.Windows.Automation.Provider.ITextProvider> and <xref:System.Windows.Automation.Provider.ITextRangeProvider> interfaces, either natively or through [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] proxies, are capable of exposing detailed attribute information for any text they contain in addition to providing robust navigational capabilities.</span></span>

<span data-ttu-id="70c46-148"><xref:System.Windows.Automation.TextPattern> プロバイダーは、コントロールで特定の属性のサポートが不足している場合、すべてのテキスト属性をサポートする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="70c46-148">A <xref:System.Windows.Automation.TextPattern> provider does not have to support all text attributes if the control lacks support for any particular attributes.</span></span>

<span data-ttu-id="70c46-149"><xref:System.Windows.Automation.TextPattern> プロバイダーは、コントロールがテキスト領域内でテキストの選択またはテキストのカーソル (またはシステム キャレット) の配置をサポートする場合に <xref:System.Windows.Automation.TextPattern.GetSelection%2A> 機能と <xref:System.Windows.Automation.Text.TextPatternRange.Select%2A> 機能をサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="70c46-149">A <xref:System.Windows.Automation.TextPattern> provider must support the <xref:System.Windows.Automation.TextPattern.GetSelection%2A> and <xref:System.Windows.Automation.Text.TextPatternRange.Select%2A> functions if the control supports text selection or placement of the text cursor (or system caret) within the text area.</span></span> <span data-ttu-id="70c46-150">コントロールがこの機能をサポートしない場合、これらのメソッドのいずれもサポートする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="70c46-150">If the control does not support this functionality then it does not need to support either of these methods.</span></span> <span data-ttu-id="70c46-151">ただし、 <xref:System.Windows.Automation.Provider.ITextProvider.SupportedTextSelection%2A> プロパティを実装することで、コントロールはサポートするテキスト選択項目の種類を公開する必要があります。</span><span class="sxs-lookup"><span data-stu-id="70c46-151">However, the control must expose the type of text selection it supports by implementing the <xref:System.Windows.Automation.Provider.ITextProvider.SupportedTextSelection%2A> property.</span></span>

<span data-ttu-id="70c46-152"><xref:System.Windows.Automation.TextPattern> プロバイダーは、 <xref:System.Windows.Automation.Text.TextUnit> の定数 <xref:System.Windows.Automation.Text.TextUnit.Character> と <xref:System.Windows.Automation.Text.TextUnit.Document> 、およびサポートが可能なその他すべての <xref:System.Windows.Automation.Text.TextUnit> 定数を常にサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="70c46-152">A <xref:System.Windows.Automation.TextPattern> provider must always support the <xref:System.Windows.Automation.Text.TextUnit> constants <xref:System.Windows.Automation.Text.TextUnit.Character> and <xref:System.Windows.Automation.Text.TextUnit.Document> as well as any other <xref:System.Windows.Automation.Text.TextUnit> constants it is capable of supporting.</span></span>

> [!NOTE]
> <span data-ttu-id="70c46-153">プロバイダーは、次に大きい <xref:System.Windows.Automation.Text.TextUnit> ( <xref:System.Windows.Automation.Text.TextUnit> 、 <xref:System.Windows.Automation.Text.TextUnit.Character>、 <xref:System.Windows.Automation.Text.TextUnit.Format>、 <xref:System.Windows.Automation.Text.TextUnit.Word>、 <xref:System.Windows.Automation.Text.TextUnit.Line>、 <xref:System.Windows.Automation.Text.TextUnit.Paragraph>、 <xref:System.Windows.Automation.Text.TextUnit.Page>の順序でサポートされています) を遅らせることで、特定の <xref:System.Windows.Automation.Text.TextUnit.Document>のサポートを省略できます。</span><span class="sxs-lookup"><span data-stu-id="70c46-153">The provider may skip support for a specific <xref:System.Windows.Automation.Text.TextUnit> by deferring to the next largest <xref:System.Windows.Automation.Text.TextUnit> supported in the following order: <xref:System.Windows.Automation.Text.TextUnit.Character>, <xref:System.Windows.Automation.Text.TextUnit.Format>, <xref:System.Windows.Automation.Text.TextUnit.Word>, <xref:System.Windows.Automation.Text.TextUnit.Line>, <xref:System.Windows.Automation.Text.TextUnit.Paragraph>, <xref:System.Windows.Automation.Text.TextUnit.Page>, and <xref:System.Windows.Automation.Text.TextUnit.Document>.</span></span>

|||
|-|-|
|`ITextProvider Interface`|<span data-ttu-id="70c46-154">クライアント アプリケーションで <xref:System.Windows.Automation.TextPattern> をサポートするメソッド、プロパティ、および属性を公開します ( <xref:System.Windows.Automation.Provider.ITextProvider>を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="70c46-154">Exposes methods, properties and attributes that support <xref:System.Windows.Automation.TextPattern> in client applications (see <xref:System.Windows.Automation.Provider.ITextProvider>).</span></span>|
|`ITextRangeProvider Interface`|<span data-ttu-id="70c46-155">テキスト プロバイダー内のテキストの範囲を表します ( <xref:System.Windows.Automation.Provider.ITextRangeProvider>を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="70c46-155">Represents a span of text in a text provider (see <xref:System.Windows.Automation.Provider.ITextRangeProvider>).</span></span>|
|`System.Windows.Automation.TextPatternIdentifiers Class`|<span data-ttu-id="70c46-156">テキスト プロバイダーの識別子として使用される値が含まれています ( <xref:System.Windows.Automation.TextPatternIdentifiers>を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="70c46-156">Contains values that are used as identifiers for text providers (see <xref:System.Windows.Automation.TextPatternIdentifiers>).</span></span>|

<a name="Security"></a>

## <a name="security"></a><span data-ttu-id="70c46-157">セキュリティ</span><span class="sxs-lookup"><span data-stu-id="70c46-157">Security</span></span>

<span data-ttu-id="70c46-158">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] アーキテクチャは、セキュリティを考慮して設計されています (「 [UI オートメーションのセキュリティの概要](ui-automation-security-overview.md)」を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="70c46-158">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] architecture was designed with security in mind (see [UI Automation Security Overview](ui-automation-security-overview.md)).</span></span> <span data-ttu-id="70c46-159">ただし、この概要で説明する TextPattern クラスにはいくつか特定のセキュリティの考慮事項が必要です。</span><span class="sxs-lookup"><span data-stu-id="70c46-159">However, the TextPattern classes described in this overview require some specific security considerations.</span></span>

- [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="70c46-160">テキスト プロバイダーは、読み取り専用のインターフェイスを提供しますが、コントロールにある既存のテキストを変更する機能はありません。</span><span class="sxs-lookup"><span data-stu-id="70c46-160">text providers supply read-only interfaces and do not provide the ability to change the existing text in a control.</span></span>

- <span data-ttu-id="70c46-161">UI オートメーション クライアントは、それらが完全に「信頼できる」場合にのみ [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] を使用します。</span><span class="sxs-lookup"><span data-stu-id="70c46-161">UI Automation clients can only use [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] if they are fully "trusted".</span></span> <span data-ttu-id="70c46-162">この一例となるものが、信頼できる既知のアプリケーションのみが実行できる、保護されたログオン デスクトップです。</span><span class="sxs-lookup"><span data-stu-id="70c46-162">An example of this would be the protected Logon Desktop, where only known and trusted applications can run.</span></span>

- <span data-ttu-id="70c46-163">UI オートメーション プロバイダーの開発者は、 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] を介してコントロールに公開することにしたすべての情報が、基本的にパブリックであり、他のコードで完全にアクセスできることを認識する必要があります。</span><span class="sxs-lookup"><span data-stu-id="70c46-163">Developers of UI Automation providers should be aware that all information they choose to expose in their controls through [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] is essentially public and fully accessible by other code.</span></span> [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="70c46-164">は、UI オートメーション クライアントの信頼性を判断しようとしません。そのため、保護されたコンテンツまたは機密性の高いテキストの情報 (パスワード フィールドなど) をUI オートメーション プロバイダーで公開しないことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="70c46-164">makes no effort to determine the trustworthiness of any UI Automation client and therefore the UI Automation provider should not expose protected content or sensitive textual information (such as password fields).</span></span>

- <span data-ttu-id="70c46-165">Windows Vista のセキュリティの最も重要な変更点の1つは、"セキュリティで保護された入力" と呼ばれます。これには、最小特権 (または制限付き) ユーザーアカウント (LUA) と UI 特権レベルの分離 (UIPI) などのテクノロジが含まれます。</span><span class="sxs-lookup"><span data-stu-id="70c46-165">One of the most significant changes in security for Windows Vista is broadly referred to as "Secure Input" which encompasses technologies such as Least-privileged (or Limited) User Accounts (LUA) and UI Privilege Level Isolation (UIPI).</span></span>

  - <span data-ttu-id="70c46-166">UIPI は、プログラムが他のより「特権が高い」プログラムを制御または監視できないようにすることで、ユーザー入力になりすましたプロセス間のウィンドウ メッセージ攻撃を防ぎます。</span><span class="sxs-lookup"><span data-stu-id="70c46-166">UIPI prevents one program from controlling and/or monitoring another more "privileged" program, preventing cross-process window message attacks that spoof user input.</span></span>

  - <span data-ttu-id="70c46-167">LUA は、管理者グループのユーザーが実行しているアプリケーションの特権に制限を設定します。</span><span class="sxs-lookup"><span data-stu-id="70c46-167">LUA sets limits on the privileges of applications being run by users in the Administrators group.</span></span> <span data-ttu-id="70c46-168">アプリケーションには必ずしも管理者特権は必要なく、代わりに必要最小限の特権で実行します。</span><span class="sxs-lookup"><span data-stu-id="70c46-168">Applications won't necessarily have administrator privileges, but will instead run with the least privileges necessary.</span></span> <span data-ttu-id="70c46-169">その結果、LUA シナリオに制限が適用される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="70c46-169">As a consequence, there may be some restrictions enforced in LUA scenarios.</span></span> <span data-ttu-id="70c46-170">最も顕著な文字列の切り捨て (TextPattern 文字列など) では、管理者レベルのアプリケーションから取得される文字列のサイズを制限する必要があることがあります。そうすることで、これらのアプリケーションは、アプリケーションを無効にするポイントまで強制的にメモリを割り当てられずに済みます。</span><span class="sxs-lookup"><span data-stu-id="70c46-170">Most notably string truncation (including TextPattern strings), where it may be necessary to limit the size of strings being retrieved from administrator-level applications so they aren't forced to allocate memory to the point of disabling the application.</span></span>

<a name="Performance"></a>

## <a name="performance"></a><span data-ttu-id="70c46-171">パフォーマンス</span><span class="sxs-lookup"><span data-stu-id="70c46-171">Performance</span></span>

<span data-ttu-id="70c46-172">TextPattern はその機能のほとんどでプロセス間の呼び出しに依存しているので、コンテンツを処理するときにパフォーマンスを向上させるキャッシュのメカニズムは提供しません。</span><span class="sxs-lookup"><span data-stu-id="70c46-172">Because TextPattern relies on cross-process calls for most of its functionality, it does not provide a caching mechanism to improve performance when processing content.</span></span> <span data-ttu-id="70c46-173">これは、 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] メソッドまたは <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> メソッドを使用してアクセスできる <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> の他のコントロール パターンとは異なります。</span><span class="sxs-lookup"><span data-stu-id="70c46-173">This is unlike other control patterns in [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] that can be accessed using the <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> or <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> methods.</span></span>

<span data-ttu-id="70c46-174">パフォーマンスを向上させるための 1 つの方法は、 <xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>を使用して、UI オートメーション クライアントに中型のテキスト ブロックの取得を試みさせることです。</span><span class="sxs-lookup"><span data-stu-id="70c46-174">One tactic for improving performance is by making sure UI Automation clients attempt to retrieve moderately-sized blocks of text using <xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>.</span></span> <span data-ttu-id="70c46-175">たとえば、GetText(1) の呼び出しでは、文字ごとにプロセス間の影響を受けます。一方、GetText(-1) の呼び出しでは、1 つのプロセス間の影響を受けますが、テキストのプロバイダーのサイズによっては待機時間が長くなることがあります。</span><span class="sxs-lookup"><span data-stu-id="70c46-175">For example, GetText(1) calls will incur cross-process hits for each character whereas one GetText(-1) call will incur one cross-process hit, but can have high latency depending on the size of the text provider.</span></span>

<a name="Glossary"></a>

## <a name="textpattern-terminology"></a><span data-ttu-id="70c46-176">TextPattern 用語集</span><span class="sxs-lookup"><span data-stu-id="70c46-176">TextPattern Terminology</span></span>

<span data-ttu-id="70c46-177">**属性**</span><span class="sxs-lookup"><span data-stu-id="70c46-177">**Attribute**</span></span>\
<span data-ttu-id="70c46-178">テキスト範囲の書式設定特性 ( <xref:System.Windows.Automation.TextPattern.IsItalicAttribute> または <xref:System.Windows.Automation.TextPattern.FontNameAttribute>など)。</span><span class="sxs-lookup"><span data-stu-id="70c46-178">A formatting characteristic of a text range (for example, <xref:System.Windows.Automation.TextPattern.IsItalicAttribute> or <xref:System.Windows.Automation.TextPattern.FontNameAttribute>).</span></span>

<span data-ttu-id="70c46-179">**低次元テキスト範囲**の</span><span class="sxs-lookup"><span data-stu-id="70c46-179">**Degenerate Range**</span></span>\
<span data-ttu-id="70c46-180">低次元テキスト範囲は、空または 0 文字のテキスト範囲です。</span><span class="sxs-lookup"><span data-stu-id="70c46-180">A degenerate range is an empty or zero-character text range.</span></span> <span data-ttu-id="70c46-181">TextPattern コントロール パターンの目的から、テキスト挿入ポイント (またはシステム キャレット) は低次元テキスト範囲と見なされます。</span><span class="sxs-lookup"><span data-stu-id="70c46-181">For the purposes of the TextPattern control pattern, the text insertion point (or system caret) is considered a degenerate range.</span></span> <span data-ttu-id="70c46-182">テキストが選択されていない場合、 <xref:System.Windows.Automation.TextPattern.GetSelection%2A> は、テキスト挿入ポイントで低次元テキスト範囲を返し、 <xref:System.Windows.Automation.TextPattern.RangeFromPoint%2A> は、開始エンドポイントとして低次元テキスト範囲を返します。</span><span class="sxs-lookup"><span data-stu-id="70c46-182">If no text is selected, <xref:System.Windows.Automation.TextPattern.GetSelection%2A> would return a degenerate range at the text insertion point and <xref:System.Windows.Automation.TextPattern.RangeFromPoint%2A> would return a degenerate range as its starting endpoint.</span></span> <span data-ttu-id="70c46-183">テキスト プロバイダーで指定された条件に一致するテキスト範囲が見つからない場合、<xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> および <xref:System.Windows.Automation.TextPattern.GetVisibleRanges%2A> は低次元テキスト範囲を返す可能性があります。</span><span class="sxs-lookup"><span data-stu-id="70c46-183"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> and <xref:System.Windows.Automation.TextPattern.GetVisibleRanges%2A> may return degenerate ranges when the text provider cannot find any text ranges that match the given condition.</span></span> <span data-ttu-id="70c46-184">この低次元テキスト範囲は、テキスト プロバイダー内の開始エンドポイントとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="70c46-184">This degenerate range can be used as a starting endpoint within the text provider.</span></span> <span data-ttu-id="70c46-185"><xref:System.Windows.Automation.Text.TextPatternRange.FindText%2A> と <xref:System.Windows.Automation.Text.TextPatternRange.FindAttribute%2A> は、検出された範囲と低次元テキスト範囲との混同を避けるために、null 参照 (Microsoft Visual Basic .NET では`Nothing`) を返します。</span><span class="sxs-lookup"><span data-stu-id="70c46-185"><xref:System.Windows.Automation.Text.TextPatternRange.FindText%2A> and <xref:System.Windows.Automation.Text.TextPatternRange.FindAttribute%2A> return a null reference (`Nothing` in Microsoft Visual Basic .NET) to avoid confusion with a discovered range versus a degenerate range.</span></span>

<span data-ttu-id="70c46-186">**埋め込みオブジェクト**</span><span class="sxs-lookup"><span data-stu-id="70c46-186">**Embedded Object**</span></span>\
<span data-ttu-id="70c46-187">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] テキスト モデルには、2 種類の埋め込みオブジェクトがあります。</span><span class="sxs-lookup"><span data-stu-id="70c46-187">There are two types of embedded objects in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text model.</span></span> <span data-ttu-id="70c46-188">これらは、ハイパーリンクやテーブルなどのテキスト ベースのコンテンツ要素、およびイメージとボタンなどのコントロール要素で構成しています。</span><span class="sxs-lookup"><span data-stu-id="70c46-188">They consist of text-based content elements such as hyperlinks or tables, and control elements such as images and buttons.</span></span> <span data-ttu-id="70c46-189">詳しくは、「 [Access Embedded Objects Using UI Automation](access-embedded-objects-using-ui-automation.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="70c46-189">For more detailed information, see [Access Embedded Objects Using UI Automation](access-embedded-objects-using-ui-automation.md).</span></span>

<span data-ttu-id="70c46-190">**エンドポイント**</span><span class="sxs-lookup"><span data-stu-id="70c46-190">**Endpoint**</span></span>\
<span data-ttu-id="70c46-191">テキスト コンテナー内のテキスト範囲の <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> または <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> の絶対ポイント。</span><span class="sxs-lookup"><span data-stu-id="70c46-191">The absolute <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> or <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> point of a text range within a text container.</span></span>

<span data-ttu-id="70c46-192">![Textpattern Rangeendpoints &#40;の開始と&#41;終了。](./media/uia-textpattern-endpoints.PNG "UIA_TextPattern_Endpoints")</span><span class="sxs-lookup"><span data-stu-id="70c46-192">![TextPatternRangeEndpoints &#40;start and end&#41;.](./media/uia-textpattern-endpoints.PNG "UIA_TextPattern_Endpoints")</span></span>
<span data-ttu-id="70c46-193">始点と終点のセットを次に示します。</span><span class="sxs-lookup"><span data-stu-id="70c46-193">The following illustrates a set of start and end points.</span></span>

<span data-ttu-id="70c46-194">**TextRange**</span><span class="sxs-lookup"><span data-stu-id="70c46-194">**TextRange**</span></span>\
<span data-ttu-id="70c46-195">関連するすべての属性と機能を含むテキスト コンテナーの始点と終点で、テキストの範囲を表したもの。</span><span class="sxs-lookup"><span data-stu-id="70c46-195">A representation of a span of text, with start and end points, in a text container including all associated attributes and functionality.</span></span>

<xref:System.Windows.Automation.Text.TextUnit>\
<span data-ttu-id="70c46-196">テキストの範囲の論理セグメントを介して移動するために使用するテキストの定義済みの単位 (文字、単語、行、または段落) 。</span><span class="sxs-lookup"><span data-stu-id="70c46-196">A pre-defined unit of text (character, word, line, or paragraph) used for navigating through logical segments of a text range.</span></span>

## <a name="see-also"></a><span data-ttu-id="70c46-197">関連項目</span><span class="sxs-lookup"><span data-stu-id="70c46-197">See also</span></span>

- [<span data-ttu-id="70c46-198">クライアントの UI オートメーション コントロール パターン</span><span class="sxs-lookup"><span data-stu-id="70c46-198">UI Automation Control Patterns for Clients</span></span>](ui-automation-control-patterns-for-clients.md)
- [<span data-ttu-id="70c46-199">UI Automation コントロール パターンの概要</span><span class="sxs-lookup"><span data-stu-id="70c46-199">UI Automation Control Patterns Overview</span></span>](ui-automation-control-patterns-overview.md)
- [<span data-ttu-id="70c46-200">UI Automation ツリーの概要</span><span class="sxs-lookup"><span data-stu-id="70c46-200">UI Automation Tree Overview</span></span>](ui-automation-tree-overview.md)
- [<span data-ttu-id="70c46-201">UI オートメーションにおけるキャッシュの使用</span><span class="sxs-lookup"><span data-stu-id="70c46-201">Use Caching in UI Automation</span></span>](use-caching-in-ui-automation.md)
- [<span data-ttu-id="70c46-202">UI オートメーション プロバイダーでのコントロール パターンのサポート</span><span class="sxs-lookup"><span data-stu-id="70c46-202">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
- [<span data-ttu-id="70c46-203">UI オートメーション クライアントのコントロール パターン マッピング</span><span class="sxs-lookup"><span data-stu-id="70c46-203">Control Pattern Mapping for UI Automation Clients</span></span>](control-pattern-mapping-for-ui-automation-clients.md)
- [<span data-ttu-id="70c46-204">Text Services Framework (TSF)</span><span class="sxs-lookup"><span data-stu-id="70c46-204">Text Services Framework</span></span>](/windows/desktop/api/_tsf/)
