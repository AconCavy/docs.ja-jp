---
title: LINQ と ADO.NET
description: ADO.NET で統合言語クエリ (LINQ) を使用することにより、別のクエリ言語を使用せずに、アプリケーション コード内でセット ベースのクエリを作成する方法について説明します。
titleSuffix: ''
ms.date: 03/30/2017
ms.assetid: bf0c8f93-3ff7-49f3-8aed-f2b7ac938dec
ms.openlocfilehash: 50e048a67d4a9bf62b2224664acb654b96da0cb7
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2020
ms.locfileid: "91194688"
---
# <a name="linq-and-adonet"></a><span data-ttu-id="c8dc2-103">LINQ と ADO.NET</span><span class="sxs-lookup"><span data-stu-id="c8dc2-103">LINQ and ADO.NET</span></span>

<span data-ttu-id="c8dc2-104">今日、ビジネス アプリケーション開発者の多くは、2 つ (またはそれ以上) のプログラミング言語を使ってアプリケーションを開発しています。ビジネス ロジックやプレゼンテーション層には高級言語 (Visual C# や Visual Basic など) が、データベースとの対話にはクエリ言語 (Transact-SQL など) が使用されています。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-104">Today, many business developers must use two (or more) programming languages: a high-level language for the business logic and presentation layers (such as Visual C# or Visual Basic), and a query language to interact with the database (such as Transact-SQL).</span></span> <span data-ttu-id="c8dc2-105">開発者は実質的に複数の言語に精通していることが要求され、開発環境における言語の不整合が生じる原因にもなっています。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-105">This requires the developer to be proficient in several languages to be effective, and also causes language mismatches in the development environment.</span></span> <span data-ttu-id="c8dc2-106">たとえば、データ アクセス API を使用してデータベースを照会するアプリケーションでは、クエリは文字列リテラルとして引用符で囲んで指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-106">For example, an application that uses a data access API to execute a query against a database specifies the query as a string literal by using quotation marks.</span></span> <span data-ttu-id="c8dc2-107">コンパイラはこのクエリ文字列を認識できないため、エラー (無効な構文、参照されている列または行が実際に存在するかどうかなど) のチェック機構が働きません。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-107">This query string is unreadable to the compiler and is not checked for errors, such as invalid syntax or whether the columns or rows it references actually exist.</span></span> <span data-ttu-id="c8dc2-108">クエリ パラメーターの型チェックや `IntelliSense` のサポートもありません。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-108">There is no type checking of the query parameters and no `IntelliSense` support, either.</span></span>  
  
 <span data-ttu-id="c8dc2-109">LINQ (統合言語クエリ) により、開発者はアプリケーション コード内でプログラミング言語とクエリ言語を使い分けることなく、セット ベースのクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-109">Language-Integrated Query (LINQ) enables developers to form set-based queries in their application code, without having to use a separate query language.</span></span> <span data-ttu-id="c8dc2-110">インメモリのデータ構造、XML ドキュメント、SQL データベース、<xref:System.Data.DataSet> オブジェクトなど、列挙可能な各種データ ソース (つまり、<xref:System.Collections.IEnumerable> インターフェイスが実装されているデータ ソース) に対する LINQ クエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-110">You can write LINQ queries against various enumerable data sources (that is, a data source that implements the <xref:System.Collections.IEnumerable> interface), such as in-memory data structures, XML documents, SQL databases, and <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="c8dc2-111">実装方法には違いがありますが、こうした列挙可能なデータ ソースはすべて同じ構文および言語構造を公開しています。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-111">Although these enumerable data sources are implemented in various ways, they all expose the same syntax and language constructs.</span></span> <span data-ttu-id="c8dc2-112">クエリはプログラミング言語のみで作成できるため、コンパイラによる認識も検証もできない文字列リテラルとしてクエリ言語を記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-112">Because queries can be formed in the programming language itself, you do not have to use another query language that is embedded as string literals that cannot be understood or verified by the compiler.</span></span> <span data-ttu-id="c8dc2-113">クエリをプログラミング言語に統合することにより、コンパイル時の型チェックや構文チェック、`IntelliSense` の使用などが可能となるため、Visual Studio プログラマは生産性を高めることができます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-113">Integrating queries into the programming language also enables Visual Studio programmers to be more productive by providing compile-time type and syntax checking, and `IntelliSense`.</span></span> <span data-ttu-id="c8dc2-114">クエリのデバッグやエラーの修正に伴う手間は、これらの機能によって軽減されます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-114">These features reduce the need for query debugging and error fixing.</span></span>  
  
 <span data-ttu-id="c8dc2-115">SQL テーブルのデータをメモリ内のオブジェクトに転送することは、面倒であるだけでなく間違いの元にもなります。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-115">Transferring data from SQL tables into objects in memory is often tedious and error-prone.</span></span> <span data-ttu-id="c8dc2-116">LINQ to DataSet と [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] によって実装されている LINQ プロバイダーでは、ソース データが <xref:System.Collections.IEnumerable> ベースのオブジェクト コレクションに変換されます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-116">The LINQ provider implemented by LINQ to DataSet and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] converts the source data into <xref:System.Collections.IEnumerable>-based object collections.</span></span> <span data-ttu-id="c8dc2-117">プログラマからは、クエリの実行時も更新時も常にデータが <xref:System.Collections.IEnumerable> コレクションとして見えます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-117">The programmer always views the data as an <xref:System.Collections.IEnumerable> collection, both when you query and when you update.</span></span> <span data-ttu-id="c8dc2-118">これらのコレクションに対するクエリを記述する際には、`IntelliSense` の機能を完全に利用できます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-118">Full `IntelliSense` support is provided for writing queries against those collections.</span></span>  
  
 <span data-ttu-id="c8dc2-119">ADO.NET 統合言語クエリ (LINQ) には、3 つのテクノロジがあります。LINQ to DataSet、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]、LINQ to Entities です。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-119">There are three separate ADO.NET Language-Integrated Query (LINQ) technologies: LINQ to DataSet, [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and LINQ to Entities.</span></span> <span data-ttu-id="c8dc2-120">LINQ to DataSet により、<xref:System.Data.DataSet> に対する高度で最適化されたクエリの実行が提供され、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] により、SQL Server データベース スキーマに対して直接クエリを実行できます。LINQ to Entities では、Entity Data Model のクエリを実行できます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-120">LINQ to DataSet provides richer, optimized querying over the <xref:System.Data.DataSet> and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] enables you to directly query SQL Server database schemas, and LINQ to Entities allows you to query an Entity Data Model.</span></span>  
  
 <span data-ttu-id="c8dc2-121">次の図は、ADO.NET LINQ テクノロジが、高級プログラミング言語および LINQ 対応のデータ ソースとどのように関係しているかを簡単に表したものです。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-121">The following diagram provides an overview of how the ADO.NET LINQ technologies relate to high-level programming languages and LINQ-enabled data sources.</span></span>  
  
 <span data-ttu-id="c8dc2-122">![LINQ to ADO.NET の概要](./media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span><span class="sxs-lookup"><span data-stu-id="c8dc2-122">![LINQ to ADO.NET overview](./media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span></span>  
  
 <span data-ttu-id="c8dc2-123">LINQ について詳しくは、「[統合言語クエリ (LINQ)](../../../csharp/programming-guide/concepts/linq/index.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-123">For more information about LINQ, see [Language Integrated Query (LINQ)](../../../csharp/programming-guide/concepts/linq/index.md).</span></span>
  
 <span data-ttu-id="c8dc2-124">以降のセクションでは、LINQ to DataSet、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]、LINQ to Entities について詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-124">The following sections provide more information about LINQ to DataSet, [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and LINQ to Entities.</span></span>  
  
## <a name="linq-to-dataset"></a><span data-ttu-id="c8dc2-125">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="c8dc2-125">LINQ to DataSet</span></span>  

 <span data-ttu-id="c8dc2-126"><xref:System.Data.DataSet> は、ADO.NET の基礎である非接続型プログラミング モデルの重要な要素であり、幅広く使用されています。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-126">The <xref:System.Data.DataSet> is a key element of the disconnected programming model that ADO.NET is built on, and is widely used.</span></span> <span data-ttu-id="c8dc2-127">LINQ to DataSet により、開発者は、他の多くのデータ ソースで利用できる共通のクエリ作成メカニズムを使用しながら、より高度なクエリ機能を <xref:System.Data.DataSet> に組み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-127">LINQ to DataSet enables developers to build richer query capabilities into <xref:System.Data.DataSet> by using the same query formulation mechanism that is available for many other data sources.</span></span> <span data-ttu-id="c8dc2-128">詳細については、「[LINQ to DataSet](linq-to-dataset.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-128">For more information, see [LINQ to DataSet](linq-to-dataset.md).</span></span>  
  
## <a name="linq-to-sql"></a><span data-ttu-id="c8dc2-129">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="c8dc2-129">LINQ to SQL</span></span>  

 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="c8dc2-130">は、概念モデルへのマッピングを必要としない開発者にとって有用なツールです。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-130">is a useful tool for developers who do not require mapping to a conceptual model.</span></span> <span data-ttu-id="c8dc2-131">[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] を使用することにより、LINQ プログラミング モデルを既存のデータベース スキーマ上で直接利用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-131">By using [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], you can use the LINQ programming model directly over existing database schema.</span></span> <span data-ttu-id="c8dc2-132">開発者は、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] を使用して、データを表す .NET Framework クラスを生成できます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-132">[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] enables developers to generate .NET Framework classes that represent data.</span></span> <span data-ttu-id="c8dc2-133">こうして生成されたクラスは、概念データ モデルではなく、直接データベースのテーブル、ビュー、ストアド プロシージャ、およびユーザー定義関数にマッピングされます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-133">Rather than mapping to a conceptual data model, these generated classes map directly to database tables, views, stored procedures, and user-defined functions.</span></span>  
  
 <span data-ttu-id="c8dc2-134">[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] では、開発者が、XML などのデータ ソースに加え、インメモリ コレクションや <xref:System.Data.DataSet> と同じ LINQ プログラミング パターンを使用して、ストレージ スキーマに対して直接コードを記述できます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-134">With [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], developers can write code directly against the storage schema using the same LINQ programming pattern as in-memory collections and the <xref:System.Data.DataSet>, in addition to other data sources such as XML.</span></span> <span data-ttu-id="c8dc2-135">詳細については、「[LINQ to SQL](./sql/linq/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-135">For more information, see [LINQ to SQL](./sql/linq/index.md).</span></span>  
  
## <a name="linq-to-entities"></a><span data-ttu-id="c8dc2-136">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="c8dc2-136">LINQ to Entities</span></span>  

 <span data-ttu-id="c8dc2-137">現在、多くのアプリケーションが、リレーショナル データベースを基にして作成されています。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-137">Most applications are currently written on top of relational databases.</span></span> <span data-ttu-id="c8dc2-138">ある時点で、これらのアプリケーションにはリレーショナル形式で表されるデータと対話する必要が生じます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-138">At some point, these applications will need to interact with the data represented in a relational form.</span></span> <span data-ttu-id="c8dc2-139">データベース スキーマはアプリケーションの構築に理想的であるとは限らず、アプリケーションの概念モデルはデータベースの論理モデルと同じではありません。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-139">Database schemas are not always ideal for building applications, and the conceptual models of application are not the same as the logical models of databases.</span></span> <span data-ttu-id="c8dc2-140">Entity Data Model は、アプリケーションがデータをオブジェクトとして操作するために特定のドメインのデータをモデル化するときに使用できる概念データ モデルです。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-140">The Entity Data Model is a conceptual data model that can be used to model the data of a particular domain so that applications can interact with data as objects.</span></span> <span data-ttu-id="c8dc2-141">詳しくは、「[ADO.NET Entity Framework](./ef/index.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-141">For more information, see [ADO.NET Entity Framework](./ef/index.md).</span></span>  
  
 <span data-ttu-id="c8dc2-142">Entity Data Model では、リレーショナル データが .NET 環境にオブジェクトとして公開されます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-142">Through the Entity Data Model, relational data is exposed as objects in the .NET environment.</span></span> <span data-ttu-id="c8dc2-143">これにより、LINQ の利用に最適なオブジェクト レイヤーが実現されます。開発者は、ビジネス ロジックの構築に使用する言語で、データベースを照会するクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-143">This makes the object layer an ideal target for LINQ support, allowing developers to formulate queries against the database from the language used to build the business logic.</span></span> <span data-ttu-id="c8dc2-144">この機能は、LINQ to Entities と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-144">This capability is known as LINQ to Entities.</span></span> <span data-ttu-id="c8dc2-145">詳しくは、「[LINQ to Entities](./ef/language-reference/linq-to-entities.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="c8dc2-145">For more information, see [LINQ to Entities](./ef/language-reference/linq-to-entities.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c8dc2-146">関連項目</span><span class="sxs-lookup"><span data-stu-id="c8dc2-146">See also</span></span>

- [<span data-ttu-id="c8dc2-147">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="c8dc2-147">LINQ to DataSet</span></span>](linq-to-dataset.md)
- [<span data-ttu-id="c8dc2-148">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="c8dc2-148">LINQ to SQL</span></span>](./sql/linq/index.md)
- [<span data-ttu-id="c8dc2-149">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="c8dc2-149">LINQ to Entities</span></span>](./ef/language-reference/linq-to-entities.md)
- [<span data-ttu-id="c8dc2-150">統合言語クエリ (LINQ)</span><span class="sxs-lookup"><span data-stu-id="c8dc2-150">Language Integrated Query (LINQ)</span></span>](../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="c8dc2-151">ADO.NET の概要</span><span class="sxs-lookup"><span data-stu-id="c8dc2-151">ADO.NET Overview</span></span>](ado-net-overview.md)
