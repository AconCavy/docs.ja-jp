---
title: LINQ と ADO.NET
titleSuffix: ''
ms.date: 03/30/2017
ms.assetid: bf0c8f93-3ff7-49f3-8aed-f2b7ac938dec
ms.openlocfilehash: c5b56fa78ce0276953597d63b3d6e2f45d88c8ab
ms.sourcegitcommit: 011314e0c8eb4cf4a11d92078f58176c8c3efd2d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/09/2020
ms.locfileid: "77094437"
---
# <a name="linq-and-adonet"></a><span data-ttu-id="98dd4-102">LINQ と ADO.NET</span><span class="sxs-lookup"><span data-stu-id="98dd4-102">LINQ and ADO.NET</span></span>

<span data-ttu-id="98dd4-103">現在、多くのビジネス開発者は、2つ (またはそれ以上) のプログラミング言語を使用する必要があります。ビジネスロジックとC#プレゼンテーション層の高水準言語 (Visual や Visual Basic など) と、データベースと対話するためのクエリ言語 (transact-sql など) です。</span><span class="sxs-lookup"><span data-stu-id="98dd4-103">Today, many business developers must use two (or more) programming languages: a high-level language for the business logic and presentation layers (such as Visual C# or Visual Basic), and a query language to interact with the database (such as Transact-SQL).</span></span> <span data-ttu-id="98dd4-104">開発者は実質的に複数の言語に精通していることが要求され、開発環境における言語の不整合が生じる原因にもなっています。</span><span class="sxs-lookup"><span data-stu-id="98dd4-104">This requires the developer to be proficient in several languages to be effective, and also causes language mismatches in the development environment.</span></span> <span data-ttu-id="98dd4-105">たとえば、データ アクセス API を使用してデータベースを照会するアプリケーションでは、クエリは文字列リテラルとして引用符で囲んで指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="98dd4-105">For example, an application that uses a data access API to execute a query against a database specifies the query as a string literal by using quotation marks.</span></span> <span data-ttu-id="98dd4-106">このクエリ文字列は、無効な構文、参照先の列または行が実際に存在するかどうかなど、コンパイラに対して読み取ることができず、エラーをチェックしません。</span><span class="sxs-lookup"><span data-stu-id="98dd4-106">This query string is unreadable to the compiler and is not checked for errors, such as invalid syntax or whether the columns or rows it references actually exist.</span></span> <span data-ttu-id="98dd4-107">クエリ パラメーターの型チェックや `IntelliSense` のサポートもありません。</span><span class="sxs-lookup"><span data-stu-id="98dd4-107">There is no type checking of the query parameters and no `IntelliSense` support, either.</span></span>  
  
 <span data-ttu-id="98dd4-108">統合言語クエリ (LINQ) を使用すると、開発者は、個別のクエリ言語を使用しなくても、アプリケーションコードにセットベースのクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-108">Language-Integrated Query (LINQ) enables developers to form set-based queries in their application code, without having to use a separate query language.</span></span> <span data-ttu-id="98dd4-109">LINQ クエリは、メモリ内のデータ構造、XML ドキュメント、SQL データベース、<xref:System.Data.DataSet> オブジェクトなど、さまざまな列挙可能なデータソース (<xref:System.Collections.IEnumerable> インターフェイスを実装するデータソース) に対して記述できます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-109">You can write LINQ queries against various enumerable data sources (that is, a data source that implements the <xref:System.Collections.IEnumerable> interface), such as in-memory data structures, XML documents, SQL databases, and <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="98dd4-110">実装方法には違いがありますが、こうした列挙可能なデータ ソースはすべて同じ構文および言語構造を公開しています。</span><span class="sxs-lookup"><span data-stu-id="98dd4-110">Although these enumerable data sources are implemented in various ways, they all expose the same syntax and language constructs.</span></span> <span data-ttu-id="98dd4-111">クエリはプログラミング言語のみで作成できるため、コンパイラによる認識も検証もできない文字列リテラルとしてクエリ言語を記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="98dd4-111">Because queries can be formed in the programming language itself, you do not have to use another query language that is embedded as string literals that cannot be understood or verified by the compiler.</span></span> <span data-ttu-id="98dd4-112">クエリをプログラミング言語に統合することにより、コンパイル時の型と構文チェックを提供し、`IntelliSense`することで、Visual Studio プログラマの生産性を向上させることができます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-112">Integrating queries into the programming language also enables Visual Studio programmers to be more productive by providing compile-time type and syntax checking, and `IntelliSense`.</span></span> <span data-ttu-id="98dd4-113">クエリのデバッグやエラーの修正に伴う手間は、これらの機能によって軽減されます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-113">These features reduce the need for query debugging and error fixing.</span></span>  
  
 <span data-ttu-id="98dd4-114">SQL テーブルのデータをメモリ内のオブジェクトに転送することは、面倒であるだけでなく間違いの元にもなります。</span><span class="sxs-lookup"><span data-stu-id="98dd4-114">Transferring data from SQL tables into objects in memory is often tedious and error-prone.</span></span> <span data-ttu-id="98dd4-115">LINQ to DataSet および [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] によって実装される LINQ プロバイダーは、ソースデータを <xref:System.Collections.IEnumerable>ベースのオブジェクトコレクションに変換します。</span><span class="sxs-lookup"><span data-stu-id="98dd4-115">The LINQ provider implemented by LINQ to DataSet and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] converts the source data into <xref:System.Collections.IEnumerable>-based object collections.</span></span> <span data-ttu-id="98dd4-116">プログラマからは、クエリの実行時も更新時も常にデータが <xref:System.Collections.IEnumerable> コレクションとして見えます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-116">The programmer always views the data as an <xref:System.Collections.IEnumerable> collection, both when you query and when you update.</span></span> <span data-ttu-id="98dd4-117">これらのコレクションに対するクエリを記述する際には、`IntelliSense` の機能を完全に利用できます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-117">Full `IntelliSense` support is provided for writing queries against those collections.</span></span>  
  
 <span data-ttu-id="98dd4-118">LINQ to DataSet、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]、LINQ to Entities という3つの独立した統合言語クエリ (LINQ) テクノロジがあります。</span><span class="sxs-lookup"><span data-stu-id="98dd4-118">There are three separate ADO.NET Language-Integrated Query (LINQ) technologies: LINQ to DataSet, [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and LINQ to Entities.</span></span> <span data-ttu-id="98dd4-119">LINQ to DataSet は、<xref:System.Data.DataSet> に対してより高度で最適化されたクエリを提供し [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] SQL Server データベーススキーマに対して直接クエリを実行できるようにします。また、LINQ to Entities を使用して Entity Data Model に対してクエリを実行できます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-119">LINQ to DataSet provides richer, optimized querying over the <xref:System.Data.DataSet> and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] enables you to directly query SQL Server database schemas, and LINQ to Entities allows you to query an Entity Data Model.</span></span>  
  
 <span data-ttu-id="98dd4-120">次の図は、ADO.NET LINQ テクノロジが、高級プログラミング言語および LINQ 対応のデータ ソースとどのように関係しているかを簡単に表したものです。</span><span class="sxs-lookup"><span data-stu-id="98dd4-120">The following diagram provides an overview of how the ADO.NET LINQ technologies relate to high-level programming languages and LINQ-enabled data sources.</span></span>  
  
 <span data-ttu-id="98dd4-121">![LINQ to ADO.NET の概要](./media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span><span class="sxs-lookup"><span data-stu-id="98dd4-121">![LINQ to ADO.NET overview](./media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span></span>  
  
 <span data-ttu-id="98dd4-122">LINQ の詳細については、「[統合言語クエリ (linq)](../../../csharp/programming-guide/concepts/linq/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="98dd4-122">For more information about LINQ, see [Language Integrated Query (LINQ)](../../../csharp/programming-guide/concepts/linq/index.md).</span></span>
  
 <span data-ttu-id="98dd4-123">次のセクションでは、LINQ to DataSet、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]、および LINQ to Entities の詳細について説明します。</span><span class="sxs-lookup"><span data-stu-id="98dd4-123">The following sections provide more information about LINQ to DataSet, [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and LINQ to Entities.</span></span>  
  
## <a name="linq-to-dataset"></a><span data-ttu-id="98dd4-124">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="98dd4-124">LINQ to DataSet</span></span>  
 <span data-ttu-id="98dd4-125"><xref:System.Data.DataSet> は、ADO.NET が構築される非接続型プログラミングモデルの重要な要素であり、広く使用されています。</span><span class="sxs-lookup"><span data-stu-id="98dd4-125">The <xref:System.Data.DataSet> is a key element of the disconnected programming model that ADO.NET is built on, and is widely used.</span></span> <span data-ttu-id="98dd4-126">LINQ to DataSet を使用すると、開発者は、他の多くのデータソースで使用できるのと同じクエリ定式化メカニズムを使用して、より豊富なクエリ機能を <xref:System.Data.DataSet> に組み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-126">LINQ to DataSet enables developers to build richer query capabilities into <xref:System.Data.DataSet> by using the same query formulation mechanism that is available for many other data sources.</span></span> <span data-ttu-id="98dd4-127">詳細については、「[LINQ to DataSet](linq-to-dataset.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="98dd4-127">For more information, see [LINQ to DataSet](linq-to-dataset.md).</span></span>  
  
## <a name="linq-to-sql"></a><span data-ttu-id="98dd4-128">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="98dd4-128">LINQ to SQL</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="98dd4-129">は、概念モデルへのマッピングを必要としない開発者にとって有用なツールです。</span><span class="sxs-lookup"><span data-stu-id="98dd4-129">is a useful tool for developers who do not require mapping to a conceptual model.</span></span> <span data-ttu-id="98dd4-130">[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]を使用すると、既存のデータベーススキーマに対して直接 LINQ プログラミングモデルを使用できます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-130">By using [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], you can use the LINQ programming model directly over existing database schema.</span></span> [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="98dd4-131">を使用すると、開発者はデータを表す .NET Framework クラスを生成できます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-131">enables developers to generate .NET Framework classes that represent data.</span></span> <span data-ttu-id="98dd4-132">こうして生成されたクラスは、概念データ モデルではなく、直接データベースのテーブル、ビュー、ストアド プロシージャ、およびユーザー定義関数にマッピングされます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-132">Rather than mapping to a conceptual data model, these generated classes map directly to database tables, views, stored procedures, and user-defined functions.</span></span>  
  
 <span data-ttu-id="98dd4-133">[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]を使用すると、開発者は、XML などの他のデータソースに加えて、メモリ内コレクションや <xref:System.Data.DataSet>と同じ LINQ プログラミングパターンを使用して、ストレージスキーマに対して直接コードを記述できます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-133">With [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], developers can write code directly against the storage schema using the same LINQ programming pattern as in-memory collections and the <xref:System.Data.DataSet>, in addition to other data sources such as XML.</span></span> <span data-ttu-id="98dd4-134">詳細については、「 [LINQ to SQL](./sql/linq/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="98dd4-134">For more information, see [LINQ to SQL](./sql/linq/index.md).</span></span>  
  
## <a name="linq-to-entities"></a><span data-ttu-id="98dd4-135">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="98dd4-135">LINQ to Entities</span></span>  
 <span data-ttu-id="98dd4-136">現在、多くのアプリケーションが、リレーショナル データベースを基にして作成されています。</span><span class="sxs-lookup"><span data-stu-id="98dd4-136">Most applications are currently written on top of relational databases.</span></span> <span data-ttu-id="98dd4-137">ある時点で、これらのアプリケーションにはリレーショナル形式で表されるデータと対話する必要が生じます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-137">At some point, these applications will need to interact with the data represented in a relational form.</span></span> <span data-ttu-id="98dd4-138">データベース スキーマはアプリケーションの構築に理想的であるとは限らず、アプリケーションの概念モデルはデータベースの論理モデルと同じではありません。</span><span class="sxs-lookup"><span data-stu-id="98dd4-138">Database schemas are not always ideal for building applications, and the conceptual models of application are not the same as the logical models of databases.</span></span> <span data-ttu-id="98dd4-139">Entity Data Model は、アプリケーションがデータをオブジェクトとして操作できるように、特定のドメインのデータをモデル化するために使用できる概念データモデルです。</span><span class="sxs-lookup"><span data-stu-id="98dd4-139">The Entity Data Model is a conceptual data model that can be used to model the data of a particular domain so that applications can interact with data as objects.</span></span> <span data-ttu-id="98dd4-140">詳細については、「 [ADO.NET Entity Framework](./ef/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="98dd4-140">For more information, see [ADO.NET Entity Framework](./ef/index.md).</span></span>  
  
 <span data-ttu-id="98dd4-141">Entity Data Model では、リレーショナル データが .NET 環境にオブジェクトとして公開されます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-141">Through the Entity Data Model, relational data is exposed as objects in the .NET environment.</span></span> <span data-ttu-id="98dd4-142">これにより、LINQ の利用に最適なオブジェクト レイヤーが実現されます。開発者は、ビジネス ロジックの構築に使用する言語で、データベースを照会するクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-142">This makes the object layer an ideal target for LINQ support, allowing developers to formulate queries against the database from the language used to build the business logic.</span></span> <span data-ttu-id="98dd4-143">この機能は、LINQ to Entities と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="98dd4-143">This capability is known as LINQ to Entities.</span></span> <span data-ttu-id="98dd4-144">詳細については、「 [LINQ to Entities](./ef/language-reference/linq-to-entities.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="98dd4-144">For more information, see [LINQ to Entities](./ef/language-reference/linq-to-entities.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="98dd4-145">参照</span><span class="sxs-lookup"><span data-stu-id="98dd4-145">See also</span></span>

- [<span data-ttu-id="98dd4-146">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="98dd4-146">LINQ to DataSet</span></span>](linq-to-dataset.md)
- [<span data-ttu-id="98dd4-147">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="98dd4-147">LINQ to SQL</span></span>](./sql/linq/index.md)
- [<span data-ttu-id="98dd4-148">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="98dd4-148">LINQ to Entities</span></span>](./ef/language-reference/linq-to-entities.md)
- [<span data-ttu-id="98dd4-149">統合言語クエリ (LINQ)</span><span class="sxs-lookup"><span data-stu-id="98dd4-149">Language Integrated Query (LINQ)</span></span>](../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="98dd4-150">ADO.NET の概要</span><span class="sxs-lookup"><span data-stu-id="98dd4-150">ADO.NET Overview</span></span>](ado-net-overview.md)
