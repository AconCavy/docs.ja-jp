---
title: LINQ to Entities でのクエリ
description: LINQ が、さまざまな種類のデータ ソースやデータ形式のデータを操作するためのシンプルで一貫性のあるモデルを、プログラミング オブジェクトを使用して提供するしくみについて説明します。
ms.date: 03/30/2017
ms.assetid: c015a609-29eb-4e95-abb1-2ca721c6e2ad
ms.openlocfilehash: 5a10aadd3f21086b2b04dc5e77e40f35655f905b
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/15/2020
ms.locfileid: "90554255"
---
# <a name="queries-in-linq-to-entities"></a><span data-ttu-id="cc46a-103">LINQ to Entities でのクエリ</span><span class="sxs-lookup"><span data-stu-id="cc46a-103">Queries in LINQ to Entities</span></span>
<span data-ttu-id="cc46a-104">クエリは、データ ソースからデータを取得する式です。</span><span class="sxs-lookup"><span data-stu-id="cc46a-104">A query is an expression that retrieves data from a data source.</span></span> <span data-ttu-id="cc46a-105">一般に、クエリは専用のクエリ言語で表現されます。たとえば、リレーショナル データベースであれば SQL、XML であれば XQuery が使用されます。</span><span class="sxs-lookup"><span data-stu-id="cc46a-105">Queries are usually expressed in a specialized query language, such as SQL for relational databases and XQuery for XML.</span></span> <span data-ttu-id="cc46a-106">そのため、開発者はクエリの対象となるデータ ソースやデータ形式ごとに新しいクエリ言語を習得する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cc46a-106">Therefore, developers have had to learn a new query language for each type of data source or data format that they query.</span></span> <span data-ttu-id="cc46a-107">統合言語クエリ (LINQ) は、データ ソースや形式の違いを意識することなくデータを扱うことのできる、より簡素化された一貫したモデルを提供します。</span><span class="sxs-lookup"><span data-stu-id="cc46a-107">Language-Integrated Query (LINQ) offers a simpler, consistent model for working with data across various kinds of data sources and formats.</span></span> <span data-ttu-id="cc46a-108">LINQ クエリでは、常にプログラミング オブジェクトを操作することになります。</span><span class="sxs-lookup"><span data-stu-id="cc46a-108">In a LINQ query, you always work with programming objects.</span></span>  
  
 <span data-ttu-id="cc46a-109">LINQ のクエリ操作は、データ ソースを取得し、クエリを作成して、クエリを実行するという 3 つのアクションから成ります。</span><span class="sxs-lookup"><span data-stu-id="cc46a-109">A LINQ query operation consists of three actions: obtain the data source or sources, create the query, and execute the query.</span></span>  
  
 <span data-ttu-id="cc46a-110">LINQ を介したクエリは、<xref:System.Collections.Generic.IEnumerable%601> ジェネリック インターフェイスまたは <xref:System.Linq.IQueryable%601> ジェネリック インターフェイスを実装するデータ ソースに対して行うことができます。</span><span class="sxs-lookup"><span data-stu-id="cc46a-110">Data sources that implement the <xref:System.Collections.Generic.IEnumerable%601> generic interface or the <xref:System.Linq.IQueryable%601> generic interface can be queried through LINQ.</span></span> <span data-ttu-id="cc46a-111">ジェネリック インターフェイス <xref:System.Linq.IQueryable%601> が実装されているジェネリック クラス <xref:System.Data.Objects.ObjectQuery%601> のインスタンスは、LINQ to Entities クエリのデータ ソースとして動作します。</span><span class="sxs-lookup"><span data-stu-id="cc46a-111">Instances of the generic <xref:System.Data.Objects.ObjectQuery%601> class, which implements the generic <xref:System.Linq.IQueryable%601> interface, serve as the data source for LINQ to Entities queries.</span></span> <span data-ttu-id="cc46a-112"><xref:System.Data.Objects.ObjectQuery%601> ジェネリック クラスは、0 個以上の型指定されたオブジェクトのコレクションを返すクエリを表します。</span><span class="sxs-lookup"><span data-stu-id="cc46a-112">The <xref:System.Data.Objects.ObjectQuery%601> generic class represents a query that returns a collection of zero or more typed objects.</span></span> <span data-ttu-id="cc46a-113">C# のキーワード `var` (Visual Basic では Dim) を使用して、コンパイラでエンティティの型を推論することもできます。</span><span class="sxs-lookup"><span data-stu-id="cc46a-113">You can also let the compiler infer the type of an entity by using the C# keyword `var` (Dim in Visual Basic).</span></span>  
  
 <span data-ttu-id="cc46a-114">クエリでは、データ ソースから取得する情報を正確に指定できます。</span><span class="sxs-lookup"><span data-stu-id="cc46a-114">In the query, you specify exactly the information that you want to retrieve from the data source.</span></span> <span data-ttu-id="cc46a-115">また、並べ替え、グループ化、整形方法を指定して情報を取得することもできます。</span><span class="sxs-lookup"><span data-stu-id="cc46a-115">A query can also specify how that information should be sorted, grouped, and shaped before it is returned.</span></span> <span data-ttu-id="cc46a-116">LINQ では、クエリが変数に格納されます。</span><span class="sxs-lookup"><span data-stu-id="cc46a-116">In LINQ, a query is stored in a variable.</span></span> <span data-ttu-id="cc46a-117">クエリが一連の値を返す場合、クエリ変数そのものがクエリ可能な型であることが必要です。</span><span class="sxs-lookup"><span data-stu-id="cc46a-117">If the query returns a sequence of values, the query variable itself must be a queryable type.</span></span> <span data-ttu-id="cc46a-118">このクエリ変数は、クエリの情報を保存するだけで、なんらかのアクションを実行したり、データを返したりすることはありません。</span><span class="sxs-lookup"><span data-stu-id="cc46a-118">This query variable takes no action and returns no data; it only stores the query information.</span></span> <span data-ttu-id="cc46a-119">クエリを作成した後、データを取得するには、そのクエリを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cc46a-119">After you create a query you must execute that query to retrieve any data.</span></span>  
  
## <a name="query-syntax"></a><span data-ttu-id="cc46a-120">クエリ構文</span><span class="sxs-lookup"><span data-stu-id="cc46a-120">Query Syntax</span></span>  
 <span data-ttu-id="cc46a-121">LINQ to Entities クエリは、クエリ式の構文とメソッド ベースのクエリ構文という 2 とおりの構文を使って作成できます。</span><span class="sxs-lookup"><span data-stu-id="cc46a-121">LINQ to Entities queries can be composed in two different syntaxes: query expression syntax and method-based query syntax.</span></span> <span data-ttu-id="cc46a-122">クエリ式の構文は、C# 3.0 および Visual Basic 9.0 で新たに導入され、Transact-SQL や XQuery などと同様な宣言型の構文で記述された一連の句で構成されます。</span><span class="sxs-lookup"><span data-stu-id="cc46a-122">Query expression syntax is new in C# 3.0 and Visual Basic 9.0, and it consists of a set of clauses written in a declarative syntax similar to Transact-SQL or XQuery.</span></span> <span data-ttu-id="cc46a-123">ただし、.NET Framework の共通言語ランタイム (CLR) では、クエリ式の構文自体を読み取ることはできません。</span><span class="sxs-lookup"><span data-stu-id="cc46a-123">However, the .NET Framework common language runtime (CLR) cannot read the query expression syntax itself.</span></span> <span data-ttu-id="cc46a-124">そのため、クエリ式はコンパイル時に、CLR が理解できる形式 (メソッド呼び出し) へと変換されます。</span><span class="sxs-lookup"><span data-stu-id="cc46a-124">Therefore, at compile time, query expressions are translated to something that the CLR does understand: method calls.</span></span> <span data-ttu-id="cc46a-125">これらのメソッドは、"*標準クエリ演算子*" として知られています。</span><span class="sxs-lookup"><span data-stu-id="cc46a-125">These methods are known as the *standard query operators*.</span></span> <span data-ttu-id="cc46a-126">開発者は、クエリ構文を使う代わりに、メソッド構文を使ってそれらを直接呼び出すこともできます。</span><span class="sxs-lookup"><span data-stu-id="cc46a-126">As a developer, you have the option of calling them directly by using method syntax, instead of using query syntax.</span></span> <span data-ttu-id="cc46a-127">詳細については、「[LINQ でのクエリ構文とメソッド構文](../../../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="cc46a-127">For more information, see [Query Syntax and Method Syntax in LINQ](../../../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md).</span></span>  
  
### <a name="query-expression-syntax"></a><span data-ttu-id="cc46a-128">クエリ式の構文</span><span class="sxs-lookup"><span data-stu-id="cc46a-128">Query Expression Syntax</span></span>  
 <span data-ttu-id="cc46a-129">クエリ式は宣言型のクエリ構文です。</span><span class="sxs-lookup"><span data-stu-id="cc46a-129">Query expressions are a declarative query syntax.</span></span> <span data-ttu-id="cc46a-130">開発者は、Transact-SQL に似た形式の高級言語でクエリを記述できます。</span><span class="sxs-lookup"><span data-stu-id="cc46a-130">This syntax enables a developer to write queries in a high-level language that is formatted similar to Transact-SQL.</span></span> <span data-ttu-id="cc46a-131">クエリ式の構文を使用することにより、フィルター、並べ替え、グループ化など、データ ソースに対するきわめて複雑な処理を最小限のコードで実行できます。</span><span class="sxs-lookup"><span data-stu-id="cc46a-131">By using query expression syntax, you can perform even complex filtering, ordering, and grouping operations on data sources with minimal code.</span></span> <span data-ttu-id="cc46a-132">詳しくは、「[基本的なクエリ操作 (Visual Basic)](../../../../../visual-basic/programming-guide/concepts/linq/basic-query-operations.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="cc46a-132">For more information, see [Basic Query Operations (Visual Basic)](../../../../../visual-basic/programming-guide/concepts/linq/basic-query-operations.md).</span></span> <span data-ttu-id="cc46a-133">クエリ式構文の使用方法を示す例については、次のトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="cc46a-133">For examples that demonstrate how to use the query expression syntax, see the following topics:</span></span>  
  
- [<span data-ttu-id="cc46a-134">クエリ式の構文例: 射影</span><span class="sxs-lookup"><span data-stu-id="cc46a-134">Query Expression Syntax Examples: Projection</span></span>](query-expression-syntax-examples-projection.md)  
  
- [<span data-ttu-id="cc46a-135">クエリ式の構文例: フィルター処理</span><span class="sxs-lookup"><span data-stu-id="cc46a-135">Query Expression Syntax Examples: Filtering</span></span>](query-expression-syntax-examples-filtering.md)  
  
- [<span data-ttu-id="cc46a-136">クエリ式の構文例: 並べ替え</span><span class="sxs-lookup"><span data-stu-id="cc46a-136">Query Expression Syntax Examples: Ordering</span></span>](query-expression-syntax-examples-ordering.md)  
  
- [<span data-ttu-id="cc46a-137">クエリ式の構文例: 集計演算子</span><span class="sxs-lookup"><span data-stu-id="cc46a-137">Query Expression Syntax Examples: Aggregate Operators</span></span>](query-expression-syntax-examples-aggregate-operators.md)  
  
- [<span data-ttu-id="cc46a-138">クエリ式の構文例: パーティション分割</span><span class="sxs-lookup"><span data-stu-id="cc46a-138">Query Expression Syntax Examples: Partitioning</span></span>](query-expression-syntax-examples-partitioning.md)  
  
- [<span data-ttu-id="cc46a-139">クエリ式の構文例: 結合演算子</span><span class="sxs-lookup"><span data-stu-id="cc46a-139">Query Expression Syntax Examples: Join Operators</span></span>](query-expression-syntax-examples-join-operators.md)  
  
- [<span data-ttu-id="cc46a-140">クエリ式の構文例: 要素演算子</span><span class="sxs-lookup"><span data-stu-id="cc46a-140">Query Expression Syntax Examples: Element Operators</span></span>](query-expression-syntax-examples-element-operators.md)  
  
- [<span data-ttu-id="cc46a-141">クエリ式の構文例: グループ化</span><span class="sxs-lookup"><span data-stu-id="cc46a-141">Query Expression Syntax Examples: Grouping</span></span>](query-expression-syntax-examples-grouping.md)  
  
- [<span data-ttu-id="cc46a-142">クエリ式の構文例: リレーションシップのナビゲーション</span><span class="sxs-lookup"><span data-stu-id="cc46a-142">Query Expression Syntax Examples: Navigating Relationships</span></span>](query-expression-syntax-examples-navigating-relationships.md)  
  
### <a name="method-based-query-syntax"></a><span data-ttu-id="cc46a-143">メソッド ベースのクエリ構文</span><span class="sxs-lookup"><span data-stu-id="cc46a-143">Method-Based Query Syntax</span></span>  
 <span data-ttu-id="cc46a-144">LINQ to Entities クエリを作成するもう 1 つの方法として、メソッド ベースのクエリがあります。</span><span class="sxs-lookup"><span data-stu-id="cc46a-144">Another way to compose LINQ to Entities queries is by using method-based queries.</span></span> <span data-ttu-id="cc46a-145">メソッド ベースのクエリ構文は、LINQ の演算子メソッドに対する直接メソッド呼び出しのシーケンスであり、パラメーターとしてラムダ式を渡します。</span><span class="sxs-lookup"><span data-stu-id="cc46a-145">The method-based query syntax is a sequence of direct method calls to LINQ operator methods, passing lambda expressions as the parameters.</span></span> <span data-ttu-id="cc46a-146">詳細については、「[ラムダ式](../../../../../csharp/language-reference/operators/lambda-expressions.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="cc46a-146">For more information, see [Lambda Expressions](../../../../../csharp/language-reference/operators/lambda-expressions.md).</span></span> <span data-ttu-id="cc46a-147">メソッドベースの構文の使用方法を示す例については、次のトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="cc46a-147">For examples that demonstrate how to use method-based syntax, see the following topics:</span></span>  
  
- [<span data-ttu-id="cc46a-148">メソッド ベースのクエリ構文例: 射影</span><span class="sxs-lookup"><span data-stu-id="cc46a-148">Method-Based Query Syntax Examples: Projection</span></span>](method-based-query-syntax-examples-projection.md)  
  
- [<span data-ttu-id="cc46a-149">メソッド ベースのクエリ構文例: フィルター処理</span><span class="sxs-lookup"><span data-stu-id="cc46a-149">Method-Based Query Syntax Examples: Filtering</span></span>](method-based-query-syntax-examples-filtering.md)  
  
- [<span data-ttu-id="cc46a-150">メソッド ベースのクエリ構文例: 並べ替え</span><span class="sxs-lookup"><span data-stu-id="cc46a-150">Method-Based Query Syntax Examples: Ordering</span></span>](method-based-query-syntax-examples-ordering.md)  
  
- [<span data-ttu-id="cc46a-151">メソッド ベースのクエリ構文例: 集計演算子</span><span class="sxs-lookup"><span data-stu-id="cc46a-151">Method-Based Query Syntax Examples: Aggregate Operators</span></span>](method-based-query-syntax-examples-aggregate-operators.md)  
  
- [<span data-ttu-id="cc46a-152">メソッド ベースのクエリ構文例: パーティション分割</span><span class="sxs-lookup"><span data-stu-id="cc46a-152">Method-Based Query Syntax Examples: Partitioning</span></span>](method-based-query-syntax-examples-partitioning.md)  
  
- [<span data-ttu-id="cc46a-153">メソッド ベースのクエリ構文例: 変換</span><span class="sxs-lookup"><span data-stu-id="cc46a-153">Method-Based Query Syntax Examples: Conversion</span></span>](method-based-query-syntax-examples-conversion.md)  
  
- [<span data-ttu-id="cc46a-154">メソッド ベースのクエリ構文例: 結合演算子</span><span class="sxs-lookup"><span data-stu-id="cc46a-154">Method-Based Query Syntax Examples: Join Operators</span></span>](method-based-query-syntax-examples-join-operators.md)  
  
- [<span data-ttu-id="cc46a-155">メソッド ベースのクエリ構文例: 要素演算子</span><span class="sxs-lookup"><span data-stu-id="cc46a-155">Method-Based Query Syntax Examples: Element Operators</span></span>](method-based-query-syntax-examples-element-operators.md)  
  
- [<span data-ttu-id="cc46a-156">メソッド ベースのクエリ構文例: グループ化</span><span class="sxs-lookup"><span data-stu-id="cc46a-156">Method-Based Query Syntax Examples: Grouping</span></span>](method-based-query-syntax-examples-grouping.md)  
  
- [<span data-ttu-id="cc46a-157">メソッド ベースのクエリ構文例: リレーションシップのナビゲーション</span><span class="sxs-lookup"><span data-stu-id="cc46a-157">Method-Based Query Syntax Examples: Navigating Relationships</span></span>](method-based-query-syntax-examples-navigating-relationships.md)  
  
## <a name="see-also"></a><span data-ttu-id="cc46a-158">関連項目</span><span class="sxs-lookup"><span data-stu-id="cc46a-158">See also</span></span>

- [<span data-ttu-id="cc46a-159">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="cc46a-159">LINQ to Entities</span></span>](linq-to-entities.md)
- [<span data-ttu-id="cc46a-160">C# の LINQ の概要</span><span class="sxs-lookup"><span data-stu-id="cc46a-160">Getting Started with LINQ in C#</span></span>](../../../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="cc46a-161">Visual Basic の LINQ の概要</span><span class="sxs-lookup"><span data-stu-id="cc46a-161">Getting Started with LINQ in Visual Basic</span></span>](../../../../../visual-basic/programming-guide/concepts/linq/getting-started-with-linq.md)
- [<span data-ttu-id="cc46a-162">EF マージ オプションとコンパイル済みクエリ</span><span class="sxs-lookup"><span data-stu-id="cc46a-162">EF Merge Options and Compiled Queries</span></span>](/archive/blogs/dsimmons/ef-merge-options-and-compiled-queries)
