---
title: データ サービスに対するクエリ (WCF Data Services)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, client library
- WCF Data Services, querying
- WCF Data Services, accessing data
ms.assetid: 823e9444-27aa-4f1f-be8e-0486d67f54c0
ms.openlocfilehash: 99fe377e8fff193c4f8bb566946b95c61c1b3693
ms.sourcegitcommit: 79a2d6a07ba4ed08979819666a0ee6927bbf1b01
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2019
ms.locfileid: "74568881"
---
# <a name="querying-the-data-service-wcf-data-services"></a><span data-ttu-id="aed45-102">データ サービスに対するクエリ (WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="aed45-102">Querying the Data Service (WCF Data Services)</span></span>

<span data-ttu-id="aed45-103">WCF Data Services クライアントライブラリを使用すると、統合言語クエリ (LINQ) を含め、使い慣れた .NET Framework プログラミングパターンを使用して、データサービスに対するクエリを実行できます。</span><span class="sxs-lookup"><span data-stu-id="aed45-103">The WCF Data Services client library enables you to execute queries against a data service by using familiar .NET Framework programming patterns, including using language integrated query (LINQ).</span></span> <span data-ttu-id="aed45-104">このクライアント ライブラリは、クライアント上で <xref:System.Data.Services.Client.DataServiceQuery%601> クラスのインスタンスとして定義されたクエリを HTTP GET 要求メッセージに変換します。</span><span class="sxs-lookup"><span data-stu-id="aed45-104">The client library translates a query, which is defined on the client as an instance of the <xref:System.Data.Services.Client.DataServiceQuery%601> class, into an HTTP GET request message.</span></span> <span data-ttu-id="aed45-105">ライブラリは応答メッセージを受信し、クライアントデータサービスクラスのインスタンスに変換します。</span><span class="sxs-lookup"><span data-stu-id="aed45-105">The library receives the response message and translates it into instances of client data service classes.</span></span> <span data-ttu-id="aed45-106">これらのクラスは、<xref:System.Data.Services.Client.DataServiceContext> が属する <xref:System.Data.Services.Client.DataServiceQuery%601> によって追跡されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-106">These classes are tracked by the <xref:System.Data.Services.Client.DataServiceContext> to which the <xref:System.Data.Services.Client.DataServiceQuery%601> belongs.</span></span>

## <a name="data-service-queries"></a><span data-ttu-id="aed45-107">データ サービス クエリ</span><span class="sxs-lookup"><span data-stu-id="aed45-107">Data Service Queries</span></span>

<span data-ttu-id="aed45-108"><xref:System.Data.Services.Client.DataServiceQuery%601> ジェネリック クラスは、0 個以上のエンティティ型インスタンスのコレクションを返すクエリを表します。</span><span class="sxs-lookup"><span data-stu-id="aed45-108">The <xref:System.Data.Services.Client.DataServiceQuery%601> generic class represents a query that returns a collection of zero or more entity type instances.</span></span> <span data-ttu-id="aed45-109">データ サービス クエリは、常に既存のデータ サービス コンテキストに属します。</span><span class="sxs-lookup"><span data-stu-id="aed45-109">A data service query always belongs to an existing data service context.</span></span> <span data-ttu-id="aed45-110">このコンテキストにより、クエリの作成と実行に必要なサービス URI とメタデータ情報が維持されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-110">This context maintains the service URI and metadata information that is required to compose and execute the query.</span></span>

<span data-ttu-id="aed45-111">**[サービス参照の追加]** ダイアログボックスを使用して、.NET Framework ベースのクライアントアプリケーションにデータサービスを追加すると、<xref:System.Data.Services.Client.DataServiceContext> クラスを継承するエンティティコンテナークラスが作成されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-111">When you use the **Add Service Reference** dialog to add a data service to a .NET Framework-based client application, an entity container class is created that inherits from the <xref:System.Data.Services.Client.DataServiceContext> class.</span></span> <span data-ttu-id="aed45-112">このクラスには、型指定された <xref:System.Data.Services.Client.DataServiceQuery%601> インスタンスを返すプロパティが含まれます。</span><span class="sxs-lookup"><span data-stu-id="aed45-112">This class includes properties that return typed <xref:System.Data.Services.Client.DataServiceQuery%601> instances.</span></span> <span data-ttu-id="aed45-113">データ サービスが公開するエンティティ セットごとに 1 つのプロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="aed45-113">There is one property for each entity set that the data service exposes.</span></span> <span data-ttu-id="aed45-114">これらのプロパティを使用すると、型指定された <xref:System.Data.Services.Client.DataServiceQuery%601> のインスタンスを簡単に作成できます。</span><span class="sxs-lookup"><span data-stu-id="aed45-114">These properties make it easier to create an instance of a typed <xref:System.Data.Services.Client.DataServiceQuery%601>.</span></span>

<span data-ttu-id="aed45-115">クエリは次のシナリオで実行されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-115">A query is executed in the following scenarios:</span></span>

- <span data-ttu-id="aed45-116">次のように結果が暗黙的に列挙される場合</span><span class="sxs-lookup"><span data-stu-id="aed45-116">When results are enumerated implicitly, such as:</span></span>

  - <span data-ttu-id="aed45-117"><xref:System.Data.Services.Client.DataServiceContext> (C#) ループや `foreach` (Visual Basic) ループなどで、エンティティ セットを表す `For Each` のプロパティが列挙されているとき</span><span class="sxs-lookup"><span data-stu-id="aed45-117">When a property on the <xref:System.Data.Services.Client.DataServiceContext> that represents and entity set is enumerated, such as during a `foreach` (C#) or `For Each` (Visual Basic) loop.</span></span>

  - <span data-ttu-id="aed45-118">`List` コレクションにクエリが割り当てられているとき</span><span class="sxs-lookup"><span data-stu-id="aed45-118">When the query is assigned to a `List` collection.</span></span>

- <span data-ttu-id="aed45-119"><xref:System.Data.Services.Client.DataServiceQuery%601.Execute%2A> メソッドまたは <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> メソッドが明示的に呼び出されたとき</span><span class="sxs-lookup"><span data-stu-id="aed45-119">When the <xref:System.Data.Services.Client.DataServiceQuery%601.Execute%2A> or <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> method is explicitly called.</span></span>

- <span data-ttu-id="aed45-120"><xref:System.Linq.Enumerable.First%2A> や <xref:System.Linq.Enumerable.Single%2A> などの LINQ クエリ実行演算子が呼び出されたとき。</span><span class="sxs-lookup"><span data-stu-id="aed45-120">When a LINQ query execution operator, such as <xref:System.Linq.Enumerable.First%2A> or <xref:System.Linq.Enumerable.Single%2A> is called.</span></span>

<span data-ttu-id="aed45-121">次のクエリを実行すると、Northwind データ サービスのすべての `Customers` エンティティが返されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-121">The following query, when it is executed, returns all `Customers` entities in the Northwind data service:</span></span>

[!code-csharp[Astoria Northwind Client#GetAllCustomersSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#getallcustomersspecific)]
[!code-vb[Astoria Northwind Client#GetAllCustomersSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#getallcustomersspecific)]

<span data-ttu-id="aed45-122">詳細については、「[方法: データサービスクエリを実行する](how-to-execute-data-service-queries-wcf-data-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="aed45-122">For more information, see [How to: Execute Data Service Queries](how-to-execute-data-service-queries-wcf-data-services.md).</span></span>

<span data-ttu-id="aed45-123">WCF Data Services クライアントは、でC#*動的*な型を使用する場合など、遅延バインディングオブジェクトのクエリをサポートします。</span><span class="sxs-lookup"><span data-stu-id="aed45-123">The WCF Data Services client supports queries for late-bound objects, such as when you use the *dynamic* type in C#.</span></span> <span data-ttu-id="aed45-124">パフォーマンス上の理由から、データ サービスに対しては常に厳密に型指定されたクエリを作成するようにしてください。</span><span class="sxs-lookup"><span data-stu-id="aed45-124">However, for performance reasons you should always compose strongly-typed queries against the data service.</span></span> <span data-ttu-id="aed45-125"><xref:System.Tuple> 型と動的オブジェクトはクライアントでサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="aed45-125">The <xref:System.Tuple> type and dynamic objects are not supported by the client.</span></span>

## <a name="linq-queries"></a><span data-ttu-id="aed45-126">LINQ クエリ</span><span class="sxs-lookup"><span data-stu-id="aed45-126">LINQ Queries</span></span>

<span data-ttu-id="aed45-127"><xref:System.Data.Services.Client.DataServiceQuery%601> クラスは LINQ で定義された <xref:System.Linq.IQueryable%601> インターフェイスを実装するため、WCF Data Services クライアントライブラリは、エンティティセットデータに対する LINQ クエリを、データサービスリソースに対して評価されるクエリ式を表す URI に変換できます。</span><span class="sxs-lookup"><span data-stu-id="aed45-127">Because the <xref:System.Data.Services.Client.DataServiceQuery%601> class implements the <xref:System.Linq.IQueryable%601> interface defined by LINQ, the WCF Data Services client library is able to transform LINQ queries against entity set data into a URI that represents a query expression evaluated against a data service resource.</span></span> <span data-ttu-id="aed45-128">次の例は、前述の <xref:System.Data.Services.Client.DataServiceQuery%601> と同じ LINQ クエリです。ここでは、輸送費が 30 ドルを超える `Orders` を取得し、その結果を輸送費順に並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="aed45-128">The following example is a LINQ query that is equivalent to the previous <xref:System.Data.Services.Client.DataServiceQuery%601> that returns `Orders` that have a freight cost of more than $30 and orders the results by the freight cost:</span></span>

[!code-csharp[Astoria Northwind Client#AddQueryOptionsLinqSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#addqueryoptionslinqspecific)]
[!code-vb[Astoria Northwind Client#AddQueryOptionsLinqSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#addqueryoptionslinqspecific)]

<span data-ttu-id="aed45-129">この LINQ クエリは、Northwind ベースの[クイックスタート](quickstart-wcf-data-services.md)データサービスに対して実行される次のクエリ URI に変換されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-129">This LINQ query is translated into the following query URI that is executed against the Northwind-based [quickstart](quickstart-wcf-data-services.md) data service:</span></span>

```http
http://localhost:12345/Northwind.svc/Orders?Orderby=ShippedDate&?filter=Freight gt 30
```

> [!NOTE]
> <span data-ttu-id="aed45-130">LINQ 構文で表現できるクエリのセットは、データ サービスによって使用される REST (Representational State Transfer) ベースの URI 構文で有効なクエリのセットよりも範囲が広くなります。</span><span class="sxs-lookup"><span data-stu-id="aed45-130">The set of queries expressible in the LINQ syntax is broader than those enabled in the representational state transfer (REST)-based URI syntax that is used by data services.</span></span> <span data-ttu-id="aed45-131">クエリを対象データ サービスの URI にマップできない場合、<xref:System.NotSupportedException> が発生します。</span><span class="sxs-lookup"><span data-stu-id="aed45-131">A <xref:System.NotSupportedException> is raised when the query cannot be mapped to a URI in the target data service.</span></span>

<span data-ttu-id="aed45-132">詳細については、「 [LINQ の考慮事項](linq-considerations-wcf-data-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="aed45-132">For more information, see [LINQ Considerations](linq-considerations-wcf-data-services.md).</span></span>

## <a name="adding-query-options"></a><span data-ttu-id="aed45-133">クエリ オプションの追加</span><span class="sxs-lookup"><span data-stu-id="aed45-133">Adding Query Options</span></span>

<span data-ttu-id="aed45-134">データサービスクエリは、WCF Data Servicess が提供するすべてのクエリオプションをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="aed45-134">Data service queries support all the query options that WCF Data Servicess provides.</span></span> <span data-ttu-id="aed45-135"><xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> メソッドを呼び出して、クエリ オプションを <xref:System.Data.Services.Client.DataServiceQuery%601> インスタンスに追加します。</span><span class="sxs-lookup"><span data-stu-id="aed45-135">You call the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method to append query options to a <xref:System.Data.Services.Client.DataServiceQuery%601> instance.</span></span> <span data-ttu-id="aed45-136"><xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> は、新しい <xref:System.Data.Services.Client.DataServiceQuery%601> インスタンスを返します。このインスタンスは元のクエリと同等ですが、新しいクエリ オプション セットを含みます。</span><span class="sxs-lookup"><span data-stu-id="aed45-136"><xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> returns a new <xref:System.Data.Services.Client.DataServiceQuery%601> instance that is equivalent to the original query but with the new query option set.</span></span> <span data-ttu-id="aed45-137">次のクエリを実行すると、`Orders` 値でフィルターされ、`Freight` によって降順に並べ替えられた `OrderID` が返されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-137">The following query, when executed, returns `Orders` that are filtered by the `Freight` value and ordered by the `OrderID`, descending:</span></span>

[!code-csharp[Astoria Northwind Client#AddQueryOptionsSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#addqueryoptionsspecific)]
[!code-vb[Astoria Northwind Client#AddQueryOptionsSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#addqueryoptionsspecific)]

<span data-ttu-id="aed45-138">`$orderby` クエリ オプションを使用すると、単一のプロパティに基づくクエリの並べ替えとフィルターの両方が可能です。次の例では、フィルターし、返された `Orders` オブジェクトを `Freight` プロパティの値に基づき並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="aed45-138">You can use the `$orderby` query option to both order and filter a query based on a single property, as in the following example that filters and orders the returned `Orders` objects based on the value of the `Freight` property:</span></span>

[!code-csharp[Astoria Northwind Client#OrderWithFilter](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#orderwithfilter)]
[!code-vb[Astoria Northwind Client#OrderWithFilter](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#orderwithfilter)]

<span data-ttu-id="aed45-139"><xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> メソッドを連続して呼び出すと、複雑なクエリ式を作成できます。</span><span class="sxs-lookup"><span data-stu-id="aed45-139">You can call the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method consecutively to construct complex query expressions.</span></span> <span data-ttu-id="aed45-140">詳細については、「[方法: データサービスクエリにクエリオプションを追加](how-to-add-query-options-to-a-data-service-query-wcf-data-services.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="aed45-140">For more information, see [How to: Add Query Options to a Data Service Query](how-to-add-query-options-to-a-data-service-query-wcf-data-services.md).</span></span>

<span data-ttu-id="aed45-141">クエリ オプションを使用して、LINQ クエリの構文要素を表すことができます。</span><span class="sxs-lookup"><span data-stu-id="aed45-141">Query options give you another way to express the syntactic components of a LINQ query.</span></span> <span data-ttu-id="aed45-142">詳細については、「 [LINQ の考慮事項](linq-considerations-wcf-data-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="aed45-142">For more information, see [LINQ Considerations](linq-considerations-wcf-data-services.md).</span></span>

> [!NOTE]
> <span data-ttu-id="aed45-143">`$select` メソッドを使用してクエリ URI に <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> クエリ オプションを追加することはできません。</span><span class="sxs-lookup"><span data-stu-id="aed45-143">The `$select` query option cannot be added to a query URI by using the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method.</span></span> <span data-ttu-id="aed45-144">LINQ の <xref:System.Linq.Enumerable.Select%2A> メソッドを使用して、クライアントによって要求 URI に `$select` クエリ オプションが生成されるようにすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="aed45-144">We recommend that you use the LINQ <xref:System.Linq.Enumerable.Select%2A> method to have the client generate the `$select` query option in the request URI.</span></span>

<a name="executingQueries"></a>

## <a name="client-versus-server-execution"></a><span data-ttu-id="aed45-145">クライアントでの実行とサーバーでの実行</span><span class="sxs-lookup"><span data-stu-id="aed45-145">Client versus Server Execution</span></span>

<span data-ttu-id="aed45-146">クライアントによるクエリの実行は 2 つの部分に分かれています。</span><span class="sxs-lookup"><span data-stu-id="aed45-146">The client executes a query in two parts.</span></span> <span data-ttu-id="aed45-147">可能な限り、クエリ内の式は最初にクライアントで評価されます。その後、URI ベースのクエリが生成され、データ サービスに送信されて、サービス内のデータに対して評価されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-147">Whenever possible, expressions in a query are first evaluated on the client, and then a URI-based query is generated and sent to the data service for evaluation against data in the service.</span></span> <span data-ttu-id="aed45-148">次の LINQ クエリについて考えてみましょう。</span><span class="sxs-lookup"><span data-stu-id="aed45-148">Consider the following LINQ query:</span></span>

[!code-csharp[Astoria Northwind Client#LinqQueryClientEvalSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#linqqueryclientevalspecific)]
[!code-vb[Astoria Northwind Client#LinqQueryClientEvalSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#linqqueryclientevalspecific)]

<span data-ttu-id="aed45-149">この例では、式 `(basePrice – (basePrice * discount))` はクライアントで評価されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-149">In this example, the expression `(basePrice – (basePrice * discount))` is evaluated on the client.</span></span> <span data-ttu-id="aed45-150">そのため、データ サービスに送信される実際のクエリ URI (`http://localhost:12345/northwind.svc/Products()?$filter=(UnitPrice gt 90.00M) and substringof('bike',ProductName)`) のフィルター句に計算済みの 10 進値 `90` が含まれています。</span><span class="sxs-lookup"><span data-stu-id="aed45-150">Because of this, the actual query URI `http://localhost:12345/northwind.svc/Products()?$filter=(UnitPrice gt 90.00M) and substringof('bike',ProductName)` that is sent to the data service contains the already calculated decimal value of `90` in the filter clause.</span></span> <span data-ttu-id="aed45-151">部分文字列式を含むフィルター式のその他の部分は、データ サービスによって評価されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-151">The other parts of the filtering expression, including the substring expression, are evaluated by the data service.</span></span> <span data-ttu-id="aed45-152">クライアントで評価される式は、共通言語ランタイム (CLR) セマンティクスに従いますが、データサービスに送信される式は、OData プロトコルのデータサービス実装に依存します。</span><span class="sxs-lookup"><span data-stu-id="aed45-152">Expressions that are evaluated on the client follow common language runtime (CLR) semantics, while expressions sent to the data service rely on the data service implementation of the OData Protocol.</span></span> <span data-ttu-id="aed45-153">また、このように別々に評価されることで予期しない結果が生じる場合があることにも注意する必要があります。たとえば、クライアントとサービスの両方で、異なるタイム ゾーンを使用して時間に基づく評価が実行される場合があります。</span><span class="sxs-lookup"><span data-stu-id="aed45-153">You should also be aware of scenarios where this separate evaluation may cause unexpected results, such as when both the client and service perform time-based evaluations in different time zones.</span></span>

## <a name="query-responses"></a><span data-ttu-id="aed45-154">クエリ応答</span><span class="sxs-lookup"><span data-stu-id="aed45-154">Query Responses</span></span>

<span data-ttu-id="aed45-155"><xref:System.Data.Services.Client.DataServiceQuery%601> を実行すると、要求したエンティティ型の <xref:System.Collections.Generic.IEnumerable%601> が返されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-155">When executed, the <xref:System.Data.Services.Client.DataServiceQuery%601> returns an <xref:System.Collections.Generic.IEnumerable%601> of the requested entity type.</span></span> <span data-ttu-id="aed45-156">このクエリ結果は、次の例のように <xref:System.Data.Services.Client.QueryOperationResponse%601> オブジェクトにキャストできます。</span><span class="sxs-lookup"><span data-stu-id="aed45-156">This query result can be cast to a <xref:System.Data.Services.Client.QueryOperationResponse%601> object, as in the following example:</span></span>

[!code-csharp[Astoria Northwind Client#GetResponseSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#getresponsespecific)]
[!code-vb[Astoria Northwind Client#GetResponseSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#getresponsespecific)]

<span data-ttu-id="aed45-157">データ サービスのエンティティを表すエンティティ型インスタンスは、オブジェクトの具体化というプロセスによってクライアントで作成されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-157">The entity type instances that represent entities in the data service are created on the client by a process called object materialization.</span></span> <span data-ttu-id="aed45-158">詳細については、「[オブジェクトの具体化](object-materialization-wcf-data-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="aed45-158">For more information, see [Object Materialization](object-materialization-wcf-data-services.md).</span></span> <span data-ttu-id="aed45-159"><xref:System.Data.Services.Client.QueryOperationResponse%601> オブジェクトは、<xref:System.Collections.Generic.IEnumerable%601> を実装してクエリ結果へのアクセスを提供します。</span><span class="sxs-lookup"><span data-stu-id="aed45-159">The <xref:System.Data.Services.Client.QueryOperationResponse%601> object implements <xref:System.Collections.Generic.IEnumerable%601> to provide access to the results of the query.</span></span>

<span data-ttu-id="aed45-160">さらに、<xref:System.Data.Services.Client.QueryOperationResponse%601> には、クエリ結果に関する追加情報へのアクセスを可能にする次のメンバーが含まれます。</span><span class="sxs-lookup"><span data-stu-id="aed45-160">The <xref:System.Data.Services.Client.QueryOperationResponse%601> also has the following members that enable you to access additional information about a query result:</span></span>

- <span data-ttu-id="aed45-161"><xref:System.Data.Services.Client.OperationResponse.Error%2A> - 発生すると、操作によってエラーがスローされます。</span><span class="sxs-lookup"><span data-stu-id="aed45-161"><xref:System.Data.Services.Client.OperationResponse.Error%2A> - gets an error thrown by the operation, if any has occurred.</span></span>

- <span data-ttu-id="aed45-162"><xref:System.Data.Services.Client.OperationResponse.Headers%2A> - クエリ応答に関連する HTTP 応答ヘッダーのコレクションが含まれます。</span><span class="sxs-lookup"><span data-stu-id="aed45-162"><xref:System.Data.Services.Client.OperationResponse.Headers%2A> - contains the collection of HTTP response headers associated with the query response.</span></span>

- <span data-ttu-id="aed45-163"><xref:System.Data.Services.Client.QueryOperationResponse.Query%2A> - <xref:System.Data.Services.Client.DataServiceQuery%601> を生成した元の <xref:System.Data.Services.Client.QueryOperationResponse%601> を取得します。</span><span class="sxs-lookup"><span data-stu-id="aed45-163"><xref:System.Data.Services.Client.QueryOperationResponse.Query%2A> - gets the original <xref:System.Data.Services.Client.DataServiceQuery%601> that generated the <xref:System.Data.Services.Client.QueryOperationResponse%601>.</span></span>

- <span data-ttu-id="aed45-164"><xref:System.Data.Services.Client.OperationResponse.StatusCode%2A> - クエリ応答の HTTP 応答コードを取得します。</span><span class="sxs-lookup"><span data-stu-id="aed45-164"><xref:System.Data.Services.Client.OperationResponse.StatusCode%2A> - gets the HTTP response code for the query response.</span></span>

- <span data-ttu-id="aed45-165"><xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A> - <xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A> で <xref:System.Data.Services.Client.DataServiceQuery%601> メソッドが呼び出されるとエンティティ セット内のエンティティの合計数を取得します。</span><span class="sxs-lookup"><span data-stu-id="aed45-165"><xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A> - gets the total number of entities in the entity set when the <xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A> method was called on the <xref:System.Data.Services.Client.DataServiceQuery%601>.</span></span>

- <span data-ttu-id="aed45-166"><xref:System.Data.Services.Client.QueryOperationResponse.GetContinuation%2A> - 結果の次のページの URI を含む <xref:System.Data.Services.Client.DataServiceQueryContinuation> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="aed45-166"><xref:System.Data.Services.Client.QueryOperationResponse.GetContinuation%2A> - returns a <xref:System.Data.Services.Client.DataServiceQueryContinuation> object that contains the URI of the next page of results.</span></span>

<span data-ttu-id="aed45-167">既定では、WCF Data Services は、クエリ URI によって明示的に選択されたデータのみを返します。</span><span class="sxs-lookup"><span data-stu-id="aed45-167">By default, WCF Data Services only returns data that is explicitly selected by the query URI.</span></span> <span data-ttu-id="aed45-168">これにより、必要に応じてデータ サービスから追加のデータを明示的に読み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="aed45-168">This gives you the option to explicitly load additional data from the data service when it is needed.</span></span> <span data-ttu-id="aed45-169">データ サービスからデータを明示的に読み込むたびに要求がデータ サービスに送られます。</span><span class="sxs-lookup"><span data-stu-id="aed45-169">A request is sent to the data service each time you explicitly load data from the data service.</span></span> <span data-ttu-id="aed45-170">明示的に読み込むことができるデータには、関連エンティティ、ページングされた応答データ、バイナリ データ ストリームがあります。</span><span class="sxs-lookup"><span data-stu-id="aed45-170">Data that can be explicitly loaded includes related entities, paged response data, and binary data streams.</span></span>

> [!NOTE]
> <span data-ttu-id="aed45-171">データ サービスはページングされた応答を返す場合があるので、アプリケーションではページングされたデータ サービス応答を処理するプログラミング パターンを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="aed45-171">Because a data service may return a paged response, we recommend that your application use the programming pattern to handle a paged data service response.</span></span> <span data-ttu-id="aed45-172">詳細については、「[遅延コンテンツの読み込み](loading-deferred-content-wcf-data-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="aed45-172">For more information, see [Loading Deferred Content](loading-deferred-content-wcf-data-services.md).</span></span>

<span data-ttu-id="aed45-173">エンティティの特定のプロパティのみが応答で返されるように指定することにより、クエリによって返されるデータの量を削減することもできます。</span><span class="sxs-lookup"><span data-stu-id="aed45-173">The amount of data returned by a query can also be reduced by specifying that only certain properties of an entity are returned in the response.</span></span> <span data-ttu-id="aed45-174">詳細については、「[クエリプロジェクション](query-projections-wcf-data-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="aed45-174">For more information, see [Query Projections](query-projections-wcf-data-services.md).</span></span>

## <a name="getting-a-count-of-the-total-number-of-entities-in-the-set"></a><span data-ttu-id="aed45-175">セット内のエンティティの合計数の取得</span><span class="sxs-lookup"><span data-stu-id="aed45-175">Getting a Count of the Total Number of Entities in the Set</span></span>

<span data-ttu-id="aed45-176">一部のシナリオでは、クエリによって返される数だけではなく、エンティティ セット内のエンティティの合計数を知っておくと役立ちます。</span><span class="sxs-lookup"><span data-stu-id="aed45-176">In some scenarios, it is helpful to know the total number of entities in an entity set and not merely the number returned by the query.</span></span> <span data-ttu-id="aed45-177">このセット内のエンティティの合計数がクエリ結果に含まれるように要求するには、<xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A> で <xref:System.Data.Services.Client.DataServiceQuery%601> メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="aed45-177">Call the <xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A> method on the <xref:System.Data.Services.Client.DataServiceQuery%601> to request that this total count of entities in the set be included with the query result.</span></span> <span data-ttu-id="aed45-178">この場合、返された <xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A> の <xref:System.Data.Services.Client.QueryOperationResponse%601> プロパティが、セット内のエンティティの合計数を返します。</span><span class="sxs-lookup"><span data-stu-id="aed45-178">In this case, the <xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A> property of the returned <xref:System.Data.Services.Client.QueryOperationResponse%601> returns the total number of entities in the set.</span></span>

<span data-ttu-id="aed45-179">さらに、<xref:System.Int32> メソッドまたは <xref:System.Int64> メソッドを呼び出すことにより、それぞれ <xref:System.Linq.Enumerable.Count%2A> 値または <xref:System.Linq.Enumerable.LongCount%2A> 値として、セット内のエンティティの合計数のみを取得することもできます。</span><span class="sxs-lookup"><span data-stu-id="aed45-179">You can also get only the total count of entities in the set either as an <xref:System.Int32> or as a <xref:System.Int64> value by calling the <xref:System.Linq.Enumerable.Count%2A> or <xref:System.Linq.Enumerable.LongCount%2A> methods respectively.</span></span> <span data-ttu-id="aed45-180">これらのメソッドを呼び出すと、<xref:System.Data.Services.Client.QueryOperationResponse%601> は返されず、カウント値のみが返されます。</span><span class="sxs-lookup"><span data-stu-id="aed45-180">When these methods are called, a <xref:System.Data.Services.Client.QueryOperationResponse%601> is not returned; only the count value is returned.</span></span> <span data-ttu-id="aed45-181">詳細については、「[方法: クエリによって返されるエンティティの数を確認する](number-of-entities-returned-by-a-query-wcf.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="aed45-181">For more information, see [How to: Determine the Number of Entities Returned by a Query](number-of-entities-returned-by-a-query-wcf.md).</span></span>

## <a name="in-this-section"></a><span data-ttu-id="aed45-182">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="aed45-182">In This Section</span></span>

- [<span data-ttu-id="aed45-183">クエリ射影</span><span class="sxs-lookup"><span data-stu-id="aed45-183">Query Projections</span></span>](query-projections-wcf-data-services.md)

- [<span data-ttu-id="aed45-184">オブジェクトの具体化</span><span class="sxs-lookup"><span data-stu-id="aed45-184">Object Materialization</span></span>](object-materialization-wcf-data-services.md)

- [<span data-ttu-id="aed45-185">LINQ に関する留意点</span><span class="sxs-lookup"><span data-stu-id="aed45-185">LINQ Considerations</span></span>](linq-considerations-wcf-data-services.md)

- [<span data-ttu-id="aed45-186">方法: データ サービス クエリを実行する</span><span class="sxs-lookup"><span data-stu-id="aed45-186">How to: Execute Data Service Queries</span></span>](how-to-execute-data-service-queries-wcf-data-services.md)

- [<span data-ttu-id="aed45-187">方法: データ サービス クエリにクエリ オプションを追加する</span><span class="sxs-lookup"><span data-stu-id="aed45-187">How to: Add Query Options to a Data Service Query</span></span>](how-to-add-query-options-to-a-data-service-query-wcf-data-services.md)

- [<span data-ttu-id="aed45-188">方法: クエリで返されたエンティティの数を確認する</span><span class="sxs-lookup"><span data-stu-id="aed45-188">How to: Determine the Number of Entities Returned by a Query</span></span>](number-of-entities-returned-by-a-query-wcf.md)

- [<span data-ttu-id="aed45-189">方法: データ サービス要求のクライアント資格情報の指定</span><span class="sxs-lookup"><span data-stu-id="aed45-189">How to: Specify Client Credentials for a Data Service Request</span></span>](specify-client-creds-for-a-data-service-request-wcf.md)

- [<span data-ttu-id="aed45-190">方法: クライアント要求のヘッダーを設定する</span><span class="sxs-lookup"><span data-stu-id="aed45-190">How to: Set Headers in the Client Request</span></span>](how-to-set-headers-in-the-client-request-wcf-data-services.md)

- [<span data-ttu-id="aed45-191">方法: クエリ結果を射影する</span><span class="sxs-lookup"><span data-stu-id="aed45-191">How to: Project Query Results</span></span>](how-to-project-query-results-wcf-data-services.md)

## <a name="see-also"></a><span data-ttu-id="aed45-192">参照</span><span class="sxs-lookup"><span data-stu-id="aed45-192">See also</span></span>

- [<span data-ttu-id="aed45-193">WCF Data Services クライアント ライブラリ</span><span class="sxs-lookup"><span data-stu-id="aed45-193">WCF Data Services Client Library</span></span>](wcf-data-services-client-library.md)
