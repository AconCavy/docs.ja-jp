---
title: Winmdexp.exe (Windows ランタイム メタデータのエクスポート ツール)
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Runtime Metadata Export Tool
- Winmdexp.exe
ms.assetid: d2ce0683-343d-403e-bb8d-209186f7a19d
ms.openlocfilehash: 52820b78f6ed7b02e80df66f90a01143b31d9b29
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/15/2020
ms.locfileid: "74447280"
---
# <a name="winmdexpexe-windows-runtime-metadata-export-tool"></a><span data-ttu-id="73974-102">Winmdexp.exe (Windows ランタイム メタデータのエクスポート ツール)</span><span class="sxs-lookup"><span data-stu-id="73974-102">Winmdexp.exe (Windows Runtime Metadata Export Tool)</span></span>
<span data-ttu-id="73974-103">Windows ランタイム メタデータ エクスポート ツール (Winmdexp.exe) は、.NET Framework モジュールを、Windows メタデータを含むファイルに変換します。</span><span class="sxs-lookup"><span data-stu-id="73974-103">The Windows Runtime Metadata Export Tool (Winmdexp.exe) transforms a .NET Framework module into a file that contains Windows Runtime metadata.</span></span> <span data-ttu-id="73974-104">.NET Framework アセンブリと Windows ランタイム メタデータ ファイルでは同じ物理形式が使用されますが、メタデータ テーブルの内容に違いがあります。つまり、NET Framework アセンブリは自動的に Windows ランタイム コンポーネントとして使用できるわけではありません。</span><span class="sxs-lookup"><span data-stu-id="73974-104">Although .NET Framework assemblies and Windows Runtime metadata files use the same physical format, there are differences in the content of the metadata tables, which means that .NET Framework assemblies are not automatically usable as Windows Runtime Components.</span></span> <span data-ttu-id="73974-105">.NET Framework モジュールを Windows ランタイム コンポーネントに変換するプロセスは、"*エクスポート*" と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="73974-105">The process of turning a .NET Framework module into a Windows Runtime component is referred to as *exporting*.</span></span> <span data-ttu-id="73974-106">.NET Framework 4.5 と .NET Framework 4.5.1 では、結果として生成される Windows メタデータ (.winmd) ファイルにメタデータと実装の両方が含まれます。</span><span class="sxs-lookup"><span data-stu-id="73974-106">In the .NET Framework 4.5 and .NET Framework 4.5.1, the resulting Windows metadata (.winmd) file contains both metadata and implementation.</span></span>  
  
 <span data-ttu-id="73974-107">Visual Studio 2013 または Visual Studio 2012 で、C# および Visual Basic の **Windows ストア**にある **Windows ランタイム コンポーネント** テンプレートを使用する場合、コンパイラのターゲットは .winmdobj ファイルであり、後続のビルド ステップで Winmdexp.exe が呼び出され、.winmdobj ファイルが .winmd ファイルにエクスポートされます。</span><span class="sxs-lookup"><span data-stu-id="73974-107">When you use the **Windows Runtime Component** template, which is located under **Windows Store** for C# and Visual Basic in Visual Studio 2013 or Visual Studio 2012, the compiler target is a .winmdobj file, and a subsequent build step calls Winmdexp.exe to export the .winmdobj file to a .winmd file.</span></span> <span data-ttu-id="73974-108">Windows ランタイム コンポーネントをビルドする場合は、この方法をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="73974-108">This is the recommended way to build a Windows Runtime component.</span></span> <span data-ttu-id="73974-109">Visual Studio による制御より細かくビルド プロセスを制御する場合は、Winmdexp.exe ファイルを直接使用します。</span><span class="sxs-lookup"><span data-stu-id="73974-109">Use Winmdexp.exe directly when you want more control over the build process than Visual Studio provides.</span></span>  
  
 <span data-ttu-id="73974-110">このツールは、Visual Studio と共に自動的にインストールされます。</span><span class="sxs-lookup"><span data-stu-id="73974-110">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="73974-111">このツールを実行するには、Visual Studio 用開発者コマンド プロンプト (または Windows 7 の Visual Studio コマンド プロンプト) を使用します。</span><span class="sxs-lookup"><span data-stu-id="73974-111">To run the tool, use the Developer Command Prompt for Visual Studio (or the Visual Studio Command Prompt in Windows 7).</span></span> <span data-ttu-id="73974-112">詳細については、「[コマンド プロンプト](developer-command-prompt-for-vs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="73974-112">For more information, see [Command Prompts](developer-command-prompt-for-vs.md).</span></span>  
  
 <span data-ttu-id="73974-113">コマンド プロンプトに次のように入力します。</span><span class="sxs-lookup"><span data-stu-id="73974-113">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="73974-114">構文</span><span class="sxs-lookup"><span data-stu-id="73974-114">Syntax</span></span>  
  
```console  
winmdexp [options] winmdmodule  
```  
  
## <a name="parameters"></a><span data-ttu-id="73974-115">パラメーター</span><span class="sxs-lookup"><span data-stu-id="73974-115">Parameters</span></span>  
  
|<span data-ttu-id="73974-116">引数またはオプション</span><span class="sxs-lookup"><span data-stu-id="73974-116">Argument or option</span></span>|<span data-ttu-id="73974-117">[説明]</span><span class="sxs-lookup"><span data-stu-id="73974-117">Description</span></span>|  
|------------------------|-----------------|  
|`winmdmodule`|<span data-ttu-id="73974-118">エクスポートするモジュール (.winmdobj) を指定します。</span><span class="sxs-lookup"><span data-stu-id="73974-118">Specifies the module (.winmdobj) to be exported.</span></span> <span data-ttu-id="73974-119">指定できるのは 1 つのモジュールのみです。</span><span class="sxs-lookup"><span data-stu-id="73974-119">Only one module is allowed.</span></span> <span data-ttu-id="73974-120">このモジュールを作成するには、`/target` ターゲットと共に `winmdobj` コンパイラ オプションを使用します。</span><span class="sxs-lookup"><span data-stu-id="73974-120">To create this module, use the `/target` compiler option with the `winmdobj` target.</span></span> <span data-ttu-id="73974-121">「[-target:winmdobj (C# コンパイラ オプション)](../../csharp/language-reference/compiler-options/target-winmdobj-compiler-option.md)」または「[-target (Visual Basic)](../../visual-basic/reference/command-line-compiler/target.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="73974-121">See [-target:winmdobj (C# Compiler Options)](../../csharp/language-reference/compiler-options/target-winmdobj-compiler-option.md) or [-target (Visual Basic)](../../visual-basic/reference/command-line-compiler/target.md).</span></span>|  
|<span data-ttu-id="73974-122">`/docfile:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="73974-122">`/docfile:` `docfile`</span></span><br /><br /> <span data-ttu-id="73974-123">`/d:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="73974-123">`/d:` `docfile`</span></span>|<span data-ttu-id="73974-124">Winmdexp.exe が生成する出力 XML ドキュメント ファイルを指定します。</span><span class="sxs-lookup"><span data-stu-id="73974-124">Specifies the output XML documentation file that Winmdexp.exe will produce.</span></span> <span data-ttu-id="73974-125">.NET Framework 4.5 では、出力ファイルは基本的に入力 XML ドキュメント ファイルと同じです。</span><span class="sxs-lookup"><span data-stu-id="73974-125">In the .NET Framework 4.5, the output file is essentially the same as the input XML documentation file.</span></span>|  
|<span data-ttu-id="73974-126">`/moduledoc:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="73974-126">`/moduledoc:` `docfile`</span></span><br /><br /> <span data-ttu-id="73974-127">`/md:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="73974-127">`/md:` `docfile`</span></span>|<span data-ttu-id="73974-128">コンパイラが `winmdmodule` と共に生成した XML ドキュメント ファイルの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="73974-128">Specifies the name of the XML documentation file that the compiler produced with `winmdmodule`.</span></span>|  
|<span data-ttu-id="73974-129">`/modulepdb:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="73974-129">`/modulepdb:` `symbolfile`</span></span><br /><br /> <span data-ttu-id="73974-130">`/mp:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="73974-130">`/mp:` `symbolfile`</span></span>|<span data-ttu-id="73974-131">`winmdmodule` のシンボルを含むプログラム データベース (PDB) ファイルの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="73974-131">Specifies the name of the program database (PDB) file that contains symbols for `winmdmodule`.</span></span>|  
|<span data-ttu-id="73974-132">`/nowarn:` `warning`</span><span class="sxs-lookup"><span data-stu-id="73974-132">`/nowarn:` `warning`</span></span>|<span data-ttu-id="73974-133">指定した警告番号が使用されなくなります。</span><span class="sxs-lookup"><span data-stu-id="73974-133">Suppresses the specified warning number.</span></span> <span data-ttu-id="73974-134">*warning* の場合は、エラー コードの数字部分だけを先行ゼロなしで指定してください。</span><span class="sxs-lookup"><span data-stu-id="73974-134">For *warning*, supply only the numeric portion of the error code, without leading zeros.</span></span>|  
|<span data-ttu-id="73974-135">`/out:` `file`</span><span class="sxs-lookup"><span data-stu-id="73974-135">`/out:` `file`</span></span><br /><br /> <span data-ttu-id="73974-136">`/o:` `file`</span><span class="sxs-lookup"><span data-stu-id="73974-136">`/o:` `file`</span></span>|<span data-ttu-id="73974-137">出力 Windows メタデータ (.winmd) ファイルの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="73974-137">Specifies the name of the output Windows metadata (.winmd) file.</span></span>|  
|<span data-ttu-id="73974-138">`/pdb:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="73974-138">`/pdb:` `symbolfile`</span></span><br /><br /> <span data-ttu-id="73974-139">`/p:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="73974-139">`/p:` `symbolfile`</span></span>|<span data-ttu-id="73974-140">エクスポートされた Windows メタデータ (.winmd) ファイルのシンボルを含む出力プログラム データベース (PDB) ファイルの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="73974-140">Specifies the name of the output program database (PDB) file that will contain the symbols for the exported Windows metadata (.winmd) file.</span></span>|  
|<span data-ttu-id="73974-141">`/reference:` `winmd`</span><span class="sxs-lookup"><span data-stu-id="73974-141">`/reference:` `winmd`</span></span><br /><br /> <span data-ttu-id="73974-142">`/r:` `winmd`</span><span class="sxs-lookup"><span data-stu-id="73974-142">`/r:` `winmd`</span></span>|<span data-ttu-id="73974-143">エクスポート時に参照するメタデータ ファイル (.winmd またはアセンブリ) を指定します。</span><span class="sxs-lookup"><span data-stu-id="73974-143">Specifies a metadata file (.winmd or assembly) to reference during export.</span></span> <span data-ttu-id="73974-144">「\Program Files (x86)\Reference Assemblies\Microsoft\Framework\\.NETCore\v4.5」(32 ビット コンピューターでは「\Program Files\\...」) にある参照アセンブリを使用する場合は、System.Runtime.dll と mscorlib.dll の両方への参照を含めます。</span><span class="sxs-lookup"><span data-stu-id="73974-144">If you use the reference assemblies in "\Program Files (x86)\Reference Assemblies\Microsoft\Framework\\.NETCore\v4.5" ("\Program Files\\..." on 32-bit computers), include references to both System.Runtime.dll and mscorlib.dll.</span></span>|  
|`/utf8output`|<span data-ttu-id="73974-145">UTF-8 エンコードでメッセージが出力される必要があることを指定します。</span><span class="sxs-lookup"><span data-stu-id="73974-145">Specifies that output messages should be in UTF-8 encoding.</span></span>|  
|`/warnaserror+`|<span data-ttu-id="73974-146">すべての警告をエラーとして扱うよう指定しています。</span><span class="sxs-lookup"><span data-stu-id="73974-146">Specifies that all warnings should be treated as errors.</span></span>|  
|<span data-ttu-id="73974-147">**@** `responsefile`</span><span class="sxs-lookup"><span data-stu-id="73974-147">**@** `responsefile`</span></span>|<span data-ttu-id="73974-148">オプション (および、必要に応じて `winmdmodule`) を含む応答 (.rsp) ファイルを指定します。</span><span class="sxs-lookup"><span data-stu-id="73974-148">Specifies a response (.rsp) file that contains options (and optionally `winmdmodule`).</span></span> <span data-ttu-id="73974-149">`responsefile` の各行に 1 つの引数またはオプションが含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="73974-149">Each line in `responsefile` should contain a single argument or option.</span></span>|  
  
## <a name="remarks"></a><span data-ttu-id="73974-150">解説</span><span class="sxs-lookup"><span data-stu-id="73974-150">Remarks</span></span>  
 <span data-ttu-id="73974-151">Winmdexp.exe は、任意の .NET Framework アセンブリを .winmd ファイルに変換するようには設計されていません。</span><span class="sxs-lookup"><span data-stu-id="73974-151">Winmdexp.exe is not designed to convert an arbitrary .NET Framework assembly to a .winmd file.</span></span> <span data-ttu-id="73974-152">`/target:winmdobj` オプションでコンパイルされるモジュールが必要で、追加の制限が適用されます。</span><span class="sxs-lookup"><span data-stu-id="73974-152">It requires a module that is compiled with the `/target:winmdobj` option, and additional restrictions apply.</span></span> <span data-ttu-id="73974-153">この中で最も重要な制限は、アセンブリの API サーフェスで公開されるすべての型は必ず Windows ランタイム型であるということです。</span><span class="sxs-lookup"><span data-stu-id="73974-153">The most important of these restrictions is that all types that are exposed in the API surface of the assembly must be Windows Runtime types.</span></span> <span data-ttu-id="73974-154">詳細については、「[C# および Visual Basic での Windows ランタイム コンポーネントの作成](https://docs.microsoft.com/previous-versions/br230301(v=vs.110))」という記事の「Windows ランタイム コンポーネントの宣言型」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="73974-154">For more information, see the "Declaring types in Windows Runtime Components" section of the article [Creating Windows Runtime Components in C# and Visual Basic](https://docs.microsoft.com/previous-versions/br230301(v=vs.110)).</span></span>
  
 <span data-ttu-id="73974-155">C# または Visual Basic で Windows 8.x Store アプリまたは Windows ランタイム コンポーネントを作成する場合は、Windows ランタイムでのプログラミングをより自然にするためのサポートが .NET Framework で提供されています。</span><span class="sxs-lookup"><span data-stu-id="73974-155">When you write a Windows 8.x Store app or a Windows Runtime component with C# or Visual Basic, the .NET Framework provides support to make programming with the Windows Runtime more natural.</span></span> <span data-ttu-id="73974-156">これは、記事「[Windows ストア アプリおよび Windows ランタイムのための .NET Framework サポート](../../standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md)」で解説されています。</span><span class="sxs-lookup"><span data-stu-id="73974-156">This is discussed in the article [.NET Framework Support for Windows Store Apps and Windows Runtime](../../standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md).</span></span> <span data-ttu-id="73974-157">プロセスでは、一般的に使用される Windows ランタイム型が .NET Framework 型にマップされます。</span><span class="sxs-lookup"><span data-stu-id="73974-157">In the process, some commonly used Windows Runtime types are mapped to .NET Framework types.</span></span> <span data-ttu-id="73974-158">Winmdexp.exe では、このプロセスが反転され、対応する Windows ランタイム型を使用する API サーフェスが生成されます。</span><span class="sxs-lookup"><span data-stu-id="73974-158">Winmdexp.exe reverses this process and produces an API surface that uses the corresponding Windows Runtime types.</span></span> <span data-ttu-id="73974-159">たとえば、<xref:System.Collections.Generic.IList%601> インターフェイスから構築された型は、Windows ランタイムの <xref:Windows.Foundation.Collections.IVector%601> インターフェイスから構築された型にマップされます。</span><span class="sxs-lookup"><span data-stu-id="73974-159">For example, types that are constructed from the <xref:System.Collections.Generic.IList%601> interface map to types that are constructed from the Windows Runtime <xref:Windows.Foundation.Collections.IVector%601> interface.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="73974-160">参照</span><span class="sxs-lookup"><span data-stu-id="73974-160">See also</span></span>

- [<span data-ttu-id="73974-161">Windows ストア アプリおよび Windows ランタイムのための .NET Framework サポート</span><span class="sxs-lookup"><span data-stu-id="73974-161">.NET Framework Support for Windows Store Apps and Windows Runtime</span></span>](../../standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md)
- <span data-ttu-id="73974-162">[C# および Visual Basic での Windows ランタイム コンポーネントの作成](https://docs.microsoft.com/previous-versions/br230301(v=vs.110))</span><span class="sxs-lookup"><span data-stu-id="73974-162">[Creating Windows Runtime Components in C# and Visual Basic](https://docs.microsoft.com/previous-versions/br230301(v=vs.110))</span></span>
- [<span data-ttu-id="73974-163">Winmdexp.exe のエラー メッセージ</span><span class="sxs-lookup"><span data-stu-id="73974-163">Winmdexp.exe Error Messages</span></span>](winmdexp-exe-error-messages.md)
- <span data-ttu-id="73974-164">[ビルド ツール、配置ツール、および構成ツール (.NET Framework)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd233108(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="73974-164">[Build, Deployment, and Configuration Tools (.NET Framework)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd233108(v=vs.100))</span></span>
