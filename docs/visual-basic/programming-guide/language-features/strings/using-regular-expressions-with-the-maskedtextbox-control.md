---
title: MaskedTextBox コントロールによる正規表現を使用する
ms.date: 07/20/2015
helpviewer_keywords:
- strings [Visual Basic], regular expressions
- strings [Visual Basic], masked edit
ms.assetid: 2a048fb0-7053-487d-b2c5-ffa5e22ed6f9
ms.openlocfilehash: b997f6f495fca51e888bb995fee0361d29d68048
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/12/2020
ms.locfileid: "79148285"
---
# <a name="using-regular-expressions-with-the-maskedtextbox-control-in-visual-basic"></a><span data-ttu-id="44ec9-102">Visual Basic の MaskedTextBox コントロールによる正規表現を使用する</span><span class="sxs-lookup"><span data-stu-id="44ec9-102">Using Regular Expressions with the MaskedTextBox Control in Visual Basic</span></span>
<span data-ttu-id="44ec9-103">この例では、コントロールを使用するために単純な正規表現を変換する<xref:System.Windows.Forms.MaskedTextBox>方法を示します。</span><span class="sxs-lookup"><span data-stu-id="44ec9-103">This example demonstrates how to convert simple regular expressions to work with the <xref:System.Windows.Forms.MaskedTextBox> control.</span></span>  
  
## <a name="description-of-the-masking-language"></a><span data-ttu-id="44ec9-104">マスキング言語の説明</span><span class="sxs-lookup"><span data-stu-id="44ec9-104">Description of the Masking Language</span></span>  
 <span data-ttu-id="44ec9-105">標準<xref:System.Windows.Forms.MaskedTextBox>のマスク言語は、Visual Basic 6.0`Masked Edit`のコントロールで使用される言語に基づいており、そのプラットフォームから移行するユーザーになじみのあるものにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="44ec9-105">The standard <xref:System.Windows.Forms.MaskedTextBox> masking language is based on the one used by the `Masked Edit` control in Visual Basic 6.0 and should be familiar to users migrating from that platform.</span></span>  
  
 <span data-ttu-id="44ec9-106">コントロール<xref:System.Windows.Forms.MaskedTextBox.Mask%2A>のプロパティは<xref:System.Windows.Forms.MaskedTextBox>、使用する定型入力を指定します。</span><span class="sxs-lookup"><span data-stu-id="44ec9-106">The <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property of the <xref:System.Windows.Forms.MaskedTextBox> control specifies what input mask to use.</span></span> <span data-ttu-id="44ec9-107">マスクは、次の表の 1 つ以上のマスク要素で構成される文字列である必要があります。</span><span class="sxs-lookup"><span data-stu-id="44ec9-107">The mask must be a string composed of one or more of the masking elements from the following table.</span></span>  
  
|<span data-ttu-id="44ec9-108">マスキング要素</span><span class="sxs-lookup"><span data-stu-id="44ec9-108">Masking element</span></span>|<span data-ttu-id="44ec9-109">説明</span><span class="sxs-lookup"><span data-stu-id="44ec9-109">Description</span></span>|<span data-ttu-id="44ec9-110">正規表現要素</span><span class="sxs-lookup"><span data-stu-id="44ec9-110">Regular expression element</span></span>|  
|---------------------|-----------------|--------------------------------|  
|<span data-ttu-id="44ec9-111">0</span><span class="sxs-lookup"><span data-stu-id="44ec9-111">0</span></span>|<span data-ttu-id="44ec9-112">0 から 9 までの任意の 1 つの数字。</span><span class="sxs-lookup"><span data-stu-id="44ec9-112">Any single digit between 0 and 9.</span></span> <span data-ttu-id="44ec9-113">入力が必要です。</span><span class="sxs-lookup"><span data-stu-id="44ec9-113">Entry required.</span></span>|<span data-ttu-id="44ec9-114">\d</span><span class="sxs-lookup"><span data-stu-id="44ec9-114">\d</span></span>|  
|<span data-ttu-id="44ec9-115">9</span><span class="sxs-lookup"><span data-stu-id="44ec9-115">9</span></span>|<span data-ttu-id="44ec9-116">数字またはスペース。</span><span class="sxs-lookup"><span data-stu-id="44ec9-116">Digit or space.</span></span> <span data-ttu-id="44ec9-117">入力はオプションです。</span><span class="sxs-lookup"><span data-stu-id="44ec9-117">Entry optional.</span></span>|<span data-ttu-id="44ec9-118">[ \d]?</span><span class="sxs-lookup"><span data-stu-id="44ec9-118">[ \d]?</span></span>|  
|#|<span data-ttu-id="44ec9-119">数字またはスペース。</span><span class="sxs-lookup"><span data-stu-id="44ec9-119">Digit or space.</span></span> <span data-ttu-id="44ec9-120">入力はオプションです。</span><span class="sxs-lookup"><span data-stu-id="44ec9-120">Entry optional.</span></span> <span data-ttu-id="44ec9-121">マスク内でこの位置を空白のままにすると、スペースとしてレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="44ec9-121">If this position is left blank in the mask, it will be rendered as a space.</span></span> <span data-ttu-id="44ec9-122">プラス (+) とマイナス (-) 記号が許可されます。</span><span class="sxs-lookup"><span data-stu-id="44ec9-122">Plus (+) and minus (-) signs are allowed.</span></span>|<span data-ttu-id="44ec9-123">[ \d+-] ?</span><span class="sxs-lookup"><span data-stu-id="44ec9-123">[ \d+-]?</span></span>|  
|<span data-ttu-id="44ec9-124">L</span><span class="sxs-lookup"><span data-stu-id="44ec9-124">L</span></span>|<span data-ttu-id="44ec9-125">ASCII 文字。</span><span class="sxs-lookup"><span data-stu-id="44ec9-125">ASCII letter.</span></span> <span data-ttu-id="44ec9-126">入力が必要です。</span><span class="sxs-lookup"><span data-stu-id="44ec9-126">Entry required.</span></span>|<span data-ttu-id="44ec9-127">[a-zA-Z]</span><span class="sxs-lookup"><span data-stu-id="44ec9-127">[a-zA-Z]</span></span>|  
|<span data-ttu-id="44ec9-128">?</span><span class="sxs-lookup"><span data-stu-id="44ec9-128">?</span></span>|<span data-ttu-id="44ec9-129">ASCII 文字。</span><span class="sxs-lookup"><span data-stu-id="44ec9-129">ASCII letter.</span></span> <span data-ttu-id="44ec9-130">入力はオプションです。</span><span class="sxs-lookup"><span data-stu-id="44ec9-130">Entry optional.</span></span>|<span data-ttu-id="44ec9-131">[a-zA-Z]?</span><span class="sxs-lookup"><span data-stu-id="44ec9-131">[a-zA-Z]?</span></span>|  
|&|<span data-ttu-id="44ec9-132">文字です。</span><span class="sxs-lookup"><span data-stu-id="44ec9-132">Character.</span></span> <span data-ttu-id="44ec9-133">入力が必要です。</span><span class="sxs-lookup"><span data-stu-id="44ec9-133">Entry required.</span></span>|<span data-ttu-id="44ec9-134">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]</span><span class="sxs-lookup"><span data-stu-id="44ec9-134">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]</span></span>|  
|<span data-ttu-id="44ec9-135">C</span><span class="sxs-lookup"><span data-stu-id="44ec9-135">C</span></span>|<span data-ttu-id="44ec9-136">文字です。</span><span class="sxs-lookup"><span data-stu-id="44ec9-136">Character.</span></span> <span data-ttu-id="44ec9-137">入力はオプションです。</span><span class="sxs-lookup"><span data-stu-id="44ec9-137">Entry optional.</span></span>|<span data-ttu-id="44ec9-138">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]?</span><span class="sxs-lookup"><span data-stu-id="44ec9-138">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]?</span></span>|  
|<span data-ttu-id="44ec9-139">A</span><span class="sxs-lookup"><span data-stu-id="44ec9-139">A</span></span>|<span data-ttu-id="44ec9-140">英数字。</span><span class="sxs-lookup"><span data-stu-id="44ec9-140">Alphanumeric.</span></span> <span data-ttu-id="44ec9-141">入力はオプションです。</span><span class="sxs-lookup"><span data-stu-id="44ec9-141">Entry optional.</span></span>|<span data-ttu-id="44ec9-142">\W</span><span class="sxs-lookup"><span data-stu-id="44ec9-142">\W</span></span>|  
|<span data-ttu-id="44ec9-143">.</span><span class="sxs-lookup"><span data-stu-id="44ec9-143">.</span></span>|<span data-ttu-id="44ec9-144">カルチャに適した小数点のプレースホルダー。</span><span class="sxs-lookup"><span data-stu-id="44ec9-144">Culture-appropriate decimal placeholder.</span></span>|<span data-ttu-id="44ec9-145">使用できません。</span><span class="sxs-lookup"><span data-stu-id="44ec9-145">Not available.</span></span>|  
|<span data-ttu-id="44ec9-146">,</span><span class="sxs-lookup"><span data-stu-id="44ec9-146">,</span></span>|<span data-ttu-id="44ec9-147">カルチャに適した千のプレースホルダー。</span><span class="sxs-lookup"><span data-stu-id="44ec9-147">Culture-appropriate thousands placeholder.</span></span>|<span data-ttu-id="44ec9-148">使用できません。</span><span class="sxs-lookup"><span data-stu-id="44ec9-148">Not available.</span></span>|  
|<span data-ttu-id="44ec9-149">:</span><span class="sxs-lookup"><span data-stu-id="44ec9-149">:</span></span>|<span data-ttu-id="44ec9-150">カルチャに適した時刻区切り記号。</span><span class="sxs-lookup"><span data-stu-id="44ec9-150">Culture-appropriate time separator.</span></span>|<span data-ttu-id="44ec9-151">使用できません。</span><span class="sxs-lookup"><span data-stu-id="44ec9-151">Not available.</span></span>|  
|/|<span data-ttu-id="44ec9-152">カルチャに適した日付区切り記号。</span><span class="sxs-lookup"><span data-stu-id="44ec9-152">Culture-appropriate date separator.</span></span>|<span data-ttu-id="44ec9-153">使用できません。</span><span class="sxs-lookup"><span data-stu-id="44ec9-153">Not available.</span></span>|  
|$|<span data-ttu-id="44ec9-154">カルチャに適した通貨記号。</span><span class="sxs-lookup"><span data-stu-id="44ec9-154">Culture-appropriate currency symbol.</span></span>|<span data-ttu-id="44ec9-155">使用できません。</span><span class="sxs-lookup"><span data-stu-id="44ec9-155">Not available.</span></span>|  
|\<|<span data-ttu-id="44ec9-156">その後の文字をすべて小文字に変換します。</span><span class="sxs-lookup"><span data-stu-id="44ec9-156">Converts all characters that follow to lowercase.</span></span>|<span data-ttu-id="44ec9-157">使用できません。</span><span class="sxs-lookup"><span data-stu-id="44ec9-157">Not available.</span></span>|  
|>|<span data-ttu-id="44ec9-158">後に続くすべての文字を大文字に変換します。</span><span class="sxs-lookup"><span data-stu-id="44ec9-158">Converts all characters that follow to uppercase.</span></span>|<span data-ttu-id="44ec9-159">使用できません。</span><span class="sxs-lookup"><span data-stu-id="44ec9-159">Not available.</span></span>|  
|<span data-ttu-id="44ec9-160">&#124;</span><span class="sxs-lookup"><span data-stu-id="44ec9-160">&#124;</span></span>|<span data-ttu-id="44ec9-161">前のシフトを上または下に戻します。</span><span class="sxs-lookup"><span data-stu-id="44ec9-161">Undoes a previous shift up or shift down.</span></span>|<span data-ttu-id="44ec9-162">使用できません。</span><span class="sxs-lookup"><span data-stu-id="44ec9-162">Not available.</span></span>|  
|<span data-ttu-id="44ec9-163">&#92;</span><span class="sxs-lookup"><span data-stu-id="44ec9-163">&#92;</span></span>|<span data-ttu-id="44ec9-164">マスク文字をエスケープしてリテラルに変換します。</span><span class="sxs-lookup"><span data-stu-id="44ec9-164">Escapes a mask character, turning it into a literal.</span></span> <span data-ttu-id="44ec9-165">"\\\\" は、バックスラッシュのエスケープ シーケンスです。</span><span class="sxs-lookup"><span data-stu-id="44ec9-165">"\\\\" is the escape sequence for a backslash.</span></span>|<span data-ttu-id="44ec9-166">&#92;</span><span class="sxs-lookup"><span data-stu-id="44ec9-166">&#92;</span></span>|  
|<span data-ttu-id="44ec9-167">その他のすべての文字。</span><span class="sxs-lookup"><span data-stu-id="44ec9-167">All other characters.</span></span>|<span data-ttu-id="44ec9-168">リテラル。</span><span class="sxs-lookup"><span data-stu-id="44ec9-168">Literals.</span></span> <span data-ttu-id="44ec9-169">マスク以外のすべての要素は、 内<xref:System.Windows.Forms.MaskedTextBox>に自分自身として表示されます。</span><span class="sxs-lookup"><span data-stu-id="44ec9-169">All non-mask elements will appear as themselves within <xref:System.Windows.Forms.MaskedTextBox>.</span></span>|<span data-ttu-id="44ec9-170">その他のすべての文字。</span><span class="sxs-lookup"><span data-stu-id="44ec9-170">All other characters.</span></span>|  
  
 <span data-ttu-id="44ec9-171">10 進数 (.)、1000 分 (,)、時刻 (:)、日付 (/)、通貨 ($) の各シンボルは、既定でアプリケーションのカルチャで定義されているシンボルを表示します。</span><span class="sxs-lookup"><span data-stu-id="44ec9-171">The decimal (.), thousandths (,), time (:), date (/), and currency ($) symbols default to displaying those symbols as defined by the application's culture.</span></span> <span data-ttu-id="44ec9-172">プロパティを使用して、別のカルチャのシンボルを強制的に<xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A>表示できます。</span><span class="sxs-lookup"><span data-stu-id="44ec9-172">You can force them to display symbols for another culture by using the <xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A> property.</span></span>  
  
## <a name="regular-expressions-and-masks"></a><span data-ttu-id="44ec9-173">正規表現とマスク</span><span class="sxs-lookup"><span data-stu-id="44ec9-173">Regular Expressions and Masks</span></span>  
 <span data-ttu-id="44ec9-174">正規表現とマスクを使用してユーザー入力を検証することはできますが、完全に同じではありません。</span><span class="sxs-lookup"><span data-stu-id="44ec9-174">Although you can use regular expressions and masks to validate user input, they are not completely equivalent.</span></span> <span data-ttu-id="44ec9-175">正規表現はマスクよりも複雑なパターンを表現できますが、マスクは同じ情報をより簡潔に、文化的に関連する形式で表現できます。</span><span class="sxs-lookup"><span data-stu-id="44ec9-175">Regular expressions can express more complex patterns than masks, but masks can express the same information more succinctly and in a culturally relevant format.</span></span>  
  
 <span data-ttu-id="44ec9-176">次の表は、4 つの正規表現と、それぞれに対応するマスクを比較しています。</span><span class="sxs-lookup"><span data-stu-id="44ec9-176">The following table compares four regular expressions and the equivalent mask for each.</span></span>  
  
|<span data-ttu-id="44ec9-177">Regular Expression</span><span class="sxs-lookup"><span data-stu-id="44ec9-177">Regular Expression</span></span>|<span data-ttu-id="44ec9-178">Mask</span><span class="sxs-lookup"><span data-stu-id="44ec9-178">Mask</span></span>|<span data-ttu-id="44ec9-179">Notes</span><span class="sxs-lookup"><span data-stu-id="44ec9-179">Notes</span></span>|  
|------------------------|----------|-----------|  
|`\d{2}/\d{2}/\d{4}`|`00/00/0000`|<span data-ttu-id="44ec9-180">マスク`/`内の文字は論理的な日付区切り記号であり、アプリケーションの現在のカルチャに適した日付区切り記号としてユーザーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="44ec9-180">The `/` character in the mask is a logical date separator, and it will appear to the user as the date separator appropriate to the application's current culture.</span></span>|  
|`\d{2}-[A-Z][a-z]{2}-\d{4}`|`00->L<LL-0000`|<span data-ttu-id="44ec9-181">3 文字の月の省略形が、先頭の大文字と小文字の後に続く 2 つの小文字で表示される米国の形式の日付 (日、月の省略形、年) です。</span><span class="sxs-lookup"><span data-stu-id="44ec9-181">A date (day, month abbreviation, and year) in United States format in which the three-letter month abbreviation is displayed with an initial uppercase letter followed by two lowercase letters.</span></span>|  
|`(\(\d{3}\)-)?\d{3}-d{4}`|`(999)-000-0000`|<span data-ttu-id="44ec9-182">米国の電話番号、市外局番はオプションです。</span><span class="sxs-lookup"><span data-stu-id="44ec9-182">United States phone number, area code optional.</span></span> <span data-ttu-id="44ec9-183">ユーザーがオプションの文字を入力しない場合は、スペースを入力するか、最初の 0 で表されるマスク内の位置にマウスポインターを直接置くことができます。</span><span class="sxs-lookup"><span data-stu-id="44ec9-183">If the user does not wish to enter the optional characters, they can either enter spaces or place the mouse pointer directly at the position in the mask represented by the first 0.</span></span>|  
|`$\d{6}.00`|`$999,999.00`|<span data-ttu-id="44ec9-184">0 ~ 999999 の範囲の通貨値。</span><span class="sxs-lookup"><span data-stu-id="44ec9-184">A currency value in the range of 0 to 999999.</span></span> <span data-ttu-id="44ec9-185">通貨、1000 分、および 10 進数の文字は、実行時にカルチャ固有の同等の文字に置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="44ec9-185">The currency, thousandth, and decimal characters will be replaced at run time with their culture-specific equivalents.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="44ec9-186">関連項目</span><span class="sxs-lookup"><span data-stu-id="44ec9-186">See also</span></span>

- <xref:System.Windows.Forms.MaskedTextBox.Mask%2A>
- <xref:System.Windows.Forms.MaskedTextBox>
- [<span data-ttu-id="44ec9-187">Visual Basic における文字列の検証</span><span class="sxs-lookup"><span data-stu-id="44ec9-187">Validating Strings in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/strings/validating-strings.md)
- [<span data-ttu-id="44ec9-188">MaskedTextBox コントロール</span><span class="sxs-lookup"><span data-stu-id="44ec9-188">MaskedTextBox Control</span></span>](../../../../framework/winforms/controls/maskedtextbox-control-windows-forms.md)
