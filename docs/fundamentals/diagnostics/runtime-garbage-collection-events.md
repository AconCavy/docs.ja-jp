---
title: ガベージコレクションランタイムイベント
description: 「.NET ガベージコレクターに固有の診断情報を収集する .NET ランタイムイベント」を参照してください。
ms.date: 11/13/2020
ms.topic: reference
helpviewer_keywords:
- GC events
- garbage collection events (CoreCLR)
- ETW, EventPipe, LTTng garbage collection events (CoreCLR)
ms.openlocfilehash: 2799a93f351baf23ec7a359b0b4b2be5c216dc4d
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/18/2020
ms.locfileid: "96594055"
---
# <a name="net-runtime-garbage-collection-events"></a>.NET ランタイムガベージコレクションイベント

これらのイベントは、ガベージ コレクションに関連する情報を収集します。 ガベージコレクションが実行された回数、ガベージコレクション中に解放されたメモリの量など、診断やデバッグに役立ちます。診断のためにこれらのイベントを使用する方法の詳細については、「 [.net アプリケーションのログ記録とトレース](../../core/diagnostics/logging-tracing.md)」を参照してください。

## <a name="gcstart_v2-event"></a>GCStart_V2 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCStart_V1`|1|ガベージ コレクションが開始されました。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`Count`|`win:UInt32`|*n* 回めのガベージ コレクション。|
|`Depth`|`win:UInt32`|収集されるジェネレーション。|
|`Reason`|`win:UInt32`|ガベージ コレクションが発生した理由:<br /><br /> `0x0` -小さなオブジェクトヒープの割り当て。<br /><br /> `0x1` 起因.<br /><br /> `0x2` -メモリが不足しています。<br /><br /> `0x3` 指定.<br /><br /> `0x4` -大きなオブジェクトヒープの割り当て。<br /><br /> `0x5` -領域が不足しています (小さなオブジェクトヒープの場合)。<br /><br /> `0x6` -領域が不足しています (大きなオブジェクトヒープの場合)。<br /><br /> `0x7` -強制されますが、ブロックとして強制されることはありません。|
|`Type`|`win:UInt32`|`0x0` -バックグラウンドガベージコレクションの外部でブロッキングガベージコレクションが発生しました。<br /><br /> `0x1` -バックグラウンドガベージコレクション。<br /><br /> `0x2` -バックグラウンドガベージコレクションの実行中に、ブロッキングガベージコレクションが発生しました。|
|`ClrInstanceID`|win:UInt16|CoreCLR のインスタンスの一意の ID。|

## <a name="gcend_v1-event"></a>GCEnd_V1 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCEnd_V1`|2|ガベージ コレクションが終了しました。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`Count`|`win:UInt32`|*n* 回めのガベージ コレクション。|
|`Depth`|`win:UInt32`|収集されたジェネレーション。|
|`ClrInstanceID`|win:UInt16|CoreCLR のインスタンスの一意の ID。|

## <a name="gcheapstats_v2-event"></a>GCHeapStats_V2 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|説明|
|-----------|--------------|-----------------|
|`GCHeapStats_V2`|4|各ガベージ コレクション終了時のヒープの統計情報を示します。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`GenerationSize0`|`win:UInt64`|ジェネレーション 0 メモリのサイズ (バイト単位)。|
|`TotalPromotedSize0`|`win:UInt64`|ジェネレーション 0 からジェネレーション 1 に移されたバイト数。|
|`GenerationSize1`|`win:UInt64`|ジェネレーション 1 メモリのサイズ (バイト単位)。|
|`TotalPromotedSize1`|`win:UInt64`|ジェネレーション 1 からジェネレーション 2 に移されたバイト数。|
|`GenerationSize2`|`win:UInt64`|ジェネレーション 2 メモリのサイズ (バイト単位)。|
|`TotalPromotedSize2`|`win:UInt64`|最後のガベージ コレクションの後にジェネレーション 2 に残ったバイト数。|
|`GenerationSize3`|`win:UInt64`|大きなオブジェクト ヒープのサイズ (バイト単位)。|
|`TotalPromotedSize3`|`win:UInt64`|最後のガベージ コレクションの後に大きなオブジェクト ヒープに残ったバイト数。|
|`FinalizationPromotedSize`|`win:UInt64`|終了準備が完了しているオブジェクトの合計サイズ (バイト単位)。|
|`FinalizationPromotedCount`|`win:UInt64`|終了準備が完了しているオブジェクトの数。|
|`PinnedObjectCount`|`win:UInt32`|ピン止めオブジェクト (移動できないオブジェクト) の数。|
|`SinkBlockCount`|`win:UInt32`|使用中の同期ブロックの数。|
|`GCHandleCount`|`win:UInt32`|使用中のガベージ コレクション ハンドルの数。|
|`ClrInstanceID`|`win:UInt16`|CoreCLR のインスタンスの一意の ID。|
|`GenerationSize4`|`win:UInt64`|固定されたオブジェクトヒープのサイズ (バイト単位)。|
|`TotalPromotedSize4`|`win:UInt64`|最後のコレクションの後に固定されたオブジェクトヒープに残ったバイト数。|

## <a name="gccreatesegment_v1-event"></a>GCCreateSegment_V1 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCCreateSegment_V1`|5|新しいガベージ コレクション セグメントが作成されました。 既に実行されているプロセスでトレースを有効にした場合は、このイベントが各既存セグメントについて発生します。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`Address`|`win:UInt64`|セグメントのアドレス。|
|`Size`|`win:UInt64`|セグメントのサイズ。|
|`Type`|`win:UInt32`|0x0 - 小さなオブジェクト ヒープ。<br /><br /> 0x1 - 大きなオブジェクト ヒープ。<br /><br /> 0x2 - 読み取り専用ヒープ。|
|`ClrInstanceID`|`win:UInt16`|CoreCLR のインスタンスの一意の ID。|

ガベージ コレクターによって割り当てられるセグメントのサイズは実装に固有であり、定期的な更新プログラムによる場合を含め、いつでも変更されることがあります。 アプリでは、セグメント サイズを推測することや、特定のセグメント サイズに依存することを絶対に避けてください。また、セグメントの割り当てに使用可能なメモリの量を構成しようとしてもなりません。

## <a name="gcfreesegment_v1-event"></a>GCFreeSegment_V1 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCFreeSegment_V1`|6|ガベージ コレクション セグメントが解放されました。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`Address`|`win:UInt64`|セグメントのアドレス。|
|`ClrInstanceID`|`win:UInt16`|CoreCLR のインスタンスの一意の ID。|

## <a name="gcrestarteebegin_v1-event"></a>GCRestartEEBegin_V1 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCRestartEEBegin_V1`|7|共通言語ランタイムの中断からの再開が開始されました。|

このイベントには、イベントデータがありません。

## <a name="gcrestarteeend_v1-event"></a>GCRestartEEEnd_V1 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCRestartEEEnd_V1`|3|共通言語ランタイムの中断からの再開が終了しました。|

このイベントには、イベントデータがありません。

## <a name="gcsuspendeeend_v1-event"></a>GCSuspendEEEnd_V1 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCSuspendEEEnd_V1`|8|ガベージ コレクションのための実行エンジンの中断の終了。|

このイベントには、イベントデータがありません。

## <a name="gcsuspendeebegin_v1-event"></a>GCSuspendEEBegin_V1 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCSuspendEEBegin_V1`|8|ガベージ コレクションのための実行エンジンの中断の開始。|

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`Count`|`win:UInt32`|*n* 回めのガベージ コレクション。|
|`Reason`|`win:UInt32`|EE の中断の理由。<br/><br/>`0x0`: その他を中断<br/><br/>`0x1`: GC を中断します。<br/><br/>`0x2`: AppDomain のシャットダウンを中断します。<br/><br/>`0x3`: コードピッチを中断します。<br/><br/>`0x4`: シャットダウンを中断します。<br/><br/>`0x5`: デバッガーを中断します。<br/><br/>`0x6`: GC 準備のために中断します。<br/><br/>`0x7`: デバッガースイープの中断|

## <a name="gcallocationtick_v3-event"></a>GCAllocationTick_V3 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|詳細 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCAllocationTick_V3`|10|約 100 KB が割り当てられるたび。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`AllocationAmount`|`win:UInt32`|割り当てサイズ (バイト単位)。 この値は、ULONG (4,294,967,295 バイト) の長さより短い割り当ての場合に正確です。 割り当てがこれを超える場合、このフィールドには切り捨てられた値が含まれます。 非常に大きな割り当てには `AllocationAmount64` を使用します。|
|`AllocationKind`|`win:UInt32`|`0x0` -小さなオブジェクトの割り当て (小さなオブジェクトヒープ内の割り当て)。<br /><br /> `0x1` -大きなオブジェクトの割り当て (大きなオブジェクトヒープ内の割り当て)。|
|`AllocationAmount64`|`win:UInt64`|割り当てサイズ (バイト単位)。 この値は非常に大きな割り当ての場合に正確です。|
|`TypeId`|`win:Pointer`|MethodTable のアドレス。 このイベント中に複数の型のオブジェクトが割り当てられた場合、これは最後に割り当てられたオブジェクト (100 KB のしきい値を超えたオブジェクト) に対応する MethodTable のアドレスです。|
|`TypeName`|`win:UnicodeString`|割り当てられた型の名前。 このイベント中に複数の型のオブジェクトが割り当てられた場合は、これは最後に割り当てられたオブジェクト (100 KB のしきい値を超えたオブジェクト) の型です。|
|`HeapIndex`|`win:UInt32`|オブジェクトが割り当てられたヒープ。 ワークステーションのガベージ コレクションと共に実行する場合、この値は 0 (ゼロ) になります。|
|`Address`|`win:Pointer`|最後に割り当てられたオブジェクトのアドレス。|
|`ClrInstanceID`|`win:UInt16`|CoreCLR のインスタンスの一意の ID。|

## <a name="gccreateconcurrentthread_v1-event"></a>GCCreateConcurrentThread_V1 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|
|`ThreadingKeyword` (0x10000)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCCreateConcurrentThread_V1`|11|同時実行ガベージ コレクション スレッドが作成されました。|

このイベントには、イベントデータがありません。

## <a name="gcterminateconcurrentthread_v1-event"></a>GCTerminateConcurrentThread_V1 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|
|`ThreadingKeyword` (0x10000)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCTerminateConcurrentThread_V1`|12|同時実行ガベージ コレクションスレッドが終了しました。|

このイベントには、イベントデータがありません。

## <a name="gcfinalizersbegin_v1-event"></a>GCFinalizersBegin_V1 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCFinalizersBegin_V1`|14|ファイナライザーの実行の開始。|

このイベントには、イベントデータがありません。

## <a name="gcfinalizersend_v1-event"></a>GCFinalizersEnd_V1 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCFinalizersEnd_V1`|13|ファイナライザーの実行の終了。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`Count`|`win:UInt32`|実行されたファイナライザーの数。|
|`ClrInstanceID`|win:UInt16|CLR または CoreCLR のインスタンスの一意の ID。|

## <a name="setgchandle-event"></a>SetGCHandle イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCHandleKeyword` 0x2|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`SetGCHandle`|30|GC ハンドルが設定されました。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`HandleID`|`win:Pointer`|割り当てられたハンドルのアドレス。|
|`ObjectID`|`win:Pointer`|ハンドルが作成されたオブジェクトのアドレス。|
|`Kind`|`win:UInt32`|設定された GC ハンドルの型。 <br /><br />`0x0`:%/Short <br/><br/>`0x1`:% (中) <br /><br />`0x2`: Strong <br /><br />`0x3`: ピン留め <br /><br />`0x4`: 変数<br /><br />`0x5`: RefCounted <br /><br />`0x6`: 依存<br /><br />`0x7`: AsyncPinned<br /><br />`0x8`: SizedRef|
|`Generation`|`win:UInt32`|ハンドルが作成されたオブジェクトの生成。|
|`AppDomainID`|`win:UInt64`|AppDomain ID。|
|`ClrInstanceID`|`win:UInt16`|CoreCLR のインスタンスの一意の ID。|

## <a name="destroygchandle-event"></a>DestroyGCHandle イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCHandleKeyword` 0x2|情報提供 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`DestroyGCHandle`|31|GC ハンドルが破棄されます。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`HandleID`|`win:Pointer`|破棄されたハンドルのアドレス。|
|`ClrInstanceID`|win:UInt16|CoreCLR のインスタンスの一意の ID。|

## <a name="pinobjectatgctime-event"></a>PinObjectAtGCTime イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|詳細 (5)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`PinObjectAtGCTime`|33|オブジェクトは GC 中にピン留めされました。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`HandleID`|`win:Pointer`|ハンドルのアドレス。|
|`ObjectID`|`win:Pointer`|固定されたオブジェクトのアドレス。|
|`ObjectSize`|`win:UInt64`|ピン留めされたオブジェクトのサイズ。|
|`TypeName`|`win:UnicodeString`|固定されたオブジェクトの型の名前。|
|`ClrInstanceID`|`win:UInt16`|CoreCLR のインスタンスの一意の ID。|

## <a name="gctriggered-event"></a>GCTriggered イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|詳細 (5)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCTriggered`|33|GC がトリガーされました。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`Reason`|`win:UInt32`|GC がトリガーされた理由。<br/><br/>`0x0`: AllocSmall<br/><br/>`0x1`: 誘発 <br/><br/>`0x2`: LowMemory <br/><br/>`0x3`: 空 <br/><br/>`0x4`: AllocLarge <br/><br/>`0x5`: OutOfSpaceSmallObjectHeap <br/><br/>`0x6`: OutOfSpaceLargeObjectHeap <br/><br/>`0x7`:InducedNoForce <br/><br/>`0x8`: ストレス <br/><br/>`0x9`: InducedLowMemory|
|`ClrInstanceID`|`win:UInt16`|CoreCLR のインスタンスの一意の ID。|

## <a name="increasememorypressure-event"></a>IncreaseMemoryPressure イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|----------------|---------------|-----------------|
|`IncreaseMemoryPressure`|200|メモリ不足が増加しました。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`ClrInstanceID`|win:UInt16|CoreCLR のインスタンスの一意の ID。|

## <a name="decreasememorypressure-event"></a>DecreaseMemoryPressure イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|----------------|---------------|-----------------|
|`DecreaseMemoryPressure`|201|メモリの負荷が減少しました。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`BytesFreed`|`win:UInt32`|解放されたバイト数。|
|`ClrInstanceID`|`win:UInt16`|CoreCLR のインスタンスの一意の ID。|

## <a name="gcmarkwithtype-event"></a>GCMarkWithType イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|情報 (4)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|----------------|---------------|-----------------|
|`GCMarkWithType`|202|Gc マークフェーズ中に GC ルートがマークされました。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`HeapNum`|`win:UInt32`|ヒープ番号。|
|`ClrInstanceID`|win:UInt16|CoreCLR のインスタンスの一意の ID。|
|`Type`|`win:UInt32`|GC ルート型。<br/><br/>`0x0`: スタック<br/><br/>`0x1`: ファイナライザー<br/><br/>`0x2`: ハンドル<br/><br/>`0x3`: 古い<br/><br/>`0x4`: SizedRef<br/><br/>`0x5`: オーバーフロー<br/><br/>|
|`Bytes`|`win:UInt64`|マークされたバイト数。|

## <a name="gcjoin_v2-event"></a>GCJoin_V2 イベント

次の表に、キーワードとレベルを示します。

|イベントを発生させるキーワード|Level|
|-----------------------------------|-----------|
|`GCKeyword` (0x1)|詳細 (5)|

次の表に、イベント情報を示します。

|event|イベント ID|いつ発生するか|
|-----------|--------------|-----------------|
|`GCJoin_V2`|203|参加している GC スレッド。|

次の表に、イベント データを示します。

|フィールド名|データ型|説明|
|----------------|---------------|-----------------|
|`Heap`|`win:UInt32`|ヒープ番号|
|`JoinTime`|`win:UInt32`|このイベントが結合の開始時に発生したか、または結合の終了時に発生したかを示します (結合の `0x0` 開始、 `0x1` 結合の終了)|
|`JoinType`|`win:UInt32`|結合の種類。 <br/><br/>`0x0`: 最後の結合<br/><br/>`0x1`: Join <br/><br/>`0x2`: 再起動 <br/><br/>`0x3`: 最初の逆結合<br/><br/>`0x4`: 逆結合<br/><br/>|
|`ClrInstanceID`|`win:UInt16`|CoreCLR のインスタンスの一意の ID。|
