---
title: 拡張メソッド
ms.date: 10/22/2008
ms.technology: dotnet-standard
ms.assetid: 5de945cb-88f4-49d7-b0e6-f098300cf357
ms.openlocfilehash: 77c012d7838ae2fa1f62163bc58520db67c64ce5
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/02/2020
ms.locfileid: "84289760"
---
# <a name="extension-methods"></a>拡張メソッド

拡張メソッドは、インスタンスメソッドの呼び出し構文を使用して静的メソッドを呼び出せるようにする言語機能です。 これらのメソッドは、メソッドが操作するインスタンスを表す1つ以上のパラメーターを受け取る必要があります。

 拡張メソッドを定義するクラスは "スポンサー" クラスと呼ばれ、として宣言する必要があり `static` ます。 拡張メソッドを使用するには、スポンサークラスを定義する名前空間をインポートする必要があります。

 ❌特に所有していない型については、拡張メソッドの使用を避けてください。

 型のソースコードを所有している場合は、代わりに通常のインスタンスメソッドを使用することを検討してください。 ソースコードを所有しておらず、メソッドを追加する場合は、細心の注意を払ってください。 拡張メソッドを自由に使用すると、これらのメソッドを使用するように設計されていない型の Api が乱雑になる可能性があります。

 次のシナリオでは、拡張メソッドの使用を検討✔️。

- インターフェイスのすべての実装に関連するヘルパー機能を提供するために、がコアインターフェイスの観点で記述されている場合は、この機能を使用できます。 これは、具象実装がインターフェイスに割り当てられないことが原因です。 たとえば、LINQ to Objects の演算子は、すべての型の拡張メソッドとして実装され <xref:System.Collections.Generic.IEnumerable%601> ます。 したがって、すべての `IEnumerable<>` 実装は自動的に LINQ 対応になります。

- インスタンスメソッドで何らかの種類の依存関係が発生しても、そのような依存関係は依存関係管理規則に違反する可能性があります。 たとえば、からへの依存関係は <xref:System.String> <xref:System.Uri?displayProperty=nameWithType> 望ましくないと考えられます。そのため、を `String.ToUri()` 返すインスタンスメソッドは、 `System.Uri` 依存関係管理の観点からの不適切な設計になります。 を返す静的な拡張メソッドは、より `Uri.ToUri(this string str)` `System.Uri` 優れた設計になります。

 ❌で拡張メソッドを定義することは避けて <xref:System.Object?displayProperty=nameWithType> ください。

 Visual Basic ユーザーは、拡張メソッドの構文を使用して、オブジェクト参照に対してこのようなメソッドを呼び出すことはできません。 Visual Basic では、として参照を宣言すると、 `Object` すべてのメソッドの呼び出しが強制的に遅延バインディングされます (つまり、呼び出された実際のメンバーは実行時に決定されます)。 拡張メソッドへのバインディングは、コンパイル時 (事前バインディング) に決定されます。

 このガイドラインは、同じバインディング動作が存在するか、または拡張メソッドがサポートされていない他の言語に適用されます。

 ❌メソッドをインターフェイスに追加する場合や依存関係の管理用に使用する場合を除き、拡張メソッドを拡張型と同じ名前空間に配置しないでください。

 ❌異なる名前空間に存在する場合でも、同じシグネチャを持つ2つ以上の拡張メソッドを定義することは避けてください。

 型がインターフェイスであり、ほとんどの場合またはほとんどの場合に拡張メソッドを使用することを意図している場合は、拡張型と同じ名前空間で拡張メソッドを定義することを✔️してください。

 ❌通常は他の機能に関連付けられている名前空間で、機能を実装する拡張メソッドを定義しないでください。 代わりに、所属する機能に関連付けられている名前空間で定義します。

 ❌拡張メソッド専用の名前空間の汎用的な名前付け ("拡張機能" など) は避けてください。 代わりに、わかりやすい名前 ("Routing" など) を使用してください。

 *部分 &copy; 2005、2009 Microsoft Corporation。すべての権限が予約されています。*

 *2008 年 10 月 22 日に Microsoft Windows Development シリーズの一部として、Addison-Wesley Professional によって発行された、Krzysztof Cwalina および Brad Abrams による「[Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619)」 (フレームワーク デザイン ガイドライン: 再利用可能な .NET ライブラリの規則、用法、パターン、第 2 版) から Pearson Education, Inc. の許可を得て再印刷されています。*

## <a name="see-also"></a>関連項目

- [メンバーデザインのガイドライン](member.md)
- [フレームワークデザインのガイドライン](index.md)
