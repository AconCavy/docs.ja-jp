---
title: オブサーバー デザイン パターン
description: .NET のオブザーバー デザイン パターンについて説明します。 このパターンでは、プロバイダーにサブスクライバーを登録して、プロバイダーから通知を受信できます。
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- IObserver(Of T) interface
- IObservable<T> interface
- IObserver<T> interface
- IObservable(Of T) interface
- observer design pattern [.NET Framework]
ms.assetid: 3680171f-f522-453c-aa4a-54f755a78f88
ms.openlocfilehash: 80dac36199dd13abeab295d4b53a52615e7ae625
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/15/2020
ms.locfileid: "90559162"
---
# <a name="observer-design-pattern"></a><span data-ttu-id="892d6-104">オブサーバー デザイン パターン</span><span class="sxs-lookup"><span data-stu-id="892d6-104">Observer Design Pattern</span></span>

<span data-ttu-id="892d6-105">オブザーバー デザイン パターンでは、プロバイダーにサブスクライバーを登録して通知を受信することができます。</span><span class="sxs-lookup"><span data-stu-id="892d6-105">The observer design pattern enables a subscriber to register with and receive notifications from a provider.</span></span> <span data-ttu-id="892d6-106">このデザイン パターンは、プッシュ ベースの通知を必要とするあらゆるシナリオに適しています。</span><span class="sxs-lookup"><span data-stu-id="892d6-106">It is suitable for any scenario that requires push-based notification.</span></span> <span data-ttu-id="892d6-107">このパターンでは、1 つの*プロバイダー* (*サブジェクト*または*観察可能なオブジェクト*とも呼ばれます) と、0 個以上の*オブザーバー*を定義します。</span><span class="sxs-lookup"><span data-stu-id="892d6-107">The pattern defines a *provider* (also known as a *subject* or an *observable*) and zero, one, or more *observers*.</span></span> <span data-ttu-id="892d6-108">プロバイダーにオブザーバーを登録すると、あらかじめ定義した条件、イベント、または状態変化が発生するたびに、プロバイダーのいずれかのメソッドが呼び出されて自動的にすべてのオブザーバーに通知されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-108">Observers register with the provider, and whenever a predefined condition, event, or state change occurs, the provider automatically notifies all observers by calling one of their methods.</span></span> <span data-ttu-id="892d6-109">このメソッド呼び出しで、プロバイダーからオブザーバーに現在の状態の情報を提供することもできます。</span><span class="sxs-lookup"><span data-stu-id="892d6-109">In this method call, the provider can also provide current state information to observers.</span></span> <span data-ttu-id="892d6-110">.NET Framework でオブザーバー デザイン パターンを適用するには、ジェネリック インターフェイスの <xref:System.IObservable%601?displayProperty=nameWithType> および <xref:System.IObserver%601?displayProperty=nameWithType> を実装します。</span><span class="sxs-lookup"><span data-stu-id="892d6-110">In the .NET Framework, the observer design pattern is applied by implementing the generic <xref:System.IObservable%601?displayProperty=nameWithType> and <xref:System.IObserver%601?displayProperty=nameWithType> interfaces.</span></span> <span data-ttu-id="892d6-111">ジェネリック型パラメーターは、通知情報を提供する型を表します。</span><span class="sxs-lookup"><span data-stu-id="892d6-111">The generic type parameter represents the type that provides notification information.</span></span>

## <a name="applying-the-pattern"></a><span data-ttu-id="892d6-112">パターンの適用</span><span class="sxs-lookup"><span data-stu-id="892d6-112">Applying the Pattern</span></span>

<span data-ttu-id="892d6-113">オブザーバー デザイン パターンは、データ ソース (ビジネス ロジック) 層とユーザー インターフェイス (表示) 層のように、2 つの異なるコンポーネントまたはアプリケーション層を明確に分離できるため、分散型のプッシュ ベースの通知に適しています。</span><span class="sxs-lookup"><span data-stu-id="892d6-113">The observer design pattern is suitable for distributed push-based notifications, because it supports a clean separation between two different components or application layers, such as a data source (business logic) layer and a user interface (display) layer.</span></span> <span data-ttu-id="892d6-114">このパターンは、プロバイダーがコールバックを使用して現在の情報をクライアントに提供するあらゆる場面で実装できます。</span><span class="sxs-lookup"><span data-stu-id="892d6-114">The pattern can be implemented whenever a provider uses callbacks to supply its clients with current information.</span></span>

<span data-ttu-id="892d6-115">このパターンを実装するために必要なものを以下に示します。</span><span class="sxs-lookup"><span data-stu-id="892d6-115">Implementing the pattern requires that you provide the following:</span></span>

- <span data-ttu-id="892d6-116">プロバイダー (サブジェクト)。オブザーバーに通知を送信するオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="892d6-116">A provider or subject, which is the object that sends notifications to observers.</span></span> <span data-ttu-id="892d6-117">プロバイダーは、<xref:System.IObservable%601> インターフェイスを実装するクラスまたは構造体で、</span><span class="sxs-lookup"><span data-stu-id="892d6-117">A provider is a class or structure that implements the <xref:System.IObservable%601> interface.</span></span> <span data-ttu-id="892d6-118"><xref:System.IObservable%601.Subscribe%2A?displayProperty=nameWithType> という 1 つのメソッドを実装する必要があります。このメソッドは、プロバイダーからの通知を受信するオブザーバーによって呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-118">The provider must implement a single method, <xref:System.IObservable%601.Subscribe%2A?displayProperty=nameWithType>, which is called by observers that wish to receive notifications from the provider.</span></span>

- <span data-ttu-id="892d6-119">オブザーバー。プロバイダーからの通知を受信するオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="892d6-119">An observer, which is an object that receives notifications from a provider.</span></span> <span data-ttu-id="892d6-120">オブザーバーは、<xref:System.IObserver%601> インターフェイスを実装するクラスまたは構造体で、</span><span class="sxs-lookup"><span data-stu-id="892d6-120">An observer is a class or structure that implements the <xref:System.IObserver%601> interface.</span></span> <span data-ttu-id="892d6-121">オブザーバーでは、次の 3 つのメソッドを実装する必要があります。これらはすべてプロバイダーによって呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-121">The observer must implement three methods, all of which are called by the provider:</span></span>

  - <span data-ttu-id="892d6-122"><xref:System.IObserver%601.OnNext%2A?displayProperty=nameWithType>。新しい情報または現在の情報をオブザーバーに提供します。</span><span class="sxs-lookup"><span data-stu-id="892d6-122"><xref:System.IObserver%601.OnNext%2A?displayProperty=nameWithType>, which supplies the observer with new or current information.</span></span>

  - <span data-ttu-id="892d6-123"><xref:System.IObserver%601.OnError%2A?displayProperty=nameWithType>。エラーが発生したことをオブザーバーに通知します。</span><span class="sxs-lookup"><span data-stu-id="892d6-123"><xref:System.IObserver%601.OnError%2A?displayProperty=nameWithType>, which informs the observer that an error has occurred.</span></span>

  - <span data-ttu-id="892d6-124"><xref:System.IObserver%601.OnCompleted%2A?displayProperty=nameWithType>。プロバイダーが通知の送信を完了したことを示します。</span><span class="sxs-lookup"><span data-stu-id="892d6-124"><xref:System.IObserver%601.OnCompleted%2A?displayProperty=nameWithType>, which indicates that the provider has finished sending notifications.</span></span>

- <span data-ttu-id="892d6-125">プロバイダーがオブザーバーを追跡するための機構。</span><span class="sxs-lookup"><span data-stu-id="892d6-125">A mechanism that allows the provider to keep track of observers.</span></span> <span data-ttu-id="892d6-126">通常、プロバイダーでは、<xref:System.Collections.Generic.List%601?displayProperty=nameWithType> オブジェクトなどのコンテナー オブジェクトを使用して、通知にサブスクライブした <xref:System.IObserver%601> の実装への参照を保持します。</span><span class="sxs-lookup"><span data-stu-id="892d6-126">Typically, the provider uses a container object, such as a <xref:System.Collections.Generic.List%601?displayProperty=nameWithType> object, to hold references to the <xref:System.IObserver%601> implementations that have subscribed to notifications.</span></span> <span data-ttu-id="892d6-127">このようにストレージ コンテナーを使用すると、プロバイダーで必要に応じていくつでもオブザーバーを処理できます。</span><span class="sxs-lookup"><span data-stu-id="892d6-127">Using a storage container for this purpose enables the provider to handle zero to an unlimited number of observers.</span></span> <span data-ttu-id="892d6-128">オブザーバーが通知を受信する順序は定義されていないため、プロバイダーで自由に順序を決定できます。</span><span class="sxs-lookup"><span data-stu-id="892d6-128">The order in which observers receive notifications is not defined; the provider is free to use any method to determine the order.</span></span>

- <span data-ttu-id="892d6-129">通知が完了したときにプロバイダーがオブザーバーを削除できるようにするための <xref:System.IDisposable> の実装。</span><span class="sxs-lookup"><span data-stu-id="892d6-129">An <xref:System.IDisposable> implementation that enables the provider to remove observers when notification is complete.</span></span> <span data-ttu-id="892d6-130">オブザーバーは、<xref:System.IDisposable> の実装への参照を <xref:System.IObservable%601.Subscribe%2A> メソッドから受け取ります。このため、プロバイダーが通知の送信を終了する前に、オブザーバーで <xref:System.IDisposable.Dispose%2A?displayProperty=nameWithType> メソッドを呼び出してサブスクリプションを解除することもできます。</span><span class="sxs-lookup"><span data-stu-id="892d6-130">Observers receive a reference to the <xref:System.IDisposable> implementation from the <xref:System.IObservable%601.Subscribe%2A> method, so they can also call the <xref:System.IDisposable.Dispose%2A?displayProperty=nameWithType> method to unsubscribe before the provider has finished sending notifications.</span></span>

- <span data-ttu-id="892d6-131">プロバイダーがオブザーバーに送信するデータを含むオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="892d6-131">An object that contains the data that the provider sends to its observers.</span></span> <span data-ttu-id="892d6-132">このオブジェクトの型は、<xref:System.IObservable%601> インターフェイスと <xref:System.IObserver%601> インターフェイスのジェネリック型パラメーターに対応します。</span><span class="sxs-lookup"><span data-stu-id="892d6-132">The type of this object corresponds to the generic type parameter of the <xref:System.IObservable%601> and <xref:System.IObserver%601> interfaces.</span></span> <span data-ttu-id="892d6-133">このオブジェクトは、<xref:System.IObservable%601> の実装と同じにすることもできますが、別の型にするのが最も一般的です。</span><span class="sxs-lookup"><span data-stu-id="892d6-133">Although this object can be the same as the <xref:System.IObservable%601> implementation, most commonly it is a separate type.</span></span>

> [!NOTE]
> <span data-ttu-id="892d6-134">オブザーバー デザイン パターンを実装するだけでなく、<xref:System.IObservable%601> インターフェイスと <xref:System.IObserver%601> インターフェイスを使用して構築されたライブラリを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="892d6-134">In addition to implementing the observer design pattern, you may be interested in exploring libraries that are built using the <xref:System.IObservable%601> and <xref:System.IObserver%601> interfaces.</span></span> <span data-ttu-id="892d6-135">たとえば、[.NET (Rx) の反応拡張](/previous-versions/dotnet/reactive-extensions/hh242985(v=vs.103))は、非同期プログラミングをサポートする一連の拡張メソッドと LINQ 標準シーケンス演算子で構成します。</span><span class="sxs-lookup"><span data-stu-id="892d6-135">For example, [Reactive Extensions for .NET (Rx)](/previous-versions/dotnet/reactive-extensions/hh242985(v=vs.103)) consist of a set of extension methods and LINQ standard sequence operators to support asynchronous programming.</span></span>

## <a name="implementing-the-pattern"></a><span data-ttu-id="892d6-136">パターンの実装</span><span class="sxs-lookup"><span data-stu-id="892d6-136">Implementing the Pattern</span></span>

<span data-ttu-id="892d6-137">次の例では、オブザーバー デザイン パターンを使用して、空港の手荷物受取所の情報システムを実装します。</span><span class="sxs-lookup"><span data-stu-id="892d6-137">The following example uses the observer design pattern to implement an airport baggage claim information system.</span></span> <span data-ttu-id="892d6-138">`BaggageInfo` クラスは、到着便と、各便の手荷物の受け取り場所に関する情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="892d6-138">A `BaggageInfo` class provides information about arriving flights and the carousels where baggage from each flight is available for pickup.</span></span> <span data-ttu-id="892d6-139">これを次の例に示します。</span><span class="sxs-lookup"><span data-stu-id="892d6-139">It is shown in the following example.</span></span>

[!code-csharp[Conceptual.ObserverDesignPattern#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesignpattern/cs/provider.cs#1)]
[!code-vb[Conceptual.ObserverDesignPattern#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesignpattern/vb/provider.vb#1)]

<span data-ttu-id="892d6-140">`BaggageHandler` クラスは、到着便と手荷物の受け取り場所に関する情報を受け取るクラスです。</span><span class="sxs-lookup"><span data-stu-id="892d6-140">A `BaggageHandler` class is responsible for receiving information about arriving flights and baggage claim carousels.</span></span> <span data-ttu-id="892d6-141">その内部では、次の 2 つのコレクションが保持されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-141">Internally, it maintains two collections:</span></span>

- <span data-ttu-id="892d6-142">`observers` - 更新された情報を受け取るクライアントのコレクション。</span><span class="sxs-lookup"><span data-stu-id="892d6-142">`observers` - A collection of clients that will receive updated information.</span></span>

- <span data-ttu-id="892d6-143">`flights` - 飛行機の便と、各便に割り当てられた手荷物の受け取り場所のコレクション。</span><span class="sxs-lookup"><span data-stu-id="892d6-143">`flights` - A collection of flights and their assigned carousels.</span></span>

<span data-ttu-id="892d6-144">どちらのコレクションも、`BaggageHandler` クラスのコンストラクターでインスタンス化されるジェネリック <xref:System.Collections.Generic.List%601> オブジェクトによって表されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-144">Both collections are represented by generic <xref:System.Collections.Generic.List%601> objects that are instantiated in the `BaggageHandler` class constructor.</span></span> <span data-ttu-id="892d6-145">`BaggageHandler` クラスのソース コードを次の例に示します。</span><span class="sxs-lookup"><span data-stu-id="892d6-145">The source code for the `BaggageHandler` class is shown in the following example.</span></span>

[!code-csharp[Conceptual.ObserverDesignPattern#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesignpattern/cs/provider.cs#2)]
[!code-vb[Conceptual.ObserverDesignPattern#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesignpattern/vb/provider.vb#2)]

<span data-ttu-id="892d6-146">更新された情報を受け取るクライアントは、`BaggageHandler.Subscribe` メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="892d6-146">Clients that wish to receive updated information call the `BaggageHandler.Subscribe` method.</span></span> <span data-ttu-id="892d6-147">以前に通知をサブスクライブしたことがないクライアントの場合は、クライアントの <xref:System.IObserver%601> の実装への参照が `observers` コレクションに追加されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-147">If the client has not previously subscribed to notifications, a reference to the client's <xref:System.IObserver%601> implementation is added to the `observers` collection.</span></span>

<span data-ttu-id="892d6-148">オーバーロードされた `BaggageHandler.BaggageStatus` メソッドは、特定の便の手荷物が処理中であるか処理済みになったかを通知するために呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-148">The overloaded `BaggageHandler.BaggageStatus` method can be called to indicate that baggage from a flight either is being unloaded or is no longer being unloaded.</span></span> <span data-ttu-id="892d6-149">処理中の場合は、飛行機の便の番号、出発空港、および手荷物の受け取り場所がメソッドに渡されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-149">In the first case, the method is passed a flight number, the airport from which the flight originated, and the carousel where baggage is being unloaded.</span></span> <span data-ttu-id="892d6-150">処理済みの場合は、飛行機の便の番号のみがメソッドに渡されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-150">In the second case, the method is passed only a flight number.</span></span> <span data-ttu-id="892d6-151">手荷物が処理中の場合、メソッドは、渡された `BaggageInfo` の情報が `flights` コレクションに存在するかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="892d6-151">For baggage that is being unloaded, the method checks whether the `BaggageInfo` information passed to the method exists in the `flights` collection.</span></span> <span data-ttu-id="892d6-152">存在しない場合は、メソッドによりその情報が追加され、各オブザーバーの `OnNext` メソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-152">If it does not, the method adds the information and calls each observer's `OnNext` method.</span></span> <span data-ttu-id="892d6-153">荷物を降ろさない便の場合、メソッドは、その便の情報が `flights` コレクションに格納されているかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="892d6-153">For flights whose baggage is no longer being unloaded, the method checks whether information on that flight is stored in the `flights` collection.</span></span> <span data-ttu-id="892d6-154">格納されている場合、メソッドは、各オブザーバーの `OnNext` メソッドを呼び出し、`flights` コレクションから `BaggageInfo` オブジェクトを削除します。</span><span class="sxs-lookup"><span data-stu-id="892d6-154">If it is, the method calls each observer's `OnNext` method and removes the `BaggageInfo` object from the `flights` collection.</span></span>

<span data-ttu-id="892d6-155">1 日の最終便が到着して手荷物の処理が完了すると、`BaggageHandler.LastBaggageClaimed` メソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-155">When the last flight of the day has landed and its baggage has been processed, the `BaggageHandler.LastBaggageClaimed` method is called.</span></span> <span data-ttu-id="892d6-156">このメソッドは、各オブザーバーの `OnCompleted` メソッドを呼び出して、すべての通知が完了したことを示します。その後、`observers` コレクションをクリアします。</span><span class="sxs-lookup"><span data-stu-id="892d6-156">This method calls each observer's `OnCompleted` method to indicate that all notifications have completed, and then clears the `observers` collection.</span></span>

<span data-ttu-id="892d6-157">プロバイダーの <xref:System.IObservable%601.Subscribe%2A> メソッドが返す <xref:System.IDisposable> の実装を使用すると、<xref:System.IObserver%601.OnCompleted%2A> メソッドが呼び出される前に、オブザーバーで通知の受信を中止できます。</span><span class="sxs-lookup"><span data-stu-id="892d6-157">The provider's <xref:System.IObservable%601.Subscribe%2A> method returns an <xref:System.IDisposable> implementation that enables observers to stop receiving notifications before the <xref:System.IObserver%601.OnCompleted%2A> method is called.</span></span> <span data-ttu-id="892d6-158">この `Unsubscriber(Of BaggageInfo)` クラスのソース コードを次の例に示します。</span><span class="sxs-lookup"><span data-stu-id="892d6-158">The source code for this `Unsubscriber(Of BaggageInfo)` class is shown in the following example.</span></span> <span data-ttu-id="892d6-159">このクラスが `BaggageHandler.Subscribe` メソッドでインスタンス化されるときに、`observers` コレクションへの参照と、コレクションに追加されるオブザーバーへの参照が渡されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-159">When the class is instantiated in the `BaggageHandler.Subscribe` method, it is passed a reference to the `observers` collection and a reference to the observer that is added to the collection.</span></span> <span data-ttu-id="892d6-160">これらの参照はローカル変数に割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="892d6-160">These references are assigned to local variables.</span></span> <span data-ttu-id="892d6-161">オブジェクトの `Dispose` メソッドが呼び出されると、オブザーバーがまだ `observers` コレクションに存在するかどうかが確認され、存在する場合、そのオブザーバーは削除されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-161">When the object's `Dispose` method is called, it checks whether the observer still exists in the `observers` collection, and, if it does, removes the observer.</span></span>

[!code-csharp[Conceptual.ObserverDesignPattern#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesignpattern/cs/provider.cs#3)]
[!code-vb[Conceptual.ObserverDesignPattern#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesignpattern/vb/provider.vb#3)]

<span data-ttu-id="892d6-162">次の例は、`ArrivalsMonitor` という名前の <xref:System.IObserver%601> の実装を示しています。これは、手荷物受取所の情報を表示する基本クラスです。</span><span class="sxs-lookup"><span data-stu-id="892d6-162">The following example provides an <xref:System.IObserver%601> implementation named `ArrivalsMonitor`, which is a base class that displays baggage claim information.</span></span> <span data-ttu-id="892d6-163">情報は、出発地名のアルファベット順に表示されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-163">The information is displayed alphabetically, by the name of the originating city.</span></span> <span data-ttu-id="892d6-164">`ArrivalsMonitor` のメソッドは、`overridable` (Visual Basic) または `virtual` (C#) としてマークされているため、派生クラスによりすべてオーバーライドできます。</span><span class="sxs-lookup"><span data-stu-id="892d6-164">The methods of `ArrivalsMonitor` are marked as `overridable` (in Visual Basic) or `virtual` (in C#), so they can all be overridden by a derived class.</span></span>

[!code-csharp[Conceptual.ObserverDesignPattern#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesignpattern/cs/observer.cs#4)]
[!code-vb[Conceptual.ObserverDesignPattern#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesignpattern/vb/observer.vb#4)]

<span data-ttu-id="892d6-165">`ArrivalsMonitor` クラスには、`Subscribe` メソッドと `Unsubscribe` メソッドが含まれています。</span><span class="sxs-lookup"><span data-stu-id="892d6-165">The `ArrivalsMonitor` class includes the `Subscribe` and `Unsubscribe` methods.</span></span> <span data-ttu-id="892d6-166">`Subscribe` メソッドにより、このクラスは、<xref:System.IObservable%601.Subscribe%2A> の呼び出しから返された <xref:System.IDisposable> の実装をプライベート変数に保存できます。</span><span class="sxs-lookup"><span data-stu-id="892d6-166">The `Subscribe` method enables the class to save the <xref:System.IDisposable> implementation returned by the call to <xref:System.IObservable%601.Subscribe%2A> to a private variable.</span></span> <span data-ttu-id="892d6-167">`Unsubscribe` メソッドにより、このクラスは、プロバイダーの <xref:System.IDisposable.Dispose%2A> の実装を呼び出して通知のサブスクリプションを解除できます。</span><span class="sxs-lookup"><span data-stu-id="892d6-167">The `Unsubscribe` method enables the class to unsubscribe from notifications by calling the provider's <xref:System.IDisposable.Dispose%2A> implementation.</span></span> <span data-ttu-id="892d6-168">`ArrivalsMonitor` は、<xref:System.IObserver%601.OnNext%2A>、<xref:System.IObserver%601.OnError%2A>、<xref:System.IObserver%601.OnCompleted%2A> の各メソッドの実装も提供します。</span><span class="sxs-lookup"><span data-stu-id="892d6-168">`ArrivalsMonitor` also provides implementations of the <xref:System.IObserver%601.OnNext%2A>, <xref:System.IObserver%601.OnError%2A>, and <xref:System.IObserver%601.OnCompleted%2A> methods.</span></span> <span data-ttu-id="892d6-169">そのうち、かなりの量のコードが含まれるのは <xref:System.IObserver%601.OnNext%2A> の実装だけです。</span><span class="sxs-lookup"><span data-stu-id="892d6-169">Only the <xref:System.IObserver%601.OnNext%2A> implementation contains a significant amount of code.</span></span> <span data-ttu-id="892d6-170">このメソッドは、到着便の出発空港と手荷物の受け取り場所に関する情報を並べ替えて保持する、プライベートなジェネリック <xref:System.Collections.Generic.List%601> オブジェクトを操作します。</span><span class="sxs-lookup"><span data-stu-id="892d6-170">The method works with a private, sorted, generic <xref:System.Collections.Generic.List%601> object that maintains information about the airports of origin for arriving flights and the carousels on which their baggage is available.</span></span> <span data-ttu-id="892d6-171">`BaggageHandler` クラスから新しい便の到着が報告されると、<xref:System.IObserver%601.OnNext%2A> メソッドの実装はその便に関する情報をリストに追加します。</span><span class="sxs-lookup"><span data-stu-id="892d6-171">If the `BaggageHandler` class reports a new flight arrival, the <xref:System.IObserver%601.OnNext%2A> method implementation adds information about that flight to the list.</span></span> <span data-ttu-id="892d6-172">`BaggageHandler` クラスからその便の手荷物の処理が完了したことが報告されると、<xref:System.IObserver%601.OnNext%2A> メソッドはその便をリストから削除します。</span><span class="sxs-lookup"><span data-stu-id="892d6-172">If the `BaggageHandler` class reports that the flight's baggage has been unloaded, the <xref:System.IObserver%601.OnNext%2A> method removes that flight from the list.</span></span> <span data-ttu-id="892d6-173">変更が発生するたびに、リストが並べ替えられてコンソールに表示されます。</span><span class="sxs-lookup"><span data-stu-id="892d6-173">Whenever a change is made, the list is sorted and displayed to the console.</span></span>

<span data-ttu-id="892d6-174">次の例に含まれているアプリケーション エントリ ポイントは、`BaggageHandler` クラスのインスタンスと、`ArrivalsMonitor` クラスの 2 つのインスタンスを作成し、`BaggageHandler.BaggageStatus` メソッドを使用して到着便に関する情報を追加および削除します。</span><span class="sxs-lookup"><span data-stu-id="892d6-174">The following example contains the application entry point that instantiates the `BaggageHandler` class as well as two instances of the `ArrivalsMonitor` class, and uses the `BaggageHandler.BaggageStatus` method to add and remove information about arriving flights.</span></span> <span data-ttu-id="892d6-175">いずれの場合も、オブザーバーが更新を受け取って、手荷物受取所の情報を正しく表示します。</span><span class="sxs-lookup"><span data-stu-id="892d6-175">In each case, the observers receive updates and correctly display baggage claim information.</span></span>

[!code-csharp[Conceptual.ObserverDesignPattern#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesignpattern/cs/program.cs#5)]
[!code-vb[Conceptual.ObserverDesignPattern#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesignpattern/vb/module1.vb#5)]

## <a name="related-topics"></a><span data-ttu-id="892d6-176">関連トピック</span><span class="sxs-lookup"><span data-stu-id="892d6-176">Related Topics</span></span>

|<span data-ttu-id="892d6-177">Title</span><span class="sxs-lookup"><span data-stu-id="892d6-177">Title</span></span>|<span data-ttu-id="892d6-178">説明</span><span class="sxs-lookup"><span data-stu-id="892d6-178">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="892d6-179">オブザーバー デザイン パターンのベスト プラクティス</span><span class="sxs-lookup"><span data-stu-id="892d6-179">Observer Design Pattern Best Practices</span></span>](observer-design-pattern-best-practices.md)|<span data-ttu-id="892d6-180">オブザーバー デザイン パターンを実装するアプリケーションを開発するときのベスト プラクティスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="892d6-180">Describes best practices to adopt when developing applications that implement the observer design pattern.</span></span>|
|[<span data-ttu-id="892d6-181">方法: プロバイダーを実装する</span><span class="sxs-lookup"><span data-stu-id="892d6-181">How to: Implement a Provider</span></span>](how-to-implement-a-provider.md)|<span data-ttu-id="892d6-182">温度監視アプリケーションのプロバイダーを実装するための手順について説明します。</span><span class="sxs-lookup"><span data-stu-id="892d6-182">Provides a step-by-step implementation of a provider for a temperature monitoring application.</span></span>|
|[<span data-ttu-id="892d6-183">方法: オブザーバーを実装する</span><span class="sxs-lookup"><span data-stu-id="892d6-183">How to: Implement an Observer</span></span>](how-to-implement-an-observer.md)|<span data-ttu-id="892d6-184">温度監視アプリケーションのオブザーバーを実装するための手順について説明します。</span><span class="sxs-lookup"><span data-stu-id="892d6-184">Provides a step-by-step implementation of an observer for a temperature monitoring application.</span></span>|
