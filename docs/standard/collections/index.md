---
title: コレクションとデータ構造体
description: .NET でコレクションとデータ構造を使用する方法について説明します。 スレッドセーフな操作でジェネリックと非ジェネリック コレクションを使用します。
ms.date: 04/30/2020
helpviewer_keywords:
- grouping data in collections
- objects [.NET], grouping in collections
- Array class, grouping data in collections
- threading [.NET], safety
- Collections classes
- collections [.NET]
ms.assetid: 60cc581f-1db5-445b-ba04-a173396bf872
ms.openlocfilehash: 7400d460c4d1ebf5c02d8313f33a5a63de1734d4
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/24/2020
ms.locfileid: "95733517"
---
# <a name="collections-and-data-structures"></a><span data-ttu-id="e3911-104">コレクションとデータ構造体</span><span class="sxs-lookup"><span data-stu-id="e3911-104">Collections and Data Structures</span></span>

<span data-ttu-id="e3911-105">多くの場合、類似するデータはコレクションとして格納および操作すると、より効率的に処理できます。</span><span class="sxs-lookup"><span data-stu-id="e3911-105">Similar data can often be handled more efficiently when stored and manipulated as a collection.</span></span> <span data-ttu-id="e3911-106"><xref:System.Array?displayProperty=nameWithType> クラスまたは <xref:System.Collections>、<xref:System.Collections.Generic>、<xref:System.Collections.Concurrent>、および <xref:System.Collections.Immutable> 名前空間のクラスを使用して、コレクションの個々の要素または一定の範囲の要素を追加、削除、および変更できます。</span><span class="sxs-lookup"><span data-stu-id="e3911-106">You can use the <xref:System.Array?displayProperty=nameWithType> class or the classes in the <xref:System.Collections>, <xref:System.Collections.Generic>, <xref:System.Collections.Concurrent>, and <xref:System.Collections.Immutable> namespaces to add, remove, and modify either individual elements or a range of elements in a collection.</span></span>

<span data-ttu-id="e3911-107">主要なコレクションの型として、ジェネリック コレクションと非ジェネリック コレクションの 2 つがあります。</span><span class="sxs-lookup"><span data-stu-id="e3911-107">There are two main types of collections; generic collections and non-generic collections.</span></span> <span data-ttu-id="e3911-108">ジェネリック コレクションはコンパイル時にタイプ セーフです。</span><span class="sxs-lookup"><span data-stu-id="e3911-108">Generic collections are type-safe at compile time.</span></span> <span data-ttu-id="e3911-109">このため、通常、ジェネリック コレクションの方がパフォーマンスが高くなります。</span><span class="sxs-lookup"><span data-stu-id="e3911-109">Because of this, generic collections typically offer better performance.</span></span> <span data-ttu-id="e3911-110">ジェネリック コレクションは構築時に型パラメーターを受け取りますが、項目をコレクションに追加またはコレクションから削除するときに <xref:System.Object> 型との間でキャストする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="e3911-110">Generic collections accept a type parameter when they are constructed and do not require that you cast to and from the <xref:System.Object> type when you add or remove items from the collection.</span></span>  <span data-ttu-id="e3911-111">また、ほとんどのジェネリック コレクションが Windows ストア アプリでサポートされています。</span><span class="sxs-lookup"><span data-stu-id="e3911-111">In addition, most generic collections are supported in Windows Store apps.</span></span> <span data-ttu-id="e3911-112">非ジェネリック コレクションは、項目を <xref:System.Object> として格納し、キャストが必要であり、ほとんどが Windows ストア アプリの開発でサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="e3911-112">Non-generic collections store items as <xref:System.Object>, require casting, and most are not supported for Windows Store app development.</span></span> <span data-ttu-id="e3911-113">ただし、以前のコードに非ジェネリック コレクションが含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="e3911-113">However, you may see non-generic collections in older code.</span></span>

<span data-ttu-id="e3911-114">.NET Framework 4 より、<xref:System.Collections.Concurrent> 名前空間のコレクションによって、複数のスレッドからコレクション項目にアクセスするための効率的なスレッドセーフ操作が可能になります。</span><span class="sxs-lookup"><span data-stu-id="e3911-114">Starting with .NET Framework 4, the collections in the <xref:System.Collections.Concurrent> namespace provide efficient thread-safe operations for accessing collection items from multiple threads.</span></span> <span data-ttu-id="e3911-115"><xref:System.Collections.Immutable> 名前空間の変更できないコレクション クラス ([NuGet パッケージ](https://www.nuget.org/packages/System.Collections.Immutable)) は、操作が元のコレクションのコピーで実行され、元のコレクションは変更不可能なため、本質的にスレッドセーフです。</span><span class="sxs-lookup"><span data-stu-id="e3911-115">The immutable collection classes in the <xref:System.Collections.Immutable> namespace ([NuGet package](https://www.nuget.org/packages/System.Collections.Immutable)) are inherently thread-safe because operations are performed on a copy of the original collection and the original collection cannot be modified.</span></span>

<a name="BKMK_Commoncollectionfeatures"></a>

## <a name="common-collection-features"></a><span data-ttu-id="e3911-116">一般的なコレクションの機能</span><span class="sxs-lookup"><span data-stu-id="e3911-116">Common collection features</span></span>

<span data-ttu-id="e3911-117">すべてのコレクションに、コレクション内の項目を追加、削除、または検索するためのメソッドが用意されています。</span><span class="sxs-lookup"><span data-stu-id="e3911-117">All collections provide methods for adding, removing, or finding items in the collection.</span></span> <span data-ttu-id="e3911-118">また、<xref:System.Collections.ICollection> インターフェイスまたは <xref:System.Collections.Generic.ICollection%601> インターフェイスを直接または間接的に実装するすべてのコレクションで、次の機能を共有しています。</span><span class="sxs-lookup"><span data-stu-id="e3911-118">In addition, all collections that directly or indirectly implement the <xref:System.Collections.ICollection> interface or the <xref:System.Collections.Generic.ICollection%601> interface share these features:</span></span>

- <span data-ttu-id="e3911-119">**コレクションを列挙する機能**</span><span class="sxs-lookup"><span data-stu-id="e3911-119">**The ability to enumerate the collection**</span></span>

    <span data-ttu-id="e3911-120">.NET のコレクションでは <xref:System.Collections.IEnumerable?displayProperty=nameWithType> または <xref:System.Collections.Generic.IEnumerable%601?displayProperty=nameWithType> が実装され、コレクションを反復処理できます。</span><span class="sxs-lookup"><span data-stu-id="e3911-120">.NET collections either implement <xref:System.Collections.IEnumerable?displayProperty=nameWithType> or <xref:System.Collections.Generic.IEnumerable%601?displayProperty=nameWithType> to enable the collection to be iterated through.</span></span> <span data-ttu-id="e3911-121">列挙子は、コレクション内の任意の要素への移動可能なポインターと考えることができます。</span><span class="sxs-lookup"><span data-stu-id="e3911-121">An enumerator can be thought of as a movable pointer to any element in the collection.</span></span> <span data-ttu-id="e3911-122">[foreach, in](../../csharp/language-reference/keywords/foreach-in.md) ステートメントと [For Each...Next ステートメント](../../visual-basic/language-reference/statements/for-each-next-statement.md) では、<xref:System.Collections.IEnumerable.GetEnumerator%2A> メソッドによって公開される列挙子を使用して、列挙子の操作の複雑さを隠しています。</span><span class="sxs-lookup"><span data-stu-id="e3911-122">The [foreach, in](../../csharp/language-reference/keywords/foreach-in.md) statement  and the [For Each...Next Statement](../../visual-basic/language-reference/statements/for-each-next-statement.md) use the enumerator exposed by the <xref:System.Collections.IEnumerable.GetEnumerator%2A> method and hide the complexity of manipulating the enumerator.</span></span> <span data-ttu-id="e3911-123">また、<xref:System.Collections.Generic.IEnumerable%601?displayProperty=nameWithType> を実装するコレクションはいずれも *クエリ可能型* と見なされ、LINQ で照会できます。</span><span class="sxs-lookup"><span data-stu-id="e3911-123">In addition, any collection that implements <xref:System.Collections.Generic.IEnumerable%601?displayProperty=nameWithType> is considered a *queryable type* and can be queried with LINQ.</span></span> <span data-ttu-id="e3911-124">LINQ クエリでは、データにアクセスするための共通パターンが提供されます。</span><span class="sxs-lookup"><span data-stu-id="e3911-124">LINQ queries provide a common pattern for accessing data.</span></span> <span data-ttu-id="e3911-125">通常、これらは、標準の `foreach` ループよりも簡潔で読みやすく、フィルター処理、並べ替え、およびグループ化の機能を利用できます。</span><span class="sxs-lookup"><span data-stu-id="e3911-125">They are typically more concise and readable than standard `foreach` loops, and provide filtering, ordering and grouping capabilities.</span></span> <span data-ttu-id="e3911-126">さらに、LINQ クエリによってパフォーマンスを向上させることができます。</span><span class="sxs-lookup"><span data-stu-id="e3911-126">LINQ queries can also improve performance.</span></span> <span data-ttu-id="e3911-127">詳細については、[LINQ to Objects (C#)](../../csharp/programming-guide/concepts/linq/linq-to-objects.md)、[LINQ to Objects (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)、[Parallel LINQ (PLINQ)](../parallel-programming/introduction-to-plinq.md)、[LINQ クエリの概要 (C#)](../../csharp/programming-guide/concepts/linq/introduction-to-linq-queries.md)、および[基本的なクエリ操作 (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/basic-query-operations.md) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e3911-127">For more information, see [LINQ to Objects (C#)](../../csharp/programming-guide/concepts/linq/linq-to-objects.md), [LINQ to Objects (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md), [Parallel LINQ (PLINQ)](../parallel-programming/introduction-to-plinq.md), [Introduction to LINQ Queries (C#)](../../csharp/programming-guide/concepts/linq/introduction-to-linq-queries.md), and [Basic Query Operations (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/basic-query-operations.md).</span></span>

- <span data-ttu-id="e3911-128">**コレクションの内容を配列にコピーする機能**</span><span class="sxs-lookup"><span data-stu-id="e3911-128">**The ability to copy the collection contents to an array**</span></span>

    <span data-ttu-id="e3911-129">**CopyTo** メソッドを使ってすべてのコレクションを配列にコピーできます。ただし、新しい配列の要素の順序は、列挙子が返す順序に基づきます。</span><span class="sxs-lookup"><span data-stu-id="e3911-129">All collections can be copied to an array using the **CopyTo** method; however, the order of the elements in the new array is based on the sequence in which the enumerator returns them.</span></span> <span data-ttu-id="e3911-130">結果の配列は、常に下限がゼロの 1 次元です。</span><span class="sxs-lookup"><span data-stu-id="e3911-130">The resulting array is always one-dimensional with a lower bound of zero.</span></span>

<span data-ttu-id="e3911-131">また、多くのコレクション クラスに次の機能が含まれています。</span><span class="sxs-lookup"><span data-stu-id="e3911-131">In addition, many collection classes contain the following features:</span></span>

- <span data-ttu-id="e3911-132">**容量とカウントのプロパティ**</span><span class="sxs-lookup"><span data-stu-id="e3911-132">**Capacity and Count properties**</span></span>

    <span data-ttu-id="e3911-133">コレクションの容量とは、そこに含むことのできる要素の数です。</span><span class="sxs-lookup"><span data-stu-id="e3911-133">The capacity of a collection is the number of elements it can contain.</span></span> <span data-ttu-id="e3911-134">コレクションのカウントとは、実際に含まれている要素の数です。</span><span class="sxs-lookup"><span data-stu-id="e3911-134">The count of a collection is the number of elements it actually contains.</span></span> <span data-ttu-id="e3911-135">コレクションによっては、容量またはカウント、あるいはその両方を内部で処理する場合があります。</span><span class="sxs-lookup"><span data-stu-id="e3911-135">Some collections hide the capacity or the count or both.</span></span>

    <span data-ttu-id="e3911-136">ほとんどのコレクションで、現在の容量に達すると自動的に容量が拡張されます。</span><span class="sxs-lookup"><span data-stu-id="e3911-136">Most collections automatically expand in capacity when the current capacity is reached.</span></span> <span data-ttu-id="e3911-137">メモリが再割り当てされ、要素は古いコレクションから新しいコレクションにコピーされます。</span><span class="sxs-lookup"><span data-stu-id="e3911-137">The memory is reallocated, and the elements are copied from the old collection to the new one.</span></span> <span data-ttu-id="e3911-138">これにより、コレクションを使用するために必要なコードが削減されます。ただし、コレクションのパフォーマンスに悪影響を及ぼす可能性があります。</span><span class="sxs-lookup"><span data-stu-id="e3911-138">This reduces the code required to use the collection; however, the performance of the collection might be negatively affected.</span></span> <span data-ttu-id="e3911-139">たとえば、<xref:System.Collections.Generic.List%601> では、<xref:System.Collections.Generic.List%601.Count%2A> が <xref:System.Collections.Generic.List%601.Capacity%2A> 未満の場合、項目の追加は O(1) 操作になります。</span><span class="sxs-lookup"><span data-stu-id="e3911-139">For example, for <xref:System.Collections.Generic.List%601>, if <xref:System.Collections.Generic.List%601.Count%2A> is less than <xref:System.Collections.Generic.List%601.Capacity%2A>, adding an item is an O(1) operation.</span></span> <span data-ttu-id="e3911-140">容量を増やして新しい要素を格納する必要がある場合、項目の追加は O(`n`) 操作になります。ここで、`n` は <xref:System.Collections.Generic.List%601.Count%2A> です。</span><span class="sxs-lookup"><span data-stu-id="e3911-140">If the capacity needs to be increased to accommodate the new element, adding an item becomes an O(`n`) operation, where `n` is <xref:System.Collections.Generic.List%601.Count%2A>.</span></span> <span data-ttu-id="e3911-141">複数の再割り当てによるパフォーマンスの低下を回避するには、初期容量をコレクションの見積もりサイズに設定しておくことが最善の方法です。</span><span class="sxs-lookup"><span data-stu-id="e3911-141">The best way to avoid poor performance caused by multiple reallocations is to set the initial capacity to be the estimated size of the collection.</span></span>

    <span data-ttu-id="e3911-142"><xref:System.Collections.BitArray> は特殊なケースで、その容量はその長さと同じで、長さはそのカウントと同じです。</span><span class="sxs-lookup"><span data-stu-id="e3911-142">A <xref:System.Collections.BitArray> is a special case; its capacity is the same as its length, which is the same as its count.</span></span>

- <span data-ttu-id="e3911-143">**一貫した下限**</span><span class="sxs-lookup"><span data-stu-id="e3911-143">**A consistent lower bound**</span></span>

    <span data-ttu-id="e3911-144">コレクションの下限とは、最初の要素のインデックスです。</span><span class="sxs-lookup"><span data-stu-id="e3911-144">The lower bound of a collection is the index of its first element.</span></span> <span data-ttu-id="e3911-145"><xref:System.Collections> 名前空間のすべてのインデックス付きコレクションの下限がゼロです。つまり、インデックスがゼロから始まります。</span><span class="sxs-lookup"><span data-stu-id="e3911-145">All indexed collections in the <xref:System.Collections> namespaces have a lower bound of zero, meaning they are 0-indexed.</span></span> <span data-ttu-id="e3911-146"><xref:System.Array> の下限は既定でゼロですが、<xref:System.Array.CreateInstance%2A?displayProperty=nameWithType> を使用して **Array** クラスのインスタンスを作成する場合には、別の下限を定義できます。</span><span class="sxs-lookup"><span data-stu-id="e3911-146"><xref:System.Array> has a lower bound of zero by default, but a different lower bound can be defined when creating an instance of the **Array** class using <xref:System.Array.CreateInstance%2A?displayProperty=nameWithType>.</span></span>

- <span data-ttu-id="e3911-147">**複数のスレッドからのアクセスの同期** (<xref:System.Collections> クラスのみ)。</span><span class="sxs-lookup"><span data-stu-id="e3911-147">**Synchronization for access from multiple threads** (<xref:System.Collections> classes only).</span></span>

    <span data-ttu-id="e3911-148"><xref:System.Collections> 名前空間の非ジェネリック コレクション型では、同期によるスレッド セーフが提供され、通常、<xref:System.Collections.ICollection.SyncRoot%2A> メンバーと <xref:System.Collections.ICollection.IsSynchronized%2A> メンバーを介して公開されます。</span><span class="sxs-lookup"><span data-stu-id="e3911-148">Non-generic collection types in the <xref:System.Collections> namespace provide some thread safety with synchronization; typically exposed through the <xref:System.Collections.ICollection.SyncRoot%2A> and  <xref:System.Collections.ICollection.IsSynchronized%2A> members.</span></span> <span data-ttu-id="e3911-149">既定では、これらのコレクションはスレッド セーフではありません。</span><span class="sxs-lookup"><span data-stu-id="e3911-149">These collections are not thread-safe by default.</span></span> <span data-ttu-id="e3911-150">拡張性が高く効率的な、コレクションへのマルチスレッド アクセスが必要な場合は、<xref:System.Collections.Concurrent> 名前空間のいずれかのクラスを使用するか、変更できないコレクションを使用することを検討します。</span><span class="sxs-lookup"><span data-stu-id="e3911-150">If you require scalable and efficient multi-threaded access to a collection, use one of the classes in the <xref:System.Collections.Concurrent> namespace or consider using an immutable collection.</span></span> <span data-ttu-id="e3911-151">詳しくは、「[スレッド セーフなコレクション](thread-safe/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e3911-151">For more information, see [Thread-Safe Collections](thread-safe/index.md).</span></span>

<a name="BKMK_Choosingacollection"></a>

## <a name="choose-a-collection"></a><span data-ttu-id="e3911-152">コレクションの選択</span><span class="sxs-lookup"><span data-stu-id="e3911-152">Choose a collection</span></span>

<span data-ttu-id="e3911-153">通常は、ジェネリック コレクションを使用します。</span><span class="sxs-lookup"><span data-stu-id="e3911-153">In general, you should use generic collections.</span></span> <span data-ttu-id="e3911-154">次の表では、一般的なコレクションのシナリオとこれらのシナリオに使用できるコレクション クラスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="e3911-154">The following table describes some common collection scenarios and the collection classes you can use for those scenarios.</span></span> <span data-ttu-id="e3911-155">ジェネリック コレクションに対する知識がない場合、このテーブルは、タスクに最適なジェネリック コレクションを選択するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="e3911-155">If you are new to generic collections, this table will help you choose the generic collection that works the best for your task.</span></span>

|<span data-ttu-id="e3911-156">やりたいこと</span><span class="sxs-lookup"><span data-stu-id="e3911-156">I want to…</span></span>|<span data-ttu-id="e3911-157">ジェネリック コレクションのオプション</span><span class="sxs-lookup"><span data-stu-id="e3911-157">Generic collection options</span></span>|<span data-ttu-id="e3911-158">非ジェネリック コレクションのオプション</span><span class="sxs-lookup"><span data-stu-id="e3911-158">Non-generic collection options</span></span>|<span data-ttu-id="e3911-159">スレッド セーフまたは変更できないコレクションのオプション</span><span class="sxs-lookup"><span data-stu-id="e3911-159">Thread-safe or immutable collection options</span></span>|
|-|-|-|-|
|<span data-ttu-id="e3911-160">キーによるクイック検索用のキー/値のペアとして項目を保存する</span><span class="sxs-lookup"><span data-stu-id="e3911-160">Store items as key/value pairs for quick look-up by key</span></span>|<xref:System.Collections.Generic.Dictionary%602>|<xref:System.Collections.Hashtable><br /><br /> <span data-ttu-id="e3911-161">(キーのハッシュ コードに基づいて編成された、キーと値のペアのコレクション。)</span><span class="sxs-lookup"><span data-stu-id="e3911-161">(A collection of key/value pairs that are organized based on the hash code of the key.)</span></span>|<xref:System.Collections.Concurrent.ConcurrentDictionary%602><br /><br /> <xref:System.Collections.ObjectModel.ReadOnlyDictionary%602><br /><br /> <xref:System.Collections.Immutable.ImmutableDictionary%602>|
|<span data-ttu-id="e3911-162">インデックスで項目にアクセスする</span><span class="sxs-lookup"><span data-stu-id="e3911-162">Access items by index</span></span>|<xref:System.Collections.Generic.List%601>|<xref:System.Array><br /><br /> <xref:System.Collections.ArrayList>|<xref:System.Collections.Immutable.ImmutableList%601><br /><br /> <xref:System.Collections.Immutable.ImmutableArray>|
|<span data-ttu-id="e3911-163">先入れ先出し (FIFO) で項目を使用する</span><span class="sxs-lookup"><span data-stu-id="e3911-163">Use items first-in-first-out (FIFO)</span></span>|<xref:System.Collections.Generic.Queue%601>|<xref:System.Collections.Queue>|<xref:System.Collections.Concurrent.ConcurrentQueue%601><br /><br /> <xref:System.Collections.Immutable.ImmutableQueue%601>|
|<span data-ttu-id="e3911-164">後入れ先出し (LIFO) でデータを使用する</span><span class="sxs-lookup"><span data-stu-id="e3911-164">Use data Last-In-First-Out (LIFO)</span></span>|<xref:System.Collections.Generic.Stack%601>|<xref:System.Collections.Stack>|<xref:System.Collections.Concurrent.ConcurrentStack%601><br /><br /> <xref:System.Collections.Immutable.ImmutableStack%601>|
|<span data-ttu-id="e3911-165">項目に順次アクセスする</span><span class="sxs-lookup"><span data-stu-id="e3911-165">Access items sequentially</span></span>|<xref:System.Collections.Generic.LinkedList%601>|<span data-ttu-id="e3911-166">推奨しません</span><span class="sxs-lookup"><span data-stu-id="e3911-166">No recommendation</span></span>|<span data-ttu-id="e3911-167">推奨しません</span><span class="sxs-lookup"><span data-stu-id="e3911-167">No recommendation</span></span>|
|<span data-ttu-id="e3911-168">項目がコレクションから削除またはコレクションに追加されるときに通知を受け取る。</span><span class="sxs-lookup"><span data-stu-id="e3911-168">Receive notifications when items are removed or added to the collection.</span></span> <span data-ttu-id="e3911-169">(<xref:System.ComponentModel.INotifyPropertyChanged> と <xref:System.Collections.Specialized.INotifyCollectionChanged> を実装する)</span><span class="sxs-lookup"><span data-stu-id="e3911-169">(implements <xref:System.ComponentModel.INotifyPropertyChanged> and <xref:System.Collections.Specialized.INotifyCollectionChanged>)</span></span>|<xref:System.Collections.ObjectModel.ObservableCollection%601>|<span data-ttu-id="e3911-170">推奨しません</span><span class="sxs-lookup"><span data-stu-id="e3911-170">No recommendation</span></span>|<span data-ttu-id="e3911-171">推奨しません</span><span class="sxs-lookup"><span data-stu-id="e3911-171">No recommendation</span></span>|
|<span data-ttu-id="e3911-172">並べ替えられたコレクション</span><span class="sxs-lookup"><span data-stu-id="e3911-172">A sorted collection</span></span>|<xref:System.Collections.Generic.SortedList%602>|<xref:System.Collections.SortedList>|<xref:System.Collections.Immutable.ImmutableSortedDictionary%602><br /><br /> <xref:System.Collections.Immutable.ImmutableSortedSet%601>|
|<span data-ttu-id="e3911-173">数学関数のセット</span><span class="sxs-lookup"><span data-stu-id="e3911-173">A set for mathematical functions</span></span>|<xref:System.Collections.Generic.HashSet%601><br /><br /> <xref:System.Collections.Generic.SortedSet%601>|<span data-ttu-id="e3911-174">推奨しません</span><span class="sxs-lookup"><span data-stu-id="e3911-174">No recommendation</span></span>|<xref:System.Collections.Immutable.ImmutableHashSet%601><br /><br /> <xref:System.Collections.Immutable.ImmutableSortedSet%601>|

### <a name="algorithmic-complexity-of-collections"></a><span data-ttu-id="e3911-175">コレクションのアルゴリズムの複雑さ</span><span class="sxs-lookup"><span data-stu-id="e3911-175">Algorithmic complexity of collections</span></span>

<span data-ttu-id="e3911-176">[コレクション クラス](selecting-a-collection-class.md)を選択する際は、パフォーマンスの潜在的なトレードオフを考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e3911-176">When choosing a [collection class](selecting-a-collection-class.md), it is worth considering potential tradeoffs in performance.</span></span> <span data-ttu-id="e3911-177">アルゴリズムの複雑さについては、次の表を使用して、さまざまな変更可能なコレクション型とそれに対応する変更できないコレクション型を比較できます。</span><span class="sxs-lookup"><span data-stu-id="e3911-177">Use the following table to reference how various mutable collection types compare in algorithmic complexity to their corresponding immutable counterparts.</span></span> <span data-ttu-id="e3911-178">変更できないコレクション型は多くの場合、パフォーマンスは劣りますが、不変性が提供され、これは、比較時に有効なメリットになることが多いです。</span><span class="sxs-lookup"><span data-stu-id="e3911-178">Often immutable collection types are less performant but provide immutability - which is often a valid comparative benefit.</span></span>

| <span data-ttu-id="e3911-179">変更可能</span><span class="sxs-lookup"><span data-stu-id="e3911-179">Mutable</span></span>                   | <span data-ttu-id="e3911-180">分散</span><span class="sxs-lookup"><span data-stu-id="e3911-180">Amortized</span></span>  | <span data-ttu-id="e3911-181">最悪のケース</span><span class="sxs-lookup"><span data-stu-id="e3911-181">Worst Case</span></span>                | <span data-ttu-id="e3911-182">変更不可</span><span class="sxs-lookup"><span data-stu-id="e3911-182">Immutable</span></span>                          | <span data-ttu-id="e3911-183">複雑さ</span><span class="sxs-lookup"><span data-stu-id="e3911-183">Complexity</span></span> |
|---------------------------|------------|---------------------------|------------------------------------|------------|
| `Stack<T>.Push`           | <span data-ttu-id="e3911-184">O(1)</span><span class="sxs-lookup"><span data-stu-id="e3911-184">O(1)</span></span>       | <span data-ttu-id="e3911-185">O(`n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-185">O(`n`)</span></span>                    | `ImmutableStack<T>.Push`           | <span data-ttu-id="e3911-186">O(1)</span><span class="sxs-lookup"><span data-stu-id="e3911-186">O(1)</span></span>       |
| `Queue<T>.Enqueue`        | <span data-ttu-id="e3911-187">O(1)</span><span class="sxs-lookup"><span data-stu-id="e3911-187">O(1)</span></span>       | <span data-ttu-id="e3911-188">O(`n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-188">O(`n`)</span></span>                    | `ImmutableQueue<T>.Enqueue`        | <span data-ttu-id="e3911-189">O(1)</span><span class="sxs-lookup"><span data-stu-id="e3911-189">O(1)</span></span>       |
| `List<T>.Add`             | <span data-ttu-id="e3911-190">O(1)</span><span class="sxs-lookup"><span data-stu-id="e3911-190">O(1)</span></span>       | <span data-ttu-id="e3911-191">O(`n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-191">O(`n`)</span></span>                    | `ImmutableList<T>.Add`             | <span data-ttu-id="e3911-192">O(log `n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-192">O(log `n`)</span></span> |
| `List<T>.Item[Int32]`     | <span data-ttu-id="e3911-193">O(1)</span><span class="sxs-lookup"><span data-stu-id="e3911-193">O(1)</span></span>       | <span data-ttu-id="e3911-194">O(1)</span><span class="sxs-lookup"><span data-stu-id="e3911-194">O(1)</span></span>                      | `ImmutableList<T>.Item[Int32]`     | <span data-ttu-id="e3911-195">O(log `n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-195">O(log `n`)</span></span> |
| `List<T>.Enumerator`      | <span data-ttu-id="e3911-196">O(`n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-196">O(`n`)</span></span>     | <span data-ttu-id="e3911-197">O(`n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-197">O(`n`)</span></span>                    | `ImmutableList<T>.Enumerator`      | <span data-ttu-id="e3911-198">O(`n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-198">O(`n`)</span></span>     |
| <span data-ttu-id="e3911-199">`HashSet<T>.Add`, lookup</span><span class="sxs-lookup"><span data-stu-id="e3911-199">`HashSet<T>.Add`, lookup</span></span>  | <span data-ttu-id="e3911-200">O(1)</span><span class="sxs-lookup"><span data-stu-id="e3911-200">O(1)</span></span>       | <span data-ttu-id="e3911-201">O(`n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-201">O(`n`)</span></span>                    | `ImmutableHashSet<T>.Add`          | <span data-ttu-id="e3911-202">O(log `n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-202">O(log `n`)</span></span> |
| `SortedSet<T>.Add`        | <span data-ttu-id="e3911-203">O(log `n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-203">O(log `n`)</span></span> | <span data-ttu-id="e3911-204">O(`n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-204">O(`n`)</span></span>                    | `ImmutableSortedSet<T>.Add`        | <span data-ttu-id="e3911-205">O(log `n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-205">O(log `n`)</span></span> |
| `Dictionary<T>.Add`       | <span data-ttu-id="e3911-206">O(1)</span><span class="sxs-lookup"><span data-stu-id="e3911-206">O(1)</span></span>       | <span data-ttu-id="e3911-207">O(`n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-207">O(`n`)</span></span>                    | `ImmutableDictionary<T>.Add`       | <span data-ttu-id="e3911-208">O(log `n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-208">O(log `n`)</span></span> |
| <span data-ttu-id="e3911-209">`Dictionary<T>`lookup</span><span class="sxs-lookup"><span data-stu-id="e3911-209">`Dictionary<T>` lookup</span></span>    | <span data-ttu-id="e3911-210">O(1)</span><span class="sxs-lookup"><span data-stu-id="e3911-210">O(1)</span></span>       | <span data-ttu-id="e3911-211">O(1) –厳密には O(`n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-211">O(1) – or strictly O(`n`)</span></span> | <span data-ttu-id="e3911-212">`ImmutableDictionary<T>`lookup</span><span class="sxs-lookup"><span data-stu-id="e3911-212">`ImmutableDictionary<T>` lookup</span></span>    | <span data-ttu-id="e3911-213">O(log `n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-213">O(log `n`)</span></span> |
| `SortedDictionary<T>.Add` | <span data-ttu-id="e3911-214">O(log `n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-214">O(log `n`)</span></span> | <span data-ttu-id="e3911-215">O(`n` log `n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-215">O(`n` log `n`)</span></span>            | `ImmutableSortedDictionary<T>.Add` | <span data-ttu-id="e3911-216">O(log `n`)</span><span class="sxs-lookup"><span data-stu-id="e3911-216">O(log `n`)</span></span> |

<span data-ttu-id="e3911-217">`List<T>` は、`for` ループまたは `foreach` ループを使用して効率的に列挙できます。</span><span class="sxs-lookup"><span data-stu-id="e3911-217">A `List<T>` can be efficiently enumerated using either a `for` loop or a `foreach` loop.</span></span> <span data-ttu-id="e3911-218">ただし、`ImmutableList<T>` では、インデクサーの O(log `n`) 時間が原因で、`for` ループ内のジョブは適切に実行されません。</span><span class="sxs-lookup"><span data-stu-id="e3911-218">An `ImmutableList<T>`, however, does a poor job inside a `for` loop, due to the O(log `n`) time for its indexer.</span></span> <span data-ttu-id="e3911-219">`foreach` ループを使用した `ImmutableList<T>` の列挙は、`ImmutableList<T>` では、`List<T>` のような単純な配列ではなく、バイナリ ツリーを使用してデータを格納するため、効率的です。</span><span class="sxs-lookup"><span data-stu-id="e3911-219">Enumerating an `ImmutableList<T>` using a `foreach` loop is efficient because `ImmutableList<T>` uses a binary tree to store its data instead of a simple array like `List<T>` uses.</span></span> <span data-ttu-id="e3911-220">配列は、簡単にインデックスを付けることができます。一方、バイナリ ツリーは、目的のインデックスを持つノードが見つかるまで下に移動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e3911-220">An array can be very quickly indexed into, whereas a binary tree must be walked down until the node with the desired index is found.</span></span>

<span data-ttu-id="e3911-221">さらに、`SortedSet<T>` の複雑さは `ImmutableSortedSet<T>` と同じです。</span><span class="sxs-lookup"><span data-stu-id="e3911-221">Additionally, `SortedSet<T>` has the same complexity as `ImmutableSortedSet<T>`.</span></span> <span data-ttu-id="e3911-222">これらは両方ともバイナリ ツリーを使用するからです。</span><span class="sxs-lookup"><span data-stu-id="e3911-222">That's because they both use binary trees.</span></span> <span data-ttu-id="e3911-223">もちろん、大きな違いは、`ImmutableSortedSet<T>` では、変更できないバイナリ ツリーが使用されることです。</span><span class="sxs-lookup"><span data-stu-id="e3911-223">The significant difference, of course, is that `ImmutableSortedSet<T>` uses an immutable binary tree.</span></span> <span data-ttu-id="e3911-224">`ImmutableSortedSet<T>` には、変更を許可する <xref:System.Collections.Immutable.ImmutableSortedSet%601.Builder?displayProperty=nameWithType> クラスも用意されているため、不変性とパフォーマンスの両方を備えることができます。</span><span class="sxs-lookup"><span data-stu-id="e3911-224">Since `ImmutableSortedSet<T>` also offers a <xref:System.Collections.Immutable.ImmutableSortedSet%601.Builder?displayProperty=nameWithType> class that allows mutation, you can have both immutability and performance.</span></span>

<a name="BKMK_RelatedTopics"></a>

## <a name="related-topics"></a><span data-ttu-id="e3911-225">関連トピック</span><span class="sxs-lookup"><span data-stu-id="e3911-225">Related Topics</span></span>

|<span data-ttu-id="e3911-226">Title</span><span class="sxs-lookup"><span data-stu-id="e3911-226">Title</span></span>|<span data-ttu-id="e3911-227">説明</span><span class="sxs-lookup"><span data-stu-id="e3911-227">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="e3911-228">コレクション クラスの選択</span><span class="sxs-lookup"><span data-stu-id="e3911-228">Selecting a Collection Class</span></span>](selecting-a-collection-class.md)|<span data-ttu-id="e3911-229">さまざまなコレクションについて説明し、いずれかのシナリオを選択できるよう支援します。</span><span class="sxs-lookup"><span data-stu-id="e3911-229">Describes the different collections and helps you select one for your scenario.</span></span>|
|[<span data-ttu-id="e3911-230"> 一般的に使用されるコレクション型</span><span class="sxs-lookup"><span data-stu-id="e3911-230">Commonly Used Collection Types</span></span>](commonly-used-collection-types.md)|<span data-ttu-id="e3911-231"><xref:System.Array?displayProperty=nameWithType>、<xref:System.Collections.Generic.List%601?displayProperty=nameWithType>、<xref:System.Collections.Generic.Dictionary%602?displayProperty=nameWithType> などの一般的に使用されるジェネリックと非ジェネリック コレクション型について説明します。</span><span class="sxs-lookup"><span data-stu-id="e3911-231">Describes commonly used generic and nongeneric collection types such as <xref:System.Array?displayProperty=nameWithType>, <xref:System.Collections.Generic.List%601?displayProperty=nameWithType>, and <xref:System.Collections.Generic.Dictionary%602?displayProperty=nameWithType>.</span></span>|
|[<span data-ttu-id="e3911-232">ジェネリック コレクションを使用する状況</span><span class="sxs-lookup"><span data-stu-id="e3911-232">When to Use Generic Collections</span></span>](when-to-use-generic-collections.md)|<span data-ttu-id="e3911-233">ジェネリック コレクション型の使用について説明します。</span><span class="sxs-lookup"><span data-stu-id="e3911-233">Discusses the use of generic collection types.</span></span>|
|[<span data-ttu-id="e3911-234">コレクション内での比較と並べ替え</span><span class="sxs-lookup"><span data-stu-id="e3911-234">Comparisons and Sorts Within Collections</span></span>](comparisons-and-sorts-within-collections.md)|<span data-ttu-id="e3911-235">コレクションでの等価比較と並べ替え比較の使用について説明します。</span><span class="sxs-lookup"><span data-stu-id="e3911-235">Discusses the use of equality comparisons and sorting comparisons in collections.</span></span>|
|[<span data-ttu-id="e3911-236">Sorted コレクション型</span><span class="sxs-lookup"><span data-stu-id="e3911-236">Sorted Collection Types</span></span>](sorted-collection-types.md)|<span data-ttu-id="e3911-237">並べ替えられたコレクションのパフォーマンスと特性について説明します</span><span class="sxs-lookup"><span data-stu-id="e3911-237">Describes sorted collections performance and characteristics</span></span>|
|[<span data-ttu-id="e3911-238">Hashtable コレクション型と Dictionary コレクション型</span><span class="sxs-lookup"><span data-stu-id="e3911-238">Hashtable and Dictionary Collection Types</span></span>](hashtable-and-dictionary-collection-types.md)|<span data-ttu-id="e3911-239">ジェネリックと非ジェネリックのハッシュをベースにしたディクショナリ型の機能について説明します。</span><span class="sxs-lookup"><span data-stu-id="e3911-239">Describes the features of generic and non-generic hash-based dictionary types.</span></span>|
|[<span data-ttu-id="e3911-240">スレッドセーフなコレクション</span><span class="sxs-lookup"><span data-stu-id="e3911-240">Thread-Safe Collections</span></span>](thread-safe/index.md)|<span data-ttu-id="e3911-241">複数のスレッドからの安全で効率的な同時アクセスをサポートする <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType> や <xref:System.Collections.Concurrent.ConcurrentBag%601?displayProperty=nameWithType> などのコレクション型について説明します。</span><span class="sxs-lookup"><span data-stu-id="e3911-241">Describes collection types such as <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType> and <xref:System.Collections.Concurrent.ConcurrentBag%601?displayProperty=nameWithType> that support safe and efficient concurrent access from multiple threads.</span></span>|
|<span data-ttu-id="e3911-242">System.Collections.Immutable</span><span class="sxs-lookup"><span data-stu-id="e3911-242">System.Collections.Immutable</span></span>|<span data-ttu-id="e3911-243">変更できないコレクションを導入し、コレクション型へのリンクを提供します。</span><span class="sxs-lookup"><span data-stu-id="e3911-243">Introduces the immutable collections and provides links to the collection types.</span></span>|

<a name="BKMK_Reference"></a>

## <a name="reference"></a><span data-ttu-id="e3911-244">関連項目</span><span class="sxs-lookup"><span data-stu-id="e3911-244">Reference</span></span>

<xref:System.Array?displayProperty=nameWithType>
<xref:System.Collections?displayProperty=nameWithType>
<xref:System.Collections.Concurrent?displayProperty=nameWithType>
<xref:System.Collections.Generic?displayProperty=nameWithType>
<xref:System.Collections.Specialized?displayProperty=nameWithType>
<xref:System.Linq?displayProperty=nameWithType>
<xref:System.Collections.Immutable>
