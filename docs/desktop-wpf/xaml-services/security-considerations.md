---
title: XAML セキュリティの考慮事項
ms.date: 03/30/2017
helpviewer_keywords:
- security [XAML Services], .NET XAML services
- XAML security [XAML Services]
ms.assetid: 544296d4-f38e-4498-af49-c9f4dad28964
ms.openlocfilehash: 1864910b339c74e3033fb4d6d8baebffada1a4f8
ms.sourcegitcommit: c2d9718996402993cf31541f11e95531bc68bad0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/27/2020
ms.locfileid: "81432918"
---
# <a name="xaml-security-considerations"></a><span data-ttu-id="fb8a8-102">XAML のセキュリティに関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="fb8a8-102">XAML security considerations</span></span>

<span data-ttu-id="fb8a8-103">この記事では、XAML および .NET XAML サービス API を使用する場合のアプリケーションのセキュリティに関するベスト プラクティスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-103">This article describes best practices for security in applications when you use XAML and .NET XAML Services API.</span></span>

## <a name="untrusted-xaml-in-applications"></a><span data-ttu-id="fb8a8-104">アプリケーションでの信頼されていない XAML</span><span class="sxs-lookup"><span data-stu-id="fb8a8-104">Untrusted XAML in Applications</span></span>

<span data-ttu-id="fb8a8-105">最も一般的な意味では、信頼されていない XAML は、アプリケーションが明示的に含めなかった XAML ソースです。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-105">In the most general sense, untrusted XAML is any XAML source that your application did not specifically include or emit.</span></span>

<span data-ttu-id="fb8a8-106">信頼済みで署名されたアセンブリ内で`resx`-type リソースにコンパイルまたは格納される XAML は、本質的に信頼されていません。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-106">XAML that is compiled into or stored as a `resx`-type resource within a trusted and signed assembly is not inherently untrusted.</span></span> <span data-ttu-id="fb8a8-107">アセンブリ全体を信頼できるのと同じくらい XAML を信頼できます。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-107">You can trust the XAML as much as you trust the assembly as a whole.</span></span> <span data-ttu-id="fb8a8-108">ほとんどの場合、ストリームまたはその他の I/O から読み込む XAML ソースである、緩い XAML の信頼の側面にのみ関心があります。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-108">In most cases, you are only concerned with the trust aspects of loose XAML, which is a XAML source that you load from a stream or other I/O.</span></span> <span data-ttu-id="fb8a8-109">Loose XAML は、配置およびパッケージ化インフラストラクチャを備えたアプリケーション モデルの特定のコンポーネントや機能ではありません。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-109">Loose XAML is not a specific component or feature of an application model with a deployment and packaging infrastructure.</span></span> <span data-ttu-id="fb8a8-110">ただし、アセンブリは、loose XAML の読み込みを含む動作を実装する場合があります。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-110">However, an assembly might implement a behavior that involves loading loose XAML.</span></span>

<span data-ttu-id="fb8a8-111">信頼されていない XAML の場合は、通常、信頼されていないコードと同じように扱う必要があります。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-111">For untrusted XAML, you should treat it generally the same as if it were untrusted code.</span></span> <span data-ttu-id="fb8a8-112">サンドボックスまたは他のメタファを使用して、信頼できない XAML から信頼されたコードにアクセスすることを防ぎます。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-112">Use sandboxing or other metaphors to prevent possibly untrusted XAML from accessing your trusted code.</span></span>

<span data-ttu-id="fb8a8-113">XAML 機能の性質により、XAML はオブジェクトを構築し、そのプロパティを設定する権限を与えます。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-113">The nature of XAML capabilities gives the XAML the right to construct objects and set their properties.</span></span> <span data-ttu-id="fb8a8-114">これらの機能には、型コンバーターへのアクセス、アプリケーション ドメイン内のアセンブリへのマッピングとアクセス、マークアップ拡張機能、`x:Code`ブロックなどを使用する機能も含まれます。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-114">These capabilities also include accessing type converters, mapping and accessing assemblies in the application domain, using markup extensions, `x:Code` blocks, and so on.</span></span>

<span data-ttu-id="fb8a8-115">言語レベルの機能に加えて、多くのテクノロジで UI 定義に XAML が使用されます。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-115">In addition to its language-level capabilities, XAML is used for UI definition in many technologies.</span></span> <span data-ttu-id="fb8a8-116">信頼されていない XAML を読み込むと、悪意のあるスプーフィング UI を読み込むことがあります。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-116">Loading untrusted XAML might mean loading a malicious spoofing UI.</span></span>

## <a name="sharing-context-between-readers-and-writers"></a><span data-ttu-id="fb8a8-117">読者とライターの間でコンテキストを共有する</span><span class="sxs-lookup"><span data-stu-id="fb8a8-117">Sharing Context Between Readers and Writers</span></span>

<span data-ttu-id="fb8a8-118">XAML リーダーと XAML ライターの .NET XAML サービス アーキテクチャでは、XAML リーダーを XAML ライターまたは共有 XAML スキーマ コンテキストと共有する必要がよくあります。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-118">.NET XAML Services architecture for XAML readers and XAML writers often requires sharing a XAML reader to a XAML writer, or a shared XAML schema context.</span></span> <span data-ttu-id="fb8a8-119">XAML ノード ループ ロジックを記述する場合や、カスタムの保存パスを提供する場合は、オブジェクトまたはコンテキストの共有が必要になることがあります。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-119">Sharing objects or contexts might be required if you are writing XAML node loop logic, or providing a custom save path.</span></span> <span data-ttu-id="fb8a8-120">信頼されたコードと信頼されていないコードの間で XAML リーダー インスタンス、既定以外の XAML スキーマ コンテキスト、または XAML リーダー/ライター クラスの設定を共有しないでください。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-120">Don't share XAML reader instances, nondefault XAML schema context, or settings for XAML reader/writer classes between trusted and untrusted code.</span></span>

<span data-ttu-id="fb8a8-121">CLR ベースの型バッキングに対する XAML オブジェクトの書き込みに関連するほとんどのシナリオと操作では、既定の XAML スキーマ コンテキストを使用できます。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-121">Most scenarios and operations involving XAML object writing for a CLR-based type backing can just use default XAML schema context.</span></span> <span data-ttu-id="fb8a8-122">既定の XAML スキーマ コンテキストには、完全な信頼を損なう可能性のある設定が明示的に含まれていません。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-122">The default XAML schema context does not explicitly include settings that could compromise full trust.</span></span> <span data-ttu-id="fb8a8-123">したがって、信頼できる XAML リーダー/ライター コンポーネント間でコンテキストを共有しても安全です。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-123">It is thus safe to share context between trusted and untrusted XAML reader/writer components.</span></span> <span data-ttu-id="fb8a8-124">ただし、これを行う場合でも、このようなリーダーとライターを別々<xref:System.AppDomain>のスコープに保持し、その 1 つを特に意図/サンドボックスして部分的な信頼を得ることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-124">However, if you do this, it is still a best practice to keep such readers and writers in separate <xref:System.AppDomain> scopes, with one of them specifically intended/sandboxed for partial trust.</span></span>

## <a name="xaml-namespaces-and-assembly-trust"></a><span data-ttu-id="fb8a8-125">XAML 名前空間とアセンブリの信頼</span><span class="sxs-lookup"><span data-stu-id="fb8a8-125">XAML Namespaces and Assembly Trust</span></span>

<span data-ttu-id="fb8a8-126">XAML がアセンブリにカスタム XAML 名前空間マッピングを解釈する方法に関する基本的な非修飾構文および定義では、信頼されたアセンブリと信頼されていないアセンブリがアプリケーション ドメインに読み込まれたアセンブリと区別されません。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-126">The basic unqualified syntax and definition for how XAML interprets a custom XAML namespace mapping to an assembly does not distinguish between a trusted and untrusted assembly as loaded into the application domain.</span></span> <span data-ttu-id="fb8a8-127">したがって、信頼されていないアセンブリが、信頼されたアセンブリの目的の XAML 名前空間マッピングを偽装し、XAML ソースの宣言されたオブジェクトとプロパティ情報を取得することは技術的に可能です。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-127">Thus, it is technically possible for an untrusted assembly to spoof a trusted assembly's intended XAML namespace mapping and capture a XAML source's declared object and property information.</span></span> <span data-ttu-id="fb8a8-128">この状況を回避するためのセキュリティ要件がある場合は、次のいずれかの方法を使用して、目的の XAML 名前空間マッピングを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-128">If you have security requirements to avoid this situation, your intended XAML namespace mapping should be made using one of the following techniques:</span></span>

- <span data-ttu-id="fb8a8-129">アプリケーションの XAML で作成された XAML 名前空間マッピングでは、厳密な名前を持つ完全修飾アセンブリ名を使用します。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-129">Use a fully qualified assembly name with strong name in any XAML namespace mapping made by your application's XAML.</span></span>

- <span data-ttu-id="fb8a8-130">XAML リーダーと XAML オブジェクト ライターに固有<xref:System.Xaml.XamlSchemaContext>のアセンブリ マッピングを構築することで、固定の参照アセンブリ セットに制限します。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-130">Restrict assembly mapping to a fixed set of reference assemblies, by constructing a specific <xref:System.Xaml.XamlSchemaContext> for your XAML readers and XAML object writers.</span></span> <span data-ttu-id="fb8a8-131">[https://docs.microsoft.com/azure/active-directory/develop/scenario-protected-web-api-overview](<xref:System.Xaml.XamlSchemaContext.%23ctor%28System.Collections.Generic.IEnumerable%7BSystem.Reflection.Assembly%7D%29> ) をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-131">See <xref:System.Xaml.XamlSchemaContext.%23ctor%28System.Collections.Generic.IEnumerable%7BSystem.Reflection.Assembly%7D%29>.</span></span>

## <a name="xaml-type-mapping-and-type-system-access"></a><span data-ttu-id="fb8a8-132">XAML 型マッピングと型システム アクセス</span><span class="sxs-lookup"><span data-stu-id="fb8a8-132">XAML Type Mapping and Type System Access</span></span>

<span data-ttu-id="fb8a8-133">XAML は独自の型システムをサポートしており、多くの点で CLR が基本的な CLR 型システムを実装する方法とは同じです。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-133">XAML supports its own type system, which in many ways is a peer to how CLR implements the basic CLR type system.</span></span> <span data-ttu-id="fb8a8-134">ただし、型の情報に基づいて型に関する信頼の決定を行う型認識の特定の側面については、CLR バッキング型の型情報に従う必要があります。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-134">However, for certain aspects of type awareness where you are making trust decisions about a type based on its type information, you should defer to the type information in the CLR backing types.</span></span> <span data-ttu-id="fb8a8-135">これは、XAML 型システムの特定のレポート機能の一部が仮想メソッドとして開かれたままであるため、元の .NET XAML サービスの実装の制御下に完全にはないためです。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-135">This is because some of the specific reporting capabilities of the XAML type system are left open as virtual methods and are therefore, not fully under the control of the original .NET XAML Services implementations.</span></span> <span data-ttu-id="fb8a8-136">XAML 型システムは拡張可能であり、XAML 自体の拡張性と、既定の CLR で対応する実装と既定の XAML スキーマ コンテキストに対して、その代替型マッピング戦略に対応するため、これらの拡張ポイントが存在します。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-136">These extensibility points exist because the XAML type system is extensible, to match the extensibility of XAML itself and its possible alternative type-mapping strategies versus the default CLR-backed implementation and default XAML schema context.</span></span> <span data-ttu-id="fb8a8-137">詳細については、<xref:System.Xaml.XamlType>および<xref:System.Xaml.XamlMember>のいくつかのプロパティに関する注意事項を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fb8a8-137">For more information, see the specific notes on several of the properties of <xref:System.Xaml.XamlType> and <xref:System.Xaml.XamlMember>.</span></span>

## <a name="see-also"></a><span data-ttu-id="fb8a8-138">関連項目</span><span class="sxs-lookup"><span data-stu-id="fb8a8-138">See also</span></span>

- <xref:System.Xaml.Permissions.XamlAccessLevel>
